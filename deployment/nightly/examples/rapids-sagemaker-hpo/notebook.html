

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Deep Dive into running Hyper Parameter Optimization on AWS SageMaker &#8212; RAPIDS Deployment Documentation  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="https://docs.rapids.ai/assets/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script defer="defer" src="https://docs.rapids.ai/assets/js/custom.js"></script>
    <script defer="defer" src="../../_static/js/nav.js"></script>
    <script defer="defer" src="../../_static/js/notebook-gallery.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script src="https://unpkg.com/mermaid@9.4.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/rapids-sagemaker-hpo/notebook';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Multi-node multi-GPU example on AWS using dask-cloudprovider" href="../rapids-ec2-mnmg/notebook.html" />
    <link rel="prev" title="Running RAPIDS hyperparameter experiments at scale on Amazon SageMaker" href="../rapids-sagemaker-higgs/notebook.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
   

<a class="navbar-brand logo" href="https://docs.rapids.ai/">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/RAPIDS-logo-purple.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/RAPIDS-logo-purple.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class=" navbar-header-items">
    
    <div class="ms-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../local.html">
                        Local
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../cloud/index.html">
                        Cloud
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../hpc.html">
                        HPC
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../platforms/index.html">
                        Platforms
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../tools/index.html">
                        Tools
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Workflow Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../guides/index.html">
                        Guides
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/rapidsai/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../local.html">
                        Local
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../cloud/index.html">
                        Cloud
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../hpc.html">
                        HPC
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../platforms/index.html">
                        Platforms
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../tools/index.html">
                        Tools
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Workflow Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../guides/index.html">
                        Guides
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/rapidsai/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../xgboost-gpu-hpo-job-parallel-k8s/notebook.html">Scaling up hyperparameter optimization with Kubernetes and XGBoost GPU algorithm</a></li>





<li class="toctree-l1"><a class="reference internal" href="../rapids-sagemaker-higgs/notebook.html">Running RAPIDS hyperparameter experiments at scale on Amazon SageMaker</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Deep Dive into running Hyper Parameter Optimization on AWS SageMaker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rapids-ec2-mnmg/notebook.html">Multi-node multi-GPU example on AWS using dask-cloudprovider</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rapids-autoscaling-multi-tenant-kubernetes/notebook.html">Autoscaling multi-tenant Kubernetes Deep-Dive</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Workflow Examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Deep Dive into running Hyper Parameter Optimization on AWS SageMaker</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="deep-dive-into-running-hyper-parameter-optimization-on-aws-sagemaker">
<h1>Deep Dive into running Hyper Parameter Optimization on AWS SageMaker<a class="headerlink" href="#deep-dive-into-running-hyper-parameter-optimization-on-aws-sagemaker" title="Permalink to this heading">#</a></h1>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Hyperparameter_optimization">Hyper Parameter Optimization</a> (HPO) improves model quality by searching over hyperparameters, parameters not typically learned during the training process but rather values that control the learning process itself (e.g., model size/capacity). This search can significantly boost model quality relative to default settings and non-expert tuning; however, HPO can take a very long time on a non-accelerated platform. In this notebook, we containerize a RAPIDS workflow and run Bring-Your-Own-Container SageMaker HPO to show how we can overcome the computational complexity of model search.</p>
<p>We accelerate HPO in two key ways:</p>
<ul class="simple">
<li><p>by <em>scaling within a node</em> (e.g., multi-GPU where each GPU brings a magnitude higher core count relative to CPUs), and</p></li>
<li><p>by <em>scaling across nodes</em> and running parallel trials on cloud instances.</p></li>
</ul>
<p>By combining these two powers HPO experiments that feel unapproachable and may take multiple days on CPU instances can complete in just hours. For example, we find a <span style="color:#8735fb; font-size:14pt"> <strong>12x</strong> </span> speedup in wall clock time (6 hours vs 3+ days) and a <span style="color:#8735fb; font-size:14pt"> <strong>4.5x</strong> </span> reduction in cost when comparing between GPU and CPU <a class="reference external" href="https://docs.aws.amazon.com/sagemaker/latest/dg/model-managed-spot-training.html">EC2 Spot instances</a> on 100 XGBoost HPO trials using 10 parallel workers on 10 years of the Airline Dataset (~63M flights) hosted in a S3 bucket. For additional details refer to the <a href='#experiments'>end of the notebook</a>.</p>
<p>With all these powerful tools at our disposal, every data scientist should feel empowered to up-level their model before serving it to the world!</p>
<img src='../../_static/images/examples/rapids-sagemaker-hpo/hpo.png'><section id="preamble">
<h2>Preamble<a class="headerlink" href="#preamble" title="Permalink to this heading">#</a></h2>
<p>To get things rolling let’s make sure we can query our AWS SageMaker execution role and session as well as our account ID and AWS region.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>docker<span class="w"> </span>images
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>REPOSITORY   TAG       IMAGE ID   CREATED   SIZE
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pip</span> install --upgrade boto3
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Looking in indexes: https://pypi.org/simple, https://pip.repos.neuron.amazonaws.com
Requirement already satisfied: boto3 in /home/ec2-user/anaconda3/envs/python3/lib/python3.10/site-packages (1.26.54)
Requirement already satisfied: s3transfer&lt;0.7.0,&gt;=0.6.0 in /home/ec2-user/anaconda3/envs/python3/lib/python3.10/site-packages (from boto3) (0.6.0)
Requirement already satisfied: botocore&lt;1.30.0,&gt;=1.29.54 in /home/ec2-user/anaconda3/envs/python3/lib/python3.10/site-packages (from boto3) (1.29.54)
Requirement already satisfied: jmespath&lt;2.0.0,&gt;=0.7.1 in /home/ec2-user/anaconda3/envs/python3/lib/python3.10/site-packages (from boto3) (1.0.1)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.25.4 in /home/ec2-user/anaconda3/envs/python3/lib/python3.10/site-packages (from botocore&lt;1.30.0,&gt;=1.29.54-&gt;boto3) (1.26.8)
Requirement already satisfied: python-dateutil&lt;3.0.0,&gt;=2.1 in /home/ec2-user/anaconda3/envs/python3/lib/python3.10/site-packages (from botocore&lt;1.30.0,&gt;=1.29.54-&gt;boto3) (2.8.2)
Requirement already satisfied: six&gt;=1.5 in /home/ec2-user/anaconda3/envs/python3/lib/python3.10/site-packages (from python-dateutil&lt;3.0.0,&gt;=2.1-&gt;botocore&lt;1.30.0,&gt;=1.29.54-&gt;boto3) (1.16.0)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sagemaker</span>
<span class="kn">from</span> <span class="nn">helper_functions</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">execution_role</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">get_execution_role</span><span class="p">()</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

<span class="n">account</span> <span class="o">=</span> <span class="o">!(</span>aws<span class="w"> </span>sts<span class="w"> </span>get-caller-identity<span class="w"> </span>--query<span class="w"> </span>Account<span class="w"> </span>--output<span class="w"> </span>text<span class="o">)</span>
<span class="n">region</span> <span class="o">=</span> <span class="o">!(</span>aws<span class="w"> </span>configure<span class="w"> </span>get<span class="w"> </span>region<span class="o">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">account</span><span class="p">,</span> <span class="n">region</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>([&#39;561241433344&#39;], [&#39;us-west-2&#39;])
</pre></div>
</div>
</div>
</div>
<section id="key-choices">
<h3>Key Choices<a class="headerlink" href="#key-choices" title="Permalink to this heading">#</a></h3>
<p>Let’s go ahead and choose the configuration options for our HPO run.</p>
<p>Below are two reference configurations showing a small and a large scale HPO (sized in terms of total experiments/compute).</p>
<p>The default values in the notebook are set for the small HPO configuration, however you are welcome to scale them up.</p>
<blockquote>
<div><p><strong>small HPO</strong>: 1_year, XGBoost, 3 CV folds, singleGPU, max_jobs = 10, max_parallel_jobs = 2</p>
</div></blockquote>
<blockquote>
<div><p><strong>large HPO</strong>: 10_year, XGBoost, 10 CV folds, multiGPU, max_jobs = 100, max_parallel_jobs = 10</p>
</div></blockquote>
<section id="dataset">
<h4>Dataset<a class="headerlink" href="#dataset" title="Permalink to this heading">#</a></h4>
<p>We offer free hosting for several demo datasets that you can try running HPO with, or alternatively you can bring your own dataset (BYOD).</p>
<p>By default we leverage the <code class="docutils literal notranslate"><span class="pre">Airline</span></code> dataset, which is a large public tracker of US domestic flight logs which we offer in various sizes (1 year, 3 year, and 10 year) and in <a href='https://parquet.apache.org/'>Parquet</a> (compressed column storage) format. The machine learning objective with this dataset is to predict whether flights will be more than 15 minutes late arriving to their destination (<a class="reference external" href="https://www.transtats.bts.gov/DatabaseInfo.asp?DB_ID=120&amp;DB_URL=">dataset link</a>, additional details in <a href='#dataset'>Section 1.1</a>).</p>
<p>As an alternative we also offer the <code class="docutils literal notranslate"><span class="pre">NYC</span> <span class="pre">Taxi</span></code> dataset which captures yellow cab trip details in Ney York in January 2020, stored in <a href='https://en.wikipedia.org/wiki/Comma-separated_values'>CSV </a> format without any compression. The machine learning objective with this dataset is to predict whether a trip had an above average tip (&gt;$2.20).</p>
<p>We host the demo datasets in public S3 demo buckets in both the <strong>us-east-1</strong> (N. Virginia) or <strong>us-west-2</strong> (Oregon) regions (i.e., <code class="docutils literal notranslate"><span class="pre">sagemaker-rapids-hpo-us-east-1</span></code>, and <code class="docutils literal notranslate"><span class="pre">sagemaker-rapids-hpo-us-west-2</span></code>). You should run the SageMaker HPO workflow in either of these two regions if you wish to leverage the demo datasets since SageMaker requires that the S3 dataset and the compute you’ll be renting are co-located.</p>
<p>Lastly, if you plan to use your own dataset refer to the <a href='#byod'>BYOD checklist in the Appendix</a> to help integrate into the workflow.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>dataset</p></th>
<th class="head"><p>data_bucket</p></th>
<th class="head"><p>dataset_directory</p></th>
<th class="head"><p># samples</p></th>
<th class="head"><p>storage type</p></th>
<th class="head"><p>time span</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Airline Stats Small</p></td>
<td><p>demo</p></td>
<td><p>1_year</p></td>
<td><p>6.3M</p></td>
<td><p>Parquet</p></td>
<td><p>2019</p></td>
</tr>
<tr class="row-odd"><td><p>Airline Stats Medium</p></td>
<td><p>demo</p></td>
<td><p>3_year</p></td>
<td><p>18M</p></td>
<td><p>Parquet</p></td>
<td><p>2019-2017</p></td>
</tr>
<tr class="row-even"><td><p>Airline Stats Large</p></td>
<td><p>demo</p></td>
<td><p>10_year</p></td>
<td><p>63M</p></td>
<td><p>Parquet</p></td>
<td><p>2019-2010</p></td>
</tr>
<tr class="row-odd"><td><p>NYC Taxi</p></td>
<td><p>demo</p></td>
<td><p>NYC_taxi</p></td>
<td><p>6.3M</p></td>
<td><p>CSV</p></td>
<td><p>2020 January</p></td>
</tr>
<tr class="row-even"><td><p>Bring Your Own Dataset</p></td>
<td><p>custom</p></td>
<td><p>custom</p></td>
<td><p>custom</p></td>
<td><p>Parquet/CSV</p></td>
<td><p>custom</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># please choose dataset S3 bucket and directory</span>
<span class="n">data_bucket</span> <span class="o">=</span> <span class="s2">&quot;sagemaker-rapids-hpo-&quot;</span> <span class="o">+</span> <span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">dataset_directory</span> <span class="o">=</span> <span class="s2">&quot;10_year&quot;</span>  <span class="c1"># &#39;1_year&#39;, &#39;3_year&#39;, &#39;10_year&#39;, &#39;NYC_taxi&#39;</span>

<span class="c1"># please choose output bucket for trained model(s)</span>
<span class="n">model_output_bucket</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">default_bucket</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s3_data_input</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;s3://</span><span class="si">{</span><span class="n">data_bucket</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">dataset_directory</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">s3_model_output</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;s3://</span><span class="si">{</span><span class="n">model_output_bucket</span><span class="si">}</span><span class="s2">/trained-models&quot;</span>

<span class="n">best_hpo_model_local_save_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="algorithm">
<h4>Algorithm<a class="headerlink" href="#algorithm" title="Permalink to this heading">#</a></h4>
<p>From a ML/algorithm perspective, we offer <a class="reference external" href="https://xgboost.readthedocs.io/en/latest/#">XGBoost</a>, <a class="reference external" href="https://docs.rapids.ai/api/cuml/stable/cuml_blogs.html#tree-and-forest-models">RandomForest</a> and <a class="reference external" href="https://docs.rapids.ai/api/cuml/stable/api.html?highlight=kmeans#cuml.KMeans">KMeans</a>. You are free to switch between these algorithm choices and everything in the example will continue to work.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># please choose learning algorithm</span>
<span class="n">algorithm_choice</span> <span class="o">=</span> <span class="s2">&quot;XGBoost&quot;</span>

<span class="k">assert</span> <span class="n">algorithm_choice</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;XGBoost&quot;</span><span class="p">,</span> <span class="s2">&quot;RandomForest&quot;</span><span class="p">,</span> <span class="s2">&quot;KMeans&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We can also optionally increase robustness via reshuffles of the train-test split (i.e., <a class="reference external" href="https://scikit-learn.org/stable/modules/cross_validation.html">cross-validation folds</a>). Typical values here are between 3 and 10 folds.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># please choose cross-validation folds</span>
<span class="n">cv_folds</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">assert</span> <span class="n">cv_folds</span> <span class="o">&gt;=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="ml-workflow-compute-choice">
<h4>ML Workflow Compute Choice<a class="headerlink" href="#ml-workflow-compute-choice" title="Permalink to this heading">#</a></h4>
<p>We enable the option of running different code variations that unlock increasing amounts of parallelism in the compute workflow.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">singleCPU</span></code>** = <a class="reference external" href="https://pandas.pydata.org/">pandas</a> + <a class="reference external" href="https://scikit-learn.org/stable/">sklearn</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">multiCPU</span></code>   = <a class="reference external" href="https://dask.org/">dask</a> + <a class="reference external" href="https://pandas.pydata.org/">pandas</a> + <a class="reference external" href="https://scikit-learn.org/stable/">sklearn</a></p></li>
<li><p><span style="color:#8735fb; font-size:14pt"> RAPIDS </span> <code class="docutils literal notranslate"><span class="pre">singleGPU</span></code> = <a class="reference external" href="https://github.com/rapidsai/cudf">cudf</a> + <a class="reference external" href="https://github.com/rapidsai/cuml">cuml</a></p></li>
<li><p><span style="color:#8735fb; font-size:14pt"> RAPIDS </span> <code class="docutils literal notranslate"><span class="pre">multiGPU</span></code>  = <a class="reference external" href="https://dask.org/">dask</a> + <a class="reference external" href="https://github.com/rapidsai/cudf">cudf</a> + <a class="reference external" href="https://github.com/rapidsai/cuml">cuml</a></p></li>
</ul>
<p>All of these code paths are available in the <code class="docutils literal notranslate"><span class="pre">/workflows</span></code> directory for your reference.</p>
<blockquote>
<div><p>**Note that the single-CPU option will leverage multiple cores in the model training portion of the workflow; however, to unlock full parallelism in each stage of the workflow we use <a class="reference external" href="https://dask.org/">Dask</a>.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># please choose code variant</span>
<span class="n">ml_workflow_choice</span> <span class="o">=</span> <span class="s2">&quot;multiGPU&quot;</span>

<span class="k">assert</span> <span class="n">ml_workflow_choice</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;singleCPU&quot;</span><span class="p">,</span> <span class="s2">&quot;singleGPU&quot;</span><span class="p">,</span> <span class="s2">&quot;multiCPU&quot;</span><span class="p">,</span> <span class="s2">&quot;multiGPU&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="search-ranges-and-strategy">
<h4>Search Ranges and Strategy<a class="headerlink" href="#search-ranges-and-strategy" title="Permalink to this heading">#</a></h4>
<p><a id='strategy-and-param-ranges'></a></p>
<p>One of the most important choices when running HPO is to choose the bounds of the hyperparameter search process. Below we’ve set the ranges of the hyperparameters to allow for interesting variation, you are of course welcome to revise these ranges based on domain knowledge especially if you plan to plug in your own dataset.</p>
<blockquote>
<div><p>Note that we support additional algorithm specific parameters (refer to the <code class="docutils literal notranslate"><span class="pre">parse_hyper_parameter_inputs</span></code> function in <code class="docutils literal notranslate"><span class="pre">HPOConfig.py</span></code>), but for demo purposes have limited our choice to the three parameters that overlap between the XGBoost and RandomForest algorithms. For more details see the documentation for <a class="reference external" href="https://xgboost.readthedocs.io/en/latest/parameter.html">XGBoost parameters</a> and <a class="reference external" href="https://docs.rapids.ai/api/cuml/stable/api.html#random-forest">RandomForest parameters</a>. Since KMeans uses different parameters, we adjust accordingly.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># please choose HPO search ranges</span>
<span class="n">hyperparameter_ranges</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;max_depth&quot;</span><span class="p">:</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">IntegerParameter</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
    <span class="s2">&quot;n_estimators&quot;</span><span class="p">:</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">IntegerParameter</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
    <span class="s2">&quot;max_features&quot;</span><span class="p">:</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">ContinuousParameter</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
<span class="p">}</span>  <span class="c1"># see note above for adding additional parameters</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s2">&quot;XGBoost&quot;</span> <span class="ow">in</span> <span class="n">algorithm_choice</span><span class="p">:</span>
    <span class="c1"># number of trees parameter name difference b/w XGBoost and RandomForest</span>
    <span class="n">hyperparameter_ranges</span><span class="p">[</span><span class="s2">&quot;num_boost_round&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hyperparameter_ranges</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;n_estimators&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s2">&quot;KMeans&quot;</span> <span class="ow">in</span> <span class="n">algorithm_choice</span><span class="p">:</span>
    <span class="n">hyperparameter_ranges</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;n_clusters&quot;</span><span class="p">:</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">IntegerParameter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s2">&quot;max_iter&quot;</span><span class="p">:</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">IntegerParameter</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>We can also choose between a Random and Bayesian search strategy for picking parameter combinations.</p>
<p><strong>Random Search</strong>: Choose a random combination of values from within the ranges for each training job it launches. The choice of hyperparameters doesn’t depend on previous results so you can run the maximum number of concurrent workers without affecting the performance of the search.</p>
<p><strong>Bayesian Search</strong>: Make a guess about which hyperparameter combinations are likely to get the best results. After testing the first set of hyperparameter values, hyperparameter tuning uses regression to choose the next set of hyperparameter values to test.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># please choose HPO search strategy</span>
<span class="n">search_strategy</span> <span class="o">=</span> <span class="s2">&quot;Random&quot;</span>

<span class="k">assert</span> <span class="n">search_strategy</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Random&quot;</span><span class="p">,</span> <span class="s2">&quot;Bayesian&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="experiment-scale">
<h4>Experiment Scale<a class="headerlink" href="#experiment-scale" title="Permalink to this heading">#</a></h4>
<p>We also need to decide how may total experiments to run, and how many should run in parallel. Below we have a very conservative number of maximum jobs to run so that you don’t accidently spawn large computations when starting out, however for meaningful HPO searches this number should be much higher (e.g., in our experiments we often run 100 max_jobs). Note that you may need to request a <a class="reference external" href="https://docs.aws.amazon.com/general/latest/gr/sagemaker.html">quota limit increase</a> for additional  <code class="docutils literal notranslate"><span class="pre">max_parallel_jobs</span></code> parallel workers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># please choose total number of HPO experiments[ we have set this number very low to allow for automated CI testing ]</span>
<span class="n">max_jobs</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># please choose number of experiments that can run in parallel</span>
<span class="n">max_parallel_jobs</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s also set the max duration for an individual job to 24 hours so we don’t have run-away compute jobs taking too long.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_duration_of_experiment_seconds</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-platform">
<h4>Compute Platform<a class="headerlink" href="#compute-platform" title="Permalink to this heading">#</a></h4>
<p>Based on the dataset size and compute choice we will try to recommend an instance choice*, you are of course welcome to select alternate configurations.</p>
<blockquote>
<div><p>e.g., For the 10_year dataset option, we suggest ml.p3.8xlarge instances (4 GPUs) and ml.m5.24xlarge CPU instances ( we will need upwards of 200GB CPU RAM during model training).</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we will recommend a compute instance type, feel free to modify</span>
<span class="n">instance_type</span> <span class="o">=</span> <span class="n">recommend_instance_type</span><span class="p">(</span><span class="n">ml_workflow_choice</span><span class="p">,</span> <span class="n">dataset_directory</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>recommended instance type : ml.p3.8xlarge 
instance details          : 4x GPUs [ V100 ], 64GB GPU memory,  244GB CPU memory
</pre></div>
</div>
</div>
</div>
<p>In addition to choosing our instance type, we can also enable significant savings by leveraging <a class="reference external" href="https://aws.amazon.com/ec2/spot/">AWS EC2 Spot Instances</a>.</p>
<p>We <strong>highly recommend</strong> that you set this flag to <code class="docutils literal notranslate"><span class="pre">True</span></code> as it typically leads to 60-70% cost savings. Note, however that you may need to request a <a class="reference external" href="https://docs.aws.amazon.com/general/latest/gr/sagemaker.html">quota limit increase</a> to enable Spot instances in SageMaker.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># please choose whether spot instances should be used</span>
<span class="n">use_spot_instances_flag</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="validate">
<h2>Validate<a class="headerlink" href="#validate" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summarize_choices</span><span class="p">(</span>
    <span class="n">s3_data_input</span><span class="p">,</span>
    <span class="n">s3_model_output</span><span class="p">,</span>
    <span class="n">ml_workflow_choice</span><span class="p">,</span>
    <span class="n">algorithm_choice</span><span class="p">,</span>
    <span class="n">cv_folds</span><span class="p">,</span>
    <span class="n">instance_type</span><span class="p">,</span>
    <span class="n">use_spot_instances_flag</span><span class="p">,</span>
    <span class="n">search_strategy</span><span class="p">,</span>
    <span class="n">max_jobs</span><span class="p">,</span>
    <span class="n">max_parallel_jobs</span><span class="p">,</span>
    <span class="n">max_duration_of_experiment_seconds</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>s3 data input    =	s3://sagemaker-rapids-hpo-us-west-2/10_year
s3 model output  =	s3://sagemaker-us-west-2-561241433344/trained-models
compute          =	multiGPU
algorithm        =	XGBoost, 10 cv-fold
instance         =	ml.p3.8xlarge
spot instances   =	True
hpo strategy     =	Random
max_experiments  =	100
max_parallel     =	10
max runtime      =	86400 sec
</pre></div>
</div>
</div>
</div>
<p><span style="display: block; text-align: center; color:#8735fb; font-size:30pt"> <strong>1. ML Workflow</strong> </span></p>
<img src='../../_static/images/examples/rapids-sagemaker-hpo/ml_workflow.png' width='800'> <section id="id1">
<h3>Dataset<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p><a id ='dataset'></a></p>
<p>The default settings for this demo are built to utilize the Airline dataset (Carrier On-Time Performance 1987-2020, available from the <a class="reference external" href="https://transtats.bts.gov/Tables.asp?DB_ID=120&amp;DB_Name=Airline%20On-Time%20Performance%20Data&amp;DB_Short_Name=On-Time#">Bureau of Transportation Statistics</a>). Below are some additional details about this dataset, we plan to offer a companion notebook that does a deep dive on the data science behind this dataset. Note that if you are using an alternate dataset (e.g., NYC Taxi or BYOData) these details are not relevant.</p>
<p>The public dataset contains logs/features about flights in the United States (17 airlines) including:</p>
<ul class="simple">
<li><p>Locations and distance  ( <code class="docutils literal notranslate"><span class="pre">Origin</span></code>, <code class="docutils literal notranslate"><span class="pre">Dest</span></code>, <code class="docutils literal notranslate"><span class="pre">Distance</span></code> )</p></li>
<li><p>Airline / carrier ( <code class="docutils literal notranslate"><span class="pre">Reporting_Airline</span></code> )</p></li>
<li><p>Scheduled departure and arrival times ( <code class="docutils literal notranslate"><span class="pre">CRSDepTime</span></code> and <code class="docutils literal notranslate"><span class="pre">CRSArrTime</span></code> )</p></li>
<li><p>Actual departure and arrival times ( <code class="docutils literal notranslate"><span class="pre">DpTime</span></code> and <code class="docutils literal notranslate"><span class="pre">ArrTime</span></code> )</p></li>
<li><p>Difference between scheduled &amp; actual times ( <code class="docutils literal notranslate"><span class="pre">ArrDelay</span></code> and <code class="docutils literal notranslate"><span class="pre">DepDelay</span></code> )</p></li>
<li><p>Binary encoded version of late, aka our target variable ( <code class="docutils literal notranslate"><span class="pre">ArrDelay15</span></code> )</p></li>
</ul>
<p>Using these features we will build a classifier model to predict whether a flight is going to be more than 15 minutes late on arrival as it prepares to depart.</p>
</section>
<section id="python-ml-workflow">
<h3>Python ML Workflow<a class="headerlink" href="#python-ml-workflow" title="Permalink to this heading">#</a></h3>
<p>To build a RAPIDS enabled SageMaker HPO we first need to build a <a class="reference external" href="https://sagemaker.readthedocs.io/en/stable/api/training/estimators.html">SageMaker Estimator</a>. An Estimator is a container image that captures all the software needed to run an HPO experiment. The container is augmented with entrypoint code that will be trggered at runtime by each worker. The entrypoint code enables us to write custom models and hook them up to data.</p>
<p>In order to work with SageMaker HPO, the entrypoint logic should parse hyperparameters (supplied by AWS SageMaker), load and split data, build and train a model, score/evaluate the trained model, and emit an output representing the final score for the given hyperparameter setting. We’ve already built multiple variations of this code.</p>
<p>If you would like to make changes by adding your custom model logic feel free to modify the <strong>train.py</strong> and/or the specific workflow files in the <code class="docutils literal notranslate"><span class="pre">workflows</span></code> directory. You are also welcome to uncomment the cells below to load the read/review the code.</p>
<p>First, let’s switch our working directory to the location of the Estimator entrypoint and library code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %load train.py</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %load workflows/MLWorkflowSingleGPU.py</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="build-estimator">
<h2>Build Estimator<a class="headerlink" href="#build-estimator" title="Permalink to this heading">#</a></h2>
<img src='../../_static/images/examples/rapids-sagemaker-hpo/estimator.png' width='800'><p>As we’ve already mentioned, the SageMaker Estimator represents the containerized software stack that AWS SageMaker will replicate to each worker node.</p>
<p>The first step to building our Estimator, is to augment a RAPIDS container with our ML Workflow code from above, and push this image to Amazon Elastic Cloud Registry so it is available to SageMaker.</p>
<section id="containerize-and-push-to-ecr">
<h3>Containerize and Push to ECR<a class="headerlink" href="#containerize-and-push-to-ecr" title="Permalink to this heading">#</a></h3>
<p>Now let’s turn to building our container so that it can integrate with the AWS SageMaker HPO API.</p>
<p>Our container can either be built on top of the latest RAPIDS [ nightly ] image as a starting layer or the RAPIDS stable image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<pre class="literal-block">rapids_base_container = &quot;rapidsai/rapidsai-core-nightly:23.04-cuda11.5-runtime-ubuntu20.04-py3.10&quot;</pre>
</div>
</div>
<p>Let’s also decide on the full name of our container.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_base</span> <span class="o">=</span> <span class="s2">&quot;rapids-sagemaker-mnmg-100&quot;</span>
<span class="n">image_tag</span> <span class="o">=</span> <span class="n">rapids_base_container</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ecr_fullname</span> <span class="o">=</span> <span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">account</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.dkr.ecr.</span><span class="si">{</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.amazonaws.com/</span><span class="si">{</span><span class="n">image_base</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">image_tag</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ecr_fullname</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;561241433344.dkr.ecr.us-west-2.amazonaws.com/rapids-sagemaker-mnmg-100:22.12-cuda11.5-runtime-ubuntu18.04-py3.9&#39;
</pre></div>
</div>
</div>
</div>
<section id="write-dockerfile">
<h4>Write Dockerfile<a class="headerlink" href="#write-dockerfile" title="Permalink to this heading">#</a></h4>
<p>We write out the Dockerfile to disk, and in a few cells execute the docker build command.</p>
<p>Let’s now write our selected RAPDIS image layer as the first FROM statement in the the Dockerfile.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Dockerfile&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dockerfile</span><span class="p">:</span>
    <span class="n">dockerfile</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;FROM </span><span class="si">{</span><span class="n">rapids_base_container</span><span class="si">}</span><span class="s2"> </span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s1">&#39;ENV AWS_DATASET_DIRECTORY=&quot;</span><span class="si">{</span><span class="n">dataset_directory</span><span class="si">}</span><span class="s1">&quot;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;ENV AWS_ALGORITHM_CHOICE=&quot;</span><span class="si">{</span><span class="n">algorithm_choice</span><span class="si">}</span><span class="s1">&quot;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;ENV AWS_ML_WORKFLOW_CHOICE=&quot;</span><span class="si">{</span><span class="n">ml_workflow_choice</span><span class="si">}</span><span class="s1">&quot;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;ENV AWS_CV_FOLDS=&quot;</span><span class="si">{</span><span class="n">cv_folds</span><span class="si">}</span><span class="s1">&quot;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next let’s append write the remaining pieces of the Dockerfile, namely adding the sagemaker-training-toolkit, flask, dask-ml, and copying our python code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%%writefile -a Dockerfile

# ensure printed output/log-messages retain correct order
ENV PYTHONUNBUFFERED=True
    
# add sagemaker-training-toolkit [ requires build tools ], flask [ serving ], and dask-ml
RUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends build-essential \ 
    &amp;&amp; source activate rapids \
    &amp;&amp; pip3 install sagemaker-training cupy-cuda115 flask dask-ml \
    &amp;&amp; pip3 install --upgrade protobuf

# path where SageMaker looks for code when container runs in the cloud
ENV CLOUD_PATH=&quot;/opt/ml/code&quot;

# copy our latest [local] code into the container 
COPY . $CLOUD_PATH

# make the entrypoint script executable
RUN chmod +x $CLOUD_PATH/entrypoint.sh

WORKDIR $CLOUD_PATH
ENTRYPOINT [&quot;./entrypoint.sh&quot;]
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Appending to Dockerfile
</pre></div>
</div>
</div>
</div>
<p>Lastly, let’s ensure that our Dockerfile correctly captured our base image selection.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">validate_dockerfile</span><span class="p">(</span><span class="n">rapids_base_container</span><span class="p">)</span>
<span class="o">!</span>cat<span class="w"> </span>Dockerfile
</pre></div>
</div>
</div>
</div>
</section>
<section id="build-and-tag">
<h4>Build and Tag<a class="headerlink" href="#build-and-tag" title="Permalink to this heading">#</a></h4>
<p>The build step will be dominated by the download of the RAPIDS image (base layer). If it’s already been downloaded the build will take less than 1 minute.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>docker<span class="w"> </span>pull<span class="w"> </span><span class="nv">$rapids_base_container</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>22.12-cuda11.5-runtime-ubuntu18.04-py3.9: Pulling from rapidsai/rapidsai-core

e5416296: Pulling fs layer 
2d3ed59c: Pulling fs layer 
1b38369f: Pulling fs layer 
4c8e4d7e: Pulling fs layer 
a06239d6: Pulling fs layer 
cb87b249: Pulling fs layer 
61c55367: Pulling fs layer 
fb9847e6: Pulling fs layer 
0cc4d9ef: Pulling fs layer 
Digest: sha256:959a2e80642e881ef99705473d95165cda8383543cff4ae5ca554da782021e47KExtracting   2.96GB/3.932GB
Status: Downloaded newer image for rapidsai/rapidsai-core:22.12-cuda11.5-runtime-ubuntu18.04-py3.9
docker.io/rapidsai/rapidsai-core:22.12-cuda11.5-runtime-ubuntu18.04-py3.9
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>docker<span class="w"> </span>images
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>REPOSITORY               TAG                                        IMAGE ID       CREATED       SIZE
rapidsai/rapidsai-core   22.12-cuda11.5-runtime-ubuntu18.04-py3.9   9de590bd08c5   5 weeks ago   13.1GB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<pre class="literal-block">%%time
!docker build -t $ecr_fullname --build-arg RAPIDS_IMAGE=rapidsai/rapidsai-core-nightly:23.04-cuda11.5-runtime-ubuntu20.04-py3.10 .</pre>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sending build context to Docker daemon  90.62kB
Step 1/12 : FROM rapidsai/rapidsai-core:22.12-cuda11.5-runtime-ubuntu18.04-py3.9
 ---&gt; 9de590bd08c5
Step 2/12 : ENV AWS_DATASET_DIRECTORY=&quot;10_year&quot;
 ---&gt; Running in 4b7c02990c9d
Removing intermediate container 4b7c02990c9d
 ---&gt; 967f657cfc72
Step 3/12 : ENV AWS_ALGORITHM_CHOICE=&quot;XGBoost&quot;
 ---&gt; Running in d6dbf287ed0f
Removing intermediate container d6dbf287ed0f
 ---&gt; 114a69f1a302
Step 4/12 : ENV AWS_ML_WORKFLOW_CHOICE=&quot;multiGPU&quot;
 ---&gt; Running in bfe707fe38f9
Removing intermediate container bfe707fe38f9
 ---&gt; 00c743a5a456
Step 5/12 : ENV AWS_CV_FOLDS=&quot;10&quot;
 ---&gt; Running in bb2a2f2a1a7e
Removing intermediate container bb2a2f2a1a7e
 ---&gt; ce9a5ab0fb1e
Step 6/12 : ENV PYTHONUNBUFFERED=True
 ---&gt; Running in d396568a5cab
Removing intermediate container d396568a5cab
 ---&gt; 1c75cb5d8dee
Step 7/12 : RUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends build-essential     &amp;&amp; source activate rapids     &amp;&amp; pip3 install sagemaker-training cupy-cuda115 flask dask-ml     &amp;&amp; pip3 install --upgrade protobuf
 ---&gt; Running in 26458c19e436
Get:1 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64  InRelease [1581 B]
Get:2 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64  Packages [1082 kB]
Get:3 http://security.ubuntu.com/ubuntu bionic-security InRelease [88.7 kB]
Get:4 http://archive.ubuntu.com/ubuntu bionic InRelease [242 kB]
Get:5 http://security.ubuntu.com/ubuntu bionic-security/multiverse amd64 Packages [22.9 kB]
Get:6 http://security.ubuntu.com/ubuntu bionic-security/main amd64 Packages [3155 kB]
Get:7 http://archive.ubuntu.com/ubuntu bionic-updates InRelease [88.7 kB]
Get:8 http://security.ubuntu.com/ubuntu bionic-security/universe amd64 Packages [1576 kB]
Get:9 http://archive.ubuntu.com/ubuntu bionic-backports InRelease [83.3 kB]
Get:10 http://security.ubuntu.com/ubuntu bionic-security/restricted amd64 Packages [1387 kB]
Get:11 http://archive.ubuntu.com/ubuntu bionic/main amd64 Packages [1344 kB]
Get:12 http://archive.ubuntu.com/ubuntu bionic/restricted amd64 Packages [13.5 kB]
Get:13 http://archive.ubuntu.com/ubuntu bionic/universe amd64 Packages [11.3 MB]
Get:14 http://archive.ubuntu.com/ubuntu bionic/multiverse amd64 Packages [186 kB]
Get:15 http://archive.ubuntu.com/ubuntu bionic-updates/restricted amd64 Packages [1427 kB]
Get:16 http://archive.ubuntu.com/ubuntu bionic-updates/universe amd64 Packages [2352 kB]
Get:17 http://archive.ubuntu.com/ubuntu bionic-updates/multiverse amd64 Packages [30.8 kB]
Get:18 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 Packages [3577 kB]
Get:19 http://archive.ubuntu.com/ubuntu bionic-backports/universe amd64 Packages [20.5 kB]
Get:20 http://archive.ubuntu.com/ubuntu bionic-backports/main amd64 Packages [64.0 kB]
Fetched 28.1 MB in 5s (5558 kB/s)
Reading package lists...
Reading package lists...
Building dependency tree...
Reading state information...
The following additional packages will be installed:
  binutils binutils-common binutils-x86-64-linux-gnu cpp cpp-7 dpkg-dev g++
  g++-7 gcc gcc-7 gcc-7-base libasan4 libatomic1 libbinutils libcc1-0
  libcilkrts5 libdpkg-perl libgcc-7-dev libgomp1 libisl19 libitm1 liblsan0
  libmpc3 libmpfr6 libmpx2 libquadmath0 libstdc++-7-dev libtsan0 libubsan0
  make xz-utils
Suggested packages:
  binutils-doc cpp-doc gcc-7-locales debian-keyring g++-multilib
  g++-7-multilib gcc-7-doc libstdc++6-7-dbg gcc-multilib manpages-dev libtool
  flex bison gdb gcc-doc gcc-7-multilib libgcc1-dbg libgomp1-dbg libitm1-dbg
  libatomic1-dbg libasan4-dbg liblsan0-dbg libtsan0-dbg libubsan0-dbg
  libcilkrts5-dbg libmpx2-dbg libquadmath0-dbg bzr libstdc++-7-doc make-doc
Recommended packages:
  fakeroot libalgorithm-merge-perl libfile-fcntllock-perl
  liblocale-gettext-perl
The following NEW packages will be installed:
  binutils binutils-common binutils-x86-64-linux-gnu build-essential cpp cpp-7
  dpkg-dev g++ g++-7 gcc gcc-7 gcc-7-base libasan4 libatomic1 libbinutils
  libcc1-0 libcilkrts5 libdpkg-perl libgcc-7-dev libgomp1 libisl19 libitm1
  liblsan0 libmpc3 libmpfr6 libmpx2 libquadmath0 libstdc++-7-dev libtsan0
  libubsan0 make xz-utils
0 upgraded, 32 newly installed, 0 to remove and 17 not upgraded.
Need to get 37.2 MB of archives.
After this operation, 137 MB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 xz-utils amd64 5.2.2-1.3ubuntu0.1 [83.8 kB]
Get:2 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 binutils-common amd64 2.30-21ubuntu1~18.04.8 [197 kB]
Get:3 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 libbinutils amd64 2.30-21ubuntu1~18.04.8 [488 kB]
Get:4 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 binutils-x86-64-linux-gnu amd64 2.30-21ubuntu1~18.04.8 [1839 kB]
Get:5 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 binutils amd64 2.30-21ubuntu1~18.04.8 [3388 B]
Get:6 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 gcc-7-base amd64 7.5.0-3ubuntu1~18.04 [18.3 kB]
Get:7 http://archive.ubuntu.com/ubuntu bionic/main amd64 libisl19 amd64 0.19-1 [551 kB]
Get:8 http://archive.ubuntu.com/ubuntu bionic/main amd64 libmpfr6 amd64 4.0.1-1 [243 kB]
Get:9 http://archive.ubuntu.com/ubuntu bionic/main amd64 libmpc3 amd64 1.1.0-1 [40.8 kB]
Get:10 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 cpp-7 amd64 7.5.0-3ubuntu1~18.04 [8591 kB]
Get:11 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 cpp amd64 4:7.4.0-1ubuntu2.3 [27.7 kB]
Get:12 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 libcc1-0 amd64 8.4.0-1ubuntu1~18.04 [39.4 kB]
Get:13 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 libgomp1 amd64 8.4.0-1ubuntu1~18.04 [76.5 kB]
Get:14 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 libitm1 amd64 8.4.0-1ubuntu1~18.04 [27.9 kB]
Get:15 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 libatomic1 amd64 8.4.0-1ubuntu1~18.04 [9192 B]
Get:16 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 libasan4 amd64 7.5.0-3ubuntu1~18.04 [358 kB]
Get:17 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 liblsan0 amd64 8.4.0-1ubuntu1~18.04 [133 kB]
Get:18 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 libtsan0 amd64 8.4.0-1ubuntu1~18.04 [288 kB]
Get:19 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 libubsan0 amd64 7.5.0-3ubuntu1~18.04 [126 kB]
Get:20 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 libcilkrts5 amd64 7.5.0-3ubuntu1~18.04 [42.5 kB]
Get:21 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 libmpx2 amd64 8.4.0-1ubuntu1~18.04 [11.6 kB]
Get:22 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 libquadmath0 amd64 8.4.0-1ubuntu1~18.04 [134 kB]
Get:23 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 libgcc-7-dev amd64 7.5.0-3ubuntu1~18.04 [2378 kB]
Get:24 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 gcc-7 amd64 7.5.0-3ubuntu1~18.04 [9381 kB]
Get:25 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 gcc amd64 4:7.4.0-1ubuntu2.3 [5184 B]
Get:26 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 libstdc++-7-dev amd64 7.5.0-3ubuntu1~18.04 [1471 kB]
Get:27 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 g++-7 amd64 7.5.0-3ubuntu1~18.04 [9697 kB]
Get:28 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 g++ amd64 4:7.4.0-1ubuntu2.3 [1568 B]
Get:29 http://archive.ubuntu.com/ubuntu bionic/main amd64 make amd64 4.1-9.1ubuntu1 [154 kB]
Get:30 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 libdpkg-perl all 1.19.0.5ubuntu2.4 [212 kB]
Get:31 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 dpkg-dev all 1.19.0.5ubuntu2.4 [607 kB]
Get:32 http://archive.ubuntu.com/ubuntu bionic/main amd64 build-essential amd64 12.4ubuntu1 [4758 B]
debconf: delaying package configuration, since apt-utils is not installed
Fetched 37.2 MB in 2s (16.6 MB/s)
Selecting previously unselected package xz-utils.
(Reading database ... 13756 files and directories currently installed.)
Preparing to unpack .../00-xz-utils_5.2.2-1.3ubuntu0.1_amd64.deb ...
Unpacking xz-utils (5.2.2-1.3ubuntu0.1) ...
Selecting previously unselected package binutils-common:amd64.
Preparing to unpack .../01-binutils-common_2.30-21ubuntu1~18.04.8_amd64.deb ...
Unpacking binutils-common:amd64 (2.30-21ubuntu1~18.04.8) ...
Selecting previously unselected package libbinutils:amd64.
Preparing to unpack .../02-libbinutils_2.30-21ubuntu1~18.04.8_amd64.deb ...
Unpacking libbinutils:amd64 (2.30-21ubuntu1~18.04.8) ...
Selecting previously unselected package binutils-x86-64-linux-gnu.
Preparing to unpack .../03-binutils-x86-64-linux-gnu_2.30-21ubuntu1~18.04.8_amd64.deb ...
Unpacking binutils-x86-64-linux-gnu (2.30-21ubuntu1~18.04.8) ...
Selecting previously unselected package binutils.
Preparing to unpack .../04-binutils_2.30-21ubuntu1~18.04.8_amd64.deb ...
Unpacking binutils (2.30-21ubuntu1~18.04.8) ...
Selecting previously unselected package gcc-7-base:amd64.
Preparing to unpack .../05-gcc-7-base_7.5.0-3ubuntu1~18.04_amd64.deb ...
Unpacking gcc-7-base:amd64 (7.5.0-3ubuntu1~18.04) ...
Selecting previously unselected package libisl19:amd64.
Preparing to unpack .../06-libisl19_0.19-1_amd64.deb ...
Unpacking libisl19:amd64 (0.19-1) ...
Selecting previously unselected package libmpfr6:amd64.
Preparing to unpack .../07-libmpfr6_4.0.1-1_amd64.deb ...
Unpacking libmpfr6:amd64 (4.0.1-1) ...
Selecting previously unselected package libmpc3:amd64.
Preparing to unpack .../08-libmpc3_1.1.0-1_amd64.deb ...
Unpacking libmpc3:amd64 (1.1.0-1) ...
Selecting previously unselected package cpp-7.
Preparing to unpack .../09-cpp-7_7.5.0-3ubuntu1~18.04_amd64.deb ...
Unpacking cpp-7 (7.5.0-3ubuntu1~18.04) ...
Selecting previously unselected package cpp.
Preparing to unpack .../10-cpp_4%3a7.4.0-1ubuntu2.3_amd64.deb ...
Unpacking cpp (4:7.4.0-1ubuntu2.3) ...
Selecting previously unselected package libcc1-0:amd64.
Preparing to unpack .../11-libcc1-0_8.4.0-1ubuntu1~18.04_amd64.deb ...
Unpacking libcc1-0:amd64 (8.4.0-1ubuntu1~18.04) ...
Selecting previously unselected package libgomp1:amd64.
Preparing to unpack .../12-libgomp1_8.4.0-1ubuntu1~18.04_amd64.deb ...
Unpacking libgomp1:amd64 (8.4.0-1ubuntu1~18.04) ...
Selecting previously unselected package libitm1:amd64.
Preparing to unpack .../13-libitm1_8.4.0-1ubuntu1~18.04_amd64.deb ...
Unpacking libitm1:amd64 (8.4.0-1ubuntu1~18.04) ...
Selecting previously unselected package libatomic1:amd64.
Preparing to unpack .../14-libatomic1_8.4.0-1ubuntu1~18.04_amd64.deb ...
Unpacking libatomic1:amd64 (8.4.0-1ubuntu1~18.04) ...
Selecting previously unselected package libasan4:amd64.
Preparing to unpack .../15-libasan4_7.5.0-3ubuntu1~18.04_amd64.deb ...
Unpacking libasan4:amd64 (7.5.0-3ubuntu1~18.04) ...
Selecting previously unselected package liblsan0:amd64.
Preparing to unpack .../16-liblsan0_8.4.0-1ubuntu1~18.04_amd64.deb ...
Unpacking liblsan0:amd64 (8.4.0-1ubuntu1~18.04) ...
Selecting previously unselected package libtsan0:amd64.
Preparing to unpack .../17-libtsan0_8.4.0-1ubuntu1~18.04_amd64.deb ...
Unpacking libtsan0:amd64 (8.4.0-1ubuntu1~18.04) ...
Selecting previously unselected package libubsan0:amd64.
Preparing to unpack .../18-libubsan0_7.5.0-3ubuntu1~18.04_amd64.deb ...
Unpacking libubsan0:amd64 (7.5.0-3ubuntu1~18.04) ...
Selecting previously unselected package libcilkrts5:amd64.
Preparing to unpack .../19-libcilkrts5_7.5.0-3ubuntu1~18.04_amd64.deb ...
Unpacking libcilkrts5:amd64 (7.5.0-3ubuntu1~18.04) ...
Selecting previously unselected package libmpx2:amd64.
Preparing to unpack .../20-libmpx2_8.4.0-1ubuntu1~18.04_amd64.deb ...
Unpacking libmpx2:amd64 (8.4.0-1ubuntu1~18.04) ...
Selecting previously unselected package libquadmath0:amd64.
Preparing to unpack .../21-libquadmath0_8.4.0-1ubuntu1~18.04_amd64.deb ...
Unpacking libquadmath0:amd64 (8.4.0-1ubuntu1~18.04) ...
Selecting previously unselected package libgcc-7-dev:amd64.
Preparing to unpack .../22-libgcc-7-dev_7.5.0-3ubuntu1~18.04_amd64.deb ...
Unpacking libgcc-7-dev:amd64 (7.5.0-3ubuntu1~18.04) ...
Selecting previously unselected package gcc-7.
Preparing to unpack .../23-gcc-7_7.5.0-3ubuntu1~18.04_amd64.deb ...
Unpacking gcc-7 (7.5.0-3ubuntu1~18.04) ...
Selecting previously unselected package gcc.
Preparing to unpack .../24-gcc_4%3a7.4.0-1ubuntu2.3_amd64.deb ...
Unpacking gcc (4:7.4.0-1ubuntu2.3) ...
Selecting previously unselected package libstdc++-7-dev:amd64.
Preparing to unpack .../25-libstdc++-7-dev_7.5.0-3ubuntu1~18.04_amd64.deb ...
Unpacking libstdc++-7-dev:amd64 (7.5.0-3ubuntu1~18.04) ...
Selecting previously unselected package g++-7.
Preparing to unpack .../26-g++-7_7.5.0-3ubuntu1~18.04_amd64.deb ...
Unpacking g++-7 (7.5.0-3ubuntu1~18.04) ...
Selecting previously unselected package g++.
Preparing to unpack .../27-g++_4%3a7.4.0-1ubuntu2.3_amd64.deb ...
Unpacking g++ (4:7.4.0-1ubuntu2.3) ...
Selecting previously unselected package make.
Preparing to unpack .../28-make_4.1-9.1ubuntu1_amd64.deb ...
Unpacking make (4.1-9.1ubuntu1) ...
Selecting previously unselected package libdpkg-perl.
Preparing to unpack .../29-libdpkg-perl_1.19.0.5ubuntu2.4_all.deb ...
Unpacking libdpkg-perl (1.19.0.5ubuntu2.4) ...
Selecting previously unselected package dpkg-dev.
Preparing to unpack .../30-dpkg-dev_1.19.0.5ubuntu2.4_all.deb ...
Unpacking dpkg-dev (1.19.0.5ubuntu2.4) ...
Selecting previously unselected package build-essential.
Preparing to unpack .../31-build-essential_12.4ubuntu1_amd64.deb ...
Unpacking build-essential (12.4ubuntu1) ...
Setting up libquadmath0:amd64 (8.4.0-1ubuntu1~18.04) ...
Setting up libgomp1:amd64 (8.4.0-1ubuntu1~18.04) ...
Setting up libatomic1:amd64 (8.4.0-1ubuntu1~18.04) ...
Setting up libcc1-0:amd64 (8.4.0-1ubuntu1~18.04) ...
Setting up make (4.1-9.1ubuntu1) ...
Setting up libtsan0:amd64 (8.4.0-1ubuntu1~18.04) ...
Setting up libmpfr6:amd64 (4.0.1-1) ...
Setting up libdpkg-perl (1.19.0.5ubuntu2.4) ...
Setting up liblsan0:amd64 (8.4.0-1ubuntu1~18.04) ...
Setting up gcc-7-base:amd64 (7.5.0-3ubuntu1~18.04) ...
Setting up binutils-common:amd64 (2.30-21ubuntu1~18.04.8) ...
Setting up libmpx2:amd64 (8.4.0-1ubuntu1~18.04) ...
Setting up xz-utils (5.2.2-1.3ubuntu0.1) ...
update-alternatives: using /usr/bin/xz to provide /usr/bin/lzma (lzma) in auto mode
update-alternatives: warning: skip creation of /usr/share/man/man1/lzma.1.gz because associated file /usr/share/man/man1/xz.1.gz (of link group lzma) doesn&#39;t exist
update-alternatives: warning: skip creation of /usr/share/man/man1/unlzma.1.gz because associated file /usr/share/man/man1/unxz.1.gz (of link group lzma) doesn&#39;t exist
update-alternatives: warning: skip creation of /usr/share/man/man1/lzcat.1.gz because associated file /usr/share/man/man1/xzcat.1.gz (of link group lzma) doesn&#39;t exist
update-alternatives: warning: skip creation of /usr/share/man/man1/lzmore.1.gz because associated file /usr/share/man/man1/xzmore.1.gz (of link group lzma) doesn&#39;t exist
update-alternatives: warning: skip creation of /usr/share/man/man1/lzless.1.gz because associated file /usr/share/man/man1/xzless.1.gz (of link group lzma) doesn&#39;t exist
update-alternatives: warning: skip creation of /usr/share/man/man1/lzdiff.1.gz because associated file /usr/share/man/man1/xzdiff.1.gz (of link group lzma) doesn&#39;t exist
update-alternatives: warning: skip creation of /usr/share/man/man1/lzcmp.1.gz because associated file /usr/share/man/man1/xzcmp.1.gz (of link group lzma) doesn&#39;t exist
update-alternatives: warning: skip creation of /usr/share/man/man1/lzgrep.1.gz because associated file /usr/share/man/man1/xzgrep.1.gz (of link group lzma) doesn&#39;t exist
update-alternatives: warning: skip creation of /usr/share/man/man1/lzegrep.1.gz because associated file /usr/share/man/man1/xzegrep.1.gz (of link group lzma) doesn&#39;t exist
update-alternatives: warning: skip creation of /usr/share/man/man1/lzfgrep.1.gz because associated file /usr/share/man/man1/xzfgrep.1.gz (of link group lzma) doesn&#39;t exist
Setting up libmpc3:amd64 (1.1.0-1) ...
Setting up libitm1:amd64 (8.4.0-1ubuntu1~18.04) ...
Setting up libisl19:amd64 (0.19-1) ...
Setting up libasan4:amd64 (7.5.0-3ubuntu1~18.04) ...
Setting up libbinutils:amd64 (2.30-21ubuntu1~18.04.8) ...
Setting up libcilkrts5:amd64 (7.5.0-3ubuntu1~18.04) ...
Setting up libubsan0:amd64 (7.5.0-3ubuntu1~18.04) ...
Setting up libgcc-7-dev:amd64 (7.5.0-3ubuntu1~18.04) ...
Setting up cpp-7 (7.5.0-3ubuntu1~18.04) ...
Setting up libstdc++-7-dev:amd64 (7.5.0-3ubuntu1~18.04) ...
Setting up binutils-x86-64-linux-gnu (2.30-21ubuntu1~18.04.8) ...
Setting up cpp (4:7.4.0-1ubuntu2.3) ...
Setting up binutils (2.30-21ubuntu1~18.04.8) ...
Setting up gcc-7 (7.5.0-3ubuntu1~18.04) ...
Setting up g++-7 (7.5.0-3ubuntu1~18.04) ...
Setting up gcc (4:7.4.0-1ubuntu2.3) ...
Setting up dpkg-dev (1.19.0.5ubuntu2.4) ...
Setting up g++ (4:7.4.0-1ubuntu2.3) ...
update-alternatives: using /usr/bin/g++ to provide /usr/bin/c++ (c++) in auto mode
update-alternatives: warning: skip creation of /usr/share/man/man1/c++.1.gz because associated file /usr/share/man/man1/g++.1.gz (of link group c++) doesn&#39;t exist
Setting up build-essential (12.4ubuntu1) ...
Processing triggers for libc-bin (2.27-3ubuntu1.6) ...
Collecting sagemaker-training
  Downloading sagemaker_training-4.4.4.tar.gz (58 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 58.5/58.5 kB 4.6 MB/s eta 0:00:00
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status &#39;done&#39;
Collecting cupy-cuda115
  Downloading cupy_cuda115-10.6.0-cp39-cp39-manylinux1_x86_64.whl (81.5 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 81.5/81.5 MB 23.7 MB/s eta 0:00:00
Collecting flask
  Downloading Flask-2.2.2-py3-none-any.whl (101 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 101.5/101.5 kB 25.8 MB/s eta 0:00:00
Requirement already satisfied: dask-ml in /opt/conda/envs/rapids/lib/python3.9/site-packages (1.9.0)
Requirement already satisfied: numpy in /opt/conda/envs/rapids/lib/python3.9/site-packages (from sagemaker-training) (1.23.5)
Collecting boto3
  Downloading boto3-1.26.54-py3-none-any.whl (132 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 132.7/132.7 kB 33.7 MB/s eta 0:00:00
Requirement already satisfied: six in /opt/conda/envs/rapids/lib/python3.9/site-packages (from sagemaker-training) (1.16.0)
Requirement already satisfied: pip in /opt/conda/envs/rapids/lib/python3.9/site-packages (from sagemaker-training) (22.3.1)
Collecting retrying&gt;=1.3.3
  Downloading retrying-1.3.4-py3-none-any.whl (11 kB)
Collecting gevent
  Downloading gevent-22.10.2-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (6.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.4/6.4 MB 99.6 MB/s eta 0:00:00
Collecting inotify_simple==1.2.1
  Downloading inotify_simple-1.2.1.tar.gz (7.9 kB)
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status &#39;done&#39;
Collecting werkzeug&gt;=0.15.5
  Downloading Werkzeug-2.2.2-py3-none-any.whl (232 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 232.7/232.7 kB 8.5 MB/s eta 0:00:00
Collecting paramiko&gt;=2.4.2
  Downloading paramiko-3.0.0-py3-none-any.whl (210 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 210.8/210.8 kB 47.2 MB/s eta 0:00:00
Requirement already satisfied: psutil&gt;=5.6.7 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from sagemaker-training) (5.9.4)
Requirement already satisfied: protobuf&lt;=3.20.2,&gt;=3.9.2 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from sagemaker-training) (3.20.2)
Requirement already satisfied: scipy&gt;=1.2.2 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from sagemaker-training) (1.6.0)
Requirement already satisfied: fastrlock&gt;=0.5 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from cupy-cuda115) (0.8)
Collecting itsdangerous&gt;=2.0
  Downloading itsdangerous-2.1.2-py3-none-any.whl (15 kB)
Requirement already satisfied: importlib-metadata&gt;=3.6.0 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from flask) (5.1.0)
Requirement already satisfied: click&gt;=8.0 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from flask) (8.1.3)
Requirement already satisfied: Jinja2&gt;=3.0 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from flask) (3.1.2)
Requirement already satisfied: distributed&gt;=2.4.0 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from dask-ml) (2022.11.1)
Requirement already satisfied: pandas&gt;=0.24.2 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from dask-ml) (1.5.2)
Requirement already satisfied: dask[array,dataframe]&gt;=2.4.0 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from dask-ml) (2022.11.1+17.g23cbe9a9a)
Requirement already satisfied: multipledispatch&gt;=0.4.9 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from dask-ml) (0.6.0)
Requirement already satisfied: numba&gt;=0.51.0 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from dask-ml) (0.56.4)
Requirement already satisfied: dask-glm&gt;=0.2.0 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from dask-ml) (0.2.0)
Requirement already satisfied: scikit-learn&gt;=0.23 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from dask-ml) (0.24.2)
Requirement already satisfied: packaging in /opt/conda/envs/rapids/lib/python3.9/site-packages (from dask-ml) (22.0)
Requirement already satisfied: cloudpickle&gt;=0.2.2 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from dask-glm&gt;=0.2.0-&gt;dask-ml) (2.2.0)
Requirement already satisfied: toolz&gt;=0.8.2 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from dask[array,dataframe]&gt;=2.4.0-&gt;dask-ml) (0.12.0)
Requirement already satisfied: fsspec&gt;=0.6.0 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from dask[array,dataframe]&gt;=2.4.0-&gt;dask-ml) (2022.11.0)
Requirement already satisfied: pyyaml&gt;=5.3.1 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from dask[array,dataframe]&gt;=2.4.0-&gt;dask-ml) (6.0)
Requirement already satisfied: partd&gt;=0.3.10 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from dask[array,dataframe]&gt;=2.4.0-&gt;dask-ml) (1.3.0)
Requirement already satisfied: urllib3 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from distributed&gt;=2.4.0-&gt;dask-ml) (1.26.13)
Requirement already satisfied: locket&gt;=1.0.0 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from distributed&gt;=2.4.0-&gt;dask-ml) (1.0.0)
Requirement already satisfied: tblib&gt;=1.6.0 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from distributed&gt;=2.4.0-&gt;dask-ml) (1.7.0)
Requirement already satisfied: msgpack&gt;=0.6.0 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from distributed&gt;=2.4.0-&gt;dask-ml) (1.0.4)
Requirement already satisfied: tornado&lt;6.2,&gt;=6.0.3 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from distributed&gt;=2.4.0-&gt;dask-ml) (6.1)
Requirement already satisfied: sortedcontainers!=2.0.0,!=2.0.1 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from distributed&gt;=2.4.0-&gt;dask-ml) (2.4.0)
Requirement already satisfied: zict&gt;=0.1.3 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from distributed&gt;=2.4.0-&gt;dask-ml) (2.2.0)
Requirement already satisfied: zipp&gt;=0.5 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from importlib-metadata&gt;=3.6.0-&gt;flask) (3.11.0)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from Jinja2&gt;=3.0-&gt;flask) (2.1.1)
Requirement already satisfied: llvmlite&lt;0.40,&gt;=0.39.0dev0 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from numba&gt;=0.51.0-&gt;dask-ml) (0.39.1)
Requirement already satisfied: setuptools in /opt/conda/envs/rapids/lib/python3.9/site-packages (from numba&gt;=0.51.0-&gt;dask-ml) (65.5.1)
Requirement already satisfied: python-dateutil&gt;=2.8.1 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from pandas&gt;=0.24.2-&gt;dask-ml) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from pandas&gt;=0.24.2-&gt;dask-ml) (2022.6)
Requirement already satisfied: cryptography&gt;=3.3 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from paramiko&gt;=2.4.2-&gt;sagemaker-training) (38.0.4)
Collecting bcrypt&gt;=3.2
  Downloading bcrypt-4.0.1-cp36-abi3-manylinux_2_24_x86_64.whl (593 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 593.2/593.2 kB 80.9 MB/s eta 0:00:00
Collecting pynacl&gt;=1.5
  Downloading PyNaCl-1.5.0-cp36-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl (856 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 856.7/856.7 kB 74.2 MB/s eta 0:00:00
Requirement already satisfied: joblib&gt;=0.11 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from scikit-learn&gt;=0.23-&gt;dask-ml) (1.2.0)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from scikit-learn&gt;=0.23-&gt;dask-ml) (3.1.0)
Collecting s3transfer&lt;0.7.0,&gt;=0.6.0
  Downloading s3transfer-0.6.0-py3-none-any.whl (79 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 79.6/79.6 kB 20.7 MB/s eta 0:00:00
Requirement already satisfied: jmespath&lt;2.0.0,&gt;=0.7.1 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from boto3-&gt;sagemaker-training) (1.0.1)
Collecting botocore&lt;1.30.0,&gt;=1.29.54
  Downloading botocore-1.29.54-py3-none-any.whl (10.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 10.3/10.3 MB 71.3 MB/s eta 0:00:00
Collecting greenlet&gt;=2.0.0
  Downloading greenlet-2.0.1-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (535 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 535.9/535.9 kB 18.4 MB/s eta 0:00:00
Collecting zope.event
  Downloading zope.event-4.6-py2.py3-none-any.whl (6.8 kB)
Collecting zope.interface
  Downloading zope.interface-5.5.2-cp39-cp39-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (257 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 257.9/257.9 kB 54.6 MB/s eta 0:00:00
Requirement already satisfied: cffi&gt;=1.12 in /opt/conda/envs/rapids/lib/python3.9/site-packages (from cryptography&gt;=3.3-&gt;paramiko&gt;=2.4.2-&gt;sagemaker-training) (1.15.1)
Requirement already satisfied: heapdict in /opt/conda/envs/rapids/lib/python3.9/site-packages (from zict&gt;=0.1.3-&gt;distributed&gt;=2.4.0-&gt;dask-ml) (1.0.1)
Requirement already satisfied: pycparser in /opt/conda/envs/rapids/lib/python3.9/site-packages (from cffi&gt;=1.12-&gt;cryptography&gt;=3.3-&gt;paramiko&gt;=2.4.2-&gt;sagemaker-training) (2.21)
Building wheels for collected packages: sagemaker-training, inotify_simple
  Building wheel for sagemaker-training (setup.py): started
  Building wheel for sagemaker-training (setup.py): finished with status &#39;done&#39;
  Created wheel for sagemaker-training: filename=sagemaker_training-4.4.4-cp39-cp39-linux_x86_64.whl size=77792 sha256=d55794478490aade03aa771de3169132e0495b46201c93474f6a01b0dd52920f
  Stored in directory: /root/.cache/pip/wheels/bd/d1/92/a280728ea435ca0905d0adc46e7e1294539cd20c20061e0847
  Building wheel for inotify_simple (setup.py): started
  Building wheel for inotify_simple (setup.py): finished with status &#39;done&#39;
  Created wheel for inotify_simple: filename=inotify_simple-1.2.1-py3-none-any.whl size=8201 sha256=3827b905d216809ebc6a6938f21634f4878cceab38fa928ac07b89ea7420e0d9
  Stored in directory: /root/.cache/pip/wheels/3f/c2/6a/6f6c65836d2fad9ae7008373d82e38b519187113fac6b720c8
Successfully built sagemaker-training inotify_simple
Installing collected packages: inotify_simple, zope.interface, zope.event, werkzeug, retrying, itsdangerous, greenlet, cupy-cuda115, bcrypt, pynacl, gevent, flask, botocore, s3transfer, paramiko, boto3, sagemaker-training
  Attempting uninstall: botocore
    Found existing installation: botocore 1.27.59
    Uninstalling botocore-1.27.59:
      Successfully uninstalled botocore-1.27.59
ERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
aiobotocore 2.4.0 requires botocore&lt;1.27.60,&gt;=1.27.59, but you have botocore 1.29.54 which is incompatible.
Successfully installed bcrypt-4.0.1 boto3-1.26.54 botocore-1.29.54 cupy-cuda115-10.6.0 flask-2.2.2 gevent-22.10.2 greenlet-2.0.1 inotify_simple-1.2.1 itsdangerous-2.1.2 paramiko-3.0.0 pynacl-1.5.0 retrying-1.3.4 s3transfer-0.6.0 sagemaker-training-4.4.4 werkzeug-2.2.2 zope.event-4.6 zope.interface-5.5.2
WARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
Requirement already satisfied: protobuf in /opt/conda/envs/rapids/lib/python3.9/site-packages (3.20.2)
Collecting protobuf
  Downloading protobuf-4.21.12-cp37-abi3-manylinux2014_x86_64.whl (409 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 409.8/409.8 kB 11.6 MB/s eta 0:00:00
Installing collected packages: protobuf
  Attempting uninstall: protobuf
    Found existing installation: protobuf 3.20.2
    Uninstalling protobuf-3.20.2:
      Successfully uninstalled protobuf-3.20.2
ERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
cudf 22.12.1 requires cupy-cuda11x, which is not installed.
sagemaker-training 4.4.4 requires protobuf&lt;=3.20.2,&gt;=3.9.2, but you have protobuf 4.21.12 which is incompatible.
cudf 22.12.1 requires protobuf&lt;3.21.0a0,&gt;=3.20.1, but you have protobuf 4.21.12 which is incompatible.
Successfully installed protobuf-4.21.12
WARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
Removing intermediate container 26458c19e436
 ---&gt; c079363fd950
Step 8/12 : ENV CLOUD_PATH=&quot;/opt/ml/code&quot;
 ---&gt; Running in 2a6107db1872
Removing intermediate container 2a6107db1872
 ---&gt; 544766cb6c2f
Step 9/12 : COPY . $CLOUD_PATH
 ---&gt; 5601b0026b3d
Step 10/12 : RUN chmod +x $CLOUD_PATH/entrypoint.sh
 ---&gt; Running in f1540779d7ac
Removing intermediate container f1540779d7ac
 ---&gt; b0e41515bf61
Step 11/12 : WORKDIR $CLOUD_PATH
 ---&gt; Running in 1630b5f89848
Removing intermediate container 1630b5f89848
 ---&gt; ad01ce435ad3
Step 12/12 : ENTRYPOINT [&quot;./entrypoint.sh&quot;]
 ---&gt; Running in 3e2a828b1833
Removing intermediate container 3e2a828b1833
 ---&gt; 045f00216761
Successfully built 045f00216761
Successfully tagged 561241433344.dkr.ecr.us-west-2.amazonaws.com/rapids-sagemaker-mnmg-100:22.12-cuda11.5-runtime-ubuntu18.04-py3.9
CPU times: user 687 ms, sys: 99.4 ms, total: 787 ms
Wall time: 45.8 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>docker<span class="w"> </span>images
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>REPOSITORY                                                               TAG                                        IMAGE ID       CREATED                  SIZE
561241433344.dkr.ecr.us-west-2.amazonaws.com/rapids-sagemaker-mnmg-100   22.12-cuda11.5-runtime-ubuntu18.04-py3.9   045f00216761   Less than a second ago   13.7GB
rapidsai/rapidsai-core                                                   22.12-cuda11.5-runtime-ubuntu18.04-py3.9   9de590bd08c5   5 weeks ago              13.1GB
</pre></div>
</div>
</div>
</div>
</section>
<section id="publish-to-elastic-cloud-registry-ecr">
<h4>Publish to Elastic Cloud Registry (ECR)<a class="headerlink" href="#publish-to-elastic-cloud-registry-ecr" title="Permalink to this heading">#</a></h4>
<p>Now that we’ve built and tagged our container its time to push it to Amazon’s container registry (ECR). Once in ECR, AWS SageMaker will be able to leverage our image to build Estimators and run experiments.</p>
<p>Docker Login to ECR</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">docker_login_str</span> <span class="o">=</span> <span class="o">!(</span>aws<span class="w"> </span>ecr<span class="w"> </span>get-login<span class="w"> </span>--region<span class="w"> </span><span class="o">{</span>region<span class="o">[</span><span class="m">0</span><span class="o">]}</span><span class="w"> </span>--no-include-email<span class="o">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!{</span>docker_login_str<span class="o">[</span><span class="m">0</span><span class="o">]}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING! Using --password via the CLI is insecure. Use --password-stdin.
WARNING! Your password will be stored unencrypted in /home/ec2-user/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store

Login Succeeded
</pre></div>
</div>
</div>
</div>
<p>Create ECR repository [ if it doesn’t already exist]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">repository_query</span> <span class="o">=</span> <span class="o">!(</span>aws<span class="w"> </span>ecr<span class="w"> </span>describe-repositories<span class="w"> </span>--repository-names<span class="w"> </span><span class="nv">$image_base</span><span class="o">)</span>
<span class="k">if</span> <span class="n">repository_query</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
    <span class="o">!(</span>aws<span class="w"> </span>ecr<span class="w"> </span>create-repository<span class="w"> </span>--repository-name<span class="w"> </span><span class="nv">$image_base</span><span class="o">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s now actually push the container to ECR</p>
<blockquote>
<div><p>Note the first push to ECR may take some time (hopefully less than 10 minutes).</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>docker<span class="w"> </span>push<span class="w"> </span><span class="nv">$ecr_fullname</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The push refers to repository [561241433344.dkr.ecr.us-west-2.amazonaws.com/rapids-sagemaker-mnmg-100]

36e5943b: Preparing 
61737e1c: Preparing 
b2094ffc: Preparing 
601675bf: Preparing 
a211643c: Preparing 
51d8b000: Preparing 
f7b7f229: Preparing 
48598b79: Preparing 
2b6403fc: Preparing 
ca9f5267: Preparing 
e36e26b2: Preparing 
2c4843ad: Preparing 
2094ffc: Pushed   588.6MB/583.5MB2A22.12-cuda11.5-runtime-ubuntu18.04-py3.9: digest: sha256:1d0c31e38929d70278bc2170206ad74207dd692dc7b4ff125de1d6c924fe0afe size: 3061
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="create-estimator">
<h3>Create Estimator<a class="headerlink" href="#create-estimator" title="Permalink to this heading">#</a></h3>
<p>Having built our container [ +custom logic] and pushed it to ECR, we can finally compile all of efforts into an Estimator instance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>docker<span class="w"> </span>images
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>REPOSITORY                                                               TAG                                        IMAGE ID       CREATED              SIZE
561241433344.dkr.ecr.us-west-2.amazonaws.com/rapids-sagemaker-mnmg-100   22.12-cuda11.5-runtime-ubuntu18.04-py3.9   045f00216761   About a minute ago   13.7GB
rapidsai/rapidsai-core                                                   22.12-cuda11.5-runtime-ubuntu18.04-py3.9   9de590bd08c5   5 weeks ago          13.1GB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;volume_size&#39; - EBS volume size in GB, default = 30</span>
<span class="n">estimator_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;image_uri&quot;</span><span class="p">:</span> <span class="n">ecr_fullname</span><span class="p">,</span>
    <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="n">execution_role</span><span class="p">,</span>
    <span class="s2">&quot;instance_type&quot;</span><span class="p">:</span> <span class="n">instance_type</span><span class="p">,</span>
    <span class="s2">&quot;instance_count&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;input_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span>
    <span class="s2">&quot;output_path&quot;</span><span class="p">:</span> <span class="n">s3_model_output</span><span class="p">,</span>
    <span class="s2">&quot;use_spot_instances&quot;</span><span class="p">:</span> <span class="n">use_spot_instances_flag</span><span class="p">,</span>
    <span class="s2">&quot;max_run&quot;</span><span class="p">:</span> <span class="n">max_duration_of_experiment_seconds</span><span class="p">,</span>  <span class="c1"># 24 hours</span>
    <span class="s2">&quot;sagemaker_session&quot;</span><span class="p">:</span> <span class="n">session</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">if</span> <span class="n">use_spot_instances_flag</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">estimator_params</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;max_wait&quot;</span><span class="p">:</span> <span class="n">max_duration_of_experiment_seconds</span> <span class="o">+</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">Estimator</span><span class="p">(</span><span class="o">**</span><span class="n">estimator_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="test-estimator">
<h3>Test Estimator<a class="headerlink" href="#test-estimator" title="Permalink to this heading">#</a></h3>
<p>Now we are ready to test by asking SageMaker to run the BYOContainer logic inside our Estimator. This is a useful step if you’ve made changes to your custom logic and are interested in making sure everything works before launching a large HPO search.</p>
<blockquote>
<div><p>Note: This verification step will use the default hyperparameter values declared in our custom train code, as SageMaker HPO will not be orchestrating a search for this single run.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summarize_choices</span><span class="p">(</span>
    <span class="n">s3_data_input</span><span class="p">,</span>
    <span class="n">s3_model_output</span><span class="p">,</span>
    <span class="n">ml_workflow_choice</span><span class="p">,</span>
    <span class="n">algorithm_choice</span><span class="p">,</span>
    <span class="n">cv_folds</span><span class="p">,</span>
    <span class="n">instance_type</span><span class="p">,</span>
    <span class="n">use_spot_instances_flag</span><span class="p">,</span>
    <span class="n">search_strategy</span><span class="p">,</span>
    <span class="n">max_jobs</span><span class="p">,</span>
    <span class="n">max_parallel_jobs</span><span class="p">,</span>
    <span class="n">max_duration_of_experiment_seconds</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>s3 data input    =	s3://sagemaker-rapids-hpo-us-west-2/10_year
s3 model output  =	s3://sagemaker-us-west-2-561241433344/trained-models
compute          =	multiGPU
algorithm        =	XGBoost, 10 cv-fold
instance         =	ml.p3.8xlarge
spot instances   =	True
hpo strategy     =	Random
max_experiments  =	100
max_parallel     =	10
max runtime      =	86400 sec
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">job_name</span> <span class="o">=</span> <span class="n">new_job_name_from_config</span><span class="p">(</span>
    <span class="n">dataset_directory</span><span class="p">,</span>
    <span class="n">region</span><span class="p">,</span>
    <span class="n">ml_workflow_choice</span><span class="p">,</span>
    <span class="n">algorithm_choice</span><span class="p">,</span>
    <span class="n">cv_folds</span><span class="p">,</span>
    <span class="n">instance_type</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>generated job name : air-mGPU-XGB-10cv-a96aa65a146b7a
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">s3_data_input</span><span class="p">,</span> <span class="n">job_name</span><span class="o">=</span><span class="n">job_name</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:sagemaker:Creating training-job with name: air-mgpu-xgb-10cv-a96aa65a146b7a
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-01-23 18:33:19 Starting - Starting the training job......
2023-01-23 18:34:13 Starting - Preparing the instances for training............
2023-01-23 18:36:00 Downloading - Downloading input data...
2023-01-23 18:36:31 Training - Downloading the training image.....................
2023-01-23 18:39:52 Training - Training image download completed. Training in progress..<span class=" -Color -Color-Blue">@ entrypoint -&gt; launching training script </span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:14,715     INFO hpo_log </span>
<span class=" -Color -Color-Blue">parsing configuration from environment settings...</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:14,715     INFO hpo_log   Dataset: Airline</span>
<span class=" -Color -Color-Blue">  Compute: multi-GPU</span>
<span class=" -Color -Color-Blue">  Algorithm: XGBoost</span>
<span class=" -Color -Color-Blue">  CV_folds: 10</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:14,715     INFO hpo_log parsing model hyperparameters from command line arguments...log</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:14,720     INFO hpo_log {    &#39;gamma&#39;: 0.0,</span>
<span class=" -Color -Color-Blue">     &#39;lambda&#39;: 1,</span>
<span class=" -Color -Color-Blue">     &#39;learning_rate&#39;: 0.3,</span>
<span class=" -Color -Color-Blue">     &#39;max_depth&#39;: 5,</span>
<span class=" -Color -Color-Blue">     &#39;num_boost_round&#39;: 10,</span>
<span class=" -Color -Color-Blue">     &#39;objective&#39;: &#39;binary:logistic&#39;,</span>
<span class=" -Color -Color-Blue">     &#39;random_state&#39;: 0,</span>
<span class=" -Color -Color-Blue">     &#39;seed&#39;: 0,</span>
<span class=" -Color -Color-Blue">     &#39;tree_method&#39;: &#39;gpu_hist&#39;,</span>
<span class=" -Color -Color-Blue">     &#39;verbosity&#39;: 0}</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:14,721     INFO hpo_log Parquet input files detected</span>
<span class=" -Color -Color-Blue">[&#39;/opt/ml/input/data/training/part.20.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.120.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.38.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.83.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.5.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.99.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.10.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.44.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.98.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.12.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.103.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.102.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.41.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.59.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.40.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.42.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.86.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.107.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.6.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.96.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.108.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.119.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.74.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.92.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.9.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.16.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.8.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.91.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.67.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.35.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.46.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.36.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.30.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.22.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.78.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.109.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.66.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.26.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.75.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.89.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.58.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.104.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.13.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.37.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.72.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.116.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.23.parquet&#39;,</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:14,722     INFO hpo_log detected 121 files as input</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.68.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.47.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.57.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.97.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.4.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.85.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.110.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.73.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.53.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.63.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.25.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.15.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.19.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.87.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.21.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.32.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.29.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.76.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.84.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.115.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.55.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.31.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.11.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.39.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.100.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.64.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.94.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.60.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.93.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.28.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.14.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.80.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.34.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.82.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.48.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.70.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.81.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.65.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.27.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.52.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.0.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.50.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.71.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.118.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.111.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.54.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.77.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.79.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.17.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.101.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.3.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.95.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.56.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.43.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.90.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.33.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.105.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.51.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.45.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.117.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.18.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.62.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.49.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.106.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.2.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.24.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.7.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.88.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.69.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.1.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.113.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.114.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.61.parquet&#39;,</span>
<span class=" -Color -Color-Blue"> &#39;/opt/ml/input/data/training/part.112.parquet&#39;]</span>
<span class=" -Color -Color-Blue">/opt/conda/envs/rapids/lib/python3.9/site-packages/cupy/_environment.py:437: UserWarning: </span>
<span class=" -Color -Color-Blue">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Blue">  CuPy may not function correctly because multiple CuPy packages are installed</span>
<span class=" -Color -Color-Blue">  in your environment:</span>
<span class=" -Color -Color-Blue">    cupy, cupy-cuda115</span>
<span class=" -Color -Color-Blue">  Follow these steps to resolve this issue:</span>
<span class=" -Color -Color-Blue">    1. For all packages listed above, run the following command to remove all</span>
<span class=" -Color -Color-Blue">       existing CuPy installations:</span>
<span class=" -Color -Color-Blue">         $ pip uninstall &lt;package_name&gt;</span>
<span class=" -Color -Color-Blue">      If you previously installed CuPy via conda, also run the following:</span>
<span class=" -Color -Color-Blue">         $ conda uninstall cupy</span>
<span class=" -Color -Color-Blue">    2. Install the appropriate CuPy package.</span>
<span class=" -Color -Color-Blue">       Refer to the Installation Guide for detailed instructions.</span>
<span class=" -Color -Color-Blue">         https://docs.cupy.dev/en/stable/install.html</span>
<span class=" -Color -Color-Blue">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Blue">  warnings.warn(f&#39;&#39;&#39;</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:17,980     INFO hpo_log Multi-GPU Workflow</span>
<span class=" -Color -Color-Magenta">@ entrypoint -&gt; launching training script </span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:15,669     INFO hpo_log </span>
<span class=" -Color -Color-Magenta">parsing configuration from environment settings...</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:15,670     INFO hpo_log   Dataset: Airline</span>
<span class=" -Color -Color-Magenta">  Compute: multi-GPU</span>
<span class=" -Color -Color-Magenta">  Algorithm: XGBoost</span>
<span class=" -Color -Color-Magenta">  CV_folds: 10</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:15,670     INFO hpo_log parsing model hyperparameters from command line arguments...log</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:15,675     INFO hpo_log {    &#39;gamma&#39;: 0.0,</span>
<span class=" -Color -Color-Magenta">     &#39;lambda&#39;: 1,</span>
<span class=" -Color -Color-Magenta">     &#39;learning_rate&#39;: 0.3,</span>
<span class=" -Color -Color-Magenta">     &#39;max_depth&#39;: 5,</span>
<span class=" -Color -Color-Magenta">     &#39;num_boost_round&#39;: 10,</span>
<span class=" -Color -Color-Magenta">     &#39;objective&#39;: &#39;binary:logistic&#39;,</span>
<span class=" -Color -Color-Magenta">     &#39;random_state&#39;: 0,</span>
<span class=" -Color -Color-Magenta">     &#39;seed&#39;: 0,</span>
<span class=" -Color -Color-Magenta">     &#39;tree_method&#39;: &#39;gpu_hist&#39;,</span>
<span class=" -Color -Color-Magenta">     &#39;verbosity&#39;: 0}</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:15,676     INFO hpo_log Parquet input files detected</span>
<span class=" -Color -Color-Magenta">[&#39;/opt/ml/input/data/training/part.95.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.40.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.41.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.20.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.29.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.23.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.17.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.83.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.78.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.103.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.70.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.53.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.51.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.66.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.72.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.76.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.31.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.44.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.77.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.47.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.113.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.45.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.3.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.11.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.13.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.111.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.69.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.21.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.114.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.28.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.94.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.73.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.48.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.35.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.16.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.67.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.79.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.25.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.119.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.37.parquet&#39;,</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:15,677     INFO hpo_log detected 121 files as input</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.4.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.74.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.68.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.9.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.54.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.39.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.96.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.71.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.7.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.50.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.15.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.104.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.88.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.80.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.12.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.84.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.116.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.19.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.46.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.0.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.61.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.36.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.64.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.102.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.100.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.86.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.89.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.6.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.60.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.120.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.56.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.26.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.99.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.14.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.105.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.106.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.90.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.33.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.43.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.118.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.27.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.65.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.101.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.87.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.107.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.8.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.110.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.49.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.112.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.24.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.115.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.55.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.57.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.98.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.85.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.117.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.52.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.93.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.30.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.82.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.75.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.81.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.97.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.62.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.18.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.22.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.91.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.32.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.92.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.38.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.63.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.2.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.59.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.42.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.34.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.108.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.109.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.1.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.5.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.58.parquet&#39;,</span>
<span class=" -Color -Color-Magenta"> &#39;/opt/ml/input/data/training/part.10.parquet&#39;]</span>
<span class=" -Color -Color-Magenta">/opt/conda/envs/rapids/lib/python3.9/site-packages/cupy/_environment.py:437: UserWarning: </span>
<span class=" -Color -Color-Magenta">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Magenta">  CuPy may not function correctly because multiple CuPy packages are installed</span>
<span class=" -Color -Color-Magenta">  in your environment:</span>
<span class=" -Color -Color-Magenta">    cupy, cupy-cuda115</span>
<span class=" -Color -Color-Magenta">  Follow these steps to resolve this issue:</span>
<span class=" -Color -Color-Magenta">    1. For all packages listed above, run the following command to remove all</span>
<span class=" -Color -Color-Magenta">       existing CuPy installations:</span>
<span class=" -Color -Color-Magenta">         $ pip uninstall &lt;package_name&gt;</span>
<span class=" -Color -Color-Magenta">      If you previously installed CuPy via conda, also run the following:</span>
<span class=" -Color -Color-Magenta">         $ conda uninstall cupy</span>
<span class=" -Color -Color-Magenta">    2. Install the appropriate CuPy package.</span>
<span class=" -Color -Color-Magenta">       Refer to the Installation Guide for detailed instructions.</span>
<span class=" -Color -Color-Magenta">         https://docs.cupy.dev/en/stable/install.html</span>
<span class=" -Color -Color-Magenta">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Magenta">  warnings.warn(f&#39;&#39;&#39;</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:18,987     INFO hpo_log Multi-GPU Workflow</span>
<span class=" -Color -Color-Blue">/opt/conda/envs/rapids/lib/python3.9/site-packages/cupy/_environment.py:437: UserWarning: </span>
<span class=" -Color -Color-Blue">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Blue">  CuPy may not function correctly because multiple CuPy packages are installed</span>
<span class=" -Color -Color-Blue">  in your environment:</span>
<span class=" -Color -Color-Blue">    cupy, cupy-cuda115</span>
<span class=" -Color -Color-Blue">  Follow these steps to resolve this issue:</span>
<span class=" -Color -Color-Blue">    1. For all packages listed above, run the following command to remove all</span>
<span class=" -Color -Color-Blue">       existing CuPy installations:</span>
<span class=" -Color -Color-Blue">         $ pip uninstall &lt;package_name&gt;</span>
<span class=" -Color -Color-Blue">      If you previously installed CuPy via conda, also run the following:</span>
<span class=" -Color -Color-Blue">         $ conda uninstall cupy</span>
<span class=" -Color -Color-Blue">    2. Install the appropriate CuPy package.</span>
<span class=" -Color -Color-Blue">       Refer to the Installation Guide for detailed instructions.</span>
<span class=" -Color -Color-Blue">         https://docs.cupy.dev/en/stable/install.html</span>
<span class=" -Color -Color-Blue">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Blue">  warnings.warn(f&#39;&#39;&#39;</span>
<span class=" -Color -Color-Blue">/opt/conda/envs/rapids/lib/python3.9/site-packages/cupy/_environment.py:437: UserWarning: </span>
<span class=" -Color -Color-Blue">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Blue">  CuPy may not function correctly because multiple CuPy packages are installed</span>
<span class=" -Color -Color-Blue">  in your environment:</span>
<span class=" -Color -Color-Blue">    cupy, cupy-cuda115</span>
<span class=" -Color -Color-Blue">  Follow these steps to resolve this issue:</span>
<span class=" -Color -Color-Blue">    1. For all packages listed above, run the following command to remove all</span>
<span class=" -Color -Color-Blue">       existing CuPy installations:</span>
<span class=" -Color -Color-Blue">         $ pip uninstall &lt;package_name&gt;</span>
<span class=" -Color -Color-Blue">      If you previously installed CuPy via conda, also run the following:</span>
<span class=" -Color -Color-Blue">         $ conda uninstall cupy</span>
<span class=" -Color -Color-Blue">    2. Install the appropriate CuPy package.</span>
<span class=" -Color -Color-Blue">       Refer to the Installation Guide for detailed instructions.</span>
<span class=" -Color -Color-Blue">         https://docs.cupy.dev/en/stable/install.html</span>
<span class=" -Color -Color-Blue">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Blue">  warnings.warn(f&#39;&#39;&#39;</span>
<span class=" -Color -Color-Blue">/opt/conda/envs/rapids/lib/python3.9/site-packages/cupy/_environment.py:437: UserWarning: </span>
<span class=" -Color -Color-Blue">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Blue">  CuPy may not function correctly because multiple CuPy packages are installed</span>
<span class=" -Color -Color-Blue">  in your environment:</span>
<span class=" -Color -Color-Blue">    cupy, cupy-cuda115</span>
<span class=" -Color -Color-Blue">  Follow these steps to resolve this issue:</span>
<span class=" -Color -Color-Blue">    1. For all packages listed above, run the following command to remove all</span>
<span class=" -Color -Color-Blue">       existing CuPy installations:</span>
<span class=" -Color -Color-Blue">         $ pip uninstall &lt;package_name&gt;</span>
<span class=" -Color -Color-Blue">      If you previously installed CuPy via conda, also run the following:</span>
<span class=" -Color -Color-Blue">         $ conda uninstall cupy</span>
<span class=" -Color -Color-Blue">    2. Install the appropriate CuPy package.</span>
<span class=" -Color -Color-Blue">       Refer to the Installation Guide for detailed instructions.</span>
<span class=" -Color -Color-Blue">         https://docs.cupy.dev/en/stable/install.html</span>
<span class=" -Color -Color-Blue">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Blue">  warnings.warn(f&#39;&#39;&#39;</span>
<span class=" -Color -Color-Blue">/opt/conda/envs/rapids/lib/python3.9/site-packages/cupy/_environment.py:437: UserWarning: </span>
<span class=" -Color -Color-Blue">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Blue">  CuPy may not function correctly because multiple CuPy packages are installed</span>
<span class=" -Color -Color-Blue">  in your environment:</span>
<span class=" -Color -Color-Blue">    cupy, cupy-cuda115</span>
<span class=" -Color -Color-Blue">  Follow these steps to resolve this issue:</span>
<span class=" -Color -Color-Blue">    1. For all packages listed above, run the following command to remove all</span>
<span class=" -Color -Color-Blue">       existing CuPy installations:</span>
<span class=" -Color -Color-Blue">         $ pip uninstall &lt;package_name&gt;</span>
<span class=" -Color -Color-Blue">      If you previously installed CuPy via conda, also run the following:</span>
<span class=" -Color -Color-Blue">         $ conda uninstall cupy</span>
<span class=" -Color -Color-Blue">    2. Install the appropriate CuPy package.</span>
<span class=" -Color -Color-Blue">       Refer to the Installation Guide for detailed instructions.</span>
<span class=" -Color -Color-Blue">         https://docs.cupy.dev/en/stable/install.html</span>
<span class=" -Color -Color-Blue">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Blue">  warnings.warn(f&#39;&#39;&#39;</span>
<span class=" -Color -Color-Magenta">/opt/conda/envs/rapids/lib/python3.9/site-packages/cupy/_environment.py:437: UserWarning: </span>
<span class=" -Color -Color-Magenta">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Magenta">  CuPy may not function correctly because multiple CuPy packages are installed</span>
<span class=" -Color -Color-Magenta">  in your environment:</span>
<span class=" -Color -Color-Magenta">    cupy, cupy-cuda115</span>
<span class=" -Color -Color-Magenta">  Follow these steps to resolve this issue:</span>
<span class=" -Color -Color-Magenta">    1. For all packages listed above, run the following command to remove all</span>
<span class=" -Color -Color-Magenta">       existing CuPy installations:</span>
<span class=" -Color -Color-Magenta">         $ pip uninstall &lt;package_name&gt;</span>
<span class=" -Color -Color-Magenta">      If you previously installed CuPy via conda, also run the following:</span>
<span class=" -Color -Color-Magenta">         $ conda uninstall cupy</span>
<span class=" -Color -Color-Magenta">    2. Install the appropriate CuPy package.</span>
<span class=" -Color -Color-Magenta">       Refer to the Installation Guide for detailed instructions.</span>
<span class=" -Color -Color-Magenta">         https://docs.cupy.dev/en/stable/install.html</span>
<span class=" -Color -Color-Magenta">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Magenta">  warnings.warn(f&#39;&#39;&#39;</span>
<span class=" -Color -Color-Magenta">/opt/conda/envs/rapids/lib/python3.9/site-packages/cupy/_environment.py:437: UserWarning: </span>
<span class=" -Color -Color-Magenta">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Magenta">  CuPy may not function correctly because multiple CuPy packages are installed</span>
<span class=" -Color -Color-Magenta">  in your environment:</span>
<span class=" -Color -Color-Magenta">    cupy, cupy-cuda115</span>
<span class=" -Color -Color-Magenta">  Follow these steps to resolve this issue:</span>
<span class=" -Color -Color-Magenta">    1. For all packages listed above, run the following command to remove all</span>
<span class=" -Color -Color-Magenta">       existing CuPy installations:</span>
<span class=" -Color -Color-Magenta">         $ pip uninstall &lt;package_name&gt;</span>
<span class=" -Color -Color-Magenta">      If you previously installed CuPy via conda, also run the following:</span>
<span class=" -Color -Color-Magenta">         $ conda uninstall cupy</span>
<span class=" -Color -Color-Magenta">    2. Install the appropriate CuPy package.</span>
<span class=" -Color -Color-Magenta">       Refer to the Installation Guide for detailed instructions.</span>
<span class=" -Color -Color-Magenta">         https://docs.cupy.dev/en/stable/install.html</span>
<span class=" -Color -Color-Magenta">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Magenta">  warnings.warn(f&#39;&#39;&#39;</span>
<span class=" -Color -Color-Magenta">/opt/conda/envs/rapids/lib/python3.9/site-packages/cupy/_environment.py:437: UserWarning: </span>
<span class=" -Color -Color-Magenta">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Magenta">  CuPy may not function correctly because multiple CuPy packages are installed</span>
<span class=" -Color -Color-Magenta">  in your environment:</span>
<span class=" -Color -Color-Magenta">    cupy, cupy-cuda115</span>
<span class=" -Color -Color-Magenta">  Follow these steps to resolve this issue:</span>
<span class=" -Color -Color-Magenta">    1. For all packages listed above, run the following command to remove all</span>
<span class=" -Color -Color-Magenta">       existing CuPy installations:</span>
<span class=" -Color -Color-Magenta">         $ pip uninstall &lt;package_name&gt;</span>
<span class=" -Color -Color-Magenta">      If you previously installed CuPy via conda, also run the following:</span>
<span class=" -Color -Color-Magenta">         $ conda uninstall cupy</span>
<span class=" -Color -Color-Magenta">    2. Install the appropriate CuPy package.</span>
<span class=" -Color -Color-Magenta">       Refer to the Installation Guide for detailed instructions.</span>
<span class=" -Color -Color-Magenta">         https://docs.cupy.dev/en/stable/install.html</span>
<span class=" -Color -Color-Magenta">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Magenta">  warnings.warn(f&#39;&#39;&#39;</span>
<span class=" -Color -Color-Magenta">/opt/conda/envs/rapids/lib/python3.9/site-packages/cupy/_environment.py:437: UserWarning: </span>
<span class=" -Color -Color-Magenta">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Magenta">  CuPy may not function correctly because multiple CuPy packages are installed</span>
<span class=" -Color -Color-Magenta">  in your environment:</span>
<span class=" -Color -Color-Magenta">    cupy, cupy-cuda115</span>
<span class=" -Color -Color-Magenta">  Follow these steps to resolve this issue:</span>
<span class=" -Color -Color-Magenta">    1. For all packages listed above, run the following command to remove all</span>
<span class=" -Color -Color-Magenta">       existing CuPy installations:</span>
<span class=" -Color -Color-Magenta">         $ pip uninstall &lt;package_name&gt;</span>
<span class=" -Color -Color-Magenta">      If you previously installed CuPy via conda, also run the following:</span>
<span class=" -Color -Color-Magenta">         $ conda uninstall cupy</span>
<span class=" -Color -Color-Magenta">    2. Install the appropriate CuPy package.</span>
<span class=" -Color -Color-Magenta">       Refer to the Installation Guide for detailed instructions.</span>
<span class=" -Color -Color-Magenta">         https://docs.cupy.dev/en/stable/install.html</span>
<span class=" -Color -Color-Magenta">--------------------------------------------------------------------------------</span>
<span class=" -Color -Color-Magenta">  warnings.warn(f&#39;&#39;&#39;</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:19,962 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:19,962 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:19,969 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:19,969 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:19,970 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:19,970 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:19,974 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:19,974 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:20,828     INFO hpo_log dask multi-GPU cluster with 4 workers </span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:20,828     INFO hpo_log  --- cluster_initialize completed in 2.84786 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:20,828     INFO hpo_log &gt; parquet data ingestion</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:20,996 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:20,996 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:20,999 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:21,000 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:21,007 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:21,007 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:21,029 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:21,029 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:21,849     INFO hpo_log dask multi-GPU cluster with 4 workers </span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:21,849     INFO hpo_log  --- cluster_initialize completed in 2.86224 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:21,850     INFO hpo_log &gt; parquet data ingestion</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:29,306     INFO hpo_log #011 dataset len: 64451250</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:30,140     INFO hpo_log #011 dataset len: 64451250</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:29,925     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:30,744     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:33,156     INFO hpo_log  --- split_dataset completed in 3.23046 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:33,156     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:33,936     INFO hpo_log  --- split_dataset completed in 3.19171 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:33,936     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Blue">[18:40:34] task [xgboost.dask-0]:tcp://127.0.0.1:45687 got new rank 0</span>
<span class=" -Color -Color-Blue">[18:40:34] task [xgboost.dask-1]:tcp://127.0.0.1:34471 got new rank 1</span>
<span class=" -Color -Color-Blue">[18:40:34] task [xgboost.dask-2]:tcp://127.0.0.1:33085 got new rank 2</span>
<span class=" -Color -Color-Blue">[18:40:34] task [xgboost.dask-3]:tcp://127.0.0.1:43469 got new rank 3</span>
<span class=" -Color -Color-Magenta">[18:40:35] task [xgboost.dask-0]:tcp://127.0.0.1:37271 got new rank 0</span>
<span class=" -Color -Color-Magenta">[18:40:35] task [xgboost.dask-1]:tcp://127.0.0.1:46615 got new rank 1</span>
<span class=" -Color -Color-Magenta">[18:40:35] task [xgboost.dask-2]:tcp://127.0.0.1:35569 got new rank 2</span>
<span class=" -Color -Color-Magenta">[18:40:35] task [xgboost.dask-3]:tcp://127.0.0.1:42903 got new rank 3</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:36,484     INFO hpo_log  --- fit completed in 3.32772 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:36,484     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:37,244     INFO hpo_log  --- fit completed in 3.30818 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:37,244     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:37,562     INFO hpo_log  --- predict completed in 1.07803 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:37,562     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:38,334     INFO hpo_log  --- predict completed in 1.08976 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:38,334     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:37,989     INFO hpo_log #011 score = 0.9204908609390259</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:37,989     INFO hpo_log  --- score completed in 0.42674 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:37,989     INFO hpo_log &gt; saving high-scoring model</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:37,990     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:37,990     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:37,997     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:38,765     INFO hpo_log #011 score = 0.9204908609390259</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:38,766     INFO hpo_log  --- score completed in 0.43147 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:38,766     INFO hpo_log &gt; saving high-scoring model</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:38,766     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:38,766     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:38,773     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:41,207     INFO hpo_log  --- split_dataset completed in 3.20958 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:41,251     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:41,981     INFO hpo_log  --- split_dataset completed in 3.20839 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:42,016     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Blue">[18:40:42] task [xgboost.dask-0]:tcp://127.0.0.1:45687 got new rank 0</span>
<span class=" -Color -Color-Blue">[18:40:42] task [xgboost.dask-1]:tcp://127.0.0.1:34471 got new rank 1</span>
<span class=" -Color -Color-Blue">[18:40:42] task [xgboost.dask-2]:tcp://127.0.0.1:33085 got new rank 2</span>
<span class=" -Color -Color-Blue">[18:40:42] task [xgboost.dask-3]:tcp://127.0.0.1:43469 got new rank 3</span>
<span class=" -Color -Color-Magenta">[18:40:42] task [xgboost.dask-0]:tcp://127.0.0.1:37271 got new rank 0</span>
<span class=" -Color -Color-Magenta">[18:40:42] task [xgboost.dask-1]:tcp://127.0.0.1:46615 got new rank 1</span>
<span class=" -Color -Color-Magenta">[18:40:42] task [xgboost.dask-2]:tcp://127.0.0.1:35569 got new rank 2</span>
<span class=" -Color -Color-Magenta">[18:40:43] task [xgboost.dask-3]:tcp://127.0.0.1:42903 got new rank 3</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:43,508     INFO hpo_log  --- fit completed in 2.25698 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:43,508     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:44,258     INFO hpo_log  --- fit completed in 2.24222 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:44,259     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:44,789     INFO hpo_log  --- predict completed in 1.28069 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:44,789     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:45,453     INFO hpo_log  --- predict completed in 1.19442 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:45,454     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:45,393     INFO hpo_log #011 score = 0.919971764087677</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:45,394     INFO hpo_log  --- score completed in 0.60415 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:45,394     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:45,394     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:45,400     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:46,064     INFO hpo_log #011 score = 0.919971764087677</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:46,064     INFO hpo_log  --- score completed in 0.61057 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:46,064     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:46,064     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:46,071     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:48,400     INFO hpo_log  --- split_dataset completed in 2.99933 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:48,446     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:49,216     INFO hpo_log  --- split_dataset completed in 3.14545 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:49,269     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Blue">[18:40:49] task [xgboost.dask-0]:tcp://127.0.0.1:45687 got new rank 0</span>
<span class=" -Color -Color-Blue">[18:40:49] task [xgboost.dask-1]:tcp://127.0.0.1:34471 got new rank 1</span>
<span class=" -Color -Color-Blue">[18:40:49] task [xgboost.dask-2]:tcp://127.0.0.1:33085 got new rank 2</span>
<span class=" -Color -Color-Blue">[18:40:49] task [xgboost.dask-3]:tcp://127.0.0.1:43469 got new rank 3</span>
<span class=" -Color -Color-Magenta">[18:40:50] task [xgboost.dask-0]:tcp://127.0.0.1:37271 got new rank 0</span>
<span class=" -Color -Color-Magenta">[18:40:50] task [xgboost.dask-1]:tcp://127.0.0.1:46615 got new rank 1</span>
<span class=" -Color -Color-Magenta">[18:40:50] task [xgboost.dask-2]:tcp://127.0.0.1:35569 got new rank 2</span>
<span class=" -Color -Color-Magenta">[18:40:50] task [xgboost.dask-3]:tcp://127.0.0.1:42903 got new rank 3</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:50,681     INFO hpo_log  --- fit completed in 2.23430 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:50,681     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:51,517     INFO hpo_log  --- fit completed in 2.24880 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:51,518     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:51,776     INFO hpo_log  --- predict completed in 1.09539 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:51,777     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:52,575     INFO hpo_log  --- predict completed in 1.05687 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:52,575     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:52,180     INFO hpo_log #011 score = 0.9202624559402466</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:52,181     INFO hpo_log  --- score completed in 0.40424 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:52,181     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:52,181     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:52,188     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:52,981     INFO hpo_log #011 score = 0.9202624559402466</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:52,981     INFO hpo_log  --- score completed in 0.40601 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:52,981     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:52,981     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:52,988     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:55,538     INFO hpo_log  --- split_dataset completed in 3.35015 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:55,589     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:56,388     INFO hpo_log  --- split_dataset completed in 3.39989 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:56,437     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Blue">[18:40:56] task [xgboost.dask-0]:tcp://127.0.0.1:45687 got new rank 0</span>
<span class=" -Color -Color-Blue">[18:40:56] task [xgboost.dask-1]:tcp://127.0.0.1:34471 got new rank 1</span>
<span class=" -Color -Color-Blue">[18:40:56] task [xgboost.dask-2]:tcp://127.0.0.1:33085 got new rank 2</span>
<span class=" -Color -Color-Blue">[18:40:56] task [xgboost.dask-3]:tcp://127.0.0.1:43469 got new rank 3</span>
<span class=" -Color -Color-Magenta">[18:40:57] task [xgboost.dask-0]:tcp://127.0.0.1:37271 got new rank 0</span>
<span class=" -Color -Color-Magenta">[18:40:57] task [xgboost.dask-1]:tcp://127.0.0.1:46615 got new rank 1</span>
<span class=" -Color -Color-Magenta">[18:40:57] task [xgboost.dask-2]:tcp://127.0.0.1:35569 got new rank 2</span>
<span class=" -Color -Color-Magenta">[18:40:57] task [xgboost.dask-3]:tcp://127.0.0.1:42903 got new rank 3</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:57,559     INFO hpo_log  --- fit completed in 1.97020 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:57,559     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:58,604     INFO hpo_log  --- predict completed in 1.04410 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:58,604     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:58,721     INFO hpo_log  --- fit completed in 2.28395 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:58,722     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:59,014     INFO hpo_log #011 score = 0.920303463935852</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:59,014     INFO hpo_log  --- score completed in 0.41051 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:59,014     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:59,014     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Blue">2023-01-23 18:40:59,021     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:59,789     INFO hpo_log  --- predict completed in 1.06737 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:40:59,790     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:00,199     INFO hpo_log #011 score = 0.920303463935852</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:00,199     INFO hpo_log  --- score completed in 0.40916 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:00,199     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:00,199     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:00,206     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:02,481     INFO hpo_log  --- split_dataset completed in 3.46011 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:02,532     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Blue">[18:41:03] task [xgboost.dask-0]:tcp://127.0.0.1:45687 got new rank 0</span>
<span class=" -Color -Color-Blue">[18:41:03] task [xgboost.dask-1]:tcp://127.0.0.1:34471 got new rank 1</span>
<span class=" -Color -Color-Blue">[18:41:03] task [xgboost.dask-2]:tcp://127.0.0.1:33085 got new rank 2</span>
<span class=" -Color -Color-Blue">[18:41:03] task [xgboost.dask-3]:tcp://127.0.0.1:43469 got new rank 3</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:03,729     INFO hpo_log  --- split_dataset completed in 3.52238 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:03,786     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Magenta">[18:41:04] task [xgboost.dask-0]:tcp://127.0.0.1:37271 got new rank 0</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:04,817     INFO hpo_log  --- fit completed in 2.28582 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:04,818     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Magenta">[18:41:04] task [xgboost.dask-1]:tcp://127.0.0.1:46615 got new rank 1</span>
<span class=" -Color -Color-Magenta">[18:41:04] task [xgboost.dask-2]:tcp://127.0.0.1:35569 got new rank 2</span>
<span class=" -Color -Color-Magenta">[18:41:04] task [xgboost.dask-3]:tcp://127.0.0.1:42903 got new rank 3</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:06,031     INFO hpo_log  --- fit completed in 2.24465 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:06,031     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:05,908     INFO hpo_log  --- predict completed in 1.08988 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:05,908     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:06,313     INFO hpo_log #011 score = 0.9203875064849854</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:06,314     INFO hpo_log  --- score completed in 0.40549 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:06,314     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:06,314     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:06,321     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:07,149     INFO hpo_log  --- predict completed in 1.11832 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:07,150     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:07,579     INFO hpo_log #011 score = 0.9203870296478271</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:07,579     INFO hpo_log  --- score completed in 0.42956 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:07,579     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:07,579     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:07,586     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:09,514     INFO hpo_log  --- split_dataset completed in 3.19311 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:09,564     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Blue">[18:41:10] task [xgboost.dask-0]:tcp://127.0.0.1:45687 got new rank 0</span>
<span class=" -Color -Color-Blue">[18:41:10] task [xgboost.dask-1]:tcp://127.0.0.1:34471 got new rank 1</span>
<span class=" -Color -Color-Blue">[18:41:10] task [xgboost.dask-2]:tcp://127.0.0.1:33085 got new rank 2</span>
<span class=" -Color -Color-Blue">[18:41:10] task [xgboost.dask-3]:tcp://127.0.0.1:43469 got new rank 3</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:10,942     INFO hpo_log  --- split_dataset completed in 3.35631 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:10,984     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:11,462     INFO hpo_log  --- fit completed in 1.89739 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:11,462     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Magenta">[18:41:11] task [xgboost.dask-0]:tcp://127.0.0.1:37271 got new rank 0</span>
<span class=" -Color -Color-Magenta">[18:41:11] task [xgboost.dask-1]:tcp://127.0.0.1:46615 got new rank 1</span>
<span class=" -Color -Color-Magenta">[18:41:11] task [xgboost.dask-2]:tcp://127.0.0.1:35569 got new rank 2</span>
<span class=" -Color -Color-Magenta">[18:41:12] task [xgboost.dask-3]:tcp://127.0.0.1:42903 got new rank 3</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:12,511     INFO hpo_log  --- predict completed in 1.04895 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:12,511     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:13,189     INFO hpo_log  --- fit completed in 2.20526 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:13,189     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:12,918     INFO hpo_log #011 score = 0.9205151200294495</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:12,918     INFO hpo_log  --- score completed in 0.40648 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:12,918     INFO hpo_log &gt; saving high-scoring model</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:12,918     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:12,918     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:12,926     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:14,264     INFO hpo_log  --- predict completed in 1.07464 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:14,264     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:14,681     INFO hpo_log #011 score = 0.9205151200294495</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:14,681     INFO hpo_log  --- score completed in 0.41679 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:14,681     INFO hpo_log &gt; saving high-scoring model</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:14,682     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:14,682     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:14,688     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:16,754     INFO hpo_log  --- split_dataset completed in 3.82814 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:16,781     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:18,182     INFO hpo_log  --- split_dataset completed in 3.49332 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:18,224     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Blue">[18:41:17] task [xgboost.dask-0]:tcp://127.0.0.1:45687 got new rank 0</span>
<span class=" -Color -Color-Blue">[18:41:18] task [xgboost.dask-1]:tcp://127.0.0.1:34471 got new rank 1</span>
<span class=" -Color -Color-Blue">[18:41:18] task [xgboost.dask-2]:tcp://127.0.0.1:33085 got new rank 2</span>
<span class=" -Color -Color-Blue">[18:41:18] task [xgboost.dask-3]:tcp://127.0.0.1:43469 got new rank 3</span>
<span class=" -Color -Color-Magenta">[18:41:19] task [xgboost.dask-0]:tcp://127.0.0.1:37271 got new rank 0</span>
<span class=" -Color -Color-Magenta">[18:41:19] task [xgboost.dask-1]:tcp://127.0.0.1:46615 got new rank 1</span>
<span class=" -Color -Color-Magenta">[18:41:19] task [xgboost.dask-2]:tcp://127.0.0.1:35569 got new rank 2</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:19,408     INFO hpo_log  --- fit completed in 2.62662 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:19,408     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Magenta">[18:41:19] task [xgboost.dask-3]:tcp://127.0.0.1:42903 got new rank 3</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:20,504     INFO hpo_log  --- predict completed in 1.09576 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:20,504     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:20,813     INFO hpo_log  --- fit completed in 2.58889 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:20,814     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:20,917     INFO hpo_log #011 score = 0.9204996228218079</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:20,917     INFO hpo_log  --- score completed in 0.41257 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:20,917     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:20,917     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:20,924     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:21,901     INFO hpo_log  --- predict completed in 1.08747 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:21,901     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:22,308     INFO hpo_log #011 score = 0.9204998016357422</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:22,308     INFO hpo_log  --- score completed in 0.40620 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:22,308     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:22,308     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:22,314     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:24,066     INFO hpo_log  --- split_dataset completed in 3.14142 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:24,117     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:25,349     INFO hpo_log  --- split_dataset completed in 3.03426 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:25,389     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Blue">[18:41:24] task [xgboost.dask-0]:tcp://127.0.0.1:45687 got new rank 0</span>
<span class=" -Color -Color-Blue">[18:41:25] task [xgboost.dask-1]:tcp://127.0.0.1:34471 got new rank 1</span>
<span class=" -Color -Color-Blue">[18:41:25] task [xgboost.dask-2]:tcp://127.0.0.1:33085 got new rank 2</span>
<span class=" -Color -Color-Blue">[18:41:25] task [xgboost.dask-3]:tcp://127.0.0.1:43469 got new rank 3</span>
<span class=" -Color -Color-Magenta">[18:41:25] task [xgboost.dask-0]:tcp://127.0.0.1:37271 got new rank 0</span>
<span class=" -Color -Color-Magenta">[18:41:25] task [xgboost.dask-1]:tcp://127.0.0.1:46615 got new rank 1</span>
<span class=" -Color -Color-Magenta">[18:41:25] task [xgboost.dask-2]:tcp://127.0.0.1:35569 got new rank 2</span>
<span class=" -Color -Color-Magenta">[18:41:26] task [xgboost.dask-3]:tcp://127.0.0.1:42903 got new rank 3</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:27,246     INFO hpo_log  --- fit completed in 1.85756 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:27,247     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:28,755     INFO hpo_log  --- predict completed in 1.50824 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:28,755     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:29,157     INFO hpo_log #011 score = 0.9205771088600159</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:29,157     INFO hpo_log  --- score completed in 0.40233 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:29,158     INFO hpo_log &gt; saving high-scoring model</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:29,158     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:29,158     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:29,165     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:26,389     INFO hpo_log  --- fit completed in 2.27204 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:26,389     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:27,531     INFO hpo_log  --- predict completed in 1.14184 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:27,531     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:27,943     INFO hpo_log #011 score = 0.9205771088600159</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:27,944     INFO hpo_log  --- score completed in 0.41231 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:27,944     INFO hpo_log &gt; saving high-scoring model</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:27,944     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:27,944     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:27,951     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:31,246     INFO hpo_log  --- split_dataset completed in 3.29588 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:31,279     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:32,337     INFO hpo_log  --- split_dataset completed in 3.17197 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:32,381     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Blue">[18:41:32] task [xgboost.dask-0]:tcp://127.0.0.1:45687 got new rank 0</span>
<span class=" -Color -Color-Blue">[18:41:32] task [xgboost.dask-1]:tcp://127.0.0.1:34471 got new rank 1</span>
<span class=" -Color -Color-Blue">[18:41:32] task [xgboost.dask-2]:tcp://127.0.0.1:33085 got new rank 2</span>
<span class=" -Color -Color-Blue">[18:41:32] task [xgboost.dask-3]:tcp://127.0.0.1:43469 got new rank 3</span>
<span class=" -Color -Color-Magenta">[18:41:32] task [xgboost.dask-0]:tcp://127.0.0.1:37271 got new rank 0</span>
<span class=" -Color -Color-Magenta">[18:41:32] task [xgboost.dask-1]:tcp://127.0.0.1:46615 got new rank 1</span>
<span class=" -Color -Color-Magenta">[18:41:32] task [xgboost.dask-2]:tcp://127.0.0.1:35569 got new rank 2</span>
<span class=" -Color -Color-Magenta">[18:41:33] task [xgboost.dask-3]:tcp://127.0.0.1:42903 got new rank 3</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:33,563     INFO hpo_log  --- fit completed in 2.28411 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:33,564     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:34,268     INFO hpo_log  --- fit completed in 1.88717 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:34,268     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:34,660     INFO hpo_log  --- predict completed in 1.09677 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:34,661     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:35,604     INFO hpo_log  --- predict completed in 1.33573 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:35,604     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:35,079     INFO hpo_log #011 score = 0.9202908873558044</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:35,079     INFO hpo_log  --- score completed in 0.41860 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:35,080     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:35,080     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:35,087     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:36,014     INFO hpo_log #011 score = 0.9202908873558044</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:36,014     INFO hpo_log  --- score completed in 0.40990 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:36,014     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:36,014     INFO hpo_log &gt; skipping ingestion, using cache</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:36,022     INFO hpo_log &gt; train-test split</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:38,950     INFO hpo_log  --- split_dataset completed in 3.86303 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:39,003     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Blue">[18:41:39] task [xgboost.dask-0]:tcp://127.0.0.1:45687 got new rank 0</span>
<span class=" -Color -Color-Blue">[18:41:39] task [xgboost.dask-1]:tcp://127.0.0.1:34471 got new rank 1</span>
<span class=" -Color -Color-Blue">[18:41:39] task [xgboost.dask-2]:tcp://127.0.0.1:33085 got new rank 2</span>
<span class=" -Color -Color-Blue">[18:41:39] task [xgboost.dask-3]:tcp://127.0.0.1:43469 got new rank 3</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:39,638     INFO hpo_log  --- split_dataset completed in 3.61579 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:39,691     INFO hpo_log &gt; fit xgboost model</span>
<span class=" -Color -Color-Magenta">[18:41:40] task [xgboost.dask-0]:tcp://127.0.0.1:37271 got new rank 0</span>
<span class=" -Color -Color-Magenta">[18:41:40] task [xgboost.dask-1]:tcp://127.0.0.1:46615 got new rank 1</span>
<span class=" -Color -Color-Magenta">[18:41:40] task [xgboost.dask-2]:tcp://127.0.0.1:35569 got new rank 2</span>
<span class=" -Color -Color-Magenta">[18:41:40] task [xgboost.dask-3]:tcp://127.0.0.1:42903 got new rank 3</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:40,845     INFO hpo_log  --- fit completed in 1.84259 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:40,846     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:41,516     INFO hpo_log  --- fit completed in 1.82582 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:41,517     INFO hpo_log &gt; predict with trained model </span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:42,574     INFO hpo_log  --- predict completed in 1.05731 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:42,574     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:42,470     INFO hpo_log  --- predict completed in 1.62403 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:42,471     INFO hpo_log &gt; score predictions</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:42,873     INFO hpo_log #011 score = 0.9202508926391602</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:42,873     INFO hpo_log  --- score completed in 0.40286 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:42,874     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:42,874     INFO hpo_log total_time = 84.89323 s </span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:42,874     INFO hpo_log fold scores : [0.9204908609390259, 0.919971764087677, 0.9202624559402466, 0.920303463935852, 0.9203875064849854, 0.9205151200294495, 0.9204996228218079, 0.9205771088600159, 0.9202908873558044, 0.9202508926391602]</span>
<span class=" -Color -Color-Blue">2023-01-23 18:41:42,874     INFO hpo_log final-score: 0.9203549683094024;</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:42,976     INFO hpo_log #011 score = 0.9202508926391602</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:42,976     INFO hpo_log  --- score completed in 0.40173 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:42,976     INFO hpo_log  --- cleanup completed in 0.00000 s</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:42,976     INFO hpo_log total_time = 83.98951 s </span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:42,976     INFO hpo_log fold scores : [0.9204908609390259, 0.919971764087677, 0.9202624559402466, 0.920303463935852, 0.9203870296478271, 0.9205151200294495, 0.9204998016357422, 0.9205771088600159, 0.9202908873558044, 0.9202508926391602]</span>
<span class=" -Color -Color-Magenta">2023-01-23 18:41:42,976     INFO hpo_log final-score: 0.9203549385070801;</span>

2023-01-23 18:41:59 Uploading - Uploading generated training model
2023-01-23 18:41:59 Completed - Training job completed
Training seconds: 718
Billable seconds: 216
Managed Spot Training savings: 69.9%
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="run-hpo">
<h2>Run HPO<a class="headerlink" href="#run-hpo" title="Permalink to this heading">#</a></h2>
<p>With a working SageMaker Estimator in hand, the hardest part is behind us. In the key choices section we <a href='#strategy-and-param-ranges'>already defined our search strategy and hyperparameter ranges</a>, so all that remains is to choose a metric to evaluate performance on. For more documentation check out the AWS SageMaker <a class="reference external" href="https://sagemaker.readthedocs.io/en/stable/tuner.html">Hyperparameter Tuner documentation</a>.</p>
<img src='../../_static/images/examples/rapids-sagemaker-hpo/run_hpo.png'><section id="define-metric">
<h3>Define Metric<a class="headerlink" href="#define-metric" title="Permalink to this heading">#</a></h3>
<p>We only focus on a single metric, which we call ‘final-score’, that captures the accuracy of our model on the test data unseen during training. You are of course welcome to add aditional metrics, see <a class="reference external" href="https://docs.aws.amazon.com/sagemaker/latest/dg/automatic-model-tuning-define-metrics.html">AWS SageMaker documentation on Metrics</a>. When defining a metric we provide a regular expression (i.e., string parsing rule) to extract the key metric from the output of each Estimator/worker.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metric_definitions</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;final-score&quot;</span><span class="p">,</span> <span class="s2">&quot;Regex&quot;</span><span class="p">:</span> <span class="s2">&quot;final-score: (.*);&quot;</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">objective_metric_name</span> <span class="o">=</span> <span class="s2">&quot;final-score&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-tuner">
<h3>Define Tuner<a class="headerlink" href="#define-tuner" title="Permalink to this heading">#</a></h3>
<p>Finally we put all of the elements we’ve been building up together into a HyperparameterTuner declaration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hpo</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">tuner</span><span class="o">.</span><span class="n">HyperparameterTuner</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span>
    <span class="n">metric_definitions</span><span class="o">=</span><span class="n">metric_definitions</span><span class="p">,</span>
    <span class="n">objective_metric_name</span><span class="o">=</span><span class="n">objective_metric_name</span><span class="p">,</span>
    <span class="n">objective_type</span><span class="o">=</span><span class="s2">&quot;Maximize&quot;</span><span class="p">,</span>
    <span class="n">hyperparameter_ranges</span><span class="o">=</span><span class="n">hyperparameter_ranges</span><span class="p">,</span>
    <span class="n">strategy</span><span class="o">=</span><span class="n">search_strategy</span><span class="p">,</span>
    <span class="n">max_jobs</span><span class="o">=</span><span class="n">max_jobs</span><span class="p">,</span>
    <span class="n">max_parallel_jobs</span><span class="o">=</span><span class="n">max_parallel_jobs</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3>Run HPO<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summarize_choices</span><span class="p">(</span>
    <span class="n">s3_data_input</span><span class="p">,</span>
    <span class="n">s3_model_output</span><span class="p">,</span>
    <span class="n">ml_workflow_choice</span><span class="p">,</span>
    <span class="n">algorithm_choice</span><span class="p">,</span>
    <span class="n">cv_folds</span><span class="p">,</span>
    <span class="n">instance_type</span><span class="p">,</span>
    <span class="n">use_spot_instances_flag</span><span class="p">,</span>
    <span class="n">search_strategy</span><span class="p">,</span>
    <span class="n">max_jobs</span><span class="p">,</span>
    <span class="n">max_parallel_jobs</span><span class="p">,</span>
    <span class="n">max_duration_of_experiment_seconds</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>s3 data input    =	s3://sagemaker-rapids-hpo-us-west-2/10_year
s3 model output  =	s3://sagemaker-us-west-2-561241433344/trained-models
compute          =	multiGPU
algorithm        =	XGBoost, 10 cv-fold
instance         =	ml.p3.8xlarge
spot instances   =	True
hpo strategy     =	Random
max_experiments  =	100
max_parallel     =	10
max runtime      =	86400 sec
</pre></div>
</div>
</div>
</div>
<p>Let’s be sure we take a moment to confirm before launching all of our HPO experiments. Depending on your configuration options running this cell can kick off a massive amount of computation!</p>
<blockquote>
<div><p>Once this process begins, we recommend that you use the SageMaker UI to keep track of the <a href='../../_static/images/examples/rapids-sagemaker-hpo/gpu_hpo_100x10.png'>health of the HPO process and the individual workers</a>.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># tuning_job_name = new_job_name_from_config(dataset_directory, region, ml_workflow_choice,</span>
<span class="c1">#                                            algorithm_choice, cv_folds,</span>
<span class="c1"># #                                            instance_type)</span>
<span class="c1"># hpo.fit( inputs=s3_data_input,</span>
<span class="c1">#          job_name=tuning_job_name,</span>
<span class="c1">#          wait=True,</span>
<span class="c1">#          logs=&#39;All&#39;)</span>

<span class="c1"># hpo.wait()  # block until the .fit call above is completed</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="results-and-summary">
<h3>Results and Summary<a class="headerlink" href="#results-and-summary" title="Permalink to this heading">#</a></h3>
<p>Once your job is complete there are multiple ways to analyze the results.
Below we display the performance of the best job, as well printing each HPO trial/job as a row of a dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tuning_job_name</span> <span class="o">=</span> <span class="s2">&quot;air-mGPU-XGB-10cv-527fd372fa4d8d&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hpo_results</span> <span class="o">=</span> <span class="n">summarize_hpo_results</span><span class="p">(</span><span class="n">tuning_job_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:botocore.credentials:Found credentials from IAM Role: BaseNotebookInstanceEc2InstanceRole
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>best score: 0.9203665256500244
best params: {&#39;max_depth&#39;: &#39;7&#39;, &#39;max_features&#39;: &#39;0.29751893065195945&#39;, &#39;num_boost_round&#39;: &#39;346&#39;}
best job-name: air-mGPU-XGB-10cv-527fd372fa4d8d-042-ed1ff13b
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sagemaker</span><span class="o">.</span><span class="n">HyperparameterTuningJobAnalytics</span><span class="p">(</span><span class="n">tuning_job_name</span><span class="p">)</span><span class="o">.</span><span class="n">dataframe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:botocore.credentials:Found credentials from IAM Role: BaseNotebookInstanceEc2InstanceRole
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>max_depth</th>
      <th>max_features</th>
      <th>num_boost_round</th>
      <th>TrainingJobName</th>
      <th>TrainingJobStatus</th>
      <th>FinalObjectiveValue</th>
      <th>TrainingStartTime</th>
      <th>TrainingEndTime</th>
      <th>TrainingElapsedTimeSeconds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.0</td>
      <td>0.715196</td>
      <td>116.0</td>
      <td>air-mGPU-XGB-10cv-527fd372fa4d8d-100-c04c691b</td>
      <td>Completed</td>
      <td>0.920362</td>
      <td>2023-01-23 21:01:38+00:00</td>
      <td>2023-01-23 21:06:21+00:00</td>
      <td>283.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12.0</td>
      <td>0.855974</td>
      <td>243.0</td>
      <td>air-mGPU-XGB-10cv-527fd372fa4d8d-099-97d44628</td>
      <td>Completed</td>
      <td>0.920355</td>
      <td>2023-01-23 21:17:56+00:00</td>
      <td>2023-01-23 21:22:34+00:00</td>
      <td>278.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11.0</td>
      <td>0.549247</td>
      <td>395.0</td>
      <td>air-mGPU-XGB-10cv-527fd372fa4d8d-098-e74f483f</td>
      <td>Completed</td>
      <td>0.920356</td>
      <td>2023-01-23 20:56:06+00:00</td>
      <td>2023-01-23 21:00:44+00:00</td>
      <td>278.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.0</td>
      <td>0.882803</td>
      <td>179.0</td>
      <td>air-mGPU-XGB-10cv-527fd372fa4d8d-097-50755cd6</td>
      <td>Completed</td>
      <td>0.920356</td>
      <td>2023-01-23 20:54:35+00:00</td>
      <td>2023-01-23 20:59:13+00:00</td>
      <td>278.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.0</td>
      <td>0.416939</td>
      <td>267.0</td>
      <td>air-mGPU-XGB-10cv-527fd372fa4d8d-096-5c95eb2f</td>
      <td>Completed</td>
      <td>0.920355</td>
      <td>2023-01-23 20:51:24+00:00</td>
      <td>2023-01-23 20:56:02+00:00</td>
      <td>278.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>5.0</td>
      <td>0.426204</td>
      <td>330.0</td>
      <td>air-mGPU-XGB-10cv-527fd372fa4d8d-005-7b755a81</td>
      <td>Completed</td>
      <td>0.920355</td>
      <td>2023-01-23 18:48:35+00:00</td>
      <td>2023-01-23 18:53:48+00:00</td>
      <td>313.0</td>
    </tr>
    <tr>
      <th>96</th>
      <td>5.0</td>
      <td>0.283752</td>
      <td>256.0</td>
      <td>air-mGPU-XGB-10cv-527fd372fa4d8d-004-e4d086fb</td>
      <td>Completed</td>
      <td>0.920356</td>
      <td>2023-01-23 18:48:34+00:00</td>
      <td>2023-01-23 18:53:47+00:00</td>
      <td>313.0</td>
    </tr>
    <tr>
      <th>97</th>
      <td>5.0</td>
      <td>0.137874</td>
      <td>377.0</td>
      <td>air-mGPU-XGB-10cv-527fd372fa4d8d-003-89cd8506</td>
      <td>Completed</td>
      <td>0.920355</td>
      <td>2023-01-23 18:48:31+00:00</td>
      <td>2023-01-23 18:53:44+00:00</td>
      <td>313.0</td>
    </tr>
    <tr>
      <th>98</th>
      <td>15.0</td>
      <td>0.934718</td>
      <td>365.0</td>
      <td>air-mGPU-XGB-10cv-527fd372fa4d8d-002-caf8f6c3</td>
      <td>Completed</td>
      <td>0.920360</td>
      <td>2023-01-23 18:48:25+00:00</td>
      <td>2023-01-23 18:53:48+00:00</td>
      <td>323.0</td>
    </tr>
    <tr>
      <th>99</th>
      <td>15.0</td>
      <td>0.356588</td>
      <td>460.0</td>
      <td>air-mGPU-XGB-10cv-527fd372fa4d8d-001-e8a6d247</td>
      <td>Completed</td>
      <td>0.920356</td>
      <td>2023-01-23 18:48:29+00:00</td>
      <td>2023-01-23 18:53:47+00:00</td>
      <td>318.0</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 9 columns</p>
</div></div></div>
</div>
<p>For a more in depth look at the HPO process we invite you to check out the <a href='https://github.com/awslabs/amazon-sagemaker-examples/tree/master/hyperparameter_tuning/analyze_results'>HPO_Analyze_TuningJob_Results.ipynb</a> notebook which shows how we can explore interesting things like the <a href='../../_static/images/examples/rapids-sagemaker-hpo/results_analysis.png'>impact of each individual hyperparameter on the performance metric</a>.</p>
</section>
<section id="getting-the-best-model">
<h3>Getting the best Model<a class="headerlink" href="#getting-the-best-model" title="Permalink to this heading">#</a></h3>
<p>Next let’s download the best trained model from our HPO runs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">local_filename</span><span class="p">,</span> <span class="n">s3_path_to_best_model</span> <span class="o">=</span> <span class="n">download_best_model</span><span class="p">(</span>
    <span class="n">model_output_bucket</span><span class="p">,</span>
    <span class="n">s3_model_output</span><span class="p">,</span>
    <span class="n">hpo_results</span><span class="p">,</span>
    <span class="n">best_hpo_model_local_save_directory</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:botocore.credentials:Found credentials from IAM Role: BaseNotebookInstanceEc2InstanceRole
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Successfully downloaded best model
&gt; filename: /home/ec2-user/SageMaker/cloud-ml-examples/aws/best_model.tar.gz
&gt; local directory : /home/ec2-user/SageMaker/cloud-ml-examples/aws

full S3 path : s3://sagemaker-us-west-2-561241433344/trained-models/air-mGPU-XGB-10cv-527fd372fa4d8d-042-ed1ff13b/output/model.tar.gz
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-serving">
<h3>Model Serving<a class="headerlink" href="#model-serving" title="Permalink to this heading">#</a></h3>
<p>With your best model in hand, you can now move on to <a class="reference external" href="https://docs.aws.amazon.com/sagemaker/latest/dg/how-it-works-deployment.html">serving this model on SageMaker</a>.</p>
<p>In the example below we show you how to build a <a class="reference external" href="https://sagemaker.readthedocs.io/en/stable/api/inference/predictors.html">RealTimePredictor</a> using the best model found during the HPO search. We will add a lightweight Flask server to our RAPIDS Estimator (a.k.a., container) which will handle the incoming requests and pass them along to the trained model for inference. If you are curious about how this works under the hood check out the <a class="reference external" href="https://docs.aws.amazon.com/sagemaker/latest/dg/your-algorithms-inference-code.html">Use Your Own Inference Server</a> documentation and reference the code in <code class="docutils literal notranslate"><span class="pre">serve.py</span></code>.</p>
<p>If you are interested in additional serving options (e.g., large batch with batch-transform), we plan to add a companion notebook that will provide additional details.</p>
<section id="gpu-serving">
<h4>GPU serving<a class="headerlink" href="#gpu-serving" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">endpoint_model</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span>
    <span class="n">image_uri</span><span class="o">=</span><span class="n">ecr_fullname</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">execution_role</span><span class="p">,</span> <span class="n">model_data</span><span class="o">=</span><span class="n">s3_path_to_best_model</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ecr_fullname</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;561241433344.dkr.ecr.us-west-2.amazonaws.com/rapids-sagemaker-mnmg-100:22.12-cuda11.5-runtime-ubuntu18.04-py3.9&#39;
</pre></div>
</div>
</div>
</div>
<p>Kick off an instance for prediction [ recommend ‘ml.g4dn.2xlarge’ ]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DEMO_SERVING_FLAG</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">if</span> <span class="n">DEMO_SERVING_FLAG</span><span class="p">:</span>
    <span class="n">endpoint_model</span><span class="o">.</span><span class="n">deploy</span><span class="p">(</span>
        <span class="n">initial_instance_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">instance_type</span><span class="o">=</span><span class="s2">&quot;ml.g4dn.2xlarge&quot;</span>
    <span class="p">)</span>  <span class="c1">#&#39;ml.p3.2xlarge&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:sagemaker:Creating model with name: rapids-sagemaker-mnmg-100-2023-01-23-22-24-22-008
INFO:sagemaker:Creating endpoint-config with name rapids-sagemaker-mnmg-100-2023-01-23-22-24-22-498
INFO:sagemaker:Creating endpoint with name rapids-sagemaker-mnmg-100-2023-01-23-22-24-22-498
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---------!
</pre></div>
</div>
</div>
</div>
<p>Perform the prediction and return the result(s).</p>
<p>Below we’ve compiled examples to sanity test the trained model performance on the Airline dataset.</p>
<blockquote>
<div><p>The first example is from a 2019 flight that departed nine minutes early,</p>
</div></blockquote>
<blockquote>
<div><p>The second example is from a 2018 flight that was more than two hours late to depart.</p>
</div></blockquote>
<p>When we run these samples we expect to see <strong>b’[0.0, 1.0]</strong> as the printed result.</p>
<p>We encourage you to modify the queries below especially if you plug in your own dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">DEMO_SERVING_FLAG</span><span class="p">:</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">Predictor</span><span class="p">(</span>
        <span class="n">endpoint_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">endpoint_model</span><span class="o">.</span><span class="n">endpoint_name</span><span class="p">),</span> <span class="n">sagemaker_session</span><span class="o">=</span><span class="n">session</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">dataset_directory</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1_year&quot;</span><span class="p">,</span> <span class="s2">&quot;3_year&quot;</span><span class="p">,</span> <span class="s2">&quot;10_year&quot;</span><span class="p">]:</span>
        <span class="n">on_time_example</span> <span class="o">=</span> <span class="p">[</span>
            <span class="mf">2019.0</span><span class="p">,</span>
            <span class="mf">4.0</span><span class="p">,</span>
            <span class="mf">12.0</span><span class="p">,</span>
            <span class="mf">2.0</span><span class="p">,</span>
            <span class="mf">3647.0</span><span class="p">,</span>
            <span class="mf">20452.0</span><span class="p">,</span>
            <span class="mf">30977.0</span><span class="p">,</span>
            <span class="mf">33244.0</span><span class="p">,</span>
            <span class="mf">1943.0</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">9.0</span><span class="p">,</span>
            <span class="mf">0.0</span><span class="p">,</span>
            <span class="mf">75.0</span><span class="p">,</span>
            <span class="mf">491.0</span><span class="p">,</span>
        <span class="p">]</span>  <span class="c1"># 9 minutes early departure</span>
        <span class="n">late_example</span> <span class="o">=</span> <span class="p">[</span>
            <span class="mf">2018.0</span><span class="p">,</span>
            <span class="mf">3.0</span><span class="p">,</span>
            <span class="mf">9.0</span><span class="p">,</span>
            <span class="mf">5.0</span><span class="p">,</span>
            <span class="mf">2279.0</span><span class="p">,</span>
            <span class="mf">20409.0</span><span class="p">,</span>
            <span class="mf">30721.0</span><span class="p">,</span>
            <span class="mf">31703.0</span><span class="p">,</span>
            <span class="mf">733.0</span><span class="p">,</span>
            <span class="mf">123.0</span><span class="p">,</span>
            <span class="mf">1.0</span><span class="p">,</span>
            <span class="mf">61.0</span><span class="p">,</span>
            <span class="mf">200.0</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">example_payload</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">([</span><span class="n">on_time_example</span><span class="p">,</span> <span class="n">late_example</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">example_payload</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># fill in a sample payload</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">example_payload</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b&#39;[0.0, 1.0]&#39;
</pre></div>
</div>
</div>
</div>
<p>Once we are finished with the serving example, we should be sure to clean up and delete the endpoint.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if DEMO_SERVING_FLAG:</span>

<span class="c1">#     predictor.delete_endpoint()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<p>We’ve now successfully built a RAPIDS ML workflow, containerized it (as a SageMaker Estimator), and launched a set of HPO experiments to find the best hyperparamters for our model.</p>
<p>If you are curious to go further, we invite you to plug in your own dataset and tweak the configuration settings to find your champion model!</p>
<p><strong>HPO Experiment Details</strong>
<a id='experiments'></a></p>
<p>As mentioned in the introduction we find a <span style="color:#8735fb; font-size:14pt"> <strong>12X</strong> </span> speedup in wall clock time and a <span style="color:#8735fb; font-size:14pt"> <strong>4.5x</strong> </span> reduction in cost when comparing between GPU and CPU instances on 100 HPO trials using 10 parallel workers on 10 years of the Airline Dataset (~63M flights). In these experiments we used the XGBoost algorithm with the multi-GPU vs multi-CPU Dask cluster and 10 cross validaiton folds. Below we offer a table with additional details.</p>
<img src='../../_static/images/examples/rapids-sagemaker-hpo/results.png' width='70%'><p>In the case of the CPU runs, 12 jobs were stopped since they exceeded the 24 hour limit we set. <a href='../../_static/images/examples/rapids-sagemaker-hpo/cpu_hpo_100x10.png'>CPU Job Summary Image</a></p>
<p>In the case of the GPU runs, no jobs were stopped. <a href='../../_static/images/examples/rapids-sagemaker-hpo/gpu_hpo_100x10.png'>GPU Job Summary Image</a></p>
<p>Note that in both cases 1 job failed because a spot instance was terminated. But 1 failed job out of 100 is a minimal tradeoff for the significant cost savings.</p>
</section>
<section id="appendix">
<h2>Appendix<a class="headerlink" href="#appendix" title="Permalink to this heading">#</a></h2>
<section id="bring-your-own-dataset-checklist">
<h3>Bring Your Own Dataset Checklist<a class="headerlink" href="#bring-your-own-dataset-checklist" title="Permalink to this heading">#</a></h3>
<p><a id ='byod'></a></p>
<p>If you plan to use your own dataset (BYOD) here is a checklist to help you integrate into the workflow:</p>
<blockquote>
<div><ul class="simple">
<li><p>[ ] Dataset should be in either CSV or Parquet format.</p></li>
<li><p>[ ] Dataset is already pre-processed (and all feature-engineering is done).</p></li>
<li><p>[ ] Dataset is uploaded to S3 and <code class="docutils literal notranslate"><span class="pre">data_bucket</span></code> and <code class="docutils literal notranslate"><span class="pre">dataset_directory</span></code> have been set to the location of your data.</p></li>
<li><p>[ ] Dataset feature and target columns have been enumerated in <code class="docutils literal notranslate"><span class="pre">/HPODataset.py</span></code></p></li>
</ul>
</div></blockquote>
</section>
<section id="rapids-references">
<h3>Rapids References<a class="headerlink" href="#rapids-references" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p><a class="reference external" href="https://docs.rapids.ai/deployment/stable/examples/">More Cloud Deployment Workflow Examples</a></p>
</div></blockquote>
<blockquote>
<div><p><a class="reference external" href="https://rapids.ai/hpo">RAPIDS HPO</a></p>
</div></blockquote>
<blockquote>
<div><p><a class="reference external" href="https://docs.rapids.ai/api/cuml/stable/">cuML Documentation</a></p>
</div></blockquote>
</section>
<section id="sagemaker-references">
<h3>SageMaker References<a class="headerlink" href="#sagemaker-references" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p><a class="reference external" href="https://github.com/aws/sagemaker-training-toolkit">SageMaker Training Toolkit</a></p>
</div></blockquote>
<blockquote>
<div><p><a class="reference external" href="https://sagemaker.readthedocs.io/en/stable/api/training/estimators.html">Estimator Parameters</a></p>
</div></blockquote>
<blockquote>
<div><p>Spot Instances <a class="reference external" href="https://docs.aws.amazon.com/sagemaker/latest/dg/model-managed-spot-training.html">docs</a>, and <span class="xref myst">blog</span></p>
</div></blockquote>
</section>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../rapids-sagemaker-higgs/notebook.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Running RAPIDS hyperparameter experiments at scale on Amazon SageMaker</p>
      </div>
    </a>
    <a class="right-next"
       href="../rapids-ec2-mnmg/notebook.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Multi-node multi-GPU example on AWS using dask-cloudprovider</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preamble">Preamble</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-choices">Key Choices</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset">Dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithm">Algorithm</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ml-workflow-compute-choice">ML Workflow Compute Choice</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#search-ranges-and-strategy">Search Ranges and Strategy</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-scale">Experiment Scale</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-platform">Compute Platform</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validate">Validate</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-ml-workflow">Python ML Workflow</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-estimator">Build Estimator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#containerize-and-push-to-ecr">Containerize and Push to ECR</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#write-dockerfile">Write Dockerfile</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#build-and-tag">Build and Tag</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#publish-to-elastic-cloud-registry-ecr">Publish to Elastic Cloud Registry (ECR)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-estimator">Create Estimator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-estimator">Test Estimator</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-hpo">Run HPO</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-metric">Define Metric</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-tuner">Define Tuner</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Run HPO</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results-and-summary">Results and Summary</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-the-best-model">Getting the best Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-serving">Model Serving</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gpu-serving">GPU serving</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix">Appendix</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bring-your-own-dataset-checklist">Bring Your Own Dataset Checklist</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rapids-references">Rapids References</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sagemaker-references">SageMaker References</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
<div class="tocsection onthispage">
  <i class="fa-regular fa-file"></i> Related files
</div>
<nav id="bd-toc-nav" class="page-toc related-files">
  <ul class="visible nav section-nav flex-column">
    
    <li class="toc-h2 nav-item toc-entry">
      <a class="reference external nav-link" href="https://github.com/rapidsai/deployment/blob/main/source/examples/rapids-sagemaker-hpo/workflows"> workflows/ </a>
    </li>
    
    <li class="toc-h2 nav-item toc-entry">
      <a class="reference external nav-link" href="https://github.com/rapidsai/deployment/blob/main/source/examples/rapids-sagemaker-hpo/HPODatasets.py"> HPODatasets.py </a>
    </li>
    
    <li class="toc-h2 nav-item toc-entry">
      <a class="reference external nav-link" href="https://github.com/rapidsai/deployment/blob/main/source/examples/rapids-sagemaker-hpo/helper_functions.py"> helper_functions.py </a>
    </li>
    
    <li class="toc-h2 nav-item toc-entry">
      <a class="reference external nav-link" href="https://github.com/rapidsai/deployment/blob/main/source/examples/rapids-sagemaker-hpo/Dockerfile"> Dockerfile </a>
    </li>
    
    <li class="toc-h2 nav-item toc-entry">
      <a class="reference external nav-link" href="https://github.com/rapidsai/deployment/blob/main/source/examples/rapids-sagemaker-hpo/train.py"> train.py </a>
    </li>
    
    <li class="toc-h2 nav-item toc-entry">
      <a class="reference external nav-link" href="https://github.com/rapidsai/deployment/blob/main/source/examples/rapids-sagemaker-hpo/serve.py"> serve.py </a>
    </li>
    
    <li class="toc-h2 nav-item toc-entry">
      <a class="reference external nav-link" href="https://github.com/rapidsai/deployment/blob/main/source/examples/rapids-sagemaker-hpo/entrypoint.sh"> entrypoint.sh </a>
    </li>
    
    <li class="toc-h2 nav-item toc-entry">
      <a class="reference external nav-link" href="https://github.com/rapidsai/deployment/blob/main/source/examples/rapids-sagemaker-hpo/MLWorkflow.py"> MLWorkflow.py </a>
    </li>
    
    <li class="toc-h2 nav-item toc-entry">
      <a class="reference external nav-link" href="https://github.com/rapidsai/deployment/blob/main/source/examples/rapids-sagemaker-hpo/HPOConfig.py"> HPOConfig.py </a>
    </li>
    
  </ul>
</nav>
</div>

  <div class="sidebar-secondary-item">
<div class="tocsection onthispage"><i class="fa-solid fa-tags"></i> Tags</div>
<nav id="bd-toc-nav" class="page-toc">
  <div class="tagwrapper">
    
    <a href="../?filters=library/xgboost">
      <span class="sd-sphinx-override sd-badge">library/xgboost</span>
    </a>
    
    <a href="../?filters=library/dask">
      <span class="sd-sphinx-override sd-badge">library/dask</span>
    </a>
    
    <a href="../?filters=workflow/hpo">
      <span class="sd-sphinx-override sd-badge">workflow/hpo</span>
    </a>
    
    <a href="../?filters=cloud/aws/sagemaker">
      <span class="sd-sphinx-override sd-badge">cloud/aws/sagemaker</span>
    </a>
    
    <a href="../?filters=library/cuml">
      <span class="sd-sphinx-override sd-badge">library/cuml</span>
    </a>
    
    <a href="../?filters=library/cupy">
      <span class="sd-sphinx-override sd-badge">library/cupy</span>
    </a>
    
    <a href="../?filters=library/cudf">
      <span class="sd-sphinx-override sd-badge">library/cudf</span>
    </a>
    
    <a href="../?filters=dataset/airline">
      <span class="sd-sphinx-override sd-badge">dataset/airline</span>
    </a>
    
  </div>
</nav>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner"></div>
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023, NVIDIA.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://sphinx-doc.org/">Sphinx</a> 5.3.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>