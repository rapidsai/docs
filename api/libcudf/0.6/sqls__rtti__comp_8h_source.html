<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/xhtml;charset=utf-8" http-equiv="Content-Type"/>
<meta content="IE=9" http-equiv="X-UA-Compatible"/>
<meta content="Doxygen 1.8.14" name="generator"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>
   libcudf: sqls_rtti_comp.h Source File
  </title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script src="jquery.js" type="text/javascript">
</script>
<script src="dynsections.js" type="text/javascript">
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script src="search/searchdata.js" type="text/javascript">
</script>
<script src="search/search.js" type="text/javascript">
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" id="rapids-fa-tag" rel="stylesheet"/><link href="/assets/css/custom.css" id="rapids-selector-css" rel="stylesheet"/></head>
<body>
<div id="top">
<!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea"><div id="rapids-doxygen-container"><div class="rapids-home-container"><a class="rapids-home-container__home-btn" href="/api">Home</a></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">libcudf</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/clx/stable/api.html">clx</a><a class="rapids-selector__menu-item" href="/api/cudf-java/stable">cudf-java</a><a class="rapids-selector__menu-item" href="/api/cudf/stable/api.html">cudf</a><a class="rapids-selector__menu-item" href="/api/cugraph/stable/api.html">cugraph</a><a class="rapids-selector__menu-item" href="/api/cuml/stable/api.html">cuml</a><a class="rapids-selector__menu-item" href="/api/cusignal/stable/api.html">cusignal</a><a class="rapids-selector__menu-item" href="/api/cuspatial/stable/api.html">cuspatial</a><a class="rapids-selector__menu-item" href="/api/cuxfilter/stable">cuxfilter</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/libcudf/stable/namespacecudf.html">libcudf</a><a class="rapids-selector__menu-item" href="/api/libcugraph/stable">libcugraph</a><a class="rapids-selector__menu-item" href="/api/libcuml/stable">libcuml</a><a class="rapids-selector__menu-item" href="/api/libnvstrings/stable/annotated.html">libnvstrings</a><a class="rapids-selector__menu-item" href="/api/nvstrings/stable/api.html">nvstrings</a><a class="rapids-selector__menu-item" href="/api/rmm/stable/annotated.html">rmm</a></div></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">legacy (0.6)</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/libcudf/nightly/namespacecudf.html">nightly (0.16)</a><a class="rapids-selector__menu-item" href="/api/libcudf/stable/namespacecudf.html">stable (0.15)</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/libcudf/legacy/namespacecudf.html">legacy (0.6)</a></div></div></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
    /* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
   </script>
<script src="menudata.js" type="text/javascript">
</script>
<script src="menu.js" type="text/javascript">
</script>
<script type="text/javascript">
    /* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
   </script>
<div id="main-nav">
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()">
</div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)">
</iframe>
</div>
<div class="navpath" id="nav-path">
<ul>
<li class="navelem">
<a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">
       src
      </a>
</li>
<li class="navelem">
<a class="el" href="dir_23747776beb236666b1a18f7d1875489.html">
       sqls
      </a>
</li>
</ul>
</div>
</div>
<!-- top -->
<div class="header">
<div class="headertitle">
<div class="title">
     sqls_rtti_comp.h
    </div>
</div>
</div>
<!--header-->
<div class="contents">
<div class="fragment">
<div class="line">
<a name="l00001">
</a>
<span class="lineno">
      1
     </span>
<span class="comment">
      /* Copyright 2018 NVIDIA Corporation.  All rights reserved. */
     </span>
</div>
<div class="line">
<a name="l00002">
</a>
<span class="lineno">
      2
     </span>
</div>
<div class="line">
<a name="l00003">
</a>
<span class="lineno">
      3
     </span>
<span class="comment">
      //Type-erasure C-style interface for Multi-column Filter, Order-By, and Group-By functionality
     </span>
</div>
<div class="line">
<a name="l00004">
</a>
<span class="lineno">
      4
     </span>
</div>
<div class="line">
<a name="l00005">
</a>
<span class="lineno">
      5
     </span>
<span class="preprocessor">
      #pragma once
     </span>
</div>
<div class="line">
<a name="l00006">
</a>
<span class="lineno">
      6
     </span>
</div>
<div class="line">
<a name="l00007">
</a>
<span class="lineno">
      7
     </span>
<span class="preprocessor">
      #include &lt;cassert&gt;
     </span>
</div>
<div class="line">
<a name="l00008">
</a>
<span class="lineno">
      8
     </span>
<span class="preprocessor">
      #include &lt;iterator&gt;
     </span>
</div>
<div class="line">
<a name="l00009">
</a>
<span class="lineno">
      9
     </span>
</div>
<div class="line">
<a name="l00010">
</a>
<span class="lineno">
      10
     </span>
<span class="preprocessor">
      #include &lt;thrust/tuple.h&gt;
     </span>
</div>
<div class="line">
<a name="l00011">
</a>
<span class="lineno">
      11
     </span>
<span class="preprocessor">
      #include &lt;thrust/execution_policy.h&gt;
     </span>
</div>
<div class="line">
<a name="l00012">
</a>
<span class="lineno">
      12
     </span>
<span class="preprocessor">
      #include &lt;thrust/system/cuda/execution_policy.h&gt;
     </span>
</div>
<div class="line">
<a name="l00013">
</a>
<span class="lineno">
      13
     </span>
<span class="preprocessor">
      #include &lt;thrust/copy.h&gt;
     </span>
</div>
<div class="line">
<a name="l00014">
</a>
<span class="lineno">
      14
     </span>
<span class="preprocessor">
      #include &lt;thrust/sort.h&gt;
     </span>
</div>
<div class="line">
<a name="l00015">
</a>
<span class="lineno">
      15
     </span>
<span class="preprocessor">
      #include &lt;thrust/sequence.h&gt;
     </span>
</div>
<div class="line">
<a name="l00016">
</a>
<span class="lineno">
      16
     </span>
<span class="preprocessor">
      #include &lt;thrust/iterator/counting_iterator.h&gt;
     </span>
</div>
<div class="line">
<a name="l00017">
</a>
<span class="lineno">
      17
     </span>
<span class="preprocessor">
      #include &lt;thrust/iterator/constant_iterator.h&gt;
     </span>
</div>
<div class="line">
<a name="l00018">
</a>
<span class="lineno">
      18
     </span>
<span class="preprocessor">
      #include &lt;thrust/reduce.h&gt;
     </span>
</div>
<div class="line">
<a name="l00019">
</a>
<span class="lineno">
      19
     </span>
<span class="preprocessor">
      #include &lt;thrust/distance.h&gt;
     </span>
</div>
<div class="line">
<a name="l00020">
</a>
<span class="lineno">
      20
     </span>
<span class="preprocessor">
      #include &lt;thrust/advance.h&gt;
     </span>
</div>
<div class="line">
<a name="l00021">
</a>
<span class="lineno">
      21
     </span>
<span class="preprocessor">
      #include &lt;thrust/gather.h&gt;
     </span>
</div>
<div class="line">
<a name="l00022">
</a>
<span class="lineno">
      22
     </span>
</div>
<div class="line">
<a name="l00023">
</a>
<span class="lineno">
      23
     </span>
<span class="preprocessor">
      #include "rmm/thrust_rmm_allocator.h"
     </span>
</div>
<div class="line">
<a name="l00024">
</a>
<span class="lineno">
      24
     </span>
</div>
<div class="line">
<a name="l00025">
</a>
<span class="lineno">
      25
     </span>
<span class="preprocessor">
      #include &lt;cstdint&gt;
     </span>
</div>
<div class="line">
<a name="l00026">
</a>
<span class="lineno">
      26
     </span>
</div>
<div class="line">
<a name="l00027">
</a>
<span class="lineno">
      27
     </span>
<span class="preprocessor">
      #include "utilities/cudf_utils.h"
     </span>
</div>
<div class="line">
<a name="l00028">
</a>
<span class="lineno">
      28
     </span>
<span class="preprocessor">
      #include "utilities/type_dispatcher.hpp"
     </span>
</div>
<div class="line">
<a name="l00029">
</a>
<span class="lineno">
      29
     </span>
<span class="preprocessor">
      #include "bitmask/legacy_bitmask.hpp"
     </span>
</div>
<div class="line">
<a name="l00030">
</a>
<span class="lineno">
      30
     </span>
</div>
<div class="line">
<a name="l00031">
</a>
<span class="lineno">
      31
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     IndexT&gt;
    </div>
<div class="line">
<a name="l00032">
</a>
<span class="lineno">
<a class="line" href="structLesserRTTI.html">
       32
      </a>
</span>
<span class="keyword">
      struct
     </span>
<a class="code" href="structLesserRTTI.html">
      LesserRTTI
     </a>
</div>
<div class="line">
<a name="l00033">
</a>
<span class="lineno">
      33
     </span>
     {
    </div>
<div class="line">
<a name="l00034">
</a>
<span class="lineno">
      34
     </span>
<a class="code" href="structLesserRTTI.html">
      LesserRTTI
     </a>
     (
     <span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     *cols,
    </div>
<div class="line">
<a name="l00035">
</a>
<span class="lineno">
      35
     </span>
<span class="keywordtype">
      int
     </span>
     *
     <span class="keyword">
      const
     </span>
     types,
    </div>
<div class="line">
<a name="l00036">
</a>
<span class="lineno">
      36
     </span>
<span class="keywordtype">
      size_t
     </span>
     sz) : columns_(cols),
    </div>
<div class="line">
<a name="l00037">
</a>
<span class="lineno">
      37
     </span>
     rtti_(types),
    </div>
<div class="line">
<a name="l00038">
</a>
<span class="lineno">
      38
     </span>
     sz_(sz)
    </div>
<div class="line">
<a name="l00039">
</a>
<span class="lineno">
      39
     </span>
     {
    </div>
<div class="line">
<a name="l00040">
</a>
<span class="lineno">
      40
     </span>
     }
    </div>
<div class="line">
<a name="l00041">
</a>
<span class="lineno">
      41
     </span>
</div>
<div class="line">
<a name="l00042">
</a>
<span class="lineno">
      42
     </span>
<a class="code" href="structLesserRTTI.html">
      LesserRTTI
     </a>
     (
     <span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     *cols,
    </div>
<div class="line">
<a name="l00043">
</a>
<span class="lineno">
      43
     </span>
<span class="keywordtype">
      int
     </span>
     *
     <span class="keyword">
      const
     </span>
     types,
    </div>
<div class="line">
<a name="l00044">
</a>
<span class="lineno">
      44
     </span>
<span class="keywordtype">
      size_t
     </span>
     sz,
    </div>
<div class="line">
<a name="l00045">
</a>
<span class="lineno">
      45
     </span>
<span class="keyword">
      const
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     *vals) : columns_(cols),
    </div>
<div class="line">
<a name="l00046">
</a>
<span class="lineno">
      46
     </span>
     rtti_(types),
    </div>
<div class="line">
<a name="l00047">
</a>
<span class="lineno">
      47
     </span>
     sz_(sz),
    </div>
<div class="line">
<a name="l00048">
</a>
<span class="lineno">
      48
     </span>
     vals_(vals)
    </div>
<div class="line">
<a name="l00049">
</a>
<span class="lineno">
      49
     </span>
     {
    </div>
<div class="line">
<a name="l00050">
</a>
<span class="lineno">
      50
     </span>
     }
    </div>
<div class="line">
<a name="l00051">
</a>
<span class="lineno">
      51
     </span>
</div>
<div class="line">
<a name="l00052">
</a>
<span class="lineno">
      52
     </span>
<a class="code" href="structLesserRTTI.html">
      LesserRTTI
     </a>
     (
     <span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     *cols,
    </div>
<div class="line">
<a name="l00053">
</a>
<span class="lineno">
      53
     </span>
     gdf_valid_type *
     <span class="keyword">
      const
     </span>
     *valids,
    </div>
<div class="line">
<a name="l00054">
</a>
<span class="lineno">
      54
     </span>
<span class="keywordtype">
      int
     </span>
     *
     <span class="keyword">
      const
     </span>
     types,
    </div>
<div class="line">
<a name="l00055">
</a>
<span class="lineno">
      55
     </span>
     int8_t *
     <span class="keyword">
      const
     </span>
     asc_desc_flags,
    </div>
<div class="line">
<a name="l00056">
</a>
<span class="lineno">
      56
     </span>
<span class="keywordtype">
      size_t
     </span>
     sz,
    </div>
<div class="line">
<a name="l00057">
</a>
<span class="lineno">
      57
     </span>
<span class="keywordtype">
      bool
     </span>
     nulls_are_smallest) : columns_(cols),
    </div>
<div class="line">
<a name="l00058">
</a>
<span class="lineno">
      58
     </span>
     valids_(valids),
    </div>
<div class="line">
<a name="l00059">
</a>
<span class="lineno">
      59
     </span>
     rtti_(types),
    </div>
<div class="line">
<a name="l00060">
</a>
<span class="lineno">
      60
     </span>
     sz_(sz),
    </div>
<div class="line">
<a name="l00061">
</a>
<span class="lineno">
      61
     </span>
     asc_desc_flags_(asc_desc_flags),
    </div>
<div class="line">
<a name="l00062">
</a>
<span class="lineno">
      62
     </span>
     nulls_are_smallest_(nulls_are_smallest)
    </div>
<div class="line">
<a name="l00063">
</a>
<span class="lineno">
      63
     </span>
     {
    </div>
<div class="line">
<a name="l00064">
</a>
<span class="lineno">
      64
     </span>
     }
    </div>
<div class="line">
<a name="l00065">
</a>
<span class="lineno">
      65
     </span>
</div>
<div class="line">
<a name="l00069">
</a>
<span class="lineno">
      69
     </span>
     __device__
    </div>
<div class="line">
<a name="l00070">
</a>
<span class="lineno">
<a class="line" href="structLesserRTTI.html#a2f39aeae6ff44daeb676080f0933add0">
       70
      </a>
</span>
<span class="keywordtype">
      bool
     </span>
<a class="code" href="structLesserRTTI.html#a2f39aeae6ff44daeb676080f0933add0">
      asc_desc_comparison
     </a>
     (IndexT row1, IndexT row2)
     <span class="keyword">
      const
     </span>
</div>
<div class="line">
<a name="l00071">
</a>
<span class="lineno">
      71
     </span>
<span class="keyword">
</span>
     {
    </div>
<div class="line">
<a name="l00072">
</a>
<span class="lineno">
      72
     </span>
<span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      size_t
     </span>
     col_index = 0; col_index &lt; sz_; ++col_index)
    </div>
<div class="line">
<a name="l00073">
</a>
<span class="lineno">
      73
     </span>
     {
    </div>
<div class="line">
<a name="l00074">
</a>
<span class="lineno">
      74
     </span>
     gdf_dtype col_type =
     <span class="keyword">
      static_cast&lt;
     </span>
     gdf_dtype
     <span class="keyword">
      &gt;
     </span>
     (rtti_[col_index]);
    </div>
<div class="line">
<a name="l00075">
</a>
<span class="lineno">
      75
     </span>
</div>
<div class="line">
<a name="l00076">
</a>
<span class="lineno">
      76
     </span>
<span class="keywordtype">
      bool
     </span>
     asc =
     <span class="keyword">
      true
     </span>
     ;
    </div>
<div class="line">
<a name="l00077">
</a>
<span class="lineno">
      77
     </span>
<span class="keywordflow">
      if
     </span>
     (asc_desc_flags_ !=
     <span class="keyword">
      nullptr
     </span>
     ){
    </div>
<div class="line">
<a name="l00078">
</a>
<span class="lineno">
      78
     </span>
     asc = (asc_desc_flags_[col_index] == GDF_ORDER_ASC);
    </div>
<div class="line">
<a name="l00079">
</a>
<span class="lineno">
      79
     </span>
     }
    </div>
<div class="line">
<a name="l00080">
</a>
<span class="lineno">
      80
     </span>
</div>
<div class="line">
<a name="l00081">
</a>
<span class="lineno">
      81
     </span>
     State state;
    </div>
<div class="line">
<a name="l00082">
</a>
<span class="lineno">
      82
     </span>
<span class="keywordflow">
      if
     </span>
     (asc){
    </div>
<div class="line">
<a name="l00083">
</a>
<span class="lineno">
      83
     </span>
     state = cudf::type_dispatcher(col_type, OpLess{},
    </div>
<div class="line">
<a name="l00084">
</a>
<span class="lineno">
      84
     </span>
     row1,
    </div>
<div class="line">
<a name="l00085">
</a>
<span class="lineno">
      85
     </span>
     row2,
    </div>
<div class="line">
<a name="l00086">
</a>
<span class="lineno">
      86
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00087">
</a>
<span class="lineno">
      87
     </span>
     columns_);
    </div>
<div class="line">
<a name="l00088">
</a>
<span class="lineno">
      88
     </span>
     }
     <span class="keywordflow">
      else
     </span>
     {
    </div>
<div class="line">
<a name="l00089">
</a>
<span class="lineno">
      89
     </span>
     state = cudf::type_dispatcher(col_type, OpGreater{},
    </div>
<div class="line">
<a name="l00090">
</a>
<span class="lineno">
      90
     </span>
     row1,
    </div>
<div class="line">
<a name="l00091">
</a>
<span class="lineno">
      91
     </span>
     row2,
    </div>
<div class="line">
<a name="l00092">
</a>
<span class="lineno">
      92
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00093">
</a>
<span class="lineno">
      93
     </span>
     columns_);
    </div>
<div class="line">
<a name="l00094">
</a>
<span class="lineno">
      94
     </span>
     }
    </div>
<div class="line">
<a name="l00095">
</a>
<span class="lineno">
      95
     </span>
</div>
<div class="line">
<a name="l00096">
</a>
<span class="lineno">
      96
     </span>
<span class="keywordflow">
      switch
     </span>
     ( state )
    </div>
<div class="line">
<a name="l00097">
</a>
<span class="lineno">
      97
     </span>
     {
    </div>
<div class="line">
<a name="l00098">
</a>
<span class="lineno">
      98
     </span>
<span class="keywordflow">
      case
     </span>
     State::False:
    </div>
<div class="line">
<a name="l00099">
</a>
<span class="lineno">
      99
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      false
     </span>
     ;
    </div>
<div class="line">
<a name="l00100">
</a>
<span class="lineno">
      100
     </span>
<span class="keywordflow">
      case
     </span>
     State::True:
    </div>
<div class="line">
<a name="l00101">
</a>
<span class="lineno">
      101
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      true
     </span>
     ;
    </div>
<div class="line">
<a name="l00102">
</a>
<span class="lineno">
      102
     </span>
<span class="keywordflow">
      case
     </span>
     State::Undecided:
    </div>
<div class="line">
<a name="l00103">
</a>
<span class="lineno">
      103
     </span>
<span class="keywordflow">
      break
     </span>
     ;
    </div>
<div class="line">
<a name="l00104">
</a>
<span class="lineno">
      104
     </span>
     }
    </div>
<div class="line">
<a name="l00105">
</a>
<span class="lineno">
      105
     </span>
     }
    </div>
<div class="line">
<a name="l00106">
</a>
<span class="lineno">
      106
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      false
     </span>
     ;
    </div>
<div class="line">
<a name="l00107">
</a>
<span class="lineno">
      107
     </span>
     }
    </div>
<div class="line">
<a name="l00108">
</a>
<span class="lineno">
      108
     </span>
</div>
<div class="line">
<a name="l00109">
</a>
<span class="lineno">
      109
     </span>
     __device__
    </div>
<div class="line">
<a name="l00110">
</a>
<span class="lineno">
      110
     </span>
<span class="keywordtype">
      bool
     </span>
     asc_desc_comparison_with_nulls(IndexT row1, IndexT row2)
     <span class="keyword">
      const
     </span>
</div>
<div class="line">
<a name="l00111">
</a>
<span class="lineno">
      111
     </span>
<span class="keyword">
</span>
     {
    </div>
<div class="line">
<a name="l00112">
</a>
<span class="lineno">
      112
     </span>
<span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      size_t
     </span>
     col_index = 0; col_index &lt; sz_; ++col_index)
    </div>
<div class="line">
<a name="l00113">
</a>
<span class="lineno">
      113
     </span>
     {
    </div>
<div class="line">
<a name="l00114">
</a>
<span class="lineno">
      114
     </span>
     gdf_dtype col_type =
     <span class="keyword">
      static_cast&lt;
     </span>
     gdf_dtype
     <span class="keyword">
      &gt;
     </span>
     (rtti_[col_index]);
    </div>
<div class="line">
<a name="l00115">
</a>
<span class="lineno">
      115
     </span>
</div>
<div class="line">
<a name="l00116">
</a>
<span class="lineno">
      116
     </span>
<span class="keywordtype">
      bool
     </span>
     asc =
     <span class="keyword">
      true
     </span>
     ;
    </div>
<div class="line">
<a name="l00117">
</a>
<span class="lineno">
      117
     </span>
<span class="keywordflow">
      if
     </span>
     (asc_desc_flags_ !=
     <span class="keyword">
      nullptr
     </span>
     ){
    </div>
<div class="line">
<a name="l00118">
</a>
<span class="lineno">
      118
     </span>
     asc = (asc_desc_flags_[col_index] == GDF_ORDER_ASC);
    </div>
<div class="line">
<a name="l00119">
</a>
<span class="lineno">
      119
     </span>
     }
    </div>
<div class="line">
<a name="l00120">
</a>
<span class="lineno">
      120
     </span>
</div>
<div class="line">
<a name="l00121">
</a>
<span class="lineno">
      121
     </span>
     State state;
    </div>
<div class="line">
<a name="l00122">
</a>
<span class="lineno">
      122
     </span>
<span class="keywordflow">
      if
     </span>
     (asc){
    </div>
<div class="line">
<a name="l00123">
</a>
<span class="lineno">
      123
     </span>
     state = cudf::type_dispatcher(col_type, OpLess_with_nulls{},
    </div>
<div class="line">
<a name="l00124">
</a>
<span class="lineno">
      124
     </span>
     row1,
    </div>
<div class="line">
<a name="l00125">
</a>
<span class="lineno">
      125
     </span>
     row2,
    </div>
<div class="line">
<a name="l00126">
</a>
<span class="lineno">
      126
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00127">
</a>
<span class="lineno">
      127
     </span>
     columns_,
    </div>
<div class="line">
<a name="l00128">
</a>
<span class="lineno">
      128
     </span>
     valids_,
    </div>
<div class="line">
<a name="l00129">
</a>
<span class="lineno">
      129
     </span>
     nulls_are_smallest_);
    </div>
<div class="line">
<a name="l00130">
</a>
<span class="lineno">
      130
     </span>
     }
     <span class="keywordflow">
      else
     </span>
     {
    </div>
<div class="line">
<a name="l00131">
</a>
<span class="lineno">
      131
     </span>
     state = cudf::type_dispatcher(col_type, OpGreater_with_nulls{},
    </div>
<div class="line">
<a name="l00132">
</a>
<span class="lineno">
      132
     </span>
     row1,
    </div>
<div class="line">
<a name="l00133">
</a>
<span class="lineno">
      133
     </span>
     row2,
    </div>
<div class="line">
<a name="l00134">
</a>
<span class="lineno">
      134
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00135">
</a>
<span class="lineno">
      135
     </span>
     columns_,
    </div>
<div class="line">
<a name="l00136">
</a>
<span class="lineno">
      136
     </span>
     valids_,
    </div>
<div class="line">
<a name="l00137">
</a>
<span class="lineno">
      137
     </span>
     nulls_are_smallest_);
    </div>
<div class="line">
<a name="l00138">
</a>
<span class="lineno">
      138
     </span>
     }
    </div>
<div class="line">
<a name="l00139">
</a>
<span class="lineno">
      139
     </span>
</div>
<div class="line">
<a name="l00140">
</a>
<span class="lineno">
      140
     </span>
<span class="keywordflow">
      switch
     </span>
     ( state )
    </div>
<div class="line">
<a name="l00141">
</a>
<span class="lineno">
      141
     </span>
     {
    </div>
<div class="line">
<a name="l00142">
</a>
<span class="lineno">
      142
     </span>
<span class="keywordflow">
      case
     </span>
     State::False:
    </div>
<div class="line">
<a name="l00143">
</a>
<span class="lineno">
      143
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      false
     </span>
     ;
    </div>
<div class="line">
<a name="l00144">
</a>
<span class="lineno">
      144
     </span>
<span class="keywordflow">
      case
     </span>
     State::True:
    </div>
<div class="line">
<a name="l00145">
</a>
<span class="lineno">
      145
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      true
     </span>
     ;
    </div>
<div class="line">
<a name="l00146">
</a>
<span class="lineno">
      146
     </span>
<span class="keywordflow">
      case
     </span>
     State::Undecided:
    </div>
<div class="line">
<a name="l00147">
</a>
<span class="lineno">
      147
     </span>
<span class="keywordflow">
      break
     </span>
     ;
    </div>
<div class="line">
<a name="l00148">
</a>
<span class="lineno">
      148
     </span>
     }
    </div>
<div class="line">
<a name="l00149">
</a>
<span class="lineno">
      149
     </span>
     }
    </div>
<div class="line">
<a name="l00150">
</a>
<span class="lineno">
      150
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      false
     </span>
     ;
    </div>
<div class="line">
<a name="l00151">
</a>
<span class="lineno">
      151
     </span>
     }
    </div>
<div class="line">
<a name="l00152">
</a>
<span class="lineno">
      152
     </span>
</div>
<div class="line">
<a name="l00153">
</a>
<span class="lineno">
      153
     </span>
     __device__
    </div>
<div class="line">
<a name="l00154">
</a>
<span class="lineno">
      154
     </span>
<span class="keywordtype">
      bool
     </span>
     equal(IndexT row1, IndexT row2)
     <span class="keyword">
      const
     </span>
</div>
<div class="line">
<a name="l00155">
</a>
<span class="lineno">
      155
     </span>
<span class="keyword">
</span>
     {
    </div>
<div class="line">
<a name="l00156">
</a>
<span class="lineno">
      156
     </span>
<span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      size_t
     </span>
     col_index = 0; col_index &lt; sz_; ++col_index)
    </div>
<div class="line">
<a name="l00157">
</a>
<span class="lineno">
      157
     </span>
     {
    </div>
<div class="line">
<a name="l00158">
</a>
<span class="lineno">
      158
     </span>
     gdf_dtype col_type =
     <span class="keyword">
      static_cast&lt;
     </span>
     gdf_dtype
     <span class="keyword">
      &gt;
     </span>
     (rtti_[col_index]);
    </div>
<div class="line">
<a name="l00159">
</a>
<span class="lineno">
      159
     </span>
</div>
<div class="line">
<a name="l00160">
</a>
<span class="lineno">
      160
     </span>
     State state = cudf::type_dispatcher(col_type, OpEqual{},
    </div>
<div class="line">
<a name="l00161">
</a>
<span class="lineno">
      161
     </span>
     row1,
    </div>
<div class="line">
<a name="l00162">
</a>
<span class="lineno">
      162
     </span>
     row2,
    </div>
<div class="line">
<a name="l00163">
</a>
<span class="lineno">
      163
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00164">
</a>
<span class="lineno">
      164
     </span>
     columns_);
    </div>
<div class="line">
<a name="l00165">
</a>
<span class="lineno">
      165
     </span>
<span class="keywordflow">
      switch
     </span>
     ( state )
    </div>
<div class="line">
<a name="l00166">
</a>
<span class="lineno">
      166
     </span>
     {
    </div>
<div class="line">
<a name="l00167">
</a>
<span class="lineno">
      167
     </span>
<span class="keywordflow">
      case
     </span>
     State::False:
    </div>
<div class="line">
<a name="l00168">
</a>
<span class="lineno">
      168
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      false
     </span>
     ;
    </div>
<div class="line">
<a name="l00169">
</a>
<span class="lineno">
      169
     </span>
</div>
<div class="line">
<a name="l00170">
</a>
<span class="lineno">
      170
     </span>
<span class="keywordflow">
      case
     </span>
     State::True:
    </div>
<div class="line">
<a name="l00171">
</a>
<span class="lineno">
      171
     </span>
<span class="keywordflow">
      case
     </span>
     State::Undecided:
    </div>
<div class="line">
<a name="l00172">
</a>
<span class="lineno">
      172
     </span>
<span class="keywordflow">
      break
     </span>
     ;
    </div>
<div class="line">
<a name="l00173">
</a>
<span class="lineno">
      173
     </span>
     }
    </div>
<div class="line">
<a name="l00174">
</a>
<span class="lineno">
      174
     </span>
     }
    </div>
<div class="line">
<a name="l00175">
</a>
<span class="lineno">
      175
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      true
     </span>
     ;
    </div>
<div class="line">
<a name="l00176">
</a>
<span class="lineno">
      176
     </span>
     }
    </div>
<div class="line">
<a name="l00177">
</a>
<span class="lineno">
      177
     </span>
</div>
<div class="line">
<a name="l00178">
</a>
<span class="lineno">
      178
     </span>
     __device__
    </div>
<div class="line">
<a name="l00179">
</a>
<span class="lineno">
      179
     </span>
<span class="keywordtype">
      bool
     </span>
     equal_v(
     <span class="keywordtype">
      size_t
     </span>
     row1)
     <span class="keyword">
      const
     </span>
</div>
<div class="line">
<a name="l00180">
</a>
<span class="lineno">
      180
     </span>
<span class="keyword">
</span>
     {
    </div>
<div class="line">
<a name="l00181">
</a>
<span class="lineno">
      181
     </span>
<span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      size_t
     </span>
     col_index = 0; col_index &lt; sz_; ++col_index)
    </div>
<div class="line">
<a name="l00182">
</a>
<span class="lineno">
      182
     </span>
     {
    </div>
<div class="line">
<a name="l00183">
</a>
<span class="lineno">
      183
     </span>
     gdf_dtype col_type =
     <span class="keyword">
      static_cast&lt;
     </span>
     gdf_dtype
     <span class="keyword">
      &gt;
     </span>
     (rtti_[col_index]);
    </div>
<div class="line">
<a name="l00184">
</a>
<span class="lineno">
      184
     </span>
</div>
<div class="line">
<a name="l00185">
</a>
<span class="lineno">
      185
     </span>
     State state = cudf::type_dispatcher(col_type, OpEqualV{},
    </div>
<div class="line">
<a name="l00186">
</a>
<span class="lineno">
      186
     </span>
     vals_,
    </div>
<div class="line">
<a name="l00187">
</a>
<span class="lineno">
      187
     </span>
     row1,
    </div>
<div class="line">
<a name="l00188">
</a>
<span class="lineno">
      188
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00189">
</a>
<span class="lineno">
      189
     </span>
     columns_);
    </div>
<div class="line">
<a name="l00190">
</a>
<span class="lineno">
      190
     </span>
<span class="keywordflow">
      switch
     </span>
     ( state )
    </div>
<div class="line">
<a name="l00191">
</a>
<span class="lineno">
      191
     </span>
     {
    </div>
<div class="line">
<a name="l00192">
</a>
<span class="lineno">
      192
     </span>
<span class="keywordflow">
      case
     </span>
     State::False:
    </div>
<div class="line">
<a name="l00193">
</a>
<span class="lineno">
      193
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      false
     </span>
     ;
    </div>
<div class="line">
<a name="l00194">
</a>
<span class="lineno">
      194
     </span>
</div>
<div class="line">
<a name="l00195">
</a>
<span class="lineno">
      195
     </span>
<span class="keywordflow">
      case
     </span>
     State::True:
    </div>
<div class="line">
<a name="l00196">
</a>
<span class="lineno">
      196
     </span>
<span class="keywordflow">
      case
     </span>
     State::Undecided:
    </div>
<div class="line">
<a name="l00197">
</a>
<span class="lineno">
      197
     </span>
<span class="keywordflow">
      break
     </span>
     ;
    </div>
<div class="line">
<a name="l00198">
</a>
<span class="lineno">
      198
     </span>
     }
    </div>
<div class="line">
<a name="l00199">
</a>
<span class="lineno">
      199
     </span>
     }
    </div>
<div class="line">
<a name="l00200">
</a>
<span class="lineno">
      200
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      true
     </span>
     ;
    </div>
<div class="line">
<a name="l00201">
</a>
<span class="lineno">
      201
     </span>
     }
    </div>
<div class="line">
<a name="l00202">
</a>
<span class="lineno">
      202
     </span>
</div>
<div class="line">
<a name="l00203">
</a>
<span class="lineno">
      203
     </span>
     __device__
    </div>
<div class="line">
<a name="l00204">
</a>
<span class="lineno">
      204
     </span>
<span class="keywordtype">
      bool
     </span>
     less(IndexT row1, IndexT row2)
     <span class="keyword">
      const
     </span>
</div>
<div class="line">
<a name="l00205">
</a>
<span class="lineno">
      205
     </span>
<span class="keyword">
</span>
     {
    </div>
<div class="line">
<a name="l00206">
</a>
<span class="lineno">
      206
     </span>
<span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      size_t
     </span>
     col_index = 0; col_index &lt; sz_; ++col_index)
    </div>
<div class="line">
<a name="l00207">
</a>
<span class="lineno">
      207
     </span>
     {
    </div>
<div class="line">
<a name="l00208">
</a>
<span class="lineno">
      208
     </span>
     gdf_dtype col_type =
     <span class="keyword">
      static_cast&lt;
     </span>
     gdf_dtype
     <span class="keyword">
      &gt;
     </span>
     (rtti_[col_index]);
    </div>
<div class="line">
<a name="l00209">
</a>
<span class="lineno">
      209
     </span>
</div>
<div class="line">
<a name="l00210">
</a>
<span class="lineno">
      210
     </span>
     State state = cudf::type_dispatcher(col_type, OpLess{},
    </div>
<div class="line">
<a name="l00211">
</a>
<span class="lineno">
      211
     </span>
     row1,
    </div>
<div class="line">
<a name="l00212">
</a>
<span class="lineno">
      212
     </span>
     row2,
    </div>
<div class="line">
<a name="l00213">
</a>
<span class="lineno">
      213
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00214">
</a>
<span class="lineno">
      214
     </span>
     columns_);
    </div>
<div class="line">
<a name="l00215">
</a>
<span class="lineno">
      215
     </span>
<span class="keywordflow">
      switch
     </span>
     ( state )
    </div>
<div class="line">
<a name="l00216">
</a>
<span class="lineno">
      216
     </span>
     {
    </div>
<div class="line">
<a name="l00217">
</a>
<span class="lineno">
      217
     </span>
<span class="keywordflow">
      case
     </span>
     State::False:
    </div>
<div class="line">
<a name="l00218">
</a>
<span class="lineno">
      218
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      false
     </span>
     ;
    </div>
<div class="line">
<a name="l00219">
</a>
<span class="lineno">
      219
     </span>
<span class="keywordflow">
      case
     </span>
     State::True:
    </div>
<div class="line">
<a name="l00220">
</a>
<span class="lineno">
      220
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      true
     </span>
     ;
    </div>
<div class="line">
<a name="l00221">
</a>
<span class="lineno">
      221
     </span>
<span class="keywordflow">
      case
     </span>
     State::Undecided:
    </div>
<div class="line">
<a name="l00222">
</a>
<span class="lineno">
      222
     </span>
<span class="keywordflow">
      break
     </span>
     ;
    </div>
<div class="line">
<a name="l00223">
</a>
<span class="lineno">
      223
     </span>
     }
    </div>
<div class="line">
<a name="l00224">
</a>
<span class="lineno">
      224
     </span>
     }
    </div>
<div class="line">
<a name="l00225">
</a>
<span class="lineno">
      225
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      false
     </span>
     ;
    </div>
<div class="line">
<a name="l00226">
</a>
<span class="lineno">
      226
     </span>
     }
    </div>
<div class="line">
<a name="l00227">
</a>
<span class="lineno">
      227
     </span>
</div>
<div class="line">
<a name="l00228">
</a>
<span class="lineno">
      228
     </span>
     __device__
    </div>
<div class="line">
<a name="l00229">
</a>
<span class="lineno">
      229
     </span>
<span class="keywordtype">
      bool
     </span>
     less_with_nulls(IndexT row1, IndexT row2)
     <span class="keyword">
      const
     </span>
</div>
<div class="line">
<a name="l00230">
</a>
<span class="lineno">
      230
     </span>
<span class="keyword">
</span>
     {
    </div>
<div class="line">
<a name="l00231">
</a>
<span class="lineno">
      231
     </span>
<span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      size_t
     </span>
     col_index = 0; col_index &lt; sz_; ++col_index)
    </div>
<div class="line">
<a name="l00232">
</a>
<span class="lineno">
      232
     </span>
     {
    </div>
<div class="line">
<a name="l00233">
</a>
<span class="lineno">
      233
     </span>
     gdf_dtype col_type =
     <span class="keyword">
      static_cast&lt;
     </span>
     gdf_dtype
     <span class="keyword">
      &gt;
     </span>
     (rtti_[col_index]);
    </div>
<div class="line">
<a name="l00234">
</a>
<span class="lineno">
      234
     </span>
</div>
<div class="line">
<a name="l00235">
</a>
<span class="lineno">
      235
     </span>
     State state = cudf::type_dispatcher(col_type, OpLess_with_nulls{},
    </div>
<div class="line">
<a name="l00236">
</a>
<span class="lineno">
      236
     </span>
     row1,
    </div>
<div class="line">
<a name="l00237">
</a>
<span class="lineno">
      237
     </span>
     row2,
    </div>
<div class="line">
<a name="l00238">
</a>
<span class="lineno">
      238
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00239">
</a>
<span class="lineno">
      239
     </span>
     columns_,
    </div>
<div class="line">
<a name="l00240">
</a>
<span class="lineno">
      240
     </span>
     valids_,
    </div>
<div class="line">
<a name="l00241">
</a>
<span class="lineno">
      241
     </span>
     nulls_are_smallest_);
    </div>
<div class="line">
<a name="l00242">
</a>
<span class="lineno">
      242
     </span>
<span class="keywordflow">
      switch
     </span>
     ( state )
    </div>
<div class="line">
<a name="l00243">
</a>
<span class="lineno">
      243
     </span>
     {
    </div>
<div class="line">
<a name="l00244">
</a>
<span class="lineno">
      244
     </span>
<span class="keywordflow">
      case
     </span>
     State::False:
    </div>
<div class="line">
<a name="l00245">
</a>
<span class="lineno">
      245
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      false
     </span>
     ;
    </div>
<div class="line">
<a name="l00246">
</a>
<span class="lineno">
      246
     </span>
<span class="keywordflow">
      case
     </span>
     State::True:
    </div>
<div class="line">
<a name="l00247">
</a>
<span class="lineno">
      247
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      true
     </span>
     ;
    </div>
<div class="line">
<a name="l00248">
</a>
<span class="lineno">
      248
     </span>
<span class="keywordflow">
      case
     </span>
     State::Undecided:
    </div>
<div class="line">
<a name="l00249">
</a>
<span class="lineno">
      249
     </span>
<span class="keywordflow">
      break
     </span>
     ;
    </div>
<div class="line">
<a name="l00250">
</a>
<span class="lineno">
      250
     </span>
     }
    </div>
<div class="line">
<a name="l00251">
</a>
<span class="lineno">
      251
     </span>
     }
    </div>
<div class="line">
<a name="l00252">
</a>
<span class="lineno">
      252
     </span>
<span class="keywordflow">
      return
     </span>
<span class="keyword">
      false
     </span>
     ;
    </div>
<div class="line">
<a name="l00253">
</a>
<span class="lineno">
      253
     </span>
     }
    </div>
<div class="line">
<a name="l00254">
</a>
<span class="lineno">
      254
     </span>
</div>
<div class="line">
<a name="l00255">
</a>
<span class="lineno">
      255
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     ColType&gt;
    </div>
<div class="line">
<a name="l00256">
</a>
<span class="lineno">
      256
     </span>
     __device__
    </div>
<div class="line">
<a name="l00257">
</a>
<span class="lineno">
      257
     </span>
<span class="keyword">
      static
     </span>
     ColType at(
     <span class="keywordtype">
      int
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00258">
</a>
<span class="lineno">
      258
     </span>
     IndexT row,
    </div>
<div class="line">
<a name="l00259">
</a>
<span class="lineno">
      259
     </span>
<span class="keyword">
      const
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     * columns)
    </div>
<div class="line">
<a name="l00260">
</a>
<span class="lineno">
      260
     </span>
     {
    </div>
<div class="line">
<a name="l00261">
</a>
<span class="lineno">
      261
     </span>
<span class="keywordflow">
      return
     </span>
     (static_cast&lt;const ColType*&gt;(columns[col_index]))[row];
    </div>
<div class="line">
<a name="l00262">
</a>
<span class="lineno">
      262
     </span>
     }
    </div>
<div class="line">
<a name="l00263">
</a>
<span class="lineno">
      263
     </span>
</div>
<div class="line">
<a name="l00264">
</a>
<span class="lineno">
      264
     </span>
     __device__
    </div>
<div class="line">
<a name="l00265">
</a>
<span class="lineno">
      265
     </span>
<span class="keyword">
      static
     </span>
<span class="keywordtype">
      bool
     </span>
     is_valid(
     <span class="keywordtype">
      int
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00266">
</a>
<span class="lineno">
      266
     </span>
     IndexT row,
    </div>
<div class="line">
<a name="l00267">
</a>
<span class="lineno">
      267
     </span>
<span class="keyword">
      const
     </span>
     gdf_valid_type*
     <span class="keyword">
      const
     </span>
     * valids)
    </div>
<div class="line">
<a name="l00268">
</a>
<span class="lineno">
      268
     </span>
     {
    </div>
<div class="line">
<a name="l00269">
</a>
<span class="lineno">
      269
     </span>
<span class="keywordflow">
      return
     </span>
     gdf_is_valid(valids[col_index], row);
    </div>
<div class="line">
<a name="l00270">
</a>
<span class="lineno">
      270
     </span>
     }
    </div>
<div class="line">
<a name="l00271">
</a>
<span class="lineno">
      271
     </span>
</div>
<div class="line">
<a name="l00272">
</a>
<span class="lineno">
      272
     </span>
<span class="keyword">
      private
     </span>
     :
    </div>
<div class="line">
<a name="l00273">
</a>
<span class="lineno">
      273
     </span>
<span class="keyword">
      enum class
     </span>
     State {False = 0, True = 1, Undecided = 2};
    </div>
<div class="line">
<a name="l00274">
</a>
<span class="lineno">
      274
     </span>
</div>
<div class="line">
<a name="l00275">
</a>
<span class="lineno">
      275
     </span>
<span class="keyword">
      struct
     </span>
     OpLess
    </div>
<div class="line">
<a name="l00276">
</a>
<span class="lineno">
      276
     </span>
     {
    </div>
<div class="line">
<a name="l00277">
</a>
<span class="lineno">
      277
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     ColType&gt;
    </div>
<div class="line">
<a name="l00278">
</a>
<span class="lineno">
      278
     </span>
     __device__
    </div>
<div class="line">
<a name="l00279">
</a>
<span class="lineno">
      279
     </span>
     State operator() (IndexT row1, IndexT row2,
    </div>
<div class="line">
<a name="l00280">
</a>
<span class="lineno">
      280
     </span>
<span class="keywordtype">
      int
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00281">
</a>
<span class="lineno">
      281
     </span>
<span class="keyword">
      const
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     * columns)
    </div>
<div class="line">
<a name="l00282">
</a>
<span class="lineno">
      282
     </span>
     {
    </div>
<div class="line">
<a name="l00283">
</a>
<span class="lineno">
      283
     </span>
<span class="keyword">
      const
     </span>
     ColType res1 = LesserRTTI::at&lt;ColType&gt;(col_index, row1, columns);
    </div>
<div class="line">
<a name="l00284">
</a>
<span class="lineno">
      284
     </span>
<span class="keyword">
      const
     </span>
     ColType res2 = LesserRTTI::at&lt;ColType&gt;(col_index, row2, columns);
    </div>
<div class="line">
<a name="l00285">
</a>
<span class="lineno">
      285
     </span>
</div>
<div class="line">
<a name="l00286">
</a>
<span class="lineno">
      286
     </span>
<span class="keywordflow">
      if
     </span>
     ( res1 &lt; res2 )
    </div>
<div class="line">
<a name="l00287">
</a>
<span class="lineno">
      287
     </span>
<span class="keywordflow">
      return
     </span>
     State::True;
    </div>
<div class="line">
<a name="l00288">
</a>
<span class="lineno">
      288
     </span>
<span class="keywordflow">
      else
     </span>
<span class="keywordflow">
      if
     </span>
     ( res1 == res2 )
    </div>
<div class="line">
<a name="l00289">
</a>
<span class="lineno">
      289
     </span>
<span class="keywordflow">
      return
     </span>
     State::Undecided;
    </div>
<div class="line">
<a name="l00290">
</a>
<span class="lineno">
      290
     </span>
<span class="keywordflow">
      else
     </span>
</div>
<div class="line">
<a name="l00291">
</a>
<span class="lineno">
      291
     </span>
<span class="keywordflow">
      return
     </span>
     State::False;
    </div>
<div class="line">
<a name="l00292">
</a>
<span class="lineno">
      292
     </span>
     }
    </div>
<div class="line">
<a name="l00293">
</a>
<span class="lineno">
      293
     </span>
     };
    </div>
<div class="line">
<a name="l00294">
</a>
<span class="lineno">
      294
     </span>
</div>
<div class="line">
<a name="l00295">
</a>
<span class="lineno">
      295
     </span>
<span class="keyword">
      struct
     </span>
     OpLess_with_nulls
    </div>
<div class="line">
<a name="l00296">
</a>
<span class="lineno">
      296
     </span>
     {
    </div>
<div class="line">
<a name="l00297">
</a>
<span class="lineno">
      297
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     ColType&gt;
    </div>
<div class="line">
<a name="l00298">
</a>
<span class="lineno">
      298
     </span>
     __device__
    </div>
<div class="line">
<a name="l00299">
</a>
<span class="lineno">
      299
     </span>
     State operator() (IndexT row1, IndexT row2,
    </div>
<div class="line">
<a name="l00300">
</a>
<span class="lineno">
      300
     </span>
<span class="keywordtype">
      int
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00301">
</a>
<span class="lineno">
      301
     </span>
<span class="keyword">
      const
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     * columns,
    </div>
<div class="line">
<a name="l00302">
</a>
<span class="lineno">
      302
     </span>
<span class="keyword">
      const
     </span>
     gdf_valid_type*
     <span class="keyword">
      const
     </span>
     * valids,
    </div>
<div class="line">
<a name="l00303">
</a>
<span class="lineno">
      303
     </span>
<span class="keywordtype">
      bool
     </span>
     nulls_are_smallest)
    </div>
<div class="line">
<a name="l00304">
</a>
<span class="lineno">
      304
     </span>
     {
    </div>
<div class="line">
<a name="l00305">
</a>
<span class="lineno">
      305
     </span>
<span class="keyword">
      const
     </span>
     ColType res1 = LesserRTTI::at&lt;ColType&gt;(col_index, row1, columns);
    </div>
<div class="line">
<a name="l00306">
</a>
<span class="lineno">
      306
     </span>
<span class="keyword">
      const
     </span>
     ColType res2 = LesserRTTI::at&lt;ColType&gt;(col_index, row2, columns);
    </div>
<div class="line">
<a name="l00307">
</a>
<span class="lineno">
      307
     </span>
<span class="keyword">
      const
     </span>
<span class="keywordtype">
      bool
     </span>
     isValid1 = LesserRTTI::is_valid(col_index, row1, valids);
    </div>
<div class="line">
<a name="l00308">
</a>
<span class="lineno">
      308
     </span>
<span class="keyword">
      const
     </span>
<span class="keywordtype">
      bool
     </span>
     isValid2 = LesserRTTI::is_valid(col_index, row2, valids);
    </div>
<div class="line">
<a name="l00309">
</a>
<span class="lineno">
      309
     </span>
</div>
<div class="line">
<a name="l00310">
</a>
<span class="lineno">
      310
     </span>
<span class="keywordflow">
      if
     </span>
     (!isValid2 &amp;&amp; !isValid1)
    </div>
<div class="line">
<a name="l00311">
</a>
<span class="lineno">
      311
     </span>
<span class="keywordflow">
      return
     </span>
     State::Undecided;
    </div>
<div class="line">
<a name="l00312">
</a>
<span class="lineno">
      312
     </span>
<span class="keywordflow">
      else
     </span>
<span class="keywordflow">
      if
     </span>
     ( isValid1 &amp;&amp; isValid2)
    </div>
<div class="line">
<a name="l00313">
</a>
<span class="lineno">
      313
     </span>
     {
    </div>
<div class="line">
<a name="l00314">
</a>
<span class="lineno">
      314
     </span>
<span class="keywordflow">
      if
     </span>
     ( res1 &lt; res2 )
    </div>
<div class="line">
<a name="l00315">
</a>
<span class="lineno">
      315
     </span>
<span class="keywordflow">
      return
     </span>
     State::True;
    </div>
<div class="line">
<a name="l00316">
</a>
<span class="lineno">
      316
     </span>
<span class="keywordflow">
      else
     </span>
<span class="keywordflow">
      if
     </span>
     ( res1 == res2 )
    </div>
<div class="line">
<a name="l00317">
</a>
<span class="lineno">
      317
     </span>
<span class="keywordflow">
      return
     </span>
     State::Undecided;
    </div>
<div class="line">
<a name="l00318">
</a>
<span class="lineno">
      318
     </span>
<span class="keywordflow">
      else
     </span>
</div>
<div class="line">
<a name="l00319">
</a>
<span class="lineno">
      319
     </span>
<span class="keywordflow">
      return
     </span>
     State::False;
    </div>
<div class="line">
<a name="l00320">
</a>
<span class="lineno">
      320
     </span>
     }
    </div>
<div class="line">
<a name="l00321">
</a>
<span class="lineno">
      321
     </span>
<span class="keywordflow">
      else
     </span>
<span class="keywordflow">
      if
     </span>
     (!isValid1 &amp;&amp; nulls_are_smallest)
    </div>
<div class="line">
<a name="l00322">
</a>
<span class="lineno">
      322
     </span>
<span class="keywordflow">
      return
     </span>
     State::True;
    </div>
<div class="line">
<a name="l00323">
</a>
<span class="lineno">
      323
     </span>
<span class="keywordflow">
      else
     </span>
<span class="keywordflow">
      if
     </span>
     (!isValid2 &amp;&amp; !nulls_are_smallest)
    </div>
<div class="line">
<a name="l00324">
</a>
<span class="lineno">
      324
     </span>
<span class="keywordflow">
      return
     </span>
     State::True;
    </div>
<div class="line">
<a name="l00325">
</a>
<span class="lineno">
      325
     </span>
<span class="keywordflow">
      else
     </span>
</div>
<div class="line">
<a name="l00326">
</a>
<span class="lineno">
      326
     </span>
<span class="keywordflow">
      return
     </span>
     State::False;
    </div>
<div class="line">
<a name="l00327">
</a>
<span class="lineno">
      327
     </span>
     }
    </div>
<div class="line">
<a name="l00328">
</a>
<span class="lineno">
      328
     </span>
     };
    </div>
<div class="line">
<a name="l00329">
</a>
<span class="lineno">
      329
     </span>
</div>
<div class="line">
<a name="l00330">
</a>
<span class="lineno">
      330
     </span>
<span class="keyword">
      struct
     </span>
     OpGreater
    </div>
<div class="line">
<a name="l00331">
</a>
<span class="lineno">
      331
     </span>
     {
    </div>
<div class="line">
<a name="l00332">
</a>
<span class="lineno">
      332
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     ColType&gt;
    </div>
<div class="line">
<a name="l00333">
</a>
<span class="lineno">
      333
     </span>
     __device__
    </div>
<div class="line">
<a name="l00334">
</a>
<span class="lineno">
      334
     </span>
     State operator() (IndexT row1, IndexT row2,
    </div>
<div class="line">
<a name="l00335">
</a>
<span class="lineno">
      335
     </span>
<span class="keywordtype">
      int
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00336">
</a>
<span class="lineno">
      336
     </span>
<span class="keyword">
      const
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     * columns)
    </div>
<div class="line">
<a name="l00337">
</a>
<span class="lineno">
      337
     </span>
     {
    </div>
<div class="line">
<a name="l00338">
</a>
<span class="lineno">
      338
     </span>
<span class="keyword">
      const
     </span>
     ColType res1 = LesserRTTI::at&lt;ColType&gt;(col_index, row1, columns);
    </div>
<div class="line">
<a name="l00339">
</a>
<span class="lineno">
      339
     </span>
<span class="keyword">
      const
     </span>
     ColType res2 = LesserRTTI::at&lt;ColType&gt;(col_index, row2, columns);
    </div>
<div class="line">
<a name="l00340">
</a>
<span class="lineno">
      340
     </span>
</div>
<div class="line">
<a name="l00341">
</a>
<span class="lineno">
      341
     </span>
<span class="keywordflow">
      if
     </span>
     ( res1 &gt; res2 )
    </div>
<div class="line">
<a name="l00342">
</a>
<span class="lineno">
      342
     </span>
<span class="keywordflow">
      return
     </span>
     State::True;
    </div>
<div class="line">
<a name="l00343">
</a>
<span class="lineno">
      343
     </span>
<span class="keywordflow">
      else
     </span>
<span class="keywordflow">
      if
     </span>
     ( res1 == res2 )
    </div>
<div class="line">
<a name="l00344">
</a>
<span class="lineno">
      344
     </span>
<span class="keywordflow">
      return
     </span>
     State::Undecided;
    </div>
<div class="line">
<a name="l00345">
</a>
<span class="lineno">
      345
     </span>
<span class="keywordflow">
      else
     </span>
</div>
<div class="line">
<a name="l00346">
</a>
<span class="lineno">
      346
     </span>
<span class="keywordflow">
      return
     </span>
     State::False;
    </div>
<div class="line">
<a name="l00347">
</a>
<span class="lineno">
      347
     </span>
     }
    </div>
<div class="line">
<a name="l00348">
</a>
<span class="lineno">
      348
     </span>
     };
    </div>
<div class="line">
<a name="l00349">
</a>
<span class="lineno">
      349
     </span>
</div>
<div class="line">
<a name="l00350">
</a>
<span class="lineno">
      350
     </span>
<span class="keyword">
      struct
     </span>
     OpGreater_with_nulls
    </div>
<div class="line">
<a name="l00351">
</a>
<span class="lineno">
      351
     </span>
     {
    </div>
<div class="line">
<a name="l00352">
</a>
<span class="lineno">
      352
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     ColType&gt;
    </div>
<div class="line">
<a name="l00353">
</a>
<span class="lineno">
      353
     </span>
     __device__
    </div>
<div class="line">
<a name="l00354">
</a>
<span class="lineno">
      354
     </span>
     State operator() (IndexT row1, IndexT row2,
    </div>
<div class="line">
<a name="l00355">
</a>
<span class="lineno">
      355
     </span>
<span class="keywordtype">
      int
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00356">
</a>
<span class="lineno">
      356
     </span>
<span class="keyword">
      const
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     * columns,
    </div>
<div class="line">
<a name="l00357">
</a>
<span class="lineno">
      357
     </span>
<span class="keyword">
      const
     </span>
     gdf_valid_type*
     <span class="keyword">
      const
     </span>
     * valids,
    </div>
<div class="line">
<a name="l00358">
</a>
<span class="lineno">
      358
     </span>
<span class="keywordtype">
      bool
     </span>
     nulls_are_smallest)
    </div>
<div class="line">
<a name="l00359">
</a>
<span class="lineno">
      359
     </span>
     {
    </div>
<div class="line">
<a name="l00360">
</a>
<span class="lineno">
      360
     </span>
<span class="keyword">
      const
     </span>
     ColType res1 = LesserRTTI::at&lt;ColType&gt;(col_index, row1, columns);
    </div>
<div class="line">
<a name="l00361">
</a>
<span class="lineno">
      361
     </span>
<span class="keyword">
      const
     </span>
     ColType res2 = LesserRTTI::at&lt;ColType&gt;(col_index, row2, columns);
    </div>
<div class="line">
<a name="l00362">
</a>
<span class="lineno">
      362
     </span>
<span class="keyword">
      const
     </span>
<span class="keywordtype">
      bool
     </span>
     isValid1 = LesserRTTI::is_valid(col_index, row1, valids);
    </div>
<div class="line">
<a name="l00363">
</a>
<span class="lineno">
      363
     </span>
<span class="keyword">
      const
     </span>
<span class="keywordtype">
      bool
     </span>
     isValid2 = LesserRTTI::is_valid(col_index, row2, valids);
    </div>
<div class="line">
<a name="l00364">
</a>
<span class="lineno">
      364
     </span>
</div>
<div class="line">
<a name="l00365">
</a>
<span class="lineno">
      365
     </span>
<span class="keywordflow">
      if
     </span>
     (!isValid2 &amp;&amp; !isValid1)
    </div>
<div class="line">
<a name="l00366">
</a>
<span class="lineno">
      366
     </span>
<span class="keywordflow">
      return
     </span>
     State::Undecided;
    </div>
<div class="line">
<a name="l00367">
</a>
<span class="lineno">
      367
     </span>
<span class="keywordflow">
      else
     </span>
<span class="keywordflow">
      if
     </span>
     ( isValid1 &amp;&amp; isValid2)
    </div>
<div class="line">
<a name="l00368">
</a>
<span class="lineno">
      368
     </span>
     {
    </div>
<div class="line">
<a name="l00369">
</a>
<span class="lineno">
      369
     </span>
<span class="keywordflow">
      if
     </span>
     ( res1 &gt; res2 )
    </div>
<div class="line">
<a name="l00370">
</a>
<span class="lineno">
      370
     </span>
<span class="keywordflow">
      return
     </span>
     State::True;
    </div>
<div class="line">
<a name="l00371">
</a>
<span class="lineno">
      371
     </span>
<span class="keywordflow">
      else
     </span>
<span class="keywordflow">
      if
     </span>
     ( res1 == res2 )
    </div>
<div class="line">
<a name="l00372">
</a>
<span class="lineno">
      372
     </span>
<span class="keywordflow">
      return
     </span>
     State::Undecided;
    </div>
<div class="line">
<a name="l00373">
</a>
<span class="lineno">
      373
     </span>
<span class="keywordflow">
      else
     </span>
</div>
<div class="line">
<a name="l00374">
</a>
<span class="lineno">
      374
     </span>
<span class="keywordflow">
      return
     </span>
     State::False;
    </div>
<div class="line">
<a name="l00375">
</a>
<span class="lineno">
      375
     </span>
     }
    </div>
<div class="line">
<a name="l00376">
</a>
<span class="lineno">
      376
     </span>
<span class="keywordflow">
      else
     </span>
<span class="keywordflow">
      if
     </span>
     (!isValid1 &amp;&amp; nulls_are_smallest)
    </div>
<div class="line">
<a name="l00377">
</a>
<span class="lineno">
      377
     </span>
<span class="keywordflow">
      return
     </span>
     State::False;
    </div>
<div class="line">
<a name="l00378">
</a>
<span class="lineno">
      378
     </span>
<span class="keywordflow">
      else
     </span>
<span class="keywordflow">
      if
     </span>
     (!isValid2 &amp;&amp; !nulls_are_smallest)
    </div>
<div class="line">
<a name="l00379">
</a>
<span class="lineno">
      379
     </span>
<span class="keywordflow">
      return
     </span>
     State::False;
    </div>
<div class="line">
<a name="l00380">
</a>
<span class="lineno">
      380
     </span>
<span class="keywordflow">
      else
     </span>
</div>
<div class="line">
<a name="l00381">
</a>
<span class="lineno">
      381
     </span>
<span class="keywordflow">
      return
     </span>
     State::True;
    </div>
<div class="line">
<a name="l00382">
</a>
<span class="lineno">
      382
     </span>
     }
    </div>
<div class="line">
<a name="l00383">
</a>
<span class="lineno">
      383
     </span>
     };
    </div>
<div class="line">
<a name="l00384">
</a>
<span class="lineno">
      384
     </span>
</div>
<div class="line">
<a name="l00385">
</a>
<span class="lineno">
      385
     </span>
<span class="keyword">
      struct
     </span>
     OpEqual
    </div>
<div class="line">
<a name="l00386">
</a>
<span class="lineno">
      386
     </span>
     {
    </div>
<div class="line">
<a name="l00387">
</a>
<span class="lineno">
      387
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     ColType&gt;
    </div>
<div class="line">
<a name="l00388">
</a>
<span class="lineno">
      388
     </span>
     __device__
    </div>
<div class="line">
<a name="l00389">
</a>
<span class="lineno">
      389
     </span>
     State operator() (IndexT row1, IndexT row2,
    </div>
<div class="line">
<a name="l00390">
</a>
<span class="lineno">
      390
     </span>
<span class="keywordtype">
      int
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00391">
</a>
<span class="lineno">
      391
     </span>
<span class="keyword">
      const
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     * columns)
    </div>
<div class="line">
<a name="l00392">
</a>
<span class="lineno">
      392
     </span>
     {
    </div>
<div class="line">
<a name="l00393">
</a>
<span class="lineno">
      393
     </span>
<span class="keyword">
      const
     </span>
     ColType res1 = LesserRTTI::at&lt;ColType&gt;(col_index, row1, columns);
    </div>
<div class="line">
<a name="l00394">
</a>
<span class="lineno">
      394
     </span>
<span class="keyword">
      const
     </span>
     ColType res2 = LesserRTTI::at&lt;ColType&gt;(col_index, row2, columns);
    </div>
<div class="line">
<a name="l00395">
</a>
<span class="lineno">
      395
     </span>
</div>
<div class="line">
<a name="l00396">
</a>
<span class="lineno">
      396
     </span>
<span class="keywordflow">
      if
     </span>
     ( res1 != res2 )
    </div>
<div class="line">
<a name="l00397">
</a>
<span class="lineno">
      397
     </span>
<span class="keywordflow">
      return
     </span>
     State::False;
    </div>
<div class="line">
<a name="l00398">
</a>
<span class="lineno">
      398
     </span>
<span class="keywordflow">
      else
     </span>
</div>
<div class="line">
<a name="l00399">
</a>
<span class="lineno">
      399
     </span>
<span class="keywordflow">
      return
     </span>
     State::Undecided;
    </div>
<div class="line">
<a name="l00400">
</a>
<span class="lineno">
      400
     </span>
     }
    </div>
<div class="line">
<a name="l00401">
</a>
<span class="lineno">
      401
     </span>
     };
    </div>
<div class="line">
<a name="l00402">
</a>
<span class="lineno">
      402
     </span>
</div>
<div class="line">
<a name="l00403">
</a>
<span class="lineno">
      403
     </span>
<span class="keyword">
      struct
     </span>
     OpEqualV
    </div>
<div class="line">
<a name="l00404">
</a>
<span class="lineno">
      404
     </span>
     {
    </div>
<div class="line">
<a name="l00405">
</a>
<span class="lineno">
      405
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     ColType&gt;
    </div>
<div class="line">
<a name="l00406">
</a>
<span class="lineno">
      406
     </span>
     __device__
    </div>
<div class="line">
<a name="l00407">
</a>
<span class="lineno">
      407
     </span>
     State operator() (
     <span class="keyword">
      const
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     * vals,
    </div>
<div class="line">
<a name="l00408">
</a>
<span class="lineno">
      408
     </span>
     IndexT row,
    </div>
<div class="line">
<a name="l00409">
</a>
<span class="lineno">
      409
     </span>
<span class="keywordtype">
      int
     </span>
     col_index,
    </div>
<div class="line">
<a name="l00410">
</a>
<span class="lineno">
      410
     </span>
<span class="keyword">
      const
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     * columns)
    </div>
<div class="line">
<a name="l00411">
</a>
<span class="lineno">
      411
     </span>
     {
    </div>
<div class="line">
<a name="l00412">
</a>
<span class="lineno">
      412
     </span>
<span class="keyword">
      const
     </span>
     ColType res1 = LesserRTTI::at&lt;ColType&gt;(col_index, row, columns);
    </div>
<div class="line">
<a name="l00413">
</a>
<span class="lineno">
      413
     </span>
<span class="keyword">
      const
     </span>
     ColType res2 = LesserRTTI::at&lt;ColType&gt;(col_index, 0, vals);
    </div>
<div class="line">
<a name="l00414">
</a>
<span class="lineno">
      414
     </span>
</div>
<div class="line">
<a name="l00415">
</a>
<span class="lineno">
      415
     </span>
<span class="keywordflow">
      if
     </span>
     ( res1 != res2 )
    </div>
<div class="line">
<a name="l00416">
</a>
<span class="lineno">
      416
     </span>
<span class="keywordflow">
      return
     </span>
     State::False;
    </div>
<div class="line">
<a name="l00417">
</a>
<span class="lineno">
      417
     </span>
<span class="keywordflow">
      else
     </span>
</div>
<div class="line">
<a name="l00418">
</a>
<span class="lineno">
      418
     </span>
<span class="keywordflow">
      return
     </span>
     State::Undecided;
    </div>
<div class="line">
<a name="l00419">
</a>
<span class="lineno">
      419
     </span>
     }
    </div>
<div class="line">
<a name="l00420">
</a>
<span class="lineno">
      420
     </span>
     };
    </div>
<div class="line">
<a name="l00421">
</a>
<span class="lineno">
      421
     </span>
</div>
<div class="line">
<a name="l00422">
</a>
<span class="lineno">
      422
     </span>
<span class="keyword">
      const
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     * columns_{
     <span class="keyword">
      nullptr
     </span>
     };
    </div>
<div class="line">
<a name="l00423">
</a>
<span class="lineno">
      423
     </span>
<span class="keyword">
      const
     </span>
     gdf_valid_type*
     <span class="keyword">
      const
     </span>
     * valids_{
     <span class="keyword">
      nullptr
     </span>
     };
    </div>
<div class="line">
<a name="l00424">
</a>
<span class="lineno">
      424
     </span>
<span class="keyword">
      const
     </span>
<span class="keywordtype">
      int
     </span>
     *
     <span class="keyword">
      const
     </span>
     rtti_{
     <span class="keyword">
      nullptr
     </span>
     };
    </div>
<div class="line">
<a name="l00425">
</a>
<span class="lineno">
      425
     </span>
<span class="keywordtype">
      size_t
     </span>
     sz_;
    </div>
<div class="line">
<a name="l00426">
</a>
<span class="lineno">
      426
     </span>
<span class="keyword">
      const
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     * vals_{
     <span class="keyword">
      nullptr
     </span>
     };
     <span class="comment">
      //for filtering
     </span>
</div>
<div class="line">
<a name="l00427">
</a>
<span class="lineno">
      427
     </span>
<span class="keyword">
      const
     </span>
     int8_t*
     <span class="keyword">
      const
     </span>
     asc_desc_flags_{
     <span class="keyword">
      nullptr
     </span>
     };
     <span class="comment">
      //array of 0 and 1 that allows us to know whether or not a column should be sorted ascending or descending
     </span>
</div>
<div class="line">
<a name="l00428">
</a>
<span class="lineno">
      428
     </span>
<span class="keywordtype">
      bool
     </span>
     nulls_are_smallest_{
     <span class="keyword">
      false
     </span>
     };
     <span class="comment">
      // when sorting if there are nulls in the data if this is true, then they will be treated as the smallest value, otherwise they will be treated as the largest value
     </span>
</div>
<div class="line">
<a name="l00429">
</a>
<span class="lineno">
      429
     </span>
     };
    </div>
<div class="line">
<a name="l00430">
</a>
<span class="lineno">
      430
     </span>
</div>
<div class="line">
<a name="l00431">
</a>
<span class="lineno">
      431
     </span>
<span class="comment">
      //###########################################################################
     </span>
</div>
<div class="line">
<a name="l00432">
</a>
<span class="lineno">
      432
     </span>
<span class="comment">
      //#                          Multi-column Filter:                           #
     </span>
</div>
<div class="line">
<a name="l00433">
</a>
<span class="lineno">
      433
     </span>
<span class="comment">
      //###########################################################################
     </span>
</div>
<div class="line">
<a name="l00434">
</a>
<span class="lineno">
      434
     </span>
<span class="comment">
      //Version with array of columns,
     </span>
</div>
<div class="line">
<a name="l00435">
</a>
<span class="lineno">
      435
     </span>
<span class="comment">
      //using type erasure and RTTI at
     </span>
</div>
<div class="line">
<a name="l00436">
</a>
<span class="lineno">
      436
     </span>
<span class="comment">
      //comparison operator level;
     </span>
</div>
<div class="line">
<a name="l00437">
</a>
<span class="lineno">
      437
     </span>
<span class="comment">
      //
     </span>
</div>
<div class="line">
<a name="l00438">
</a>
<span class="lineno">
      438
     </span>
<span class="comment">
      //Filter array of columns ("table")
     </span>
</div>
<div class="line">
<a name="l00439">
</a>
<span class="lineno">
      439
     </span>
<span class="comment">
      //on given array of values;
     </span>
</div>
<div class="line">
<a name="l00440">
</a>
<span class="lineno">
      440
     </span>
<span class="comment">
      //Input:
     </span>
</div>
<div class="line">
<a name="l00441">
</a>
<span class="lineno">
      441
     </span>
<span class="comment">
      // nrows    = # rows;
     </span>
</div>
<div class="line">
<a name="l00442">
</a>
<span class="lineno">
      442
     </span>
<span class="comment">
      // ncols    = # columns;
     </span>
</div>
<div class="line">
<a name="l00443">
</a>
<span class="lineno">
      443
     </span>
<span class="comment">
      // d_cols   = device array to ncols type erased columns;
     </span>
</div>
<div class="line">
<a name="l00444">
</a>
<span class="lineno">
      444
     </span>
<span class="comment">
      // d_gdf_t  = device array to runtime column types;
     </span>
</div>
<div class="line">
<a name="l00445">
</a>
<span class="lineno">
      445
     </span>
<span class="comment">
      // d_vals      = tuple of values to filter against;
     </span>
</div>
<div class="line">
<a name="l00446">
</a>
<span class="lineno">
      446
     </span>
<span class="comment">
      // stream     = cudaStream to work in;
     </span>
</div>
<div class="line">
<a name="l00447">
</a>
<span class="lineno">
      447
     </span>
<span class="comment">
      //Output:
     </span>
</div>
<div class="line">
<a name="l00448">
</a>
<span class="lineno">
      448
     </span>
<span class="comment">
      // d_flt_indx = device_vector of indx for which a match exists (no holes in array!);
     </span>
</div>
<div class="line">
<a name="l00449">
</a>
<span class="lineno">
      449
     </span>
<span class="comment">
      //Return:
     </span>
</div>
<div class="line">
<a name="l00450">
</a>
<span class="lineno">
      450
     </span>
<span class="comment">
      // new_sz     = new #rows after filtering;
     </span>
</div>
<div class="line">
<a name="l00451">
</a>
<span class="lineno">
      451
     </span>
<span class="comment">
      //
     </span>
</div>
<div class="line">
<a name="l00452">
</a>
<span class="lineno">
      452
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     IndexT&gt;
    </div>
<div class="line">
<a name="l00453">
</a>
<span class="lineno">
      453
     </span>
<span class="keywordtype">
      size_t
     </span>
     multi_col_filter(
     <span class="keywordtype">
      size_t
     </span>
     nrows,
    </div>
<div class="line">
<a name="l00454">
</a>
<span class="lineno">
      454
     </span>
<span class="keywordtype">
      size_t
     </span>
     ncols,
    </div>
<div class="line">
<a name="l00455">
</a>
<span class="lineno">
      455
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     * d_cols,
    </div>
<div class="line">
<a name="l00456">
</a>
<span class="lineno">
      456
     </span>
<span class="keywordtype">
      int
     </span>
     *
     <span class="keyword">
      const
     </span>
     d_gdf_t,
    </div>
<div class="line">
<a name="l00457">
</a>
<span class="lineno">
      457
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     * d_vals,
    </div>
<div class="line">
<a name="l00458">
</a>
<span class="lineno">
      458
     </span>
     IndexT* ptr_d_flt_indx,
    </div>
<div class="line">
<a name="l00459">
</a>
<span class="lineno">
      459
     </span>
     cudaStream_t stream = NULL)
    </div>
<div class="line">
<a name="l00460">
</a>
<span class="lineno">
      460
     </span>
     {
    </div>
<div class="line">
<a name="l00461">
</a>
<span class="lineno">
      461
     </span>
<a class="code" href="structLesserRTTI.html">
      LesserRTTI&lt;size_t&gt;
     </a>
     f(d_cols, d_gdf_t, ncols, d_vals);
     <span class="comment">
      //size_t, not IndexT, because of counting_iterator below;
     </span>
</div>
<div class="line">
<a name="l00462">
</a>
<span class="lineno">
      462
     </span>
</div>
<div class="line">
<a name="l00463">
</a>
<span class="lineno">
      463
     </span>
</div>
<div class="line">
<a name="l00464">
</a>
<span class="lineno">
      464
     </span>
<span class="comment">
      //actual filtering happens here:
     </span>
</div>
<div class="line">
<a name="l00465">
</a>
<span class="lineno">
      465
     </span>
<span class="comment">
      //
     </span>
</div>
<div class="line">
<a name="l00466">
</a>
<span class="lineno">
      466
     </span>
<span class="keyword">
      auto
     </span>
     ret_iter_last =
    </div>
<div class="line">
<a name="l00467">
</a>
<span class="lineno">
      467
     </span>
     thrust::copy_if(rmm::exec_policy(stream)-&gt;on(stream),
    </div>
<div class="line">
<a name="l00468">
</a>
<span class="lineno">
      468
     </span>
     thrust::make_counting_iterator&lt;size_t&gt;(0),
    </div>
<div class="line">
<a name="l00469">
</a>
<span class="lineno">
      469
     </span>
     thrust::make_counting_iterator&lt;size_t&gt;(nrows),
    </div>
<div class="line">
<a name="l00470">
</a>
<span class="lineno">
      470
     </span>
     ptr_d_flt_indx,
    </div>
<div class="line">
<a name="l00471">
</a>
<span class="lineno">
      471
     </span>
     [f] __device__ (
     <span class="keywordtype">
      size_t
     </span>
     indx) {
    </div>
<div class="line">
<a name="l00472">
</a>
<span class="lineno">
      472
     </span>
<span class="keywordflow">
      return
     </span>
     f.equal_v(indx);
    </div>
<div class="line">
<a name="l00473">
</a>
<span class="lineno">
      473
     </span>
     });
    </div>
<div class="line">
<a name="l00474">
</a>
<span class="lineno">
      474
     </span>
</div>
<div class="line">
<a name="l00475">
</a>
<span class="lineno">
      475
     </span>
<span class="keywordtype">
      size_t
     </span>
     new_sz = thrust::distance(ptr_d_flt_indx, ret_iter_last);
    </div>
<div class="line">
<a name="l00476">
</a>
<span class="lineno">
      476
     </span>
</div>
<div class="line">
<a name="l00477">
</a>
<span class="lineno">
      477
     </span>
<span class="keywordflow">
      return
     </span>
     new_sz;
    </div>
<div class="line">
<a name="l00478">
</a>
<span class="lineno">
      478
     </span>
     }
    </div>
<div class="line">
<a name="l00479">
</a>
<span class="lineno">
      479
     </span>
</div>
<div class="line">
<a name="l00480">
</a>
<span class="lineno">
      480
     </span>
</div>
<div class="line">
<a name="l00481">
</a>
<span class="lineno">
      481
     </span>
<span class="comment">
      //###########################################################################
     </span>
</div>
<div class="line">
<a name="l00482">
</a>
<span class="lineno">
      482
     </span>
<span class="comment">
      //#                          Multi-column Group-By:                         #
     </span>
</div>
<div class="line">
<a name="l00483">
</a>
<span class="lineno">
      483
     </span>
<span class="comment">
      //###########################################################################
     </span>
</div>
<div class="line">
<a name="l00484">
</a>
<span class="lineno">
      484
     </span>
<span class="comment">
      //group-by is a reduce_by_key
     </span>
</div>
<div class="line">
<a name="l00485">
</a>
<span class="lineno">
      485
     </span>
<span class="comment">
      //
     </span>
</div>
<div class="line">
<a name="l00486">
</a>
<span class="lineno">
      486
     </span>
<span class="comment">
      //not only COUNT(*) makes sense with multicolumn:
     </span>
</div>
<div class="line">
<a name="l00487">
</a>
<span class="lineno">
      487
     </span>
<span class="comment">
      //one can specify a multi-column GROUP-BY criterion
     </span>
</div>
<div class="line">
<a name="l00488">
</a>
<span class="lineno">
      488
     </span>
<span class="comment">
      //and one specifc column to aggregate on;
     </span>
</div>
<div class="line">
<a name="l00489">
</a>
<span class="lineno">
      489
     </span>
<span class="comment">
      //
     </span>
</div>
<div class="line">
<a name="l00490">
</a>
<span class="lineno">
      490
     </span>
<span class="comment">
      //Input:
     </span>
</div>
<div class="line">
<a name="l00491">
</a>
<span class="lineno">
      491
     </span>
<span class="comment">
      // nrows    = # rows;
     </span>
</div>
<div class="line">
<a name="l00492">
</a>
<span class="lineno">
      492
     </span>
<span class="comment">
      // ncols    = # columns;
     </span>
</div>
<div class="line">
<a name="l00493">
</a>
<span class="lineno">
      493
     </span>
<span class="comment">
      // d_cols   = device array to ncols type erased columns;
     </span>
</div>
<div class="line">
<a name="l00494">
</a>
<span class="lineno">
      494
     </span>
<span class="comment">
      // d_gdf_t  = device array to runtime column types;
     </span>
</div>
<div class="line">
<a name="l00495">
</a>
<span class="lineno">
      495
     </span>
<span class="comment">
      // stream   = cudaStream to work in;
     </span>
</div>
<div class="line">
<a name="l00496">
</a>
<span class="lineno">
      496
     </span>
<span class="comment">
      //Output:
     </span>
</div>
<div class="line">
<a name="l00497">
</a>
<span class="lineno">
      497
     </span>
<span class="comment">
      // d_indx   = reordering of indices after sorting;
     </span>
</div>
<div class="line">
<a name="l00498">
</a>
<span class="lineno">
      498
     </span>
<span class="comment">
      //             (passed as argument to avoid allocations inside the stream)
     </span>
</div>
<div class="line">
<a name="l00499">
</a>
<span class="lineno">
      499
     </span>
<span class="comment">
      // d_kout   = indices of rows after group by;
     </span>
</div>
<div class="line">
<a name="l00500">
</a>
<span class="lineno">
      500
     </span>
<span class="comment">
      // d_vout   = aggregated values (COUNT-ed) as a result of group-by;
     </span>
</div>
<div class="line">
<a name="l00501">
</a>
<span class="lineno">
      501
     </span>
<span class="comment">
      // d_items  = device_vector of items corresponding to indices in d_flt_indx;
     </span>
</div>
<div class="line">
<a name="l00502">
</a>
<span class="lineno">
      502
     </span>
<span class="comment">
      //Return:
     </span>
</div>
<div class="line">
<a name="l00503">
</a>
<span class="lineno">
      503
     </span>
<span class="comment">
      // ret      = # rows after aggregation;
     </span>
</div>
<div class="line">
<a name="l00504">
</a>
<span class="lineno">
      504
     </span>
<span class="comment">
      //
     </span>
</div>
<div class="line">
<a name="l00505">
</a>
<span class="lineno">
      505
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     IndexT,
    </div>
<div class="line">
<a name="l00506">
</a>
<span class="lineno">
      506
     </span>
<span class="keyword">
      typename
     </span>
     CountT = IndexT&gt;
    </div>
<div class="line">
<a name="l00507">
</a>
<span class="lineno">
      507
     </span>
<span class="keywordtype">
      size_t
     </span>
</div>
<div class="line">
<a name="l00508">
</a>
<span class="lineno">
      508
     </span>
     multi_col_group_by_count_sort(
     <span class="keywordtype">
      size_t
     </span>
     nrows,
    </div>
<div class="line">
<a name="l00509">
</a>
<span class="lineno">
      509
     </span>
<span class="keywordtype">
      size_t
     </span>
     ncols,
    </div>
<div class="line">
<a name="l00510">
</a>
<span class="lineno">
      510
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     *   d_cols,
    </div>
<div class="line">
<a name="l00511">
</a>
<span class="lineno">
      511
     </span>
<span class="keywordtype">
      int
     </span>
     *
     <span class="keyword">
      const
     </span>
     d_gdf_t,
    </div>
<div class="line">
<a name="l00512">
</a>
<span class="lineno">
      512
     </span>
     IndexT*        ptr_d_indx,
    </div>
<div class="line">
<a name="l00513">
</a>
<span class="lineno">
      513
     </span>
     IndexT*        ptr_d_kout,
    </div>
<div class="line">
<a name="l00514">
</a>
<span class="lineno">
      514
     </span>
     CountT*        ptr_d_vout,
    </div>
<div class="line">
<a name="l00515">
</a>
<span class="lineno">
      515
     </span>
<span class="keywordtype">
      bool
     </span>
     sorted =
     <span class="keyword">
      false
     </span>
     ,
    </div>
<div class="line">
<a name="l00516">
</a>
<span class="lineno">
      516
     </span>
<span class="keywordtype">
      bool
     </span>
     distinct =
     <span class="keyword">
      false
     </span>
     ,
    </div>
<div class="line">
<a name="l00517">
</a>
<span class="lineno">
      517
     </span>
     cudaStream_t   stream = NULL)
    </div>
<div class="line">
<a name="l00518">
</a>
<span class="lineno">
      518
     </span>
     {
    </div>
<div class="line">
<a name="l00519">
</a>
<span class="lineno">
      519
     </span>
<span class="keywordflow">
      if
     </span>
     ( !sorted )
    </div>
<div class="line">
<a name="l00520">
</a>
<span class="lineno">
      520
     </span>
     multi_col_sort(d_cols,
     <span class="keyword">
      nullptr
     </span>
     , d_gdf_t,
     <span class="keyword">
      nullptr
     </span>
     , ncols, nrows,
     <span class="keyword">
      false
     </span>
     , ptr_d_indx,
     <span class="keyword">
      false
     </span>
     , stream);
    </div>
<div class="line">
<a name="l00521">
</a>
<span class="lineno">
      521
     </span>
</div>
<div class="line">
<a name="l00522">
</a>
<span class="lineno">
      522
     </span>
<a class="code" href="structLesserRTTI.html">
      LesserRTTI&lt;IndexT&gt;
     </a>
     f(d_cols, d_gdf_t, ncols);
    </div>
<div class="line">
<a name="l00523">
</a>
<span class="lineno">
      523
     </span>
</div>
<div class="line">
<a name="l00524">
</a>
<span class="lineno">
      524
     </span>
</div>
<div class="line">
<a name="l00525">
</a>
<span class="lineno">
      525
     </span>
     thrust::pair&lt;IndexT*, CountT*&gt; ret =
    </div>
<div class="line">
<a name="l00526">
</a>
<span class="lineno">
      526
     </span>
     thrust::reduce_by_key(rmm::exec_policy(stream)-&gt;on(stream),
    </div>
<div class="line">
<a name="l00527">
</a>
<span class="lineno">
      527
     </span>
     ptr_d_indx, ptr_d_indx+nrows,
    </div>
<div class="line">
<a name="l00528">
</a>
<span class="lineno">
      528
     </span>
     thrust::make_constant_iterator&lt;CountT&gt;(1),
    </div>
<div class="line">
<a name="l00529">
</a>
<span class="lineno">
      529
     </span>
     ptr_d_kout,
    </div>
<div class="line">
<a name="l00530">
</a>
<span class="lineno">
      530
     </span>
     ptr_d_vout,
    </div>
<div class="line">
<a name="l00531">
</a>
<span class="lineno">
      531
     </span>
     [f] __host__ __device__(IndexT key1, IndexT key2){
    </div>
<div class="line">
<a name="l00532">
</a>
<span class="lineno">
      532
     </span>
<span class="keywordflow">
      return
     </span>
     f.equal(key1, key2);
    </div>
<div class="line">
<a name="l00533">
</a>
<span class="lineno">
      533
     </span>
     });
    </div>
<div class="line">
<a name="l00534">
</a>
<span class="lineno">
      534
     </span>
</div>
<div class="line">
<a name="l00535">
</a>
<span class="lineno">
      535
     </span>
<span class="keywordtype">
      size_t
     </span>
     new_sz = thrust::distance(ptr_d_vout, ret.second);
    </div>
<div class="line">
<a name="l00536">
</a>
<span class="lineno">
      536
     </span>
</div>
<div class="line">
<a name="l00537">
</a>
<span class="lineno">
      537
     </span>
<span class="comment">
      //COUNT(*) for each distinct entry gets collected in d_vout;
     </span>
</div>
<div class="line">
<a name="l00538">
</a>
<span class="lineno">
      538
     </span>
<span class="comment">
      //DISTINCT COUNT(*) is just: thrust::distance(d_kout.begin(), ret.first)
     </span>
</div>
<div class="line">
<a name="l00539">
</a>
<span class="lineno">
      539
     </span>
</div>
<div class="line">
<a name="l00540">
</a>
<span class="lineno">
      540
     </span>
<span class="keywordflow">
      if
     </span>
     ( distinct )
    </div>
<div class="line">
<a name="l00541">
</a>
<span class="lineno">
      541
     </span>
     {
    </div>
<div class="line">
<a name="l00542">
</a>
<span class="lineno">
      542
     </span>
     CountT distinct_count =
     <span class="keyword">
      static_cast&lt;
     </span>
     CountT
     <span class="keyword">
      &gt;
     </span>
     (new_sz);
    </div>
<div class="line">
<a name="l00543">
</a>
<span class="lineno">
      543
     </span>
     cudaMemcpy(ptr_d_vout, &amp;distinct_count,
     <span class="keyword">
      sizeof
     </span>
     (CountT), cudaMemcpyHostToDevice);
    </div>
<div class="line">
<a name="l00544">
</a>
<span class="lineno">
      544
     </span>
     new_sz = 1;
    </div>
<div class="line">
<a name="l00545">
</a>
<span class="lineno">
      545
     </span>
     }
    </div>
<div class="line">
<a name="l00546">
</a>
<span class="lineno">
      546
     </span>
</div>
<div class="line">
<a name="l00547">
</a>
<span class="lineno">
      547
     </span>
<span class="keywordflow">
      return
     </span>
     new_sz;
    </div>
<div class="line">
<a name="l00548">
</a>
<span class="lineno">
      548
     </span>
     }
    </div>
<div class="line">
<a name="l00549">
</a>
<span class="lineno">
      549
     </span>
</div>
<div class="line">
<a name="l00550">
</a>
<span class="lineno">
      550
     </span>
</div>
<div class="line">
<a name="l00551">
</a>
<span class="lineno">
      551
     </span>
<span class="comment">
      //group-by is a reduce_by_key
     </span>
</div>
<div class="line">
<a name="l00552">
</a>
<span class="lineno">
      552
     </span>
<span class="comment">
      //
     </span>
</div>
<div class="line">
<a name="l00553">
</a>
<span class="lineno">
      553
     </span>
<span class="comment">
      //COUNT(*) isn't the only one that makes sense with multicolumn:
     </span>
</div>
<div class="line">
<a name="l00554">
</a>
<span class="lineno">
      554
     </span>
<span class="comment">
      //one can specify a multi-column GROUP-BY criterion
     </span>
</div>
<div class="line">
<a name="l00555">
</a>
<span class="lineno">
      555
     </span>
<span class="comment">
      //and one specifc column to aggregate on;
     </span>
</div>
<div class="line">
<a name="l00556">
</a>
<span class="lineno">
      556
     </span>
<span class="comment">
      //
     </span>
</div>
<div class="line">
<a name="l00557">
</a>
<span class="lineno">
      557
     </span>
<span class="comment">
      //Input:
     </span>
</div>
<div class="line">
<a name="l00558">
</a>
<span class="lineno">
      558
     </span>
<span class="comment">
      // nrows    = # rows;
     </span>
</div>
<div class="line">
<a name="l00559">
</a>
<span class="lineno">
      559
     </span>
<span class="comment">
      // ncols    = # columns;
     </span>
</div>
<div class="line">
<a name="l00560">
</a>
<span class="lineno">
      560
     </span>
<span class="comment">
      // d_cols   = device array to ncols type erased columns;
     </span>
</div>
<div class="line">
<a name="l00561">
</a>
<span class="lineno">
      561
     </span>
<span class="comment">
      // d_gdf_t  = device array to runtime column types;
     </span>
</div>
<div class="line">
<a name="l00562">
</a>
<span class="lineno">
      562
     </span>
<span class="comment">
      // d_agg    = column (device vector) to get aggregated;
     </span>
</div>
<div class="line">
<a name="l00563">
</a>
<span class="lineno">
      563
     </span>
<span class="comment">
      //fctr      = functor to perform the aggregation &lt;Tagg(Tagg, Tagg)&gt;
     </span>
</div>
<div class="line">
<a name="l00564">
</a>
<span class="lineno">
      564
     </span>
<span class="comment">
      //stream    = cudaStream to work in;
     </span>
</div>
<div class="line">
<a name="l00565">
</a>
<span class="lineno">
      565
     </span>
<span class="comment">
      //Output:
     </span>
</div>
<div class="line">
<a name="l00566">
</a>
<span class="lineno">
      566
     </span>
<span class="comment">
      //d_indx    = reordering of indices after sorting;
     </span>
</div>
<div class="line">
<a name="l00567">
</a>
<span class="lineno">
      567
     </span>
<span class="comment">
      //             (passed as argument to avoid allcoations inside the stream)
     </span>
</div>
<div class="line">
<a name="l00568">
</a>
<span class="lineno">
      568
     </span>
<span class="comment">
      //d_agg_p   = reordering of d_agg after sorting;
     </span>
</div>
<div class="line">
<a name="l00569">
</a>
<span class="lineno">
      569
     </span>
<span class="comment">
      //             (passed as argument to avoid allcoations inside the stream)
     </span>
</div>
<div class="line">
<a name="l00570">
</a>
<span class="lineno">
      570
     </span>
<span class="comment">
      //d_kout    = indices of rows after group by;
     </span>
</div>
<div class="line">
<a name="l00571">
</a>
<span class="lineno">
      571
     </span>
<span class="comment">
      //d_vout    = aggregated values (counted) as a result of group-by;
     </span>
</div>
<div class="line">
<a name="l00572">
</a>
<span class="lineno">
      572
     </span>
<span class="comment">
      //Return:
     </span>
</div>
<div class="line">
<a name="l00573">
</a>
<span class="lineno">
      573
     </span>
<span class="comment">
      //ret       = # rows after aggregation;
     </span>
</div>
<div class="line">
<a name="l00574">
</a>
<span class="lineno">
      574
     </span>
<span class="comment">
      //
     </span>
</div>
<div class="line">
<a name="l00575">
</a>
<span class="lineno">
      575
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     ValsT,
    </div>
<div class="line">
<a name="l00576">
</a>
<span class="lineno">
      576
     </span>
<span class="keyword">
      typename
     </span>
     IndexT,
    </div>
<div class="line">
<a name="l00577">
</a>
<span class="lineno">
      577
     </span>
<span class="keyword">
      typename
     </span>
     Reducer&gt;
    </div>
<div class="line">
<a name="l00578">
</a>
<span class="lineno">
      578
     </span>
<span class="keywordtype">
      size_t
     </span>
     multi_col_group_by_sort(
     <span class="keywordtype">
      size_t
     </span>
     nrows,
    </div>
<div class="line">
<a name="l00579">
</a>
<span class="lineno">
      579
     </span>
<span class="keywordtype">
      size_t
     </span>
     ncols,
    </div>
<div class="line">
<a name="l00580">
</a>
<span class="lineno">
      580
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     *   d_cols,
    </div>
<div class="line">
<a name="l00581">
</a>
<span class="lineno">
      581
     </span>
<span class="keywordtype">
      int
     </span>
     *
     <span class="keyword">
      const
     </span>
     d_gdf_t,
    </div>
<div class="line">
<a name="l00582">
</a>
<span class="lineno">
      582
     </span>
<span class="keyword">
      const
     </span>
     ValsT*   ptr_d_agg,
    </div>
<div class="line">
<a name="l00583">
</a>
<span class="lineno">
      583
     </span>
     Reducer        fctr,
    </div>
<div class="line">
<a name="l00584">
</a>
<span class="lineno">
      584
     </span>
     IndexT*        ptr_d_indx,
    </div>
<div class="line">
<a name="l00585">
</a>
<span class="lineno">
      585
     </span>
     ValsT*         ptr_d_agg_p,
    </div>
<div class="line">
<a name="l00586">
</a>
<span class="lineno">
      586
     </span>
     IndexT*        ptr_d_kout,
    </div>
<div class="line">
<a name="l00587">
</a>
<span class="lineno">
      587
     </span>
     ValsT*         ptr_d_vout,
    </div>
<div class="line">
<a name="l00588">
</a>
<span class="lineno">
      588
     </span>
<span class="keywordtype">
      bool
     </span>
     sorted =
     <span class="keyword">
      false
     </span>
     ,
    </div>
<div class="line">
<a name="l00589">
</a>
<span class="lineno">
      589
     </span>
     cudaStream_t   stream = NULL)
    </div>
<div class="line">
<a name="l00590">
</a>
<span class="lineno">
      590
     </span>
     {
    </div>
<div class="line">
<a name="l00591">
</a>
<span class="lineno">
      591
     </span>
<span class="keywordflow">
      if
     </span>
     ( !sorted )
    </div>
<div class="line">
<a name="l00592">
</a>
<span class="lineno">
      592
     </span>
     multi_col_sort(d_cols,
     <span class="keyword">
      nullptr
     </span>
     , d_gdf_t,
     <span class="keyword">
      nullptr
     </span>
     , ncols, nrows,
     <span class="keyword">
      false
     </span>
     , ptr_d_indx,
     <span class="keyword">
      false
     </span>
     , stream);
    </div>
<div class="line">
<a name="l00593">
</a>
<span class="lineno">
      593
     </span>
</div>
<div class="line">
<a name="l00594">
</a>
<span class="lineno">
      594
     </span>
</div>
<div class="line">
<a name="l00595">
</a>
<span class="lineno">
      595
     </span>
     thrust::gather(rmm::exec_policy(stream)-&gt;on(stream),
    </div>
<div class="line">
<a name="l00596">
</a>
<span class="lineno">
      596
     </span>
     ptr_d_indx, ptr_d_indx + nrows,
     <span class="comment">
      //map[i]
     </span>
</div>
<div class="line">
<a name="l00597">
</a>
<span class="lineno">
      597
     </span>
     ptr_d_agg,
     <span class="comment">
      //source[i]
     </span>
</div>
<div class="line">
<a name="l00598">
</a>
<span class="lineno">
      598
     </span>
     ptr_d_agg_p);
     <span class="comment">
      //source[map[i]]
     </span>
</div>
<div class="line">
<a name="l00599">
</a>
<span class="lineno">
      599
     </span>
</div>
<div class="line">
<a name="l00600">
</a>
<span class="lineno">
      600
     </span>
<a class="code" href="structLesserRTTI.html">
      LesserRTTI&lt;IndexT&gt;
     </a>
     f(d_cols, d_gdf_t, ncols);
    </div>
<div class="line">
<a name="l00601">
</a>
<span class="lineno">
      601
     </span>
</div>
<div class="line">
<a name="l00602">
</a>
<span class="lineno">
      602
     </span>
     thrust::pair&lt;IndexT*, ValsT*&gt; ret =
    </div>
<div class="line">
<a name="l00603">
</a>
<span class="lineno">
      603
     </span>
     thrust::reduce_by_key(rmm::exec_policy(stream)-&gt;on(stream),
    </div>
<div class="line">
<a name="l00604">
</a>
<span class="lineno">
      604
     </span>
     ptr_d_indx, ptr_d_indx + nrows,
    </div>
<div class="line">
<a name="l00605">
</a>
<span class="lineno">
      605
     </span>
     ptr_d_agg_p,
    </div>
<div class="line">
<a name="l00606">
</a>
<span class="lineno">
      606
     </span>
     ptr_d_kout,
    </div>
<div class="line">
<a name="l00607">
</a>
<span class="lineno">
      607
     </span>
     ptr_d_vout,
    </div>
<div class="line">
<a name="l00608">
</a>
<span class="lineno">
      608
     </span>
     [f] __device__(IndexT key1, IndexT key2) {
    </div>
<div class="line">
<a name="l00609">
</a>
<span class="lineno">
      609
     </span>
<span class="keywordflow">
      return
     </span>
     f.equal(key1, key2);
    </div>
<div class="line">
<a name="l00610">
</a>
<span class="lineno">
      610
     </span>
     },
    </div>
<div class="line">
<a name="l00611">
</a>
<span class="lineno">
      611
     </span>
     fctr);
    </div>
<div class="line">
<a name="l00612">
</a>
<span class="lineno">
      612
     </span>
</div>
<div class="line">
<a name="l00613">
</a>
<span class="lineno">
      613
     </span>
<span class="keywordtype">
      size_t
     </span>
     new_sz = thrust::distance(ptr_d_vout, ret.second);
    </div>
<div class="line">
<a name="l00614">
</a>
<span class="lineno">
      614
     </span>
<span class="keywordflow">
      return
     </span>
     new_sz;
    </div>
<div class="line">
<a name="l00615">
</a>
<span class="lineno">
      615
     </span>
     }
    </div>
<div class="line">
<a name="l00616">
</a>
<span class="lineno">
      616
     </span>
</div>
<div class="line">
<a name="l00617">
</a>
<span class="lineno">
      617
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     ValsT,
    </div>
<div class="line">
<a name="l00618">
</a>
<span class="lineno">
      618
     </span>
<span class="keyword">
      typename
     </span>
     IndexT&gt;
    </div>
<div class="line">
<a name="l00619">
</a>
<span class="lineno">
      619
     </span>
<span class="keywordtype">
      size_t
     </span>
     multi_col_group_by_sum_sort(
     <span class="keywordtype">
      size_t
     </span>
     nrows,
    </div>
<div class="line">
<a name="l00620">
</a>
<span class="lineno">
      620
     </span>
<span class="keywordtype">
      size_t
     </span>
     ncols,
    </div>
<div class="line">
<a name="l00621">
</a>
<span class="lineno">
      621
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     *   d_cols,
    </div>
<div class="line">
<a name="l00622">
</a>
<span class="lineno">
      622
     </span>
<span class="keywordtype">
      int
     </span>
     *
     <span class="keyword">
      const
     </span>
     d_gdf_t,
    </div>
<div class="line">
<a name="l00623">
</a>
<span class="lineno">
      623
     </span>
<span class="keyword">
      const
     </span>
     ValsT*   ptr_d_agg,
    </div>
<div class="line">
<a name="l00624">
</a>
<span class="lineno">
      624
     </span>
     IndexT*        ptr_d_indx,
    </div>
<div class="line">
<a name="l00625">
</a>
<span class="lineno">
      625
     </span>
     ValsT*         ptr_d_agg_p,
    </div>
<div class="line">
<a name="l00626">
</a>
<span class="lineno">
      626
     </span>
     IndexT*        ptr_d_kout,
    </div>
<div class="line">
<a name="l00627">
</a>
<span class="lineno">
      627
     </span>
     ValsT*         ptr_d_vout,
    </div>
<div class="line">
<a name="l00628">
</a>
<span class="lineno">
      628
     </span>
<span class="keywordtype">
      bool
     </span>
     sorted =
     <span class="keyword">
      false
     </span>
     ,
    </div>
<div class="line">
<a name="l00629">
</a>
<span class="lineno">
      629
     </span>
     cudaStream_t   stream = NULL)
    </div>
<div class="line">
<a name="l00630">
</a>
<span class="lineno">
      630
     </span>
     {
    </div>
<div class="line">
<a name="l00631">
</a>
<span class="lineno">
      631
     </span>
<span class="keyword">
      auto
     </span>
     lamb = [] __device__ (ValsT x, ValsT y) {
    </div>
<div class="line">
<a name="l00632">
</a>
<span class="lineno">
      632
     </span>
<span class="keywordflow">
      return
     </span>
     x+y;
    </div>
<div class="line">
<a name="l00633">
</a>
<span class="lineno">
      633
     </span>
     };
    </div>
<div class="line">
<a name="l00634">
</a>
<span class="lineno">
      634
     </span>
</div>
<div class="line">
<a name="l00635">
</a>
<span class="lineno">
      635
     </span>
<span class="keyword">
      using
     </span>
     ReducerT = decltype(lamb);
    </div>
<div class="line">
<a name="l00636">
</a>
<span class="lineno">
      636
     </span>
</div>
<div class="line">
<a name="l00637">
</a>
<span class="lineno">
      637
     </span>
<span class="keywordflow">
      return
     </span>
     multi_col_group_by_sort(nrows,
    </div>
<div class="line">
<a name="l00638">
</a>
<span class="lineno">
      638
     </span>
     ncols,
    </div>
<div class="line">
<a name="l00639">
</a>
<span class="lineno">
      639
     </span>
     d_cols,
    </div>
<div class="line">
<a name="l00640">
</a>
<span class="lineno">
      640
     </span>
     d_gdf_t,
    </div>
<div class="line">
<a name="l00641">
</a>
<span class="lineno">
      641
     </span>
     ptr_d_agg,
    </div>
<div class="line">
<a name="l00642">
</a>
<span class="lineno">
      642
     </span>
     lamb,
    </div>
<div class="line">
<a name="l00643">
</a>
<span class="lineno">
      643
     </span>
     ptr_d_indx,
    </div>
<div class="line">
<a name="l00644">
</a>
<span class="lineno">
      644
     </span>
     ptr_d_agg_p,
    </div>
<div class="line">
<a name="l00645">
</a>
<span class="lineno">
      645
     </span>
     ptr_d_kout,
    </div>
<div class="line">
<a name="l00646">
</a>
<span class="lineno">
      646
     </span>
     ptr_d_vout,
    </div>
<div class="line">
<a name="l00647">
</a>
<span class="lineno">
      647
     </span>
     sorted,
    </div>
<div class="line">
<a name="l00648">
</a>
<span class="lineno">
      648
     </span>
     stream);
    </div>
<div class="line">
<a name="l00649">
</a>
<span class="lineno">
      649
     </span>
     }
    </div>
<div class="line">
<a name="l00650">
</a>
<span class="lineno">
      650
     </span>
</div>
<div class="line">
<a name="l00651">
</a>
<span class="lineno">
      651
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     ValsT,
    </div>
<div class="line">
<a name="l00652">
</a>
<span class="lineno">
      652
     </span>
<span class="keyword">
      typename
     </span>
     IndexT&gt;
    </div>
<div class="line">
<a name="l00653">
</a>
<span class="lineno">
      653
     </span>
<span class="keywordtype">
      size_t
     </span>
     multi_col_group_by_min_sort(
     <span class="keywordtype">
      size_t
     </span>
     nrows,
    </div>
<div class="line">
<a name="l00654">
</a>
<span class="lineno">
      654
     </span>
<span class="keywordtype">
      size_t
     </span>
     ncols,
    </div>
<div class="line">
<a name="l00655">
</a>
<span class="lineno">
      655
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     *   d_cols,
    </div>
<div class="line">
<a name="l00656">
</a>
<span class="lineno">
      656
     </span>
<span class="keywordtype">
      int
     </span>
     *
     <span class="keyword">
      const
     </span>
     d_gdf_t,
    </div>
<div class="line">
<a name="l00657">
</a>
<span class="lineno">
      657
     </span>
<span class="keyword">
      const
     </span>
     ValsT*   ptr_d_agg,
    </div>
<div class="line">
<a name="l00658">
</a>
<span class="lineno">
      658
     </span>
     IndexT*        ptr_d_indx,
    </div>
<div class="line">
<a name="l00659">
</a>
<span class="lineno">
      659
     </span>
     ValsT*         ptr_d_agg_p,
    </div>
<div class="line">
<a name="l00660">
</a>
<span class="lineno">
      660
     </span>
     IndexT*        ptr_d_kout,
    </div>
<div class="line">
<a name="l00661">
</a>
<span class="lineno">
      661
     </span>
     ValsT*         ptr_d_vout,
    </div>
<div class="line">
<a name="l00662">
</a>
<span class="lineno">
      662
     </span>
<span class="keywordtype">
      bool
     </span>
     sorted =
     <span class="keyword">
      false
     </span>
     ,
    </div>
<div class="line">
<a name="l00663">
</a>
<span class="lineno">
      663
     </span>
     cudaStream_t   stream = NULL)
    </div>
<div class="line">
<a name="l00664">
</a>
<span class="lineno">
      664
     </span>
     {
    </div>
<div class="line">
<a name="l00665">
</a>
<span class="lineno">
      665
     </span>
<span class="keyword">
      auto
     </span>
     lamb = [] __device__ (ValsT x, ValsT y) {
    </div>
<div class="line">
<a name="l00666">
</a>
<span class="lineno">
      666
     </span>
<span class="keywordflow">
      return
     </span>
     (x&lt;y?x:y);
    </div>
<div class="line">
<a name="l00667">
</a>
<span class="lineno">
      667
     </span>
     };
    </div>
<div class="line">
<a name="l00668">
</a>
<span class="lineno">
      668
     </span>
</div>
<div class="line">
<a name="l00669">
</a>
<span class="lineno">
      669
     </span>
<span class="keyword">
      using
     </span>
     ReducerT = decltype(lamb);
    </div>
<div class="line">
<a name="l00670">
</a>
<span class="lineno">
      670
     </span>
</div>
<div class="line">
<a name="l00671">
</a>
<span class="lineno">
      671
     </span>
<span class="keywordflow">
      return
     </span>
     multi_col_group_by_sort(nrows,
    </div>
<div class="line">
<a name="l00672">
</a>
<span class="lineno">
      672
     </span>
     ncols,
    </div>
<div class="line">
<a name="l00673">
</a>
<span class="lineno">
      673
     </span>
     d_cols,
    </div>
<div class="line">
<a name="l00674">
</a>
<span class="lineno">
      674
     </span>
     d_gdf_t,
    </div>
<div class="line">
<a name="l00675">
</a>
<span class="lineno">
      675
     </span>
     ptr_d_agg,
    </div>
<div class="line">
<a name="l00676">
</a>
<span class="lineno">
      676
     </span>
     lamb,
    </div>
<div class="line">
<a name="l00677">
</a>
<span class="lineno">
      677
     </span>
     ptr_d_indx,
    </div>
<div class="line">
<a name="l00678">
</a>
<span class="lineno">
      678
     </span>
     ptr_d_agg_p,
    </div>
<div class="line">
<a name="l00679">
</a>
<span class="lineno">
      679
     </span>
     ptr_d_kout,
    </div>
<div class="line">
<a name="l00680">
</a>
<span class="lineno">
      680
     </span>
     ptr_d_vout,
    </div>
<div class="line">
<a name="l00681">
</a>
<span class="lineno">
      681
     </span>
     sorted,
    </div>
<div class="line">
<a name="l00682">
</a>
<span class="lineno">
      682
     </span>
     stream);
    </div>
<div class="line">
<a name="l00683">
</a>
<span class="lineno">
      683
     </span>
     }
    </div>
<div class="line">
<a name="l00684">
</a>
<span class="lineno">
      684
     </span>
</div>
<div class="line">
<a name="l00685">
</a>
<span class="lineno">
      685
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     ValsT,
    </div>
<div class="line">
<a name="l00686">
</a>
<span class="lineno">
      686
     </span>
<span class="keyword">
      typename
     </span>
     IndexT&gt;
    </div>
<div class="line">
<a name="l00687">
</a>
<span class="lineno">
      687
     </span>
<span class="keywordtype">
      size_t
     </span>
     multi_col_group_by_max_sort(
     <span class="keywordtype">
      size_t
     </span>
     nrows,
    </div>
<div class="line">
<a name="l00688">
</a>
<span class="lineno">
      688
     </span>
<span class="keywordtype">
      size_t
     </span>
     ncols,
    </div>
<div class="line">
<a name="l00689">
</a>
<span class="lineno">
      689
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     *   d_cols,
    </div>
<div class="line">
<a name="l00690">
</a>
<span class="lineno">
      690
     </span>
<span class="keywordtype">
      int
     </span>
     *
     <span class="keyword">
      const
     </span>
     d_gdf_t,
    </div>
<div class="line">
<a name="l00691">
</a>
<span class="lineno">
      691
     </span>
<span class="keyword">
      const
     </span>
     ValsT*   ptr_d_agg,
    </div>
<div class="line">
<a name="l00692">
</a>
<span class="lineno">
      692
     </span>
     IndexT*        ptr_d_indx,
    </div>
<div class="line">
<a name="l00693">
</a>
<span class="lineno">
      693
     </span>
     ValsT*         ptr_d_agg_p,
    </div>
<div class="line">
<a name="l00694">
</a>
<span class="lineno">
      694
     </span>
     IndexT*        ptr_d_kout,
    </div>
<div class="line">
<a name="l00695">
</a>
<span class="lineno">
      695
     </span>
     ValsT*         ptr_d_vout,
    </div>
<div class="line">
<a name="l00696">
</a>
<span class="lineno">
      696
     </span>
<span class="keywordtype">
      bool
     </span>
     sorted =
     <span class="keyword">
      false
     </span>
     ,
    </div>
<div class="line">
<a name="l00697">
</a>
<span class="lineno">
      697
     </span>
     cudaStream_t   stream = NULL)
    </div>
<div class="line">
<a name="l00698">
</a>
<span class="lineno">
      698
     </span>
     {
    </div>
<div class="line">
<a name="l00699">
</a>
<span class="lineno">
      699
     </span>
<span class="keyword">
      auto
     </span>
     lamb = [] __device__ (ValsT x, ValsT y) {
    </div>
<div class="line">
<a name="l00700">
</a>
<span class="lineno">
      700
     </span>
<span class="keywordflow">
      return
     </span>
     (x&gt;y?x:y);
    </div>
<div class="line">
<a name="l00701">
</a>
<span class="lineno">
      701
     </span>
     };
    </div>
<div class="line">
<a name="l00702">
</a>
<span class="lineno">
      702
     </span>
</div>
<div class="line">
<a name="l00703">
</a>
<span class="lineno">
      703
     </span>
<span class="keyword">
      using
     </span>
     ReducerT = decltype(lamb);
    </div>
<div class="line">
<a name="l00704">
</a>
<span class="lineno">
      704
     </span>
</div>
<div class="line">
<a name="l00705">
</a>
<span class="lineno">
      705
     </span>
<span class="keywordflow">
      return
     </span>
     multi_col_group_by_sort(nrows,
    </div>
<div class="line">
<a name="l00706">
</a>
<span class="lineno">
      706
     </span>
     ncols,
    </div>
<div class="line">
<a name="l00707">
</a>
<span class="lineno">
      707
     </span>
     d_cols,
    </div>
<div class="line">
<a name="l00708">
</a>
<span class="lineno">
      708
     </span>
     d_gdf_t,
    </div>
<div class="line">
<a name="l00709">
</a>
<span class="lineno">
      709
     </span>
     ptr_d_agg,
    </div>
<div class="line">
<a name="l00710">
</a>
<span class="lineno">
      710
     </span>
     lamb,
    </div>
<div class="line">
<a name="l00711">
</a>
<span class="lineno">
      711
     </span>
     ptr_d_indx,
    </div>
<div class="line">
<a name="l00712">
</a>
<span class="lineno">
      712
     </span>
     ptr_d_agg_p,
    </div>
<div class="line">
<a name="l00713">
</a>
<span class="lineno">
      713
     </span>
     ptr_d_kout,
    </div>
<div class="line">
<a name="l00714">
</a>
<span class="lineno">
      714
     </span>
     ptr_d_vout,
    </div>
<div class="line">
<a name="l00715">
</a>
<span class="lineno">
      715
     </span>
     sorted,
    </div>
<div class="line">
<a name="l00716">
</a>
<span class="lineno">
      716
     </span>
     stream);
    </div>
<div class="line">
<a name="l00717">
</a>
<span class="lineno">
      717
     </span>
     }
    </div>
<div class="line">
<a name="l00718">
</a>
<span class="lineno">
      718
     </span>
</div>
<div class="line">
<a name="l00719">
</a>
<span class="lineno">
      719
     </span>
</div>
<div class="line">
<a name="l00720">
</a>
<span class="lineno">
      720
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     ValsT,
    </div>
<div class="line">
<a name="l00721">
</a>
<span class="lineno">
      721
     </span>
<span class="keyword">
      typename
     </span>
     IndexT&gt;
    </div>
<div class="line">
<a name="l00722">
</a>
<span class="lineno">
      722
     </span>
<span class="keywordtype">
      size_t
     </span>
     multi_col_group_by_avg_sort(
     <span class="keywordtype">
      size_t
     </span>
     nrows,
    </div>
<div class="line">
<a name="l00723">
</a>
<span class="lineno">
      723
     </span>
<span class="keywordtype">
      size_t
     </span>
     ncols,
    </div>
<div class="line">
<a name="l00724">
</a>
<span class="lineno">
      724
     </span>
<span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     *   d_cols,
    </div>
<div class="line">
<a name="l00725">
</a>
<span class="lineno">
      725
     </span>
<span class="keywordtype">
      int
     </span>
     *
     <span class="keyword">
      const
     </span>
     d_gdf_t,
    </div>
<div class="line">
<a name="l00726">
</a>
<span class="lineno">
      726
     </span>
<span class="keyword">
      const
     </span>
     ValsT*   ptr_d_agg,
    </div>
<div class="line">
<a name="l00727">
</a>
<span class="lineno">
      727
     </span>
     IndexT*        ptr_d_indx,
    </div>
<div class="line">
<a name="l00728">
</a>
<span class="lineno">
      728
     </span>
     IndexT*        ptr_d_cout,
    </div>
<div class="line">
<a name="l00729">
</a>
<span class="lineno">
      729
     </span>
     ValsT*         ptr_d_agg_p,
    </div>
<div class="line">
<a name="l00730">
</a>
<span class="lineno">
      730
     </span>
     IndexT*        ptr_d_kout,
    </div>
<div class="line">
<a name="l00731">
</a>
<span class="lineno">
      731
     </span>
     ValsT*         ptr_d_vout,
    </div>
<div class="line">
<a name="l00732">
</a>
<span class="lineno">
      732
     </span>
<span class="keywordtype">
      bool
     </span>
     sorted =
     <span class="keyword">
      false
     </span>
     ,
    </div>
<div class="line">
<a name="l00733">
</a>
<span class="lineno">
      733
     </span>
     cudaStream_t   stream = NULL)
    </div>
<div class="line">
<a name="l00734">
</a>
<span class="lineno">
      734
     </span>
     {
    </div>
<div class="line">
<a name="l00735">
</a>
<span class="lineno">
      735
     </span>
     multi_col_group_by_count_sort(nrows,
    </div>
<div class="line">
<a name="l00736">
</a>
<span class="lineno">
      736
     </span>
     ncols,
    </div>
<div class="line">
<a name="l00737">
</a>
<span class="lineno">
      737
     </span>
     d_cols,
    </div>
<div class="line">
<a name="l00738">
</a>
<span class="lineno">
      738
     </span>
     d_gdf_t,
    </div>
<div class="line">
<a name="l00739">
</a>
<span class="lineno">
      739
     </span>
     ptr_d_indx,
    </div>
<div class="line">
<a name="l00740">
</a>
<span class="lineno">
      740
     </span>
     ptr_d_kout,
    </div>
<div class="line">
<a name="l00741">
</a>
<span class="lineno">
      741
     </span>
     ptr_d_cout,
    </div>
<div class="line">
<a name="l00742">
</a>
<span class="lineno">
      742
     </span>
     sorted,
    </div>
<div class="line">
<a name="l00743">
</a>
<span class="lineno">
      743
     </span>
     stream);
    </div>
<div class="line">
<a name="l00744">
</a>
<span class="lineno">
      744
     </span>
</div>
<div class="line">
<a name="l00745">
</a>
<span class="lineno">
      745
     </span>
<span class="keywordtype">
      size_t
     </span>
     new_sz =  multi_col_group_by_sum_sort(nrows,
    </div>
<div class="line">
<a name="l00746">
</a>
<span class="lineno">
      746
     </span>
     ncols,
    </div>
<div class="line">
<a name="l00747">
</a>
<span class="lineno">
      747
     </span>
     d_cols,
    </div>
<div class="line">
<a name="l00748">
</a>
<span class="lineno">
      748
     </span>
     d_gdf_t,
    </div>
<div class="line">
<a name="l00749">
</a>
<span class="lineno">
      749
     </span>
     ptr_d_agg,
    </div>
<div class="line">
<a name="l00750">
</a>
<span class="lineno">
      750
     </span>
     ptr_d_indx,
    </div>
<div class="line">
<a name="l00751">
</a>
<span class="lineno">
      751
     </span>
     ptr_d_agg_p,
    </div>
<div class="line">
<a name="l00752">
</a>
<span class="lineno">
      752
     </span>
     ptr_d_kout,
    </div>
<div class="line">
<a name="l00753">
</a>
<span class="lineno">
      753
     </span>
     ptr_d_vout,
    </div>
<div class="line">
<a name="l00754">
</a>
<span class="lineno">
      754
     </span>
     sorted,
    </div>
<div class="line">
<a name="l00755">
</a>
<span class="lineno">
      755
     </span>
     stream);
    </div>
<div class="line">
<a name="l00756">
</a>
<span class="lineno">
      756
     </span>
</div>
<div class="line">
<a name="l00757">
</a>
<span class="lineno">
      757
     </span>
</div>
<div class="line">
<a name="l00758">
</a>
<span class="lineno">
      758
     </span>
     thrust::transform(rmm::exec_policy(stream)-&gt;on(stream),
    </div>
<div class="line">
<a name="l00759">
</a>
<span class="lineno">
      759
     </span>
     ptr_d_cout, ptr_d_cout + nrows,
    </div>
<div class="line">
<a name="l00760">
</a>
<span class="lineno">
      760
     </span>
     ptr_d_vout,
    </div>
<div class="line">
<a name="l00761">
</a>
<span class="lineno">
      761
     </span>
     ptr_d_vout,
    </div>
<div class="line">
<a name="l00762">
</a>
<span class="lineno">
      762
     </span>
     [] __device__ (IndexT n, ValsT sum) {
    </div>
<div class="line">
<a name="l00763">
</a>
<span class="lineno">
      763
     </span>
<span class="keywordflow">
      return
     </span>
     sum/
     <span class="keyword">
      static_cast&lt;
     </span>
     ValsT
     <span class="keyword">
      &gt;
     </span>
     (n);
    </div>
<div class="line">
<a name="l00764">
</a>
<span class="lineno">
      764
     </span>
     });
    </div>
<div class="line">
<a name="l00765">
</a>
<span class="lineno">
      765
     </span>
</div>
<div class="line">
<a name="l00766">
</a>
<span class="lineno">
      766
     </span>
<span class="keywordflow">
      return
     </span>
     new_sz;
    </div>
<div class="line">
<a name="l00767">
</a>
<span class="lineno">
      767
     </span>
     }
    </div>
<div class="line">
<a name="l00768">
</a>
<span class="lineno">
      768
     </span>
</div>
<div class="line">
<a name="l00769">
</a>
<span class="lineno">
      769
     </span>
<span class="comment">
      /* --------------------------------------------------------------------------*/
     </span>
</div>
<div class="line">
<a name="l00788">
</a>
<span class="lineno">
      788
     </span>
<span class="comment">
      /* ----------------------------------------------------------------------------*/
     </span>
</div>
<div class="line">
<a name="l00789">
</a>
<span class="lineno">
      789
     </span>
<span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     IndexT&gt;
    </div>
<div class="line">
<a name="l00790">
</a>
<span class="lineno">
      790
     </span>
<span class="keywordtype">
      void
     </span>
     multi_col_sort(
     <span class="keywordtype">
      void
     </span>
     *
     <span class="keyword">
      const
     </span>
     *           d_cols,
    </div>
<div class="line">
<a name="l00791">
</a>
<span class="lineno">
      791
     </span>
     gdf_valid_type*
     <span class="keyword">
      const
     </span>
     * d_valids,
    </div>
<div class="line">
<a name="l00792">
</a>
<span class="lineno">
      792
     </span>
<span class="keywordtype">
      int
     </span>
     *                    d_col_types,
    </div>
<div class="line">
<a name="l00793">
</a>
<span class="lineno">
      793
     </span>
     int8_t*                 d_asc_desc,
    </div>
<div class="line">
<a name="l00794">
</a>
<span class="lineno">
      794
     </span>
<span class="keywordtype">
      size_t
     </span>
     ncols,
    </div>
<div class="line">
<a name="l00795">
</a>
<span class="lineno">
      795
     </span>
<span class="keywordtype">
      size_t
     </span>
     nrows,
    </div>
<div class="line">
<a name="l00796">
</a>
<span class="lineno">
      796
     </span>
<span class="keywordtype">
      bool
     </span>
     have_nulls,
    </div>
<div class="line">
<a name="l00797">
</a>
<span class="lineno">
      797
     </span>
     IndexT*                 d_indx,
    </div>
<div class="line">
<a name="l00798">
</a>
<span class="lineno">
      798
     </span>
<span class="keywordtype">
      bool
     </span>
     nulls_are_smallest =
     <span class="keyword">
      false
     </span>
     ,
    </div>
<div class="line">
<a name="l00799">
</a>
<span class="lineno">
      799
     </span>
     cudaStream_t            stream = NULL)
    </div>
<div class="line">
<a name="l00800">
</a>
<span class="lineno">
      800
     </span>
     {
    </div>
<div class="line">
<a name="l00801">
</a>
<span class="lineno">
      801
     </span>
<span class="comment">
      //cannot use counting_iterator 2 reasons:
     </span>
</div>
<div class="line">
<a name="l00802">
</a>
<span class="lineno">
      802
     </span>
<span class="comment">
      //(1.) need to return a container result;
     </span>
</div>
<div class="line">
<a name="l00803">
</a>
<span class="lineno">
      803
     </span>
<span class="comment">
      //(2.) that container must be mutable;
     </span>
</div>
<div class="line">
<a name="l00804">
</a>
<span class="lineno">
      804
     </span>
     thrust::sequence(rmm::exec_policy(stream)-&gt;on(stream), d_indx, d_indx+nrows, 0);
    </div>
<div class="line">
<a name="l00805">
</a>
<span class="lineno">
      805
     </span>
</div>
<div class="line">
<a name="l00806">
</a>
<span class="lineno">
      806
     </span>
<a class="code" href="structLesserRTTI.html">
      LesserRTTI&lt;IndexT&gt;
     </a>
     comp(d_cols, d_valids, d_col_types, d_asc_desc, ncols, nulls_are_smallest);
    </div>
<div class="line">
<a name="l00807">
</a>
<span class="lineno">
      807
     </span>
<span class="keywordflow">
      if
     </span>
     (d_valids !=
     <span class="keyword">
      nullptr
     </span>
     &amp;&amp; have_nulls) {
    </div>
<div class="line">
<a name="l00808">
</a>
<span class="lineno">
      808
     </span>
     thrust::sort(rmm::exec_policy(stream)-&gt;on(stream),
    </div>
<div class="line">
<a name="l00809">
</a>
<span class="lineno">
      809
     </span>
     d_indx, d_indx+nrows,
    </div>
<div class="line">
<a name="l00810">
</a>
<span class="lineno">
      810
     </span>
     [comp] __device__ (IndexT i1, IndexT i2){
    </div>
<div class="line">
<a name="l00811">
</a>
<span class="lineno">
      811
     </span>
<span class="keywordflow">
      return
     </span>
     comp.asc_desc_comparison_with_nulls(i1, i2);
    </div>
<div class="line">
<a name="l00812">
</a>
<span class="lineno">
      812
     </span>
     });
    </div>
<div class="line">
<a name="l00813">
</a>
<span class="lineno">
      813
     </span>
     }
    </div>
<div class="line">
<a name="l00814">
</a>
<span class="lineno">
      814
     </span>
<span class="keywordflow">
      else
     </span>
     {
    </div>
<div class="line">
<a name="l00815">
</a>
<span class="lineno">
      815
     </span>
     thrust::sort(rmm::exec_policy(stream)-&gt;on(stream),
    </div>
<div class="line">
<a name="l00816">
</a>
<span class="lineno">
      816
     </span>
     d_indx, d_indx+nrows,
    </div>
<div class="line">
<a name="l00817">
</a>
<span class="lineno">
      817
     </span>
     [comp] __device__ (IndexT i1, IndexT i2) {
    </div>
<div class="line">
<a name="l00818">
</a>
<span class="lineno">
      818
     </span>
<span class="keywordflow">
      return
     </span>
     comp.asc_desc_comparison(i1, i2);
    </div>
<div class="line">
<a name="l00819">
</a>
<span class="lineno">
      819
     </span>
     });
    </div>
<div class="line">
<a name="l00820">
</a>
<span class="lineno">
      820
     </span>
     }
    </div>
<div class="line">
<a name="l00821">
</a>
<span class="lineno">
      821
     </span>
     }
    </div>
<div class="ttc" id="structLesserRTTI_html_a2f39aeae6ff44daeb676080f0933add0">
<div class="ttname">
<a href="structLesserRTTI.html#a2f39aeae6ff44daeb676080f0933add0">
       LesserRTTI::asc_desc_comparison
      </a>
</div>
<div class="ttdeci">
      __device__ bool asc_desc_comparison(IndexT row1, IndexT row2) const
     </div>
<div class="ttdef">
<b>
       Definition:
      </b>
      sqls_rtti_comp.h:70
     </div>
</div>
<div class="ttc" id="structLesserRTTI_html">
<div class="ttname">
<a href="structLesserRTTI.html">
       LesserRTTI
      </a>
</div>
<div class="ttdef">
<b>
       Definition:
      </b>
      sqls_rtti_comp.h:32
     </div>
</div>
</div>
<!-- fragment -->
</div>
<!-- contents -->
<!-- start footer part -->
<hr class="footer"/>
<address class="footer">
<small>
    Generated by
    <a href="http://www.doxygen.org/index.html">
<img alt="doxygen" class="footer" src="doxygen.png"/>
</a>
    1.8.14
   </small>
</address>
<script defer id="rapids-selector-js" src="/assets/js/custom.js"></script></body>
</html>
