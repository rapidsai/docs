

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>10 minutes to CLX &mdash; clx 0.12.0a documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/params.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CLX Workflow" href="intro-clx-workflow.html" />
    <link rel="prev" title="API Reference" href="api.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> clx
          

          
          </a>

          
            
            
              <div class="version">
                0.12
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">10 minutes to CLX</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#What-are-these-libraries?">What are these libraries?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#When-to-use-CLX">When to use CLX</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Log-Parsing">Log Parsing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Cyber-Data-Types">Cyber Data Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#IPv4">IPv4</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Convert-IPv4-values-to-integers">Convert IPv4 values to integers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Check-if-IPv4-values-are-multicast">Check if IPv4 values are multicast</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#TLD-Extraction">TLD Extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Machine-Learning">Machine Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Workflows">Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Open-Source-Threat-Intelligence-Integration">Open Source Threat Intelligence Integration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="intro-clx-workflow.html">CLX Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro-clx-dga.html">CLX DGA Detection</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">clx</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>10 minutes to CLX</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/10min-clx.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="10-minutes-to-CLX">
<h1>10 minutes to CLX<a class="headerlink" href="#10-minutes-to-CLX" title="Permalink to this headline">¶</a></h1>
<p>This is a short introduction to CLX geared mainly towards new users of the code.</p>
<div class="section" id="What-are-these-libraries?">
<h2>What are these libraries?<a class="headerlink" href="#What-are-these-libraries?" title="Permalink to this headline">¶</a></h2>
<p>CLX (Cyber Log Accelerators) provides a simple API for security analysts, data scientists, and engineers to quickly get started applying RAPIDS to real-world cyber use cases. CLX uses the GPU dataframe (<a class="reference external" href="https://github.com/rapidsai/cudf">cuDF</a>) and other RAPIDS packages to execute cybersecurity and information security workflows. The following packages are available:</p>
<ul class="simple">
<li><p>analytics - Machine learning and statistics functionality</p></li>
<li><p>ip - IPv4 data translation and parsing</p></li>
<li><p>parsers - Cyber log Event parsing</p></li>
<li><p>io - Input and output features for a workflow</p></li>
<li><p>workflow - Workflow which receives input data and produces analytical output data</p></li>
<li><p>osi - Open source integration (VirusTotal, FarsightDB and Whois)</p></li>
<li><p>dns - TLD extraction</p></li>
</ul>
</div>
<div class="section" id="When-to-use-CLX">
<h2>When to use CLX<a class="headerlink" href="#When-to-use-CLX" title="Permalink to this headline">¶</a></h2>
<p>Use CLX to build your cyber data analytics workflows for a GPU-accelerated environmetn using RAPIDS. CLX contains common cyber and cyber ML functionality, such as log parsing for specific data sources, cyber data type parsing (e.g., IPv4), and DGA detection. CLX also provides the ability to integrate this functionality into a CLX workflow, which simplifies execution of the series of parsing and ML functions needed for end-to-end use cases.</p>
</div>
<div class="section" id="Log-Parsing">
<h2>Log Parsing<a class="headerlink" href="#Log-Parsing" title="Permalink to this headline">¶</a></h2>
<p>CLX provides traditional parsers for some common log types. Here’s an example parsing a common <a class="reference external" href="https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/default.aspx">Windows Event Log</a> of event code type <a class="reference external" href="https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=4770">4770</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">cudf</span>
<span class="kn">from</span> <span class="nn">clx.parsers.windows_event_parser</span> <span class="kn">import</span> <span class="n">WindowsEventParser</span>
<span class="n">event</span> <span class="o">=</span> <span class="s2">&quot;04/03/2019 11:58:59 AM</span><span class="se">\\</span><span class="s2">nLogName=Security</span><span class="se">\\</span><span class="s2">nSourceName=Microsoft Windows security auditing.</span><span class="se">\\</span><span class="s2">nEventCode=5156</span><span class="se">\\</span><span class="s2">nEventType=0</span><span class="se">\\</span><span class="s2">nType=Information</span><span class="se">\\</span><span class="s2">nComputerName=user234.test.com</span><span class="se">\\</span><span class="s2">nTaskCategory=Filtering Platform Connection</span><span class="se">\\</span><span class="s2">nOpCode=Info</span><span class="se">\\</span><span class="s2">nRecordNumber=241754521</span><span class="se">\\</span><span class="s2">nKeywords=Audit Success</span><span class="se">\\</span><span class="s2">nMessage=The Windows Filtering Platform has permitted a connection.</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">nApplication Information:</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tProcess ID:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">t4</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tApplication Name:</span><span class="se">\\</span><span class="s2">tSystem</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">nNetwork Information:</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tDirection:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">tInbound</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tSource Address:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">t100.20.100.20</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tSource Port:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">t138</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tDestination Address:</span><span class="se">\\</span><span class="s2">t100.20.100.30</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tDestination Port:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">t138</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tProtocol:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">t17</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">nFilter Information:</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tFilter Run-Time ID:</span><span class="se">\\</span><span class="s2">t0</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tLayer Name:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">tReceive/Accept</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tLayer Run-Time ID:</span><span class="se">\\</span><span class="s2">t44&quot;</span>
<span class="n">wep</span> <span class="o">=</span> <span class="n">WindowsEventParser</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;raw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span><span class="p">]</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">wep</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;raw&#39;</span><span class="p">)</span>
<span class="n">result_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>service_information_service_id</th>
      <th>target_account_old_account_name</th>
      <th>service_service_name</th>
      <th>group_group_name</th>
      <th>changed_attributes_account_expires</th>
      <th>detailed_authentication_information_key_length</th>
      <th>additional_information_result_code</th>
      <th>account_information_security_id</th>
      <th>changed_attributes_user_account_control</th>
      <th>process_information_caller_process_id</th>
      <th>...</th>
      <th>changed_attributes_old_uac_value</th>
      <th>attributes_profile_path</th>
      <th>attributes_user_account_control</th>
      <th>account_for_which_logon_failed_account_domain</th>
      <th>account_whose_credentials_were_used_account_domain</th>
      <th>new_logon_logon_guid</th>
      <th>service_server</th>
      <th>attributes_home_directory</th>
      <th>failure_information_status</th>
      <th>failure_information_sub_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>1 rows × 131 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Cyber-Data-Types">
<h2>Cyber Data Types<a class="headerlink" href="#Cyber-Data-Types" title="Permalink to this headline">¶</a></h2>
<p>CLX provides the ability to work with different data types that are specific to cybersecurity, such as IPv4 and DNS. Here’s an example of how to get started.</p>
<div class="section" id="IPv4">
<h3>IPv4<a class="headerlink" href="#IPv4" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/IPv4">IPv4</a> data type is still commonly used and present in log files. Below we demonstrate functionality. Additional operations are available in the <code class="docutils literal notranslate"><span class="pre">clx.ip</span></code> module.</p>
<div class="section" id="Convert-IPv4-values-to-integers">
<h4>Convert IPv4 values to integers<a class="headerlink" href="#Convert-IPv4-values-to-integers" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">clx.ip</span>
<span class="kn">import</span> <span class="nn">cudf</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;5.79.97.178&quot;</span><span class="p">,</span> <span class="s2">&quot;94.130.74.45&quot;</span><span class="p">])</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">clx</span><span class="o">.</span><span class="n">ip</span><span class="o">.</span><span class="n">ip_to_int</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0      89088434
1    1585596973
dtype: int64
</pre></div></div>
</div>
</div>
<div class="section" id="Check-if-IPv4-values-are-multicast">
<h4>Check if IPv4 values are multicast<a class="headerlink" href="#Check-if-IPv4-values-are-multicast" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">clx.ip</span>
<span class="kn">import</span> <span class="nn">cudf</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;224.0.0.0&quot;</span><span class="p">,</span> <span class="s2">&quot;239.255.255.255&quot;</span><span class="p">,</span> <span class="s2">&quot;5.79.97.178&quot;</span><span class="p">])</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">clx</span><span class="o">.</span><span class="n">ip</span><span class="o">.</span><span class="n">is_multicast</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0     True
1     True
2    False
dtype: bool
</pre></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="TLD-Extraction">
<h2>TLD Extraction<a class="headerlink" href="#TLD-Extraction" title="Permalink to this headline">¶</a></h2>
<p>CLX provides the ability to extract the TLD from the registered domain and subdomains of a URL, using the public suffix list.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">cudf</span>
<span class="kn">from</span> <span class="nn">clx.dns</span> <span class="kn">import</span> <span class="n">dns_extractor</span> <span class="k">as</span> <span class="n">dns</span>

<span class="n">input_df</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;http://www.google.com&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gmail.com&quot;</span><span class="p">,</span>
            <span class="s2">&quot;github.com&quot;</span><span class="p">,</span>
            <span class="s2">&quot;https://pandas.pydata.org&quot;</span><span class="p">,</span>
            <span class="s2">&quot;http://www.worldbank.org.kg/&quot;</span><span class="p">,</span>
            <span class="s2">&quot;waiterrant.blogspot.com&quot;</span><span class="p">,</span>
            <span class="s2">&quot;http://forums.news.cnn.com.ac/&quot;</span><span class="p">,</span>
            <span class="s2">&quot;http://forums.news.cnn.ac/&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ftp://b.cnn.com/&quot;</span><span class="p">,</span>
            <span class="s2">&quot;a.news.uk&quot;</span><span class="p">,</span>
            <span class="s2">&quot;a.news.co.uk&quot;</span><span class="p">,</span>
            <span class="s2">&quot;https://a.news.co.uk&quot;</span><span class="p">,</span>
            <span class="s2">&quot;107-193-100-2.lightspeed.cicril.sbcglobal.net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;a23-44-13-2.deploy.static.akamaitechnologies.com&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">output_df</span> <span class="o">=</span> <span class="n">dns</span><span class="o">.</span><span class="n">parse_url</span><span class="p">(</span><span class="n">input_df</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">])</span>
<span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hostname</th>
      <th>domain</th>
      <th>suffix</th>
      <th>subdomain</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>www.google.com</td>
      <td>google</td>
      <td>com</td>
      <td>www</td>
    </tr>
    <tr>
      <th>1</th>
      <td>gmail.com</td>
      <td>gmail</td>
      <td>com</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>github.com</td>
      <td>github</td>
      <td>com</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>pandas.pydata.org</td>
      <td>pydata</td>
      <td>org</td>
      <td>pandas</td>
    </tr>
    <tr>
      <th>4</th>
      <td>www.worldbank.org.kg</td>
      <td>worldbank</td>
      <td>org.kg</td>
      <td>www</td>
    </tr>
    <tr>
      <th>5</th>
      <td>waiterrant.blogspot.com</td>
      <td>waiterrant</td>
      <td>blogspot.com</td>
      <td></td>
    </tr>
    <tr>
      <th>6</th>
      <td>forums.news.cnn.com.ac</td>
      <td>cnn</td>
      <td>com.ac</td>
      <td>forums.news</td>
    </tr>
    <tr>
      <th>7</th>
      <td>forums.news.cnn.ac</td>
      <td>cnn</td>
      <td>ac</td>
      <td>forums.news</td>
    </tr>
    <tr>
      <th>8</th>
      <td>b.cnn.com</td>
      <td>cnn</td>
      <td>com</td>
      <td>b</td>
    </tr>
    <tr>
      <th>9</th>
      <td>a.news.uk</td>
      <td>news</td>
      <td>uk</td>
      <td>a</td>
    </tr>
    <tr>
      <th>10</th>
      <td>a.news.co.uk</td>
      <td>news</td>
      <td>co.uk</td>
      <td>a</td>
    </tr>
    <tr>
      <th>11</th>
      <td>a.news.co.uk</td>
      <td>news</td>
      <td>co.uk</td>
      <td>a</td>
    </tr>
    <tr>
      <th>12</th>
      <td>107-193-100-2.lightspeed.cicril.sbcglobal.net</td>
      <td>sbcglobal</td>
      <td>net</td>
      <td>107-193-100-2.lightspeed.cicril</td>
    </tr>
    <tr>
      <th>13</th>
      <td>a23-44-13-2.deploy.static.akamaitechnologies.com</td>
      <td>akamaitechnologies</td>
      <td>com</td>
      <td>a23-44-13-2.deploy.static</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Machine-Learning">
<h2>Machine Learning<a class="headerlink" href="#Machine-Learning" title="Permalink to this headline">¶</a></h2>
<p>CLX offers machine learning and statistcs functions that are ready to integrate into your CLX workflow.</p>
<p>Calculate a rolling z-score on a given cuDF series.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">clx.analytics.stats</span>
<span class="kn">import</span> <span class="nn">cudf</span>
<span class="n">sequence</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">98</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
<span class="n">series</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
<span class="n">zscores_df</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">zscores_df</span><span class="p">[</span><span class="s1">&#39;zscore&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clx</span><span class="o">.</span><span class="n">analytics</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rzscore</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">zscores_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          zscore
0           null
1           null
2           null
3           null
4           null
5           null
6    2.374423424
7   -0.645941275
8   -0.683973734
9    0.158832461
10   1.847751909
11   0.880026019
12  -0.950835449
13  -0.360593742
14   0.111407599
15   1.228914145
16  -0.074966331
17  -0.570321249
18   0.327849973
19  -0.934372308
20   2.296828498
21   1.282966989
22  -0.795223674
</pre></div></div>
</div>
</div>
<div class="section" id="Workflows">
<h2>Workflows<a class="headerlink" href="#Workflows" title="Permalink to this headline">¶</a></h2>
<p>Now that we’ve demonstrated the basics of CLX , let’s try to tie some of this functionality into a CLX workflow. A workflow is defined as a function that receives a cuDF dataframe, performs some operations on it, and then returns an output cuDF dataframe. In our use case, we decide to show how to parse raw WinEVT data within a workflow.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">cudf</span>
<span class="kn">from</span> <span class="nn">clx.workflow.workflow</span> <span class="kn">import</span> <span class="n">Workflow</span>
<span class="kn">from</span> <span class="nn">clx.parsers.windows_event_parser</span> <span class="kn">import</span> <span class="n">WindowsEventParser</span>

<span class="n">wep</span> <span class="o">=</span> <span class="n">WindowsEventParser</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">LogParseWorkflow</span><span class="p">(</span><span class="n">Workflow</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">workflow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">wep</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="s2">&quot;raw&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

<span class="n">input_df</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">input_df</span><span class="p">[</span><span class="s2">&quot;raw&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;04/03/2019 11:58:59 AM</span><span class="se">\\</span><span class="s2">nLogName=Security</span><span class="se">\\</span><span class="s2">nSourceName=Microsoft Windows security auditing.</span><span class="se">\\</span><span class="s2">nEventCode=5156</span><span class="se">\\</span><span class="s2">nEventType=0</span><span class="se">\\</span><span class="s2">nType=Information</span><span class="se">\\</span><span class="s2">nComputerName=user234.test.com</span><span class="se">\\</span><span class="s2">nTaskCategory=Filtering Platform Connection</span><span class="se">\\</span><span class="s2">nOpCode=Info</span><span class="se">\\</span><span class="s2">nRecordNumber=241754521</span><span class="se">\\</span><span class="s2">nKeywords=Audit Success</span><span class="se">\\</span><span class="s2">nMessage=The Windows Filtering Platform has permitted a connection.</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">nApplication Information:</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tProcess ID:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">t4</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tApplication Name:</span><span class="se">\\</span><span class="s2">tSystem</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">nNetwork Information:</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tDirection:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">tInbound</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tSource Address:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">t100.20.100.20</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tSource Port:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">t138</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tDestination Address:</span><span class="se">\\</span><span class="s2">t100.20.100.30</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tDestination Port:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">t138</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tProtocol:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">t17</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">nFilter Information:</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tFilter Run-Time ID:</span><span class="se">\\</span><span class="s2">t0</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tLayer Name:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">tReceive/Accept</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tLayer Run-Time ID:</span><span class="se">\\</span><span class="s2">t44&quot;</span><span class="p">]</span>
<span class="n">lpw</span> <span class="o">=</span> <span class="n">LogParseWorkflow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;my-log-parsing-workflow&quot;</span><span class="p">)</span>
<span class="n">lpw</span><span class="o">.</span><span class="n">workflow</span><span class="p">(</span><span class="n">input_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>member_account_name</th>
      <th>attributes_password_last_set</th>
      <th>service_service_name</th>
      <th>attributes_profile_path</th>
      <th>account_information_security_id</th>
      <th>additional_information_transited_services</th>
      <th>additional_information_caller_computer_name</th>
      <th>network_information_direction</th>
      <th>new_logon_account_name</th>
      <th>changed_attributes_home_drive</th>
      <th>...</th>
      <th>certificate_information_certificate_issuer_name</th>
      <th>network_information_source_network_address</th>
      <th>service_information_service_name</th>
      <th>privileges</th>
      <th>account_for_which_logon_failed_account_domain</th>
      <th>network_information_network_address</th>
      <th>service_server</th>
      <th>new_account_account_name</th>
      <th>user_account_name</th>
      <th>attributes_user_account_control</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>inbound</td>
      <td></td>
      <td></td>
      <td>...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>1 rows × 131 columns</p>
</div></div>
</div>
<div class="line-block">
<div class="line">A workflow can receive and output data from different locations, including CSV files and Kafka. To integrate I/O into your workflow, simply indicate your workflow configurations within a <code class="docutils literal notranslate"><span class="pre">workflow.yaml</span></code> file or define your configurations at instantiation within a python dictionary.</div>
<div class="line">The workflow class will first look for any configuration file here:</div>
</div>
<ul class="simple">
<li><p>/etc/clx/[workflow-name]/workflow.yaml then</p></li>
<li><p>~/.config/clx/[workflow-name]/workflow.yaml</p></li>
</ul>
<p>To learn more about workflow configurations visit the <a class="reference external" href="./intro-clx-workflow.html">CLX Workflow</a> page</p>
<p>To demonstrate the input functionality, we’ll create a small CSV input file.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">cudf</span>
<span class="n">input_df</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">input_df</span><span class="p">[</span><span class="s2">&quot;raw&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;04/03/2019 11:58:59 AM</span><span class="se">\\</span><span class="s2">nLogName=Security</span><span class="se">\\</span><span class="s2">nSourceName=Microsoft Windows security auditing.</span><span class="se">\\</span><span class="s2">nEventCode=5156</span><span class="se">\\</span><span class="s2">nEventType=0</span><span class="se">\\</span><span class="s2">nType=Information</span><span class="se">\\</span><span class="s2">nComputerName=user234.test.com</span><span class="se">\\</span><span class="s2">nTaskCategory=Filtering Platform Connection</span><span class="se">\\</span><span class="s2">nOpCode=Info</span><span class="se">\\</span><span class="s2">nRecordNumber=241754521</span><span class="se">\\</span><span class="s2">nKeywords=Audit Success</span><span class="se">\\</span><span class="s2">nMessage=The Windows Filtering Platform has permitted a connection.</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">nApplication Information:</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tProcess ID:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">t4</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tApplication Name:</span><span class="se">\\</span><span class="s2">tSystem</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">nNetwork Information:</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tDirection:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">tInbound</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tSource Address:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">t100.20.100.20</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tSource Port:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">t138</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tDestination Address:</span><span class="se">\\</span><span class="s2">t100.20.100.30</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tDestination Port:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">t138</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tProtocol:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">t17</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">nFilter Information:</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tFilter Run-Time ID:</span><span class="se">\\</span><span class="s2">t0</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tLayer Name:</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">tReceive/Accept</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">tLayer Run-Time ID:</span><span class="se">\\</span><span class="s2">t44&quot;</span><span class="p">]</span>
<span class="n">input_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;alert_data.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next, create and run the workflow.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">clx.workflow.workflow</span> <span class="kn">import</span> <span class="n">Workflow</span>
<span class="kn">from</span> <span class="nn">clx.parsers.windows_event_parser</span> <span class="kn">import</span> <span class="n">WindowsEventParser</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">dirpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fs&quot;</span><span class="p">,</span>
   <span class="s2">&quot;input_format&quot;</span><span class="p">:</span> <span class="s2">&quot;csv&quot;</span><span class="p">,</span>
   <span class="s2">&quot;input_path&quot;</span><span class="p">:</span> <span class="n">dirpath</span> <span class="o">+</span> <span class="s2">&quot;alert_data.csv&quot;</span><span class="p">,</span>
   <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;raw&quot;</span><span class="p">],</span>
   <span class="s2">&quot;delimiter&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>
   <span class="s2">&quot;required_cols&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;raw&quot;</span><span class="p">],</span>
   <span class="s2">&quot;dtype&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;str&quot;</span><span class="p">],</span>
   <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">}</span>
<span class="n">destination</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fs&quot;</span><span class="p">,</span>
   <span class="s2">&quot;output_format&quot;</span><span class="p">:</span> <span class="s2">&quot;csv&quot;</span><span class="p">,</span>
   <span class="s2">&quot;output_path&quot;</span><span class="p">:</span> <span class="n">dirpath</span> <span class="o">+</span> <span class="s2">&quot;alert_data_output.csv&quot;</span>
<span class="p">}</span>
<span class="n">wep</span> <span class="o">=</span> <span class="n">WindowsEventParser</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">LogParseWorkflow</span><span class="p">(</span><span class="n">Workflow</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">workflow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">wep</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="s2">&quot;raw&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

<span class="n">lpw</span> <span class="o">=</span> <span class="n">LogParseWorkflow</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="n">destination</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my-log-parsing-workflow&quot;</span><span class="p">)</span>
<span class="n">lpw</span><span class="o">.</span><span class="n">run_workflow</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Output data can be read directly from the resulting CSV file.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;alert_data_output.csv&#39;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;member_account_name,attributes_password_last_set,service_service_name,attributes_profile_path,account_information_security_id,additional_information_transited_services,additional_information_caller_computer_name,network_information_direction,new_logon_account_name,changed_attributes_home_drive,filter_information_layer_run_time_id,new_logon_security_id,additional_information_result_code,eventcode,changed_attributes_logon_hours,account_information_supplied_realm_name,additional_information_ticket_options,subject_security_id,detailed_authentication_information_key_length,changed_attributes_script_path,changed_attributes_display_name,detailed_authentication_information_transited_services,subject_logon_id,changed_attributes_sam_account_name,network_information_workstation_name,service_information_service_id,subject_account_name,account_information_user_id,new_logon_account_domain,attributes_user_workstations,account_locked_out_account_name,target_account_old_account_name,network_information_protocol,attributes_home_directory,attributes_logon_hours,group_group_domain,changed_attributes_allowedtodelegateto,changed_attributes_user_account_control,network_information_source_port,attributes_user_parameters,network_information_port,application_information_process_id,attributes_sid_history,attributes_new_uac_value,process_process_name,network_information_destination_port,changed_attributes_home_directory,group_security_id,member_security_id,user_account_domain,certificate_information_certificate_serial_number,account_whose_credentials_were_used_account_domain,attributes_account_expires,subject_account_domain,process_information_caller_process_id,process_process_id,target_server_additional_information,process_information_caller_process_name,logon_type,network_information_destination_address,account_whose_credentials_were_used_logon_guid,filter_information_layer_name,additional_information_ticket_encryption_type,network_information_source_address,target_account_account_domain,failure_information_status,failure_information_failure_reason,process_information_process_name,target_account_security_id,filter_information_filter_run_time_id,attributes_allowed_to_delegate_to,changed_attributes_sid_history,account_for_which_logon_failed_security_id,new_account_domain_name,detailed_authentication_information_logon_process,additional_information_privileges,account_information_account_name,user_security_id,process_information_process_id,network_information_client_port,certificate_information_certificate_thumbprint,target_server_target_server_name,attributes_primary_group_id,additional_information_pre_authentication_type,changed_attributes_old_uac_value,account_information_account_domain,account_whose_credentials_were_used_account_name,id,subject_logon_guid,attributes_sam_account_name,detailed_authentication_information_authentication_package,attributes_user_principal_name,target_account_new_account_name,computername,attributes_home_drive,changed_attributes_account_expires,target_account_account_name,application_information_application_name,changed_attributes_primary_group_id,additional_information_failure_code,time,failure_information_sub_status,attributes_display_name,new_account_security_id,changed_attributes_user_principal_name,new_logon_logon_guid,changed_attributes_user_workstations,account_information_logon_guid,new_logon_logon_id,attributes_old_uac_value,changed_attributes_new_uac_value,additional_information_expiration_time,changed_attributes_password_last_set,network_information_client_address,account_for_which_logon_failed_account_name,changed_attributes_profile_path,attributes_script_path,detailed_authentication_information_package_name_ntlm_only,group_group_name,changed_attributes_user_parameters,account_locked_out_security_id,certificate_information_certificate_issuer_name,network_information_source_network_address,service_information_service_name,privileges,account_for_which_logon_failed_account_domain,network_information_network_address,service_server,new_account_account_name,user_account_name,attributes_user_account_control\n&#39;,
 &#39;,,,,,,,inbound,,,44,,,5156,,,,,,,,,,,,,,,,,,,17,,,,,,138,,,4,,,,138,,,,,,,,,,,,,,100.20.100.30,,receive/accept,,100.20.100.20,,,,,,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,system,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\n&#39;]
</pre></div></div>
</div>
</div>
<div class="section" id="Open-Source-Threat-Intelligence-Integration">
<h2>Open Source Threat Intelligence Integration<a class="headerlink" href="#Open-Source-Threat-Intelligence-Integration" title="Permalink to this headline">¶</a></h2>
<p>Often it’s beneficial to integrate open source threat intelligence with collected data. CLX includes the ability to query <a class="reference external" href="https://www.virustotal.com">VirusTotal</a> and <a class="reference external" href="https://www.farsightsecurity.com">FarsightDB</a> directly. An API key is necessary for both of these integrations.</p>
<ul class="simple">
<li><p>Create an account with <a class="reference external" href="https://www.virustotal.com">https://www.virustotal.com</a></p></li>
<li><p>Create an account with <a class="reference external" href="https://www.farsightsecurity.com">https://www.farsightsecurity.com</a></p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">clx.osi.virus_total</span> <span class="kn">import</span> <span class="n">VirusTotalClient</span>
<span class="n">vt_api_key</span><span class="o">=</span><span class="s1">&#39;&lt;virus total apikey goes here&gt;&#39;</span>
<span class="n">vt_client</span> <span class="o">=</span> <span class="n">VirusTotalClient</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="n">vt_api_key</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">vt_client</span><span class="o">.</span><span class="n">url_scan</span><span class="p">([</span><span class="s2">&quot;virustotal.com&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">clx.osi.farsight</span> <span class="kn">import</span> <span class="n">FarsightLookupClient</span>
<span class="n">server</span><span class="o">=</span><span class="s1">&#39;https://api.dnsdb.info&#39;</span>
<span class="n">fs_api_key</span><span class="o">=</span><span class="s1">&#39;&lt;farsight apikey goes here&gt;&#39;</span>
<span class="n">fs_client</span> <span class="o">=</span> <span class="n">FarsightLookupClient</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">fs_api_key</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">fs_client</span><span class="o">.</span><span class="n">query_rrset</span><span class="p">(</span><span class="s2">&quot;www.dnsdb.info&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">clx.osi.whois</span> <span class="kn">import</span> <span class="n">WhoIsLookupClient</span>
<span class="n">whois_client</span> <span class="o">=</span> <span class="n">WhoIsLookupClient</span><span class="p">()</span>
<span class="n">whois_result</span> <span class="o">=</span> <span class="n">whois_client</span><span class="o">.</span><span class="n">whois</span><span class="p">([</span><span class="s2">&quot;nvidia.com&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">whois_result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{&#39;domain_name&#39;: &#39;NVIDIA.COM&#39;, &#39;registrar&#39;: &#39;Safenames Ltd&#39;, &#39;whois_server&#39;: &#39;whois.safenames.net&#39;, &#39;referral_url&#39;: None, &#39;updated_date&#39;: &#39;04-23-2019 17:17:03,10-04-2013 20:01:01&#39;, &#39;creation_date&#39;: &#39;04-20-1993 04:00:00&#39;, &#39;expiration_date&#39;: &#39;04-21-2020 04:00:00&#39;, &#39;name_servers&#39;: &#39;DNS1.P09.NSONE.NET,DNS2.P09.NSONE.NET,NS5.DNSMADEEASY.COM,NS6.DNSMADEEASY.COM,NS7.DNSMADEEASY.COM&#39;, &#39;status&#39;: &#39;clientDeleteProhibited https://icann.org/epp#clientDeleteProhibited,clientTransferProhibited https://icann.org/epp#clientTransferProhibited,serverDeleteProhibited https://icann.org/epp#serverDeleteProhibited,serverTransferProhibited https://icann.org/epp#serverTransferProhibited,serverUpdateProhibited https://icann.org/epp#serverUpdateProhibited&#39;, &#39;emails&#39;: &#39;abuse@safenames.net,wadmpfvzi5ei@idp.email,hostmaster@safenames.net&#39;, &#39;dnssec&#39;: &#39;unsigned&#39;, &#39;name&#39;: &#39;Data protected, not disclosed&#39;, &#39;org&#39;: None, &#39;address&#39;: &#39;2701 San Tomas Expressway&#39;, &#39;city&#39;: &#39;Santa Clara&#39;, &#39;state&#39;: &#39;CA&#39;, &#39;zipcode&#39;: &#39;95050&#39;, &#39;country&#39;: &#39;US&#39;}]
</pre></div></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="intro-clx-workflow.html" class="btn btn-neutral float-right" title="CLX Workflow" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="api.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, NVIDIA

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>