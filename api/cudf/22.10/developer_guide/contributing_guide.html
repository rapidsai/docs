<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport"><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator">

    <title>Contributing Guide &mdash; cudf 22.10.00 documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link href="../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet">
  <link as="font" crossorigin href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2">
  <link as="font" crossorigin href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2">

    <link href="../_static/pygments.css" rel="stylesheet" type="text/css">
    <link href="../_static/copybutton.css" rel="stylesheet" type="text/css">
    <link href="../_static/mystnb.css" rel="stylesheet" type="text/css">
    <link href="../_static/togglebutton.css" rel="stylesheet" type="text/css">
    <link href="https://docs.rapids.ai/assets/css/custom.css" rel="stylesheet" type="text/css">

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695" rel="preload">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script defer="defer" src="https://docs.rapids.ai/assets/js/custom.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <link href="../genindex.html" rel="index" title="Index">
    <link href="../search.html" rel="search" title="Search">
    <link href="documentation.html" rel="next" title="Writing documentation">
    <link href="library_design.html" rel="prev" title="Library Design">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="en" name="docsearch:language">
  <script id="rapids-selector-pixel-src" src="https://assets.adobedtm.com/5d4962a43b79/814eb6e9b4e1/launch-4bc07f1e0b0b.min.js"></script><link href="/assets/css/custom.css" id="rapids-selector-css" rel="stylesheet"></head>
  
  
  <body data-default-mode data-offset="180" data-spy="scroll" data-target="#bd-toc-nav">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    <img alt="Logo image" class="logo__image only-light" src="../_static/RAPIDS-logo-purple.png">
    <img alt="Logo image" class="logo__image only-dark" src="../_static/RAPIDS-logo-purple.png">
  
  
</a>
    
  </div>

  <button aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#navbar-collapsible" data-toggle="collapse" type="button">
    <span class="fas fa-bars"></span>
  </button>

  
  <div class="collapse navbar-collapse" id="navbar-collapsible">
    <div class="ml-auto" id="navbar-center">
      
      <div class="navbar-center-item">
        <ul class="navbar-nav" id="navbar-main-elements">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../user_guide/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api_docs/index.html">
  API reference
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  Developer Guide
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span class="btn btn-sm btn-outline-primary navbar-btn rounded-circle" id="theme-switch">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/rapidsai/cudf" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/rapidsai" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar"><div id="rapids-pydata-container"><div class="rapids-home-container"><a class="rapids-home-container__home-btn" href="/api">Home</a></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">cudf</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/clx/stable/api.html">clx</a><a class="rapids-selector__menu-item" href="/api/cucim/stable/api.html">cucim</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/cudf/stable/index.html">cudf</a><a class="rapids-selector__menu-item" href="/api/cudf-java/stable">cudf-java</a><a class="rapids-selector__menu-item" href="/api/cugraph/stable">cugraph</a><a class="rapids-selector__menu-item" href="/api/cuml/stable/api.html">cuml</a><a class="rapids-selector__menu-item" href="/api/cusignal/stable/api.html">cusignal</a><a class="rapids-selector__menu-item" href="/api/cuspatial/stable">cuspatial</a><a class="rapids-selector__menu-item" href="/api/cuxfilter/stable">cuxfilter</a><a class="rapids-selector__menu-item" href="/api/dask-cuda/stable/api.html">dask-cuda</a><a class="rapids-selector__menu-item" href="/api/kvikio/stable/api.html">kvikio</a><a class="rapids-selector__menu-item" href="/api/libcudf/stable/namespacecudf.html">libcudf</a><a class="rapids-selector__menu-item" href="/api/libcugraph/stable">libcugraph</a><a class="rapids-selector__menu-item" href="/api/libcuml/stable">libcuml</a><a class="rapids-selector__menu-item" href="/api/libcuspatial/stable">libcuspatial</a><a class="rapids-selector__menu-item" href="/api/libkvikio/stable">libkvikio</a><a class="rapids-selector__menu-item" href="/api/librmm/stable/annotated.html">librmm</a><a class="rapids-selector__menu-item" href="/api/raft/stable">raft</a><a class="rapids-selector__menu-item" href="/api/rapids-cmake/stable/api.html">rapids-cmake</a><a class="rapids-selector__menu-item" href="/api/rmm/stable/api.html">rmm</a></div></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">nightly (22.10)</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/cudf/nightly/index.html">nightly (22.10)</a><a class="rapids-selector__menu-item" href="/api/cudf/stable/index.html">stable (22.08)</a><a class="rapids-selector__menu-item" href="/api/cudf/legacy/index.html">legacy (22.06)</a></div></div></div>
  <div class="sidebar-start-items"><form action="../search.html" class="bd-search d-flex align-items-center" method="get">
  <i class="icon fas fa-search"></i>
  <input aria-label="Search the docs ..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search the docs ..." type="search">
</form><nav aria-label="Main navigation" class="bd-links" id="bd-docs-nav">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="library_design.html">
   Library Design
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Contributing Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="documentation.html">
   Writing documentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="benchmarking.html">
   Benchmarking cuDF
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="options.html">
   Options
  </a>
 </li>
</ul>

  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#directory-structure-and-file-naming">
   Directory structure and file naming
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#code-style">
   Code style
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deprecating-and-removing-code">
   Deprecating and removing code
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pandas-compatibility">
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
   compatibility
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#python-vs-cython">
   Python vs Cython
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exception-handling">
   Exception handling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#handling-libcudf-exceptions">
     Handling libcudf Exceptions
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="contributing-guide">
<h1>Contributing Guide<a class="headerlink" href="#contributing-guide" title="Permalink to this heading">#</a></h1>
<p>This document focuses on a high-level overview of best practices in cuDF.</p>
<section id="directory-structure-and-file-naming">
<h2>Directory structure and file naming<a class="headerlink" href="#directory-structure-and-file-naming" title="Permalink to this heading">#</a></h2>
<p>cuDF generally presents the same importable modules and subpackages as pandas.
All Cython code is contained in <code class="docutils literal notranslate"><span class="pre">python/cudf/cudf/_lib</span></code>.</p>
</section>
<section id="code-style">
<h2>Code style<a class="headerlink" href="#code-style" title="Permalink to this heading">#</a></h2>
<p>cuDF employs a number of linters to ensure consistent style across the code base.
We manage our linters using <a class="reference external" href="https://pre-commit.com/"><code class="docutils literal notranslate"><span class="pre">pre-commit</span></code></a>.
Developers are strongly recommended to set up <code class="docutils literal notranslate"><span class="pre">pre-commit</span></code> prior to any development.
The <code class="docutils literal notranslate"><span class="pre">.pre-commit-config.yaml</span></code> file at the root of the repo is the primary source of truth linting.
Specifically, cuDF uses the following tools:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pycqa/flake8"><code class="docutils literal notranslate"><span class="pre">flake8</span></code></a> checks for general code formatting compliance.</p></li>
<li><p><a class="reference external" href="https://github.com/psf/black"><code class="docutils literal notranslate"><span class="pre">black</span></code></a> is an automatic code formatter.</p></li>
<li><p><a class="reference external" href="https://pycqa.github.io/isort/"><code class="docutils literal notranslate"><span class="pre">isort</span></code></a> ensures imports are sorted consistently.</p></li>
<li><p><a class="reference external" href="http://mypy-lang.org/"><code class="docutils literal notranslate"><span class="pre">mypy</span></code></a> performs static type checking.
In conjunction with <a class="reference external" href="https://docs.python.org/3/library/typing.html">type hints</a>,
<code class="docutils literal notranslate"><span class="pre">mypy</span></code> can help catch various bugs that are otherwise difficult to find.</p></li>
<li><p><a class="reference external" href="https://github.com/PyCQA/pydocstyle/"><code class="docutils literal notranslate"><span class="pre">pydocstyle</span></code></a> lints docstring style.</p></li>
</ul>
<p>Linter config data is stored in a number of files.
We generally use <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> over <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> and avoid project-specific files (e.g. <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">python/cudf/setup.cfg</span></code>).
However, differences between tools and the different packages in the repo result in the following caveats:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">flake8</span></code> has no plans to support <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>, so it must live in <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">isort</span></code> must be configured per project to set which project is the &ldquo;first party&rdquo; project.</p></li>
</ul>
<p>Additionally, our use of <code class="docutils literal notranslate"><span class="pre">versioneer</span></code> means that each project must have a <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code>.
As a result, we currently maintain both root and project-level <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> and <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> files.</p>
<p>For more information on how to use pre-commit hooks, see the code formatting section of the
<a class="reference external" href="https://github.com/rapidsai/cudf/blob/main/CONTRIBUTING.md#python--pre-commit-hooks">overall contributing guide</a>.</p>
</section>
<section id="deprecating-and-removing-code">
<h2>Deprecating and removing code<a class="headerlink" href="#deprecating-and-removing-code" title="Permalink to this heading">#</a></h2>
<p>cuDF follows the policy of deprecating code for one release prior to removal.
For example, if we decide to remove an API during the 22.08 release cycle,
it will be marked as deprecated in the 22.08 release and removed in the 22.10 release.
All internal usage of deprecated APIs in cuDF should be removed when the API is deprecated.
This prevents users from encountering unexpected deprecation warnings when using other (non-deprecated) APIs.
The documentation for the API should also be updated to reflect its deprecation.
When the time comes to remove a deprecated API, make sure to remove all tests and documentation.</p>
<p>Deprecation messages should:</p>
<ul class="simple">
<li><p>emit a FutureWarning;</p></li>
<li><p>consist of a single line with no newline characters;</p></li>
<li><p>indicate replacement APIs, if any exist
(deprecation messages are an opportunity to show users better ways to do things);</p></li>
<li><p>not specify a version when removal will occur (this gives us more flexibility).</p></li>
</ul>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
    <span class="s2">"`Series.foo` is deprecated and will be removed in a future version of cudf. "</span>
    <span class="s2">"Use `Series.new_foo` instead."</span><span class="p">,</span>
    <span class="ne">FutureWarning</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Deprecations should be signaled using a <code class="docutils literal notranslate"><span class="pre">FutureWarning</span></code> <strong>not a <code class="docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></strong>!
<code class="docutils literal notranslate"><span class="pre">DeprecationWarning</span></code> is hidden by default except in code run in the <code class="docutils literal notranslate"><span class="pre">__main__</span></code> module.</p>
</div>
</section>
<section id="pandas-compatibility">
<h2><code class="docutils literal notranslate"><span class="pre">pandas</span></code> compatibility<a class="headerlink" href="#pandas-compatibility" title="Permalink to this heading">#</a></h2>
<p>Maintaining compatibility with the <a class="reference external" href="https://pandas.pydata.org/docs/reference/index.html">pandas API</a> is a primary goal of cuDF.
Developers should always look at pandas APIs when adding a new feature to cuDF.
When introducing a new cuDF API with a pandas analog, we should match pandas as much as possible.
Since we try to maintain compatibility even with various edge cases (such as null handling),
new pandas releases sometimes require changes that break compatibility with old versions.
As a result, our compatibility target is the latest pandas version.</p>
<p>However, there are occasionally good reasons to deviate from pandas behavior.
The most common reasons center around performance.
Some APIs cannot match pandas behavior exactly without incurring exorbitant runtime costs.
Others may require using additional memory, which is always at a premium in GPU workflows.
If you are developing a feature and believe that perfect pandas compatibility is infeasible or undesirable,
you should consult with other members of the team to assess how to proceed.</p>
<p>When such a deviation from pandas behavior is necessary, it should be documented.
For more information on how to do that, see <a class="reference internal" href="documentation.html#comparing-to-pandas"><span class="std std-doc">our documentation on pandas comparison</span></a>.</p>
</section>
<section id="python-vs-cython">
<h2>Python vs Cython<a class="headerlink" href="#python-vs-cython" title="Permalink to this heading">#</a></h2>
<p>cuDF makes substantial use of <a class="reference external" href="https://cython.org/">Cython</a>.
Cython is a powerful tool, but it is less user-friendly than pure Python.
It is also more difficult to debug or profile.
Therefore, developers should generally prefer Python code over Cython where possible.</p>
<p>The primary use-case for Cython in cuDF is to expose libcudf C++ APIs to Python.
This Cython usage is generally composed of two parts:</p>
<ol class="arabic simple">
<li><p>A <code class="docutils literal notranslate"><span class="pre">pxd</span></code> file declaring C++ APIs so that they may be used in Cython, and</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">pyx</span></code> file containing Cython functions that wrap those C++ APIs so that they can be called from Python.</p></li>
</ol>
<p>The latter wrappers should generally be kept as thin as possible to minimize Cython usage.
For more information see <a class="reference internal" href="library_design.html#the-cython-layer"><span class="std std-doc">our Cython layer design documentation</span></a>.</p>
<p>In some rare cases we may actually benefit from writing pure Cython code to speed up particular code paths.
Given that most numerical computations in cuDF actually happen in libcudf, however,
such use cases are quite rare.
Any attempt to write pure Cython code for this purpose should be justified with benchmarks.</p>
</section>
<section id="exception-handling">
<h2>Exception handling<a class="headerlink" href="#exception-handling" title="Permalink to this heading">#</a></h2>
<p>In alignment with <a class="reference internal" href="#pandas-compatibility"><span class="std std-doc">maintaining compatibility with pandas</span></a>,
any API that cuDF shares with pandas should throw all the same exceptions as the
corresponding pandas API given the same inputs.
However, it is not required to match the corresponding pandas API&rsquo;s exception message.</p>
<p>When writing error messages,
sufficient information should be included to help users locate the source of the error,
such as including the expected argument type versus the actual argument provided.</p>
<p>For parameters that are not yet supported,
raise <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>.
There is no need to mention when the argument will be supported in the future.</p>
<section id="handling-libcudf-exceptions">
<h3>Handling libcudf Exceptions<a class="headerlink" href="#handling-libcudf-exceptions" title="Permalink to this heading">#</a></h3>
<p>Currently libcudf raises <code class="docutils literal notranslate"><span class="pre">cudf::logic_error</span></code> and <code class="docutils literal notranslate"><span class="pre">cudf::cuda_error</span></code>.
These error types are mapped to <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code> in python.
Several APIs use the exception payload <code class="docutils literal notranslate"><span class="pre">what()</span></code> message to determine the exception type raised by libcudf.</p>
<p>Determining error type based on exception payload is brittle since libcudf does not maintain API stability on exception messages.
This is a compromise due to libcudf only raising a limited number of error types.
Only adopt this strategy when necessary.</p>
<p>The projected roadmap is to diversify the exception types raised by libcudf.
Standard C++ natively supports various <a class="reference external" href="https://en.cppreference.com/w/cpp/error/exception">exception types</a>,
which Cython maps to <a class="reference external" href="https://docs.cython.org/en/latest/src/userguide/wrapping_CPlusPlus.html#exceptions">these Python exception types</a>.
In the future, libcudf may employ custom C++ exception types.
If that occurs, this section will be updated to reflect how these may be mapped to desired Python exception types.</p>
</section>
</section>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
  <a class="left-prev" href="library_design.html" id="prev-link" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Library Design</p>
      </div>
  </a>
  <a class="right-next" href="documentation.html" id="next-link" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Writing documentation</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2018-2021, NVIDIA.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1.<br>
</p>
  </div>
  
</div>
</footer>
  
<script defer id="rapids-selector-js" src="/assets/js/custom.js"></script><script id="rapids-selector-pixel-invocation" type="text/javascript">_satellite.pageBottom();</script></body></html>