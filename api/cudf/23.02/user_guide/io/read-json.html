<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport"><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator">

    <title>Working with JSON data &mdash; cudf 23.02.00 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link as="font" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2">
<link as="font" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2">
<link as="font" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2">

    <link href="../../_static/pygments.css" rel="stylesheet" type="text/css">
    <link href="../../_static/copybutton.css" rel="stylesheet" type="text/css">
    <link href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" rel="stylesheet" type="text/css">
    <link href="https://docs.rapids.ai/assets/css/custom.css" rel="stylesheet" type="text/css">
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link as="script" href="../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94" rel="preload">
<link as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94" rel="preload">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script defer="defer" src="https://docs.rapids.ai/assets/js/custom.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/io/read-json';</script>
    <link href="../../genindex.html" rel="index" title="Index">
    <link href="../../search.html" rel="search" title="Search">
    <link href="../missing-data.html" rel="next" title="Working with missing data">
    <link href="io.html" rel="prev" title="Input / Output">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="en" name="docsearch:language">
  <script id="rapids-selector-pixel-src" src="https://assets.adobedtm.com/5d4962a43b79/814eb6e9b4e1/launch-4bc07f1e0b0b.min.js"></script><link href="/assets/css/custom.css" id="rapids-selector-css" rel="stylesheet"></head>
  
  
  <body data-default-mode data-offset="180" data-spy="scroll" data-target="#bd-toc-nav">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input class="sidebar-toggle" id="__primary" name="__primary" type="checkbox">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input class="sidebar-toggle" id="__secondary" name="__secondary" type="checkbox">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form action="../../search.html" class="bd-search d-flex align-items-center" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input aria-label="Search the docs ..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search the docs ..." spellcheck="false" type="search">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">

  
  
  
  
  
  
  

  
    <img alt="Logo image" class="logo__image only-light" src="../../_static/RAPIDS-logo-purple.png">
    <img alt="Logo image" class="logo__image only-dark" src="../../_static/RAPIDS-logo-purple.png">
  
  
</a>
    
  </div>

  
  <div class="navbar-header-items">
    <div class="ml-auto" id="navbar-center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
        Site Navigation
    </p>
    <ul class="navbar-nav" id="navbar-main-elements">
        
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api_docs/index.html">
                        API reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../developer_guide/index.html">
                        Developer Guide
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button aria-label="Search" class="btn btn-sm navbar-btn search-button search-button__button" data-toggle="tooltip" title="Search">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button aria-label="light/dark" class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" data-toggle="tooltip" title="light/dark">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a class="nav-link" data-toggle="tooltip" href="https://github.com/rapidsai/cudf" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a class="nav-link" data-toggle="tooltip" href="https://twitter.com/rapidsai" rel="noopener" target="_blank" title="Twitter"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button aria-label="Search" class="btn btn-sm navbar-btn search-button search-button__button" data-toggle="tooltip" title="Search">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar"><div id="rapids-pydata-container"><div class="rapids-home-container"><a class="rapids-home-container__home-btn" href="/api">Home</a></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">cudf</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/clx/stable/api.html">clx</a><a class="rapids-selector__menu-item" href="/api/cucim/stable/api.html">cucim</a><a class="rapids-selector__menu-item" href="/api/cudf-java/stable">cudf-java</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/cudf/stable/index.html">cudf</a><a class="rapids-selector__menu-item" href="/api/cugraph/stable">cugraph</a><a class="rapids-selector__menu-item" href="/api/cuml/stable/api.html">cuml</a><a class="rapids-selector__menu-item" href="/api/cusignal/stable/api.html">cusignal</a><a class="rapids-selector__menu-item" href="/api/cuspatial/stable">cuspatial</a><a class="rapids-selector__menu-item" href="/api/cuxfilter/stable">cuxfilter</a><a class="rapids-selector__menu-item" href="/api/dask-cuda/stable/api.html">dask-cuda</a><a class="rapids-selector__menu-item" href="/api/kvikio/stable/api.html">kvikio</a><a class="rapids-selector__menu-item" href="/api/libcudf/stable/namespacecudf.html">libcudf</a><a class="rapids-selector__menu-item" href="/api/libcugraph/stable">libcugraph</a><a class="rapids-selector__menu-item" href="/api/libcuml/stable">libcuml</a><a class="rapids-selector__menu-item" href="/api/libcuspatial/stable">libcuspatial</a><a class="rapids-selector__menu-item" href="/api/libkvikio/stable">libkvikio</a><a class="rapids-selector__menu-item" href="/api/librmm/stable/annotated.html">librmm</a><a class="rapids-selector__menu-item" href="/api/raft/stable">raft</a><a class="rapids-selector__menu-item" href="/api/rapids-cmake/stable/api.html">rapids-cmake</a><a class="rapids-selector__menu-item" href="/api/rmm/stable/api.html">rmm</a></div></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">stable (23.02)</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/cudf/nightly/index.html">nightly (23.04)</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/cudf/stable/index.html">stable (23.02)</a><a class="rapids-selector__menu-item" href="/api/cudf/legacy/index.html">legacy (22.12)</a></div></div></div>
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
        Site Navigation
    </p>
    <ul class="navbar-nav" id="navbar-main-elements">
        
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api_docs/index.html">
                        API reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../developer_guide/index.html">
                        Developer Guide
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button aria-label="light/dark" class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" data-toggle="tooltip" title="light/dark">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a class="nav-link" data-toggle="tooltip" href="https://github.com/rapidsai/cudf" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a class="nav-link" data-toggle="tooltip" href="https://twitter.com/rapidsai" rel="noopener" target="_blank" title="Twitter"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav aria-label="Section navigation" class="bd-links" id="bd-docs-nav">
  <p aria-level="1" class="bd-links__title" role="heading">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../10min.html">10 Minutes to cuDF and Dask-cuDF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pandas-comparison.html">Comparison of cuDF and Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-types.html">Supported Data Types</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Input / Output</a><input checked class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="io.html">Input / Output</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Working with JSON data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../missing-data.html">Working with missing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../groupby.html">GroupBy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide-to-udfs.html">Overview of User Defined Functions with cuDF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cupy-interop.html">Interoperability between cuDF and CuPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../options.html">Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PandasCompat.html">Pandas Compatibility Notes</a></li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main class="bd-main" id="main-content">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="working-with-json-data">
<h1>Working with JSON data<a class="headerlink" href="#working-with-json-data" title="Permalink to this heading">#</a></h1>
<p>This page contains a tutorial about reading and manipulating JSON data in cuDF.</p>
<section id="reading-json-data">
<h2>Reading JSON data<a class="headerlink" href="#reading-json-data" title="Permalink to this heading">#</a></h2>
<p>By default, the cuDF JSON reader expects input data using the
&ldquo;records&rdquo; orientation. Records-oriented JSON data comprises
an array of objects at the root level, and each object in the
array corresponds to a row. Records-oriented JSON data begins
with <code class="docutils literal notranslate"><span class="pre">[</span></code>, ends with <code class="docutils literal notranslate"><span class="pre">]</span></code> and ignores unquoted whitespace.
Another common variant for JSON data is &ldquo;JSON Lines&rdquo;, where
JSON objects are separated by new line characters (<code class="docutils literal notranslate"><span class="pre">\n</span></code>), and
each object corresponds to a row.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">j</span> <span class="o">=</span> <span class="s1">'''[</span>
<span class="go">    {"a": "v1", "b": 12},</span>
<span class="go">    {"a": "v2", "b": 7},</span>
<span class="go">    {"a": "v3", "b": 5}</span>
<span class="go">]'''</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_records</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">'cudf'</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">j</span> <span class="o">=</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
<span class="gp">... </span>    <span class="s1">'{"a": "v1", "b": 12}'</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">'{"a": "v2", "b": 7}'</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">'{"a": "v3", "b": 5}'</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_lines</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_lines</span>
<span class="go">    a   b</span>
<span class="go">0  v1  12</span>
<span class="go">1  v2   7</span>
<span class="go">2  v3   5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_records</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df_lines</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The cuDF JSON reader also supports arbitrarily-nested combinations
of JSON objects and arrays, which map to struct and list data types.
The following examples demonstrate the inputs and outputs for
reading nested JSON data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example with columns types:</span>
<span class="c1"># list&lt;int&gt; and struct&lt;k:string&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">j</span> <span class="o">=</span> <span class="s1">'''[</span>
<span class="s1">    {"list": [0,1,2], "struct": {"k":"v1"}},</span>
<span class="s1">    {"list": [3,4,5], "struct": {"k":"v2"}}</span>
<span class="s1">]'''</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">'cudf'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span>
        <span class="nb">list</span>       <span class="n">struct</span>
<span class="mi">0</span>  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>  <span class="p">{</span><span class="s1">'k'</span><span class="p">:</span> <span class="s1">'v1'</span><span class="p">}</span>
<span class="mi">1</span>  <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>  <span class="p">{</span><span class="s1">'k'</span><span class="p">:</span> <span class="s1">'v2'</span><span class="p">}</span>

<span class="c1"># Example with columns types:</span>
<span class="c1"># list&lt;struct&lt;k:int&gt;&gt; and struct&lt;k:list&lt;int&gt;, m:int&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">j</span> <span class="o">=</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
<span class="o">...</span>     <span class="s1">'{"a": [{"k": 0}], "b": {"k": [0, 1], "m": 5}}'</span><span class="p">,</span>
<span class="o">...</span>     <span class="s1">'{"a": [{"k": 1}, {"k": 2}], "b": {"k": [2, 3], "m": 6}}'</span><span class="p">,</span>
<span class="o">...</span> <span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span>
                      <span class="n">a</span>                      <span class="n">b</span>
<span class="mi">0</span>            <span class="p">[{</span><span class="s1">'k'</span><span class="p">:</span> <span class="mi">0</span><span class="p">}]</span>  <span class="p">{</span><span class="s1">'k'</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">'m'</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
<span class="mi">1</span>  <span class="p">[{</span><span class="s1">'k'</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s1">'k'</span><span class="p">:</span> <span class="mi">2</span><span class="p">}]</span>  <span class="p">{</span><span class="s1">'k'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">'m'</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="handling-large-and-small-json-lines-files">
<h2>Handling large and small JSON Lines files<a class="headerlink" href="#handling-large-and-small-json-lines-files" title="Permalink to this heading">#</a></h2>
<p>For workloads based on JSON Lines data, cuDF includes reader options
to assist with data processing: byte range support for large files,
and multi-source support for small files.</p>
<p>Some workflows require processing large JSON Lines files that may
exceed GPU memory capacity. The JSON reader in cuDF supports a byte
range argument that specifies a starting byte offset and size in bytes.
The reader parses each record that begins within the byte range,
and for this reason byte ranges do not need to align with record
boundaries. To avoid skipping rows or reading duplicate rows, byte ranges
should be adjacent, as shown in the following example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">num_rows</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j</span> <span class="o">=</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
<span class="gp">... </span>    <span class="s1">'{"id":</span><span class="si">%s</span><span class="s1">, "distance": </span><span class="si">%s</span><span class="s1">, "unit": "m/s"}'</span> <span class="o">%</span> <span class="n">x</span> \
<span class="gp">... </span>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_rows</span><span class="p">),</span> <span class="n">cupy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_rows</span><span class="p">))</span>
<span class="gp">... </span><span class="p">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">chunk_count</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chunk_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">//</span> <span class="n">chunk_count</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">chunk_count</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">d</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">j</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">byte_range</span><span class="o">=</span><span class="p">(</span><span class="n">chunk_size</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>By contrast, some workflows require processing many small JSON
Lines files. Rather than looping through the sources and
concatenating the resulting dataframes, the JSON reader in
cuDF accepts an iterable of data sources. Then the raw inputs
are concatenated and processed as a single source. Please
note that the JSON reader in cuDF accepts sources as file paths,
raw strings, or file-like objects, as well as iterables of these sources.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">j1</span> <span class="o">=</span> <span class="s1">'{"id":0}</span><span class="se">\n</span><span class="s1">{"id":1}</span><span class="se">\n</span><span class="s1">'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j2</span> <span class="o">=</span> <span class="s1">'{"id":2}</span><span class="se">\n</span><span class="s1">{"id":3}</span><span class="se">\n</span><span class="s1">'</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">read_json</span><span class="p">([</span><span class="n">j1</span><span class="p">,</span> <span class="n">j2</span><span class="p">],</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="unpacking-list-and-struct-data">
<h2>Unpacking list and struct data<a class="headerlink" href="#unpacking-list-and-struct-data" title="Permalink to this heading">#</a></h2>
<p>After reading JSON data into a cuDF dataframe with list/struct
column types, the next step in many workflows extracts or
flattens the data into simple types. For struct columns, one
solution is extracting the data with the <code class="docutils literal notranslate"><span class="pre">struct.explode</span></code>
accessor and joining the result to the parent dataframe. The
following example demonstrates how to extract data from a struct column.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">j</span> <span class="o">=</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
<span class="gp">... </span>   <span class="s1">'{"x": "Tokyo", "y": {"country": "Japan", "iso2": "JP"}}'</span><span class="p">,</span>
<span class="gp">... </span>   <span class="s1">'{"x": "Jakarta", "y": {"country": "Indonesia", "iso2": "ID"}}'</span><span class="p">,</span>
<span class="gp">... </span>   <span class="s1">'{"x": "Shanghai", "y": {"country": "China", "iso2": "CN"}}'</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">'y'</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'y'</span><span class="p">]</span><span class="o">.</span><span class="n">struct</span><span class="o">.</span><span class="n">explode</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">          x    country iso2</span>
<span class="go">0     Tokyo      Japan   JP</span>
<span class="go">1   Jakarta  Indonesia   ID</span>
<span class="go">2  Shanghai      China   CN</span>
</pre></div>
</div>
<p>For list columns where the order of the elements is meaningful,
the <code class="docutils literal notranslate"><span class="pre">list.get</span></code> accessor extracts the elements from specific
positions. The resulting <code class="docutils literal notranslate"><span class="pre">cudf.Series</span></code> object can then be assigned
to a new column in the dataframe. The following example
demonstrates how to extract the first and second elements from a
list column.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">j</span> <span class="o">=</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
<span class="gp">... </span>   <span class="s1">'{"name": "Peabody, MA", "coord": [42.53, -70.98]}'</span><span class="p">,</span>
<span class="gp">... </span>   <span class="s1">'{"name": "Northampton, MA", "coord": [42.32, -72.66]}'</span><span class="p">,</span>
<span class="gp">... </span>   <span class="s1">'{"name": "New Bedford, MA", "coord": [41.63, -70.93]}'</span>
<span class="gp">... </span><span class="p">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="p">[</span><span class="s1">'latitude'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'coord'</span><span class="p">]</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="p">[</span><span class="s1">'longitude'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'coord'</span><span class="p">]</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">'coord'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">              name  latitude  longitude</span>
<span class="go">0      Peabody, MA     42.53     -70.98</span>
<span class="go">1  Northampton, MA     42.32     -72.66</span>
<span class="go">2  New Bedford, MA     41.63     -70.93</span>
</pre></div>
</div>
<p>Finally, for list columns with variable length, the <code class="docutils literal notranslate"><span class="pre">explode</span></code>
method creates a new dataframe with each element as a row.
Joining the exploded dataframe on the parent dataframe yields
an output with all simple types. The following example flattens
a list column and joins it to the index and additional data from
the parent dataframe.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">j</span> <span class="o">=</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
<span class="gp">... </span>   <span class="s1">'{"product": "socks", "ratings": [2, 3, 4]}'</span><span class="p">,</span>
<span class="gp">... </span>   <span class="s1">'{"product": "shoes", "ratings": [5, 4, 5, 3]}'</span><span class="p">,</span>
<span class="gp">... </span>   <span class="s1">'{"product": "shirts", "ratings": [3, 4]}'</span>
<span class="gp">... </span><span class="p">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">'ratings'</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'ratings'</span><span class="p">]</span><span class="o">.</span><span class="n">explode</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">  product  ratings</span>
<span class="go">0   socks        2</span>
<span class="go">0   socks        4</span>
<span class="go">0   socks        3</span>
<span class="go">1   shoes        5</span>
<span class="go">1   shoes        5</span>
<span class="go">1   shoes        4</span>
<span class="go">1   shoes        3</span>
<span class="go">2  shirts        3</span>
<span class="go">2  shirts        4</span>
</pre></div>
</div>
</section>
<section id="building-json-data-solutions">
<h2>Building JSON data solutions<a class="headerlink" href="#building-json-data-solutions" title="Permalink to this heading">#</a></h2>
<p>Sometimes a workflow needs to process JSON data with an object
root and cuDF provides tools to build solutions for this kind
of data. If you need to process JSON data with an object root,
we recommend reading the data as a single JSON Line and then
unpacking the resulting dataframe. The following example
reads a JSON object as a single line and then extracts the
&ldquo;results&rdquo; field into a new dataframe.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">j</span> <span class="o">=</span> <span class="s1">'''{</span>
<span class="go">    "metadata" : {"vehicle":"car"},</span>
<span class="go">    "results": [</span>
<span class="go">        {"id": 0, "distance": 1.2},</span>
<span class="go">        {"id": 1, "distance": 2.4},</span>
<span class="go">        {"id": 2, "distance": 1.7}</span>
<span class="go">    ]</span>
<span class="go">}'''</span>

<span class="go"># first read the JSON object with line=True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">cudf</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">             metadata                                            records</span>
<span class="go">0  {'vehicle': 'car'}  [{'id': 0, 'distance': 1.2}, {'id': 1, 'distan...</span>

<span class="go"># then explode the 'records' column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'records'</span><span class="p">]</span><span class="o">.</span><span class="n">explode</span><span class="p">()</span><span class="o">.</span><span class="n">struct</span><span class="o">.</span><span class="n">explode</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   id  distance</span>
<span class="go">0   0       1.2</span>
<span class="go">1   1       2.4</span>
<span class="go">2   2       1.7</span>
</pre></div>
</div>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class="prev-next-area">
  <a class="left-prev" href="io.html" id="prev-link" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Input / Output</p>
      </div>
  </a>
  <a class="right-next" href="../missing-data.html" id="next-link" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Working with missing data</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav class="page-toc" id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reading-json-data">
   Reading JSON data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#handling-large-and-small-json-lines-files">
   Handling large and small JSON Lines files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unpacking-list-and-struct-data">
   Unpacking list and struct data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#building-json-data-solutions">
   Building JSON data solutions
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="../../_sources/user_guide/io/read-json.md.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2018-2023, NVIDIA Corporation.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>

  </div>
  
</div>
  </footer>
  
<script defer id="rapids-selector-js" src="/assets/js/custom.js"></script><script id="rapids-selector-pixel-invocation" type="text/javascript">_satellite.pageBottom();</script></body></html>