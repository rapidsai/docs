<!DOCTYPE html>
<html class="writer-html5" lang="en"><head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>API &mdash; dask-cuda 0+untagged.1.g78326ee documentation</title>
      <link href="_static/pygments.css" rel="stylesheet" type="text/css">
      <link href="_static/css/theme.css" rel="stylesheet" type="text/css">
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link href="genindex.html" rel="index" title="Index">
    <link href="search.html" rel="search" title="Search">
    <link href="ucx.html" rel="next" title="UCX Integration">
    <link href="quickstart.html" rel="prev" title="Quickstart"> 
<link href="/assets/css/custom.css" id="rapids-selector-css" rel="stylesheet"></head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav class="wy-nav-side" data-toggle="wy-nav-shift">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"><div id="rapids-jtd-container"><div class="rapids-home-container"><a class="rapids-home-container__home-btn" href="/api">Home</a></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">dask-cuda</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/clx/stable/api.html">clx</a><a class="rapids-selector__menu-item" href="/api/cucim/stable/api.html">cucim</a><a class="rapids-selector__menu-item" href="/api/cudf/stable/index.html">cudf</a><a class="rapids-selector__menu-item" href="/api/cudf-java/stable">cudf-java</a><a class="rapids-selector__menu-item" href="/api/cugraph/stable/api.html">cugraph</a><a class="rapids-selector__menu-item" href="/api/cuml/stable/api.html">cuml</a><a class="rapids-selector__menu-item" href="/api/cusignal/stable/api.html">cusignal</a><a class="rapids-selector__menu-item" href="/api/cuspatial/stable/api.html">cuspatial</a><a class="rapids-selector__menu-item" href="/api/cuxfilter/stable">cuxfilter</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/dask-cuda/stable/api.html">dask-cuda</a><a class="rapids-selector__menu-item" href="/api/libcudf/stable/namespacecudf.html">libcudf</a><a class="rapids-selector__menu-item" href="/api/libcugraph/stable">libcugraph</a><a class="rapids-selector__menu-item" href="/api/libcuml/stable">libcuml</a><a class="rapids-selector__menu-item" href="/api/librmm/stable/annotated.html">librmm</a><a class="rapids-selector__menu-item" href="/api/rapids-cmake/nightly/api.html">rapids-cmake</a><a class="rapids-selector__menu-item" href="/api/rmm/stable/api.html">rmm</a></div></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">nightly (21.12)</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/dask-cuda/nightly/api.html">nightly (21.12)</a><a class="rapids-selector__menu-item" href="/api/dask-cuda/stable/api.html">stable (21.08)</a><a class="rapids-selector__menu-item" href="/api/dask-cuda/legacy/api.html">legacy (21.06)</a></div></div></div>
            
              
<div role="search">
  <form action="search.html" class="wy-form" id="rtd-search-form" method="get">
    <input name="q" placeholder="Search docs" type="text">
    <input name="check_keywords" type="hidden" value="yes">
    <input name="area" type="hidden" value="default">
  </form>
</div>
        </div><div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cluster">Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="#worker">Worker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dask-cuda-worker">dask-cuda-worker</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#client-initialization">Client initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#explicit-comms">Explicit-comms</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ucx.html">UCX Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="explicit_comms.html">Explicit-comms</a></li>
<li class="toctree-l1"><a class="reference internal" href="spilling.html">Spilling from device</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/worker_count.html">Controlling number of workers</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/ucx.html">Enabling UCX communication</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section class="wy-nav-content-wrap" data-toggle="wy-nav-shift"><nav aria-label="Mobile navigation menu" class="wy-nav-top">
          <i class="fa fa-bars" data-toggle="wy-nav-top"></i>
          <a href="index.html">dask-cuda</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div aria-label="Page navigation" role="navigation">
  <ul class="wy-breadcrumbs">
      <li><a class="icon icon-home" href="index.html"></a> &raquo;</li>
      <li>API</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr>
</div>
          <div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
           <div itemprop="articleBody">
             
  <div class="section" id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this headline"></a></h1>
<div class="section" id="cluster">
<h2>Cluster<a class="headerlink" href="#cluster" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dask_cuda.LocalCUDACluster">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">dask_cuda.</span></span><span class="sig-name descname"><span class="pre">LocalCUDACluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">CUDA_VISIBLE_DEVICES</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threads_per_worker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device_memory_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_filesystem</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">protocol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_tcp_over_ucx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_infiniband</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_nvlink</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_rdmacm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ucx_net_devices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmm_pool_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmm_managed_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmm_async</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmm_log_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jit_unspill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_spilling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dask_cuda/local_cuda_cluster.html#LocalCUDACluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dask_cuda.LocalCUDACluster" title="Permalink to this definition"></a></dt>
<dd><p>A variant of <code class="docutils literal notranslate"><span class="pre">dask.distributed.LocalCluster</span></code> that uses one GPU per process.</p>
<p>This assigns a different <code class="docutils literal notranslate"><span class="pre">CUDA_VISIBLE_DEVICES</span></code> environment variable to each Dask
worker process.</p>
<p>For machines with a complex architecture mapping CPUs, GPUs, and network hardware,
such as NVIDIA DGX-1 and DGX-2, this class creates a local cluster that tries to
respect this hardware as much as possible.</p>
<p>Each worker process is automatically assigned the correct CPU cores and network
interface cards to maximize performance. If UCX and UCX-Py are available, InfiniBand
and NVLink connections can be used to optimize data transfer performance.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>CUDA_VISIBLE_DEVICES</strong><span class="classifier">str, list of int, or None, default None</span></dt><dd><p>GPUs to restrict activity to. Can be a string (like <code class="docutils literal notranslate"><span class="pre">"0,1,2,3"</span></code>), list (like
<code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code>), or <code class="docutils literal notranslate"><span class="pre">None</span></code> to use all available GPUs.</p>
</dd>
<dt><strong>n_workers</strong><span class="classifier">int or None, default None</span></dt><dd><p>Number of workers. Can be an integer or <code class="docutils literal notranslate"><span class="pre">None</span></code> to fall back on the GPUs
specified by <code class="docutils literal notranslate"><span class="pre">CUDA_VISIBLE_DEVICES</span></code>. Will override the value of
<code class="docutils literal notranslate"><span class="pre">CUDA_VISIBLE_DEVICES</span></code> if specified.</p>
</dd>
<dt><strong>threads_per_worker</strong><span class="classifier">int, default 1</span></dt><dd><p>Number of threads to be used for each Dask worker process.</p>
</dd>
<dt><strong>memory_limit</strong><span class="classifier">int, float, str, or None, default &ldquo;auto&rdquo;</span></dt><dd><p>Bytes of memory per process that the worker can use. Can be an integer (bytes),
float (fraction of total system memory), string (like <code class="docutils literal notranslate"><span class="pre">"5GB"</span></code> or <code class="docutils literal notranslate"><span class="pre">"5000M"</span></code>),
or <code class="docutils literal notranslate"><span class="pre">"auto"</span></code>, 0, or <code class="docutils literal notranslate"><span class="pre">None</span></code> for no memory management.</p>
</dd>
<dt><strong>device_memory_limit</strong><span class="classifier">int, float, str, or None, default 0.8</span></dt><dd><p>Size of the CUDA device LRU cache, which is used to determine when the worker
starts spilling to host memory. Can be an integer (bytes), float (fraction of
total device memory), string (like <code class="docutils literal notranslate"><span class="pre">"5GB"</span></code> or <code class="docutils literal notranslate"><span class="pre">"5000M"</span></code>), or <code class="docutils literal notranslate"><span class="pre">"auto"</span></code>, 0,
or <code class="docutils literal notranslate"><span class="pre">None</span></code> to disable spilling to host (i.e. allow full device memory usage).</p>
</dd>
<dt><strong>local_directory</strong><span class="classifier">str or None, default None</span></dt><dd><p>Path on local machine to store temporary files. Can be a string (like
<code class="docutils literal notranslate"><span class="pre">"path/to/files"</span></code>) or <code class="docutils literal notranslate"><span class="pre">None</span></code> to fall back on the value of
<code class="docutils literal notranslate"><span class="pre">dask.temporary-directory</span></code> in the local Dask configuration, using the current
working directory if this is not set.</p>
</dd>
<dt><strong>shared_filesystem: bool or None, default None</strong></dt><dd><p>Whether the <cite>local_directory</cite> above is shared between all workers or not.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the &ldquo;jit-unspill-shared-fs&rdquo; config value are used, which
defaults to True. Notice, in all other cases this option defaults to False,
but on a local cluster it defaults to True &ndash; we assume all workers use the
same filesystem.</p>
</dd>
<dt><strong>protocol</strong><span class="classifier">str or None, default None</span></dt><dd><p>Protocol to use for communication. Can be a string (like <code class="docutils literal notranslate"><span class="pre">"tcp"</span></code> or
<code class="docutils literal notranslate"><span class="pre">"ucx"</span></code>), or <code class="docutils literal notranslate"><span class="pre">None</span></code> to automatically choose the correct protocol.</p>
</dd>
<dt><strong>enable_tcp_over_ucx</strong><span class="classifier">bool, default False</span></dt><dd><p>Set environment variables to enable TCP over UCX, even if InfiniBand and NVLink
are not supported or disabled.</p>
</dd>
<dt><strong>enable_infiniband</strong><span class="classifier">bool, default False</span></dt><dd><p>Set environment variables to enable UCX over InfiniBand, requires
<code class="docutils literal notranslate"><span class="pre">protocol="ucx"</span></code> and implies <code class="docutils literal notranslate"><span class="pre">enable_tcp_over_ucx=True</span></code>.</p>
</dd>
<dt><strong>enable_nvlink</strong><span class="classifier">bool, default False</span></dt><dd><p>Set environment variables to enable UCX over NVLink, requires <code class="docutils literal notranslate"><span class="pre">protocol="ucx"</span></code>
and implies <code class="docutils literal notranslate"><span class="pre">enable_tcp_over_ucx=True</span></code>.</p>
</dd>
<dt><strong>enable_rdmacm</strong><span class="classifier">bool, default False</span></dt><dd><p>Set environment variables to enable UCX RDMA connection manager support,
requires <code class="docutils literal notranslate"><span class="pre">protocol="ucx"</span></code> and <code class="docutils literal notranslate"><span class="pre">enable_infiniband=True</span></code>.</p>
</dd>
<dt><strong>ucx_net_devices</strong><span class="classifier">str, callable, or None, default None</span></dt><dd><p>Interface(s) used by workers for UCX communication. Can be a string (like
<code class="docutils literal notranslate"><span class="pre">"eth0"</span></code> for NVLink or <code class="docutils literal notranslate"><span class="pre">"mlx5_0:1"</span></code>/<code class="docutils literal notranslate"><span class="pre">"ib0"</span></code> for InfiniBand), a callable
function that takes the index of the current GPU to return an interface name
(like <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">dev:</span> <span class="pre">"mlx5_%d:1"</span> <span class="pre">%</span> <span class="pre">(dev</span> <span class="pre">//</span> <span class="pre">2)</span></code>), <code class="docutils literal notranslate"><span class="pre">"auto"</span></code> (requires
<code class="docutils literal notranslate"><span class="pre">enable_infiniband=True</span></code>) to pick the optimal interface per-worker
based on the system&rsquo;s topology, or <code class="docutils literal notranslate"><span class="pre">None</span></code> to stay with the default value of
<code class="docutils literal notranslate"><span class="pre">"all"</span></code> (use all available interfaces).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">"auto"</span></code> requires UCX-Py to be installed and compiled with hwloc support.
Unexpected errors can occur when using <code class="docutils literal notranslate"><span class="pre">"auto"</span></code> if any interfaces are
disconnected or improperly configured.</p>
</div>
</dd>
<dt><strong>rmm_pool_size</strong><span class="classifier">int, str or None, default None</span></dt><dd><p>RMM pool size to initialize each worker with. Can be an integer (bytes), string
(like <code class="docutils literal notranslate"><span class="pre">"5GB"</span></code> or <code class="docutils literal notranslate"><span class="pre">"5000M"</span></code>), or <code class="docutils literal notranslate"><span class="pre">None</span></code> to disable RMM pools.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This size is a per-worker configuration, and not cluster-wide.</p>
</div>
</dd>
<dt><strong>rmm_managed_memory</strong><span class="classifier">bool, default False</span></dt><dd><p>Initialize each worker with RMM and set it to use managed memory. If disabled,
RMM may still be used by specifying <code class="docutils literal notranslate"><span class="pre">rmm_pool_size</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Managed memory is currently incompatible with NVLink. Trying to enable both
will result in an exception.</p>
</div>
</dd>
<dt><strong>rmm_async: bool, default False</strong></dt><dd><p>Initialize each worker withh RMM and set it to use RMM&rsquo;s asynchronous allocator.
See <code class="docutils literal notranslate"><span class="pre">rmm.mr.CudaAsyncMemoryResource</span></code> for more info.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The asynchronous allocator requires CUDA Toolkit 11.2 or newer. It is also
incompatible with RMM pools and managed memory. Trying to enable both will
result in an exception.</p>
</div>
</dd>
<dt><strong>rmm_log_directory</strong><span class="classifier">str or None, default None</span></dt><dd><p>Directory to write per-worker RMM log files to. The client and scheduler are not
logged here. Can be a string (like <code class="docutils literal notranslate"><span class="pre">"/path/to/logs/"</span></code>) or <code class="docutils literal notranslate"><span class="pre">None</span></code> to
disable logging.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Logging will only be enabled if <code class="docutils literal notranslate"><span class="pre">rmm_pool_size</span></code> is specified or
<code class="docutils literal notranslate"><span class="pre">rmm_managed_memory=True</span></code>.</p>
</div>
</dd>
<dt><strong>jit_unspill</strong><span class="classifier">bool or None, default None</span></dt><dd><p>Enable just-in-time unspilling. Can be a boolean or <code class="docutils literal notranslate"><span class="pre">None</span></code> to fall back on
the value of <code class="docutils literal notranslate"><span class="pre">dask.jit-unspill</span></code> in the local Dask configuration, disabling
unspilling if this is not set.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is experimental and doesn&rsquo;t support memory spilling to disk. See
<code class="docutils literal notranslate"><span class="pre">proxy_object.ProxyObject</span></code> and <code class="docutils literal notranslate"><span class="pre">proxify_host_file.ProxifyHostFile</span></code> for
more info.</p>
</div>
</dd>
<dt><strong>log_spilling</strong><span class="classifier">bool, default True</span></dt><dd><p>Enable logging of spilling operations directly to <code class="docutils literal notranslate"><span class="pre">distributed.Worker</span></code> with an
<code class="docutils literal notranslate"><span class="pre">INFO</span></code> log level.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl>
<dt>TypeError</dt><dd><p>If InfiniBand or NVLink are enabled and <code class="docutils literal notranslate"><span class="pre">protocol!="ucx"</span></code>.</p>
</dd>
<dt>ValueError</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">ucx_net_devices=""</span></code>, if NVLink and RMM managed memory are
both enabled, if RMM pools / managed memory and asynchronous allocator are both
enabled, or if <code class="docutils literal notranslate"><span class="pre">ucx_net_devices="auto"</span></code> and:</p>
<blockquote>
<div><ul class="simple">
<li><p>UCX-Py is not installed or wasn&rsquo;t compiled with hwloc support; or</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">enable_infiniband=False</span></code></p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">LocalCluster</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dask_cuda</span> <span class="kn">import</span> <span class="n">LocalCUDACluster</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dask.distributed</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cluster</span> <span class="o">=</span> <span class="n">LocalCUDACluster</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dask_cuda.LocalCUDACluster.new_worker_spec">
<span class="sig-name descname"><span class="pre">new_worker_spec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dask_cuda/local_cuda_cluster.html#LocalCUDACluster.new_worker_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dask_cuda.LocalCUDACluster.new_worker_spec" title="Permalink to this definition"></a></dt>
<dd><p>Return name and spec for the next worker</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>d: dict mapping names to worker specs</dt><dd></dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">scale</span></code></dt><dd></dd>
</dl>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="worker">
<h2>Worker<a class="headerlink" href="#worker" title="Permalink to this headline"></a></h2>
<div class="section" id="dask-cuda-worker">
<h3>dask-cuda-worker<a class="headerlink" href="#dask-cuda-worker" title="Permalink to this headline"></a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>dask-cuda-worker <span class="o">[</span>OPTIONS<span class="o">]</span> <span class="o">[</span>SCHEDULER<span class="o">]</span> <span class="o">[</span>PRELOAD_ARGV<span class="o">]</span>...
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-host">
<span class="sig-name descname"><span class="pre">--host</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;host&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-host" title="Permalink to this definition"></a></dt>
<dd><p>IP address of serving host; should be visible to the scheduler and other
workers. Can be a string (like <code class="docutils literal notranslate"><span class="pre">"127.0.0.1"</span></code>) or <code class="docutils literal notranslate"><span class="pre">None</span></code> to fall back on the
address of the interface specified by <code class="docutils literal notranslate"><span class="pre">--interface</span></code> or the default interface.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-nthreads">
<span class="sig-name descname"><span class="pre">--nthreads</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;nthreads&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-nthreads" title="Permalink to this definition"></a></dt>
<dd><p>Number of threads to be used for each Dask worker process.</p>
<dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-name">
<span class="sig-name descname"><span class="pre">--name</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;name&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-name" title="Permalink to this definition"></a></dt>
<dd><p>A unique name for the worker. Can be a string (like <code class="docutils literal notranslate"><span class="pre">"worker-1"</span></code>) or
<code class="docutils literal notranslate"><span class="pre">None</span></code> for a nameless worker. If used with <code class="docutils literal notranslate"><span class="pre">--nprocs</span></code>, then the process number
will be appended to the worker name, e.g. <code class="docutils literal notranslate"><span class="pre">"worker-1-0"</span></code>, <code class="docutils literal notranslate"><span class="pre">"worker-1-1"</span></code>,
<code class="docutils literal notranslate"><span class="pre">"worker-1-2"</span></code>.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-memory-limit">
<span class="sig-name descname"><span class="pre">--memory-limit</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;memory_limit&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-memory-limit" title="Permalink to this definition"></a></dt>
<dd><p>Bytes of memory per process that the worker can use. Can be an integer
(bytes), float (fraction of total system memory), string (like <code class="docutils literal notranslate"><span class="pre">"5GB"</span></code> or
<code class="docutils literal notranslate"><span class="pre">"5000M"</span></code>), or <code class="docutils literal notranslate"><span class="pre">"auto"</span></code> or 0 for no memory management.</p>
<dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>auto</p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-device-memory-limit">
<span class="sig-name descname"><span class="pre">--device-memory-limit</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;device_memory_limit&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-device-memory-limit" title="Permalink to this definition"></a></dt>
<dd><p>Size of the CUDA device LRU cache, which is used to determine when the
worker starts spilling to host memory. Can be an integer (bytes), float (fraction of
total device memory), string (like <code class="docutils literal notranslate"><span class="pre">"5GB"</span></code> or <code class="docutils literal notranslate"><span class="pre">"5000M"</span></code>), or <code class="docutils literal notranslate"><span class="pre">"auto"</span></code> or 0 to
disable spilling to host (i.e. allow full device memory usage).</p>
<dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>0.8</p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-rmm-pool-size">
<span class="sig-name descname"><span class="pre">--rmm-pool-size</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;rmm_pool_size&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-rmm-pool-size" title="Permalink to this definition"></a></dt>
<dd><p>RMM pool size to initialize each worker with. Can be an integer (bytes),
string (like <code class="docutils literal notranslate"><span class="pre">"5GB"</span></code> or <code class="docutils literal notranslate"><span class="pre">"5000M"</span></code>), or <code class="docutils literal notranslate"><span class="pre">None</span></code> to disable RMM pools.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This size is a per-worker configuration, and not cluster-wide.</p>
</div>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-rmm-managed-memory">
<span id="cmdoption-dask-cuda-worker-no-rmm-managed-memory"></span><span class="sig-name descname"><span class="pre">--rmm-managed-memory</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-rmm-managed-memory</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-rmm-managed-memory" title="Permalink to this definition"></a></dt>
<dd><p>Initialize each worker with RMM and set it to use managed memory. If
disabled, RMM may still be used by specifying <code class="docutils literal notranslate"><span class="pre">--rmm-pool-size</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Managed memory is currently incompatible with NVLink. Trying to enable both will
result in failure.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>False</p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-rmm-async">
<span id="cmdoption-dask-cuda-worker-no-rmm-async"></span><span class="sig-name descname"><span class="pre">--rmm-async</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-rmm-async</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-rmm-async" title="Permalink to this definition"></a></dt>
<dd><p>Initialize each worker withh RMM and set it to use RMM&rsquo;s asynchronous
allocator. See <code class="docutils literal notranslate"><span class="pre">rmm.mr.CudaAsyncMemoryResource</span></code> for more info.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The asynchronous allocator requires CUDA Toolkit 11.2 or newer. It is also
incompatible with RMM pools and managed memory, trying to enable both will
result in failure.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>False</p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-rmm-log-directory">
<span class="sig-name descname"><span class="pre">--rmm-log-directory</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;rmm_log_directory&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-rmm-log-directory" title="Permalink to this definition"></a></dt>
<dd><p>Directory to write per-worker RMM log files to. The client and scheduler are
not logged here. Can be a string (like <code class="docutils literal notranslate"><span class="pre">"/path/to/logs/"</span></code>) or <code class="docutils literal notranslate"><span class="pre">None</span></code> to disable
logging.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Logging will only be enabled if <code class="docutils literal notranslate"><span class="pre">--rmm-pool-size</span></code> or <code class="docutils literal notranslate"><span class="pre">--rmm-managed-memory</span></code>
are specified.</p>
</div>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-pid-file">
<span class="sig-name descname"><span class="pre">--pid-file</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;pid_file&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-pid-file" title="Permalink to this definition"></a></dt>
<dd><p>File to write the process PID.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-resources">
<span class="sig-name descname"><span class="pre">--resources</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;resources&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-resources" title="Permalink to this definition"></a></dt>
<dd><p>Resources for task constraints like <code class="docutils literal notranslate"><span class="pre">"GPU=2</span> <span class="pre">MEM=10e9"</span></code>. Resources are
applied separately to each worker process (only relevant when starting multiple
worker processes with <code class="docutils literal notranslate"><span class="pre">--nprocs</span></code>).</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-dashboard">
<span id="cmdoption-dask-cuda-worker-no-dashboard"></span><span class="sig-name descname"><span class="pre">--dashboard</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-dashboard</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-dashboard" title="Permalink to this definition"></a></dt>
<dd><p>Launch the dashboard.</p>
<dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>True</p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-dashboard-address">
<span class="sig-name descname"><span class="pre">--dashboard-address</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;dashboard_address&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-dashboard-address" title="Permalink to this definition"></a></dt>
<dd><p>Relative address to serve the dashboard (if enabled).</p>
<dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>:0</p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-local-directory">
<span class="sig-name descname"><span class="pre">--local-directory</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;local_directory&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-local-directory" title="Permalink to this definition"></a></dt>
<dd><p>Path on local machine to store temporary files. Can be a string (like
<code class="docutils literal notranslate"><span class="pre">"path/to/files"</span></code>) or <code class="docutils literal notranslate"><span class="pre">None</span></code> to fall back on the value of
<code class="docutils literal notranslate"><span class="pre">dask.temporary-directory</span></code> in the local Dask configuration, using the current
working directory if this is not set.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-shared-filesystem">
<span id="cmdoption-dask-cuda-worker-no-shared-filesystem"></span><span class="sig-name descname"><span class="pre">--shared-filesystem</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--no-shared-filesystem</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-shared-filesystem" title="Permalink to this definition"></a></dt>
<dd><p>If <cite>&ndash;shared-filesystem</cite> is specified, inform JIT-Unspill that
<cite>local_directory</cite> is a shared filesystem available for all workers, whereas
<cite>&ndash;no-shared-filesystem</cite> informs it may not assume it&rsquo;s a shared filesystem.
If neither is specified, JIT-Unspill will decide based on the Dask config value
specified by <cite>&ldquo;jit-unspill-shared-fs&rdquo;</cite>.
Notice, a shared filesystem must support the <cite>os.link()</cite> operation.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-scheduler-file">
<span class="sig-name descname"><span class="pre">--scheduler-file</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;scheduler_file&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-scheduler-file" title="Permalink to this definition"></a></dt>
<dd><p>Filename to JSON encoded scheduler information. To be used in conjunction
with the equivalent <code class="docutils literal notranslate"><span class="pre">dask-scheduler</span></code> option.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-protocol">
<span class="sig-name descname"><span class="pre">--protocol</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;protocol&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-protocol" title="Permalink to this definition"></a></dt>
<dd><p>Protocol like tcp, tls, or ucx</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-interface">
<span class="sig-name descname"><span class="pre">--interface</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;interface&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-interface" title="Permalink to this definition"></a></dt>
<dd><p>External interface used to connect to the scheduler. Usually an ethernet
interface is used for connection, and not an InfiniBand interface (if one is
available). Can be a string (like <code class="docutils literal notranslate"><span class="pre">"eth0"</span></code> for NVLink or <code class="docutils literal notranslate"><span class="pre">"ib0"</span></code> for
InfiniBand) or <code class="docutils literal notranslate"><span class="pre">None</span></code> to fall back on the default interface.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-preload">
<span class="sig-name descname"><span class="pre">--preload</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;preload&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-preload" title="Permalink to this definition"></a></dt>
<dd><p>Module that should be loaded by each worker process like <code class="docutils literal notranslate"><span class="pre">"foo.bar"</span></code> or
<code class="docutils literal notranslate"><span class="pre">"/path/to/foo.py"</span></code>.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-dashboard-prefix">
<span class="sig-name descname"><span class="pre">--dashboard-prefix</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;dashboard_prefix&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-dashboard-prefix" title="Permalink to this definition"></a></dt>
<dd><p>Prefix for the dashboard. Can be a string (like &hellip;) or <code class="docutils literal notranslate"><span class="pre">None</span></code> for no
prefix.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-tls-ca-file">
<span class="sig-name descname"><span class="pre">--tls-ca-file</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;tls_ca_file&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-tls-ca-file" title="Permalink to this definition"></a></dt>
<dd><p>CA certificate(s) file for TLS (in PEM format). Can be a string (like
<code class="docutils literal notranslate"><span class="pre">"path/to/certs"</span></code>), or <code class="docutils literal notranslate"><span class="pre">None</span></code> for no certificate(s).</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-tls-cert">
<span class="sig-name descname"><span class="pre">--tls-cert</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;tls_cert&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-tls-cert" title="Permalink to this definition"></a></dt>
<dd><p>Certificate file for TLS (in PEM format). Can be a string (like
<code class="docutils literal notranslate"><span class="pre">"path/to/certs"</span></code>), or <code class="docutils literal notranslate"><span class="pre">None</span></code> for no certificate(s).</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-tls-key">
<span class="sig-name descname"><span class="pre">--tls-key</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;tls_key&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-tls-key" title="Permalink to this definition"></a></dt>
<dd><p>Private key file for TLS (in PEM format). Can be a string (like
<code class="docutils literal notranslate"><span class="pre">"path/to/certs"</span></code>), or <code class="docutils literal notranslate"><span class="pre">None</span></code> for no private key.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-enable-tcp-over-ucx">
<span id="cmdoption-dask-cuda-worker-disable-tcp-over-ucx"></span><span class="sig-name descname"><span class="pre">--enable-tcp-over-ucx</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--disable-tcp-over-ucx</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-enable-tcp-over-ucx" title="Permalink to this definition"></a></dt>
<dd><p>Set environment variables to enable TCP over UCX, even if InfiniBand and
NVLink are not supported or disabled.</p>
<dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>False</p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-enable-infiniband">
<span id="cmdoption-dask-cuda-worker-disable-infiniband"></span><span class="sig-name descname"><span class="pre">--enable-infiniband</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--disable-infiniband</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-enable-infiniband" title="Permalink to this definition"></a></dt>
<dd><p>Set environment variables to enable UCX over InfiniBand, implies
<code class="docutils literal notranslate"><span class="pre">--enable-tcp-over-ucx</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>False</p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-enable-nvlink">
<span id="cmdoption-dask-cuda-worker-disable-nvlink"></span><span class="sig-name descname"><span class="pre">--enable-nvlink</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--disable-nvlink</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-enable-nvlink" title="Permalink to this definition"></a></dt>
<dd><p>Set environment variables to enable UCX over NVLink, implies
<code class="docutils literal notranslate"><span class="pre">--enable-tcp-over-ucx</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>False</p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-enable-rdmacm">
<span id="cmdoption-dask-cuda-worker-disable-rdmacm"></span><span class="sig-name descname"><span class="pre">--enable-rdmacm</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--disable-rdmacm</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-enable-rdmacm" title="Permalink to this definition"></a></dt>
<dd><p>Set environment variables to enable UCX RDMA connection manager support,
requires <code class="docutils literal notranslate"><span class="pre">--enable-infiniband</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>False</p>
</dd>
</dl>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-net-devices">
<span class="sig-name descname"><span class="pre">--net-devices</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;net_devices&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-net-devices" title="Permalink to this definition"></a></dt>
<dd><p>Interface(s) used by workers for UCX communication. Can be a string (like
<code class="docutils literal notranslate"><span class="pre">"eth0"</span></code> for NVLink or <code class="docutils literal notranslate"><span class="pre">"mlx5_0:1"</span></code>/<code class="docutils literal notranslate"><span class="pre">"ib0"</span></code> for InfiniBand), <code class="docutils literal notranslate"><span class="pre">"auto"</span></code>
(requires <code class="docutils literal notranslate"><span class="pre">--enable-infiniband</span></code>) to pick the optimal interface per-worker based on
the system&rsquo;s topology, or <code class="docutils literal notranslate"><span class="pre">None</span></code> to stay with the default value of <code class="docutils literal notranslate"><span class="pre">"all"</span></code> (use
all available interfaces).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">"auto"</span></code> requires UCX-Py to be installed and compiled with hwloc support.
Unexpected errors can occur when using <code class="docutils literal notranslate"><span class="pre">"auto"</span></code> if any interfaces are
disconnected or improperly configured.</p>
</div>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-enable-jit-unspill">
<span id="cmdoption-dask-cuda-worker-disable-jit-unspill"></span><span class="sig-name descname"><span class="pre">--enable-jit-unspill</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--disable-jit-unspill</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-enable-jit-unspill" title="Permalink to this definition"></a></dt>
<dd><p>Enable just-in-time unspilling. Can be a boolean or <code class="docutils literal notranslate"><span class="pre">None</span></code> to fall back on
the value of <code class="docutils literal notranslate"><span class="pre">dask.jit-unspill</span></code> in the local Dask configuration, disabling
unspilling if this is not set.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is experimental and doesn&rsquo;t support memory spilling to disk. See
<code class="docutils literal notranslate"><span class="pre">proxy_object.ProxyObject</span></code> and <code class="docutils literal notranslate"><span class="pre">proxify_host_file.ProxifyHostFile</span></code> for more
info.</p>
</div>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-worker-class">
<span class="sig-name descname"><span class="pre">--worker-class</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;worker_class&gt;</span></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-worker-class" title="Permalink to this definition"></a></dt>
<dd><p>Use a different class than Distributed&rsquo;s default (<code class="docutils literal notranslate"><span class="pre">distributed.Worker</span></code>)
to spawn <code class="docutils literal notranslate"><span class="pre">distributed.Nanny</span></code>.</p>
</dd></dl>

<p class="rubric">Arguments</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-arg-SCHEDULER">
<span id="cmdoption-dask-cuda-worker-arg-scheduler"></span><span class="sig-name descname"><span class="pre">SCHEDULER</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-arg-SCHEDULER" title="Permalink to this definition"></a></dt>
<dd><p>Optional argument</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dask-cuda-worker-arg-PRELOAD_ARGV">
<span id="cmdoption-dask-cuda-worker-arg-preload-argv"></span><span class="sig-name descname"><span class="pre">PRELOAD_ARGV</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-dask-cuda-worker-arg-PRELOAD_ARGV" title="Permalink to this definition"></a></dt>
<dd><p>Optional argument(s)</p>
</dd></dl>

</div>
</div>
<div class="section" id="client-initialization">
<h2>Client initialization<a class="headerlink" href="#client-initialization" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dask_cuda.initialize.initialize">
<span class="sig-prename descclassname"><span class="pre">dask_cuda.initialize.</span></span><span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">create_cuda_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_tcp_over_ucx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_infiniband</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_nvlink</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_rdmacm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">net_devices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cuda_device_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dask_cuda/initialize.html#initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dask_cuda.initialize.initialize" title="Permalink to this definition"></a></dt>
<dd><p>Create CUDA context and initialize UCX-Py, depending on user parameters.</p>
<p>Sometimes it is convenient to initialize the CUDA context, particularly before
starting up Dask worker processes which create a variety of threads.</p>
<p>To ensure UCX works correctly, it is important to ensure it is initialized with the
correct options. This is especially important for the client, which cannot be
configured to use UCX with arguments like <code class="docutils literal notranslate"><span class="pre">LocalCUDACluster</span></code> and
<code class="docutils literal notranslate"><span class="pre">dask-cuda-worker</span></code>. This function will ensure that they are provided a UCX
configuration based on the flags and options passed by the user.</p>
<p>This function can also be used within a worker preload script for UCX configuration
of mainline Dask.distributed.
<a class="reference external" href="https://docs.dask.org/en/latest/setup/custom-startup.html">https://docs.dask.org/en/latest/setup/custom-startup.html</a></p>
<p>You can add it to your global config with the following YAML:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">distributed</span><span class="p">:</span>
  <span class="nt">worker</span><span class="p">:</span>
    <span class="nt">preload</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dask_cuda.initialize</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://docs.dask.org/en/latest/configuration.html">https://docs.dask.org/en/latest/configuration.html</a> for more information about
Dask configuration.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>create_cuda_context</strong><span class="classifier">bool, default True</span></dt><dd><p>Create CUDA context on initialization.</p>
</dd>
<dt><strong>enable_tcp_over_ucx</strong><span class="classifier">bool, default False</span></dt><dd><p>Set environment variables to enable TCP over UCX, even if InfiniBand and NVLink
are not supported or disabled.</p>
</dd>
<dt><strong>enable_infiniband</strong><span class="classifier">bool, default False</span></dt><dd><p>Set environment variables to enable UCX over InfiniBand, implies
<code class="docutils literal notranslate"><span class="pre">enable_tcp_over_ucx=True</span></code>.</p>
</dd>
<dt><strong>enable_nvlink</strong><span class="classifier">bool, default False</span></dt><dd><p>Set environment variables to enable UCX over NVLink, implies
<code class="docutils literal notranslate"><span class="pre">enable_tcp_over_ucx=True</span></code>.</p>
</dd>
<dt><strong>enable_rdmacm</strong><span class="classifier">bool, default False</span></dt><dd><p>Set environment variables to enable UCX RDMA connection manager support,
requires <code class="docutils literal notranslate"><span class="pre">enable_infiniband=True</span></code>.</p>
</dd>
<dt><strong>net_devices</strong><span class="classifier">str or callable, default &ldquo;&rdquo;</span></dt><dd><p>Interface(s) used by workers for UCX communication. Can be a string (like
<code class="docutils literal notranslate"><span class="pre">"eth0"</span></code> for NVLink, <code class="docutils literal notranslate"><span class="pre">"mlx5_0:1"</span></code>/<code class="docutils literal notranslate"><span class="pre">"ib0"</span></code> for InfiniBand, or <code class="docutils literal notranslate"><span class="pre">""</span></code> to use
all available devices), or a callable function that takes the index of the
current GPU to return an interface name (like
<code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">dev:</span> <span class="pre">"mlx5_%d:1"</span> <span class="pre">%</span> <span class="pre">(dev</span> <span class="pre">//</span> <span class="pre">2)</span></code>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">net_devices</span></code> is callable, a GPU index must be supplied through
<code class="docutils literal notranslate"><span class="pre">cuda_device_index</span></code>.</p>
</div>
</dd>
<dt><strong>cuda_device_index</strong><span class="classifier">int or None, default None</span></dt><dd><p>Index of the current GPU, which must be specified for <code class="docutils literal notranslate"><span class="pre">net_devices</span></code> if
it is callable. Can be an integer or <code class="docutils literal notranslate"><span class="pre">None</span></code> if <code class="docutils literal notranslate"><span class="pre">net_devices</span></code> is not
callable.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="explicit-comms">
<h2>Explicit-comms<a class="headerlink" href="#explicit-comms" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dask_cuda.explicit_comms.comms.CommsContext">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">dask_cuda.explicit_comms.comms.</span></span><span class="sig-name descname"><span class="pre">CommsContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">distributed.client.Client</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dask_cuda/explicit_comms/comms.html#CommsContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dask_cuda.explicit_comms.comms.CommsContext" title="Permalink to this definition"></a></dt>
<dd><p>Communication handler for explicit communication</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>client: Client, optional</strong></dt><dd><p>Specify client to use for communication. If None, use the default client.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dask_cuda.explicit_comms.comms.CommsContext.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coroutine</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lock_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dask_cuda/explicit_comms/comms.html#CommsContext.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dask_cuda.explicit_comms.comms.CommsContext.run" title="Permalink to this definition"></a></dt>
<dd><p>Run a coroutine on multiple workers</p>
<p>The coroutine is given the worker&rsquo;s state dict as the first argument
and <a href="#id1"><span class="problematic" id="id2">*</span></a>args as the following arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>coroutine: coroutine</strong></dt><dd><p>The function to run on each worker</p>
</dd>
<dt><strong>*args:</strong></dt><dd><p>Arguments for <cite>coroutine</cite></p>
</dd>
<dt><strong>workers: list, optional</strong></dt><dd><p>List of workers. Default is all workers</p>
</dd>
<dt><strong>lock_workers: bool, optional</strong></dt><dd><p>Use distributed.MultiLock to get exclusive access to the workers. Use
this flag to support parallel runs.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>ret: list</dt><dd><p>List of the output from each worker</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dask_cuda.explicit_comms.comms.CommsContext.submit">
<span class="sig-name descname"><span class="pre">submit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">worker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coroutine</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wait</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dask_cuda/explicit_comms/comms.html#CommsContext.submit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dask_cuda.explicit_comms.comms.CommsContext.submit" title="Permalink to this definition"></a></dt>
<dd><p>Run a coroutine on a single worker</p>
<p>The coroutine is given the worker&rsquo;s state dict as the first argument
and <a href="#id3"><span class="problematic" id="id4">*</span></a>args as the following arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>worker: str</strong></dt><dd><p>Worker to run the <cite>coroutine</cite></p>
</dd>
<dt><strong>coroutine: coroutine</strong></dt><dd><p>The function to run on the worker</p>
</dd>
<dt><strong>*args:</strong></dt><dd><p>Arguments for <cite>coroutine</cite></p>
</dd>
<dt><strong>wait: boolean, optional</strong></dt><dd><p>If True, waits for the coroutine to finished before returning.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>ret: object or Future</dt><dd><p>If wait=True, the result of <cite>coroutine</cite>
If wait=False, Future that can be waited on later.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer><div aria-label="Footer" class="rst-footer-buttons" role="navigation">
        <a accesskey="p" class="btn btn-neutral float-left" href="quickstart.html" rel="prev" title="Quickstart"><span aria-hidden="true" class="fa fa-arrow-circle-left"></span> Previous</a>
        <a accesskey="n" class="btn btn-neutral float-right" href="ucx.html" rel="next" title="UCX Integration">Next <span aria-hidden="true" class="fa fa-arrow-circle-right"></span></a>
    </div>

  <hr>

  <div role="contentinfo">
    <p>&copy; Copyright 2020-2021, NVIDIA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 


<script defer id="rapids-selector-js" src="/assets/js/custom.js"></script></body></html>