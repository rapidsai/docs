<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport"><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator">

    <title>Neighbors &mdash; raft 22.12.01 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2">
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2">
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2">

    <link href="../_static/pygments.css" rel="stylesheet" type="text/css">
    <link href="../_static/copybutton.css" rel="stylesheet" type="text/css">
    <link href="../_static/references.css" rel="stylesheet" type="text/css">
    <link href="https://docs.rapids.ai/assets/css/custom.css" rel="stylesheet" type="text/css">
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link as="script" href="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94" rel="preload">
<link as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94" rel="preload">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script defer="defer" src="https://docs.rapids.ai/assets/js/custom.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'cpp_api/neighbors';</script>
    <link href="../genindex.html" rel="index" title="Index">
    <link href="../search.html" rel="search" title="Search">
    <link href="solver.html" rel="next" title="Solvers">
    <link href="mdspan.html" rel="prev" title="Multi-dimensional Data">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="en" name="docsearch:language">
  <script id="rapids-selector-pixel-src" src="https://assets.adobedtm.com/5d4962a43b79/814eb6e9b4e1/launch-4bc07f1e0b0b.min.js"></script><link href="/assets/css/custom.css" id="rapids-selector-css" rel="stylesheet"></head>
  
  
  <body data-default-mode="" data-offset="180" data-spy="scroll" data-target="#bd-toc-nav">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input class="sidebar-toggle" id="__primary" name="__primary" type="checkbox">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input class="sidebar-toggle" id="__secondary" name="__secondary" type="checkbox">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form action="../search.html" class="bd-search d-flex align-items-center" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input aria-label="Search the docs ..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search the docs ..." spellcheck="false" type="search">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">

  
  
  
  
  
  
  

  
  
    <p class="title logo__title">raft 22.12.01 documentation</p>
  
</a>
    
  </div>

  
  <div class="navbar-header-items">
    <div class="ml-auto" id="navbar-center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
        Site Navigation
    </p>
    <ul class="navbar-nav" id="navbar-main-elements">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../quick_start.html">
                        Quick Start
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../build.html">
                        Install Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../developer_guide.html">
                        Developer Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../cpp_api.html">
                        C++ API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../pylibraft_api.html">
                        PyLibRAFT API Reference
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button aria-expanded="false" aria-haspopup="true" class="btn dropdown-toggle nav-item" data-toggle="dropdown" type="button">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../raft_dask_api.html">
                        RAFT Dask API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing.html">
                        Contributing
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button aria-label="Search" class="btn btn-sm navbar-btn search-button search-button__button" data-toggle="tooltip" title="Search">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button aria-label="light/dark" class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" data-toggle="tooltip" title="light/dark">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a class="nav-link" data-toggle="tooltip" href="https://github.com/rapidsai/raft" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a class="nav-link" data-toggle="tooltip" href="https://twitter.com/rapidsai" rel="noopener" target="_blank" title="Twitter"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button aria-label="Search" class="btn btn-sm navbar-btn search-button search-button__button" data-toggle="tooltip" title="Search">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar"><div id="rapids-pydata-container"><div class="rapids-home-container"><a class="rapids-home-container__home-btn" href="/api">Home</a></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">raft</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/clx/stable/api.html">clx</a><a class="rapids-selector__menu-item" href="/api/cucim/stable/api.html">cucim</a><a class="rapids-selector__menu-item" href="/api/cudf/stable/index.html">cudf</a><a class="rapids-selector__menu-item" href="/api/cudf-java/nightly">cudf-java</a><a class="rapids-selector__menu-item" href="/api/cugraph/stable">cugraph</a><a class="rapids-selector__menu-item" href="/api/cuml/stable/api.html">cuml</a><a class="rapids-selector__menu-item" href="/api/cusignal/stable/api.html">cusignal</a><a class="rapids-selector__menu-item" href="/api/cuspatial/stable">cuspatial</a><a class="rapids-selector__menu-item" href="/api/cuxfilter/stable">cuxfilter</a><a class="rapids-selector__menu-item" href="/api/dask-cuda/stable/api.html">dask-cuda</a><a class="rapids-selector__menu-item" href="/api/kvikio/stable/api.html">kvikio</a><a class="rapids-selector__menu-item" href="/api/libcudf/stable/namespacecudf.html">libcudf</a><a class="rapids-selector__menu-item" href="/api/libcugraph/stable">libcugraph</a><a class="rapids-selector__menu-item" href="/api/libcuml/stable">libcuml</a><a class="rapids-selector__menu-item" href="/api/libcuspatial/stable">libcuspatial</a><a class="rapids-selector__menu-item" href="/api/libkvikio/stable">libkvikio</a><a class="rapids-selector__menu-item" href="/api/librmm/stable/annotated.html">librmm</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/raft/stable">raft</a><a class="rapids-selector__menu-item" href="/api/rapids-cmake/stable/api.html">rapids-cmake</a><a class="rapids-selector__menu-item" href="/api/rmm/stable/api.html">rmm</a></div></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">stable (22.12)</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/raft/nightly">nightly (23.02)</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/raft/stable">stable (22.12)</a><a class="rapids-selector__menu-item" href="/api/raft/legacy">legacy (22.10)</a></div></div></div>
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
        Site Navigation
    </p>
    <ul class="navbar-nav" id="navbar-main-elements">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../quick_start.html">
                        Quick Start
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../build.html">
                        Install Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../developer_guide.html">
                        Developer Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../cpp_api.html">
                        C++ API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../pylibraft_api.html">
                        PyLibRAFT API Reference
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button aria-expanded="false" aria-haspopup="true" class="btn dropdown-toggle nav-item" data-toggle="dropdown" type="button">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../raft_dask_api.html">
                        RAFT Dask API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing.html">
                        Contributing
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button aria-label="light/dark" class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" data-toggle="tooltip" title="light/dark">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a class="nav-link" data-toggle="tooltip" href="https://github.com/rapidsai/raft" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a class="nav-link" data-toggle="tooltip" href="https://twitter.com/rapidsai" rel="noopener" target="_blank" title="Twitter"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav aria-label="Section navigation" class="bd-links" id="bd-docs-nav">
  <p aria-level="1" class="bd-links__title" role="heading">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="core.html">Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster.html">Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="distance.html">Distance</a></li>
<li class="toctree-l1"><a class="reference internal" href="linalg.html">Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="mdspan.html">Multi-dimensional Data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Neighbors</a></li>
<li class="toctree-l1"><a class="reference internal" href="solver.html">Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="random.html">Random</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparse.html">Sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="stats.html">Stats</a></li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main class="bd-main" id="main-content">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="neighbors">
<h1>Neighbors<a class="headerlink" href="#neighbors" title="Permalink to this heading">#</a></h1>
<p>This page provides C++ class references for the publicly-exposed elements of the neighbors package.</p>
<section id="brute-force">
<h2>Brute-force<a class="headerlink" href="#brute-force" title="Permalink to this heading">#</a></h2>
<p>Header: <code class="xref py py-obj docutils literal notranslate"><span class="pre">raft/neighbors/brute_force.cuh</span></code></p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft9neighbors11brute_force15knn_merge_partsEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewIK5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEE6size_tNSt8optionalIN4raft18device_vector_viewI5idx_t5idx_tEEEE">
<span id="_CPPv3I00EN4raft9neighbors11brute_force15knn_merge_partsERKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewIK5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEE6size_tNSt8optionalIN4raft18device_vector_viewI5idx_t5idx_tEEEE"></span><span id="_CPPv2I00EN4raft9neighbors11brute_force15knn_merge_partsERKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewIK5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEE6size_tNSt8optionalIN4raft18device_vector_viewI5idx_t5idx_tEEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1brute__force_1a564cdd1e0104f64f560cb80f97815222"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">brute_force</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">knn_merge_parts</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors11brute_force15knn_merge_partsEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewIK5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEE6size_tNSt8optionalIN4raft18device_vector_viewI5idx_t5idx_tEEEE" title="raft::neighbors::brute_force::knn_merge_parts::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors11brute_force15knn_merge_partsEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewIK5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEE6size_tNSt8optionalIN4raft18device_vector_viewI5idx_t5idx_tEEEE" title="raft::neighbors::brute_force::knn_merge_parts::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">in_keys</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors11brute_force15knn_merge_partsEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewIK5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEE6size_tNSt8optionalIN4raft18device_vector_viewI5idx_t5idx_tEEEE" title="raft::neighbors::brute_force::knn_merge_parts::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors11brute_force15knn_merge_partsEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewIK5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEE6size_tNSt8optionalIN4raft18device_vector_viewI5idx_t5idx_tEEEE" title="raft::neighbors::brute_force::knn_merge_parts::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">in_values</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors11brute_force15knn_merge_partsEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewIK5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEE6size_tNSt8optionalIN4raft18device_vector_viewI5idx_t5idx_tEEEE" title="raft::neighbors::brute_force::knn_merge_parts::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors11brute_force15knn_merge_partsEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewIK5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEE6size_tNSt8optionalIN4raft18device_vector_viewI5idx_t5idx_tEEEE" title="raft::neighbors::brute_force::knn_merge_parts::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out_keys</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors11brute_force15knn_merge_partsEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewIK5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEE6size_tNSt8optionalIN4raft18device_vector_viewI5idx_t5idx_tEEEE" title="raft::neighbors::brute_force::knn_merge_parts::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors11brute_force15knn_merge_partsEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewIK5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEE6size_tNSt8optionalIN4raft18device_vector_viewI5idx_t5idx_tEEEE" title="raft::neighbors::brute_force::knn_merge_parts::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out_values</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_samples</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_vector_viewE" title="raft::device_vector_view"><span class="n"><span class="pre">device_vector_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors11brute_force15knn_merge_partsEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewIK5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEE6size_tNSt8optionalIN4raft18device_vector_viewI5idx_t5idx_tEEEE" title="raft::neighbors::brute_force::knn_merge_parts::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors11brute_force15knn_merge_partsEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewIK5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEE6size_tNSt8optionalIN4raft18device_vector_viewI5idx_t5idx_tEEEE" title="raft::neighbors::brute_force::knn_merge_parts::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">translations</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">nullopt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft9neighbors11brute_force15knn_merge_partsEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewIK5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEE6size_tNSt8optionalIN4raft18device_vector_viewI5idx_t5idx_tEEEE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Performs a k-select across several (contiguous) row-partitioned index/distance matrices formatted like the following: </p>
<p>part1row1: k0, k1, k2, k3 part1row2: k0, k1, k2, k3 part1row3: k0, k1, k2, k3 part2row1: k0, k1, k2, k3 part2row2: k0, k1, k2, k3 part2row3: k0, k1, k2, k3 etc&hellip;</p>
<p>The example above shows what an aggregated index/distance matrix would look like with two partitions when n_samples=3 and k=4.</p>
<p>When working with extremely large data sets that have been broken over multiple indexes, such as when computing over multiple GPUs, the ids will often start at 0 for each local knn index but the global ids need to be used when merging them together. An optional translations vector can be supplied to map the starting id of each partition to its global id so that the final merged knn is based on the global ids.</p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/handle.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/neighbors/brute_force.cuh&gt;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">neighbors</span><span class="p">;</span><span class="w"></span>

<span class="n">raft</span><span class="o">::</span><span class="n">handle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">;</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
<span class="n">compute</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">knn</span><span class="w"> </span><span class="n">graphs</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">aggregate</span><span class="w"> </span><span class="n">row</span><span class="o">-</span><span class="n">wise</span><span class="w"></span>
<span class="p">(</span><span class="n">see</span><span class="w"> </span><span class="n">detailed</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">above</span><span class="p">)</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
<span class="n">brute_force</span><span class="o">::</span><span class="n">knn_merge_parts</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">in_keys</span><span class="p">,</span><span class="w"> </span><span class="n">in_values</span><span class="p">,</span><span class="w"> </span><span class="n">out_keys</span><span class="p">,</span><span class="w"> </span><span class="n">out_values</span><span class="p">,</span><span class="w"> </span><span class="n">n_samples</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx_t</strong> &ndash; </p></li>
<li><p><strong>value_t</strong> &ndash; </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>in_keys</strong> &ndash; <strong>[in]</strong> matrix of input keys (size n_samples * n_parts * k) </p></li>
<li><p><strong>in_values</strong> &ndash; <strong>[in]</strong> matrix of input values (size n_samples * n_parts * k) </p></li>
<li><p><strong>out_keys</strong> &ndash; <strong>[out]</strong> matrix of output keys (size n_samples * k) </p></li>
<li><p><strong>out_values</strong> &ndash; <strong>[out]</strong> matrix of output values (size n_samples * k) </p></li>
<li><p><strong>n_samples</strong> &ndash; <strong>[in]</strong> number of rows in each partition </p></li>
<li><p><strong>translations</strong> &ndash; <strong>[in]</strong> optional vector of starting global id mappings for each local partition </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000000EN4raft9neighbors11brute_force3knnEvRKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE">
<span id="_CPPv3I000000EN4raft9neighbors11brute_force3knnERKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE"></span><span id="_CPPv2I000000EN4raft9neighbors11brute_force3knnERKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_int</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">matrix_idx</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_layout</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">search_layout</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1brute__force_1ae024a88d8c37b98e463106f310682d18"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">brute_force</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">knn</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN4raft9neighbors11brute_force3knnEvRKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE" title="raft::neighbors::brute_force::knn::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN4raft9neighbors11brute_force3knnEvRKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE" title="raft::neighbors::brute_force::knn::matrix_idx"><span class="n"><span class="pre">matrix_idx</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN4raft9neighbors11brute_force3knnEvRKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE" title="raft::neighbors::brute_force::knn::index_layout"><span class="n"><span class="pre">index_layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">index</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN4raft9neighbors11brute_force3knnEvRKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE" title="raft::neighbors::brute_force::knn::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN4raft9neighbors11brute_force3knnEvRKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE" title="raft::neighbors::brute_force::knn::matrix_idx"><span class="n"><span class="pre">matrix_idx</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN4raft9neighbors11brute_force3knnEvRKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE" title="raft::neighbors::brute_force::knn::search_layout"><span class="n"><span class="pre">search_layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">search</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000000EN4raft9neighbors11brute_force3knnEvRKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE" title="raft::neighbors::brute_force::knn::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN4raft9neighbors11brute_force3knnEvRKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE" title="raft::neighbors::brute_force::knn::matrix_idx"><span class="n"><span class="pre">matrix_idx</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indices</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000000EN4raft9neighbors11brute_force3knnEvRKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE" title="raft::neighbors::brute_force::knn::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN4raft9neighbors11brute_force3knnEvRKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE" title="raft::neighbors::brute_force::knn::matrix_idx"><span class="n"><span class="pre">matrix_idx</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">distances</span></span>, <a class="reference internal" href="#_CPPv4I000000EN4raft9neighbors11brute_force3knnEvRKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE" title="raft::neighbors::brute_force::knn::value_int"><span class="n"><span class="pre">value_int</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <a class="reference internal" href="distance.html#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="distance.html#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="distance.html#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="distance.html#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="distance.html#_CPPv4N4raft8distance12DistanceType12L2UnexpandedE" title="raft::distance::DistanceType::L2Unexpanded"><span class="n"><span class="pre">L2Unexpanded</span></span></a>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">make_optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">2.0f</span></span><span class="p"><span class="pre">)</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000000EN4raft9neighbors11brute_force3knnEvRKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE" title="raft::neighbors::brute_force::knn::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">global_id_offset</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">nullopt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000000EN4raft9neighbors11brute_force3knnEvRKN4raft8handle_tENSt6vectorIN4raft18device_matrix_viewIK7value_t10matrix_idx12index_layoutEEEEN4raft18device_matrix_viewIK7value_t10matrix_idx13search_layoutEEN4raft18device_matrix_viewI5idx_t10matrix_idx9row_majorEEN4raft18device_matrix_viewI7value_t10matrix_idx9row_majorEE9value_intN8distance12DistanceTypeENSt8optionalIfEENSt8optionalI5idx_tEE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Flat C++ API function to perform a brute force knn on a series of input arrays and combine the results into a single output array for indexes and distances. Inputs can be either row- or column-major but the output matrices will always be in row-major format. </p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/handle.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/neighbors/brute_force.cuh&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/distance/distance_types.hpp&gt;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">neighbors</span><span class="p">;</span><span class="w"></span>

<span class="n">raft</span><span class="o">::</span><span class="n">handle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">;</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">distance</span><span class="o">::</span><span class="n">DistanceType</span><span class="o">::</span><span class="n">L2SqrtExpanded</span><span class="p">;</span><span class="w"></span>
<span class="n">brute_force</span><span class="o">::</span><span class="n">knn</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">search</span><span class="p">,</span><span class="w"> </span><span class="n">indices</span><span class="p">,</span><span class="w"> </span><span class="n">distances</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> the cuml handle to use </p></li>
<li><p><strong>index</strong> &ndash; <strong>[in]</strong> vector of device matrices (each size m_i*d) to be used as the knn index </p></li>
<li><p><strong>search</strong> &ndash; <strong>[in]</strong> matrix (size n*d) to be used for searching the index </p></li>
<li><p><strong>indices</strong> &ndash; <strong>[out]</strong> matrix (size n*k) to store output knn indices </p></li>
<li><p><strong>distances</strong> &ndash; <strong>[out]</strong> matrix (size n*k) to store the output knn distance </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> the number of nearest neighbors to return </p></li>
<li><p><strong>metric</strong> &ndash; <strong>[in]</strong> distance metric to use. Euclidean (L2) is used by default </p></li>
<li><p><strong>metric_arg</strong> &ndash; <strong>[in]</strong> the value of <code class="docutils literal notranslate"><span class="pre">p</span></code> for Minkowski (l-p) distances. This is ignored if the metric_type is not Minkowski. </p></li>
<li><p><strong>global_id_offset</strong> &ndash; <strong>[in]</strong> optional starting global id mapping for the local partition (assumes the index contains contiguous ids in the global id space) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN4raft9neighbors11brute_force12fused_l2_knnEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t10idx_layoutEEN4raft18device_matrix_viewIK7value_t5idx_t12query_layoutEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft8distance12DistanceTypeE">
<span id="_CPPv3I0000EN4raft9neighbors11brute_force12fused_l2_knnERKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t10idx_layoutEEN4raft18device_matrix_viewIK7value_t5idx_t12query_layoutEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft8distance12DistanceTypeE"></span><span id="_CPPv2I0000EN4raft9neighbors11brute_force12fused_l2_knnERKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t10idx_layoutEEN4raft18device_matrix_viewIK7value_t5idx_t12query_layoutEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft8distance12DistanceTypeE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_layout</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">query_layout</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1brute__force_1a6317fead65616c29110025eadc002fb8"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">brute_force</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">fused_l2_knn</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors11brute_force12fused_l2_knnEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t10idx_layoutEEN4raft18device_matrix_viewIK7value_t5idx_t12query_layoutEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft8distance12DistanceTypeE" title="raft::neighbors::brute_force::fused_l2_knn::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors11brute_force12fused_l2_knnEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t10idx_layoutEEN4raft18device_matrix_viewIK7value_t5idx_t12query_layoutEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft8distance12DistanceTypeE" title="raft::neighbors::brute_force::fused_l2_knn::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors11brute_force12fused_l2_knnEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t10idx_layoutEEN4raft18device_matrix_viewIK7value_t5idx_t12query_layoutEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft8distance12DistanceTypeE" title="raft::neighbors::brute_force::fused_l2_knn::idx_layout"><span class="n"><span class="pre">idx_layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">index</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors11brute_force12fused_l2_knnEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t10idx_layoutEEN4raft18device_matrix_viewIK7value_t5idx_t12query_layoutEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft8distance12DistanceTypeE" title="raft::neighbors::brute_force::fused_l2_knn::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors11brute_force12fused_l2_knnEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t10idx_layoutEEN4raft18device_matrix_viewIK7value_t5idx_t12query_layoutEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft8distance12DistanceTypeE" title="raft::neighbors::brute_force::fused_l2_knn::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors11brute_force12fused_l2_knnEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t10idx_layoutEEN4raft18device_matrix_viewIK7value_t5idx_t12query_layoutEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft8distance12DistanceTypeE" title="raft::neighbors::brute_force::fused_l2_knn::query_layout"><span class="n"><span class="pre">query_layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">query</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors11brute_force12fused_l2_knnEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t10idx_layoutEEN4raft18device_matrix_viewIK7value_t5idx_t12query_layoutEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft8distance12DistanceTypeE" title="raft::neighbors::brute_force::fused_l2_knn::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors11brute_force12fused_l2_knnEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t10idx_layoutEEN4raft18device_matrix_viewIK7value_t5idx_t12query_layoutEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft8distance12DistanceTypeE" title="raft::neighbors::brute_force::fused_l2_knn::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out_inds</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors11brute_force12fused_l2_knnEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t10idx_layoutEEN4raft18device_matrix_viewIK7value_t5idx_t12query_layoutEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft8distance12DistanceTypeE" title="raft::neighbors::brute_force::fused_l2_knn::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors11brute_force12fused_l2_knnEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t10idx_layoutEEN4raft18device_matrix_viewIK7value_t5idx_t12query_layoutEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft8distance12DistanceTypeE" title="raft::neighbors::brute_force::fused_l2_knn::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out_dists</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="distance.html#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="distance.html#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN4raft9neighbors11brute_force12fused_l2_knnEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t5idx_t10idx_layoutEEN4raft18device_matrix_viewIK7value_t5idx_t12query_layoutEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI7value_t5idx_t9row_majorEEN4raft8distance12DistanceTypeE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Compute the k-nearest neighbors using L2 expanded/unexpanded distance. </p>
<p>This is a specialized function for fusing the k-selection with the distance computation when k &lt; 64. The value of k will be inferred from the number of columns in the output matrices.</p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/handle.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/neighbors/brute_force.cuh&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/distance/distance_types.hpp&gt;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">neighbors</span><span class="p">;</span><span class="w"></span>

<span class="n">raft</span><span class="o">::</span><span class="n">handle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">;</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">distance</span><span class="o">::</span><span class="n">DistanceType</span><span class="o">::</span><span class="n">L2SqrtExpanded</span><span class="p">;</span><span class="w"></span>
<span class="n">brute_force</span><span class="o">::</span><span class="n">fused_l2_knn</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">search</span><span class="p">,</span><span class="w"> </span><span class="n">indices</span><span class="p">,</span><span class="w"> </span><span class="n">distances</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_t</strong> &ndash; type of values </p></li>
<li><p><strong>idx_t</strong> &ndash; type of indices </p></li>
<li><p><strong>idx_layout</strong> &ndash; layout type of index matrix </p></li>
<li><p><strong>query_layout</strong> &ndash; layout type of query matrix </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> raft handle for sharing expensive resources </p></li>
<li><p><strong>index</strong> &ndash; <strong>[in]</strong> input index array on device (size m * d) </p></li>
<li><p><strong>query</strong> &ndash; <strong>[in]</strong> input query array on device (size n * d) </p></li>
<li><p><strong>out_inds</strong> &ndash; <strong>[out]</strong> output indices array on device (size n * k) </p></li>
<li><p><strong>out_dists</strong> &ndash; <strong>[out]</strong> output dists array on device (size n * k) </p></li>
<li><p><strong>metric</strong> &ndash; <strong>[in]</strong> type of distance computation to perform (must be a variant of L2) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="ivf-flat">
<h2>IVF-Flat<a class="headerlink" href="#ivf-flat" title="Permalink to this heading">#</a></h2>
<p>Header: <code class="xref py py-obj docutils literal notranslate"><span class="pre">raft/neighbors/ivf_flat.cuh</span></code></p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat15kIndexGroupSizeE">
<span id="_CPPv3N4raft9neighbors8ivf_flat15kIndexGroupSizeE"></span><span id="_CPPv2N4raft9neighbors8ivf_flat15kIndexGroupSizeE"></span><span id="raft::neighbors::ivf_flat::kIndexGroupSize__uint32_t"></span><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__flat_1a47bc14debcfc4e4b6ff1d54123f172e2"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_flat</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">kIndexGroupSize</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">32</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat15kIndexGroupSizeE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Size of the interleaved group (see <code class="docutils literal notranslate"><a class="reference internal" href="#structraft_1_1neighbors_1_1ivf__flat_1_1index_1a0ff8ac7aa31fae1b739f04e566df7fd2"><span class="std std-ref"><span class="pre">index::data</span></span></a></code> description). </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft9neighbors8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t">
<span id="_CPPv3I00EN4raft9neighbors8ivf_flat5buildERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t"></span><span id="_CPPv2I00EN4raft9neighbors8ivf_flat5buildERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__flat_1a862bdf0c894d7c62c3cb6d0aff6a765f"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_flat</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">build</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">index_params</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::neighbors::ivf_flat::build::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dataset</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::neighbors::ivf_flat::build::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_rows</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::neighbors::ivf_flat::build::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::neighbors::ivf_flat::build::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft9neighbors8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="Permalink to this definition">#</a><br></dt>
<dd><p>Build the index from the dataset for efficient search. </p>
<p>NB: Currently, the following distance metrics are supported:</p><ul class="simple">
<li><p>L2Expanded</p></li>
<li><p>L2Unexpanded</p></li>
<li><p>InnerProduct</p></li>
</ul>
<p></p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">neighbors</span><span class="p">;</span><span class="w"></span>
<span class="c1">// use default index parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// create and fill the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">);</span><span class="w"></span>
<span class="c1">// use default search parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search_params</span><span class="w"> </span><span class="n">search_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// search K nearest neighbours for each of the N queries</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>params</strong> &ndash; <strong>[in]</strong> configure the index building </p></li>
<li><p><strong>dataset</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, dim] </p></li>
<li><p><strong>n_rows</strong> &ndash; <strong>[in]</strong> the number of samples </p></li>
<li><p><strong>dim</strong> &ndash; <strong>[in]</strong> the dimensionality of the data</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the constructed ivf-flat index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft9neighbors8ivf_flat5buildE5indexI7value_t5idx_tERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params">
<span id="_CPPv3I00EN4raft9neighbors8ivf_flat5buildERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params"></span><span id="_CPPv2I00EN4raft9neighbors8ivf_flat5buildERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__flat_1aa97ecde1f0660e8b2fed5efc942abeae"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_flat</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">build</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat5buildE5indexI7value_t5idx_tERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params" title="raft::neighbors::ivf_flat::build::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat5buildE5indexI7value_t5idx_tERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params" title="raft::neighbors::ivf_flat::build::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dataset</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">index_params</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat5buildE5indexI7value_t5idx_tERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params" title="raft::neighbors::ivf_flat::build::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat5buildE5indexI7value_t5idx_tERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params" title="raft::neighbors::ivf_flat::build::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft9neighbors8ivf_flat5buildE5indexI7value_t5idx_tERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params" title="Permalink to this definition">#</a><br></dt>
<dd><p>Build the index from the dataset for efficient search. </p>
<p>NB: Currently, the following distance metrics are supported:</p><ul class="simple">
<li><p>L2Expanded</p></li>
<li><p>L2Unexpanded</p></li>
<li><p>InnerProduct</p></li>
</ul>
<p></p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">neighbors</span><span class="p">;</span><span class="w"></span>
<span class="c1">// use default index parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// create and fill the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">);</span><span class="w"></span>
<span class="c1">// use default search parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search_params</span><span class="w"> </span><span class="n">search_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// search K nearest neighbours for each of the N queries</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_t</strong> &ndash; data element type </p></li>
<li><p><strong>idx_t</strong> &ndash; type of the indices in the source dataset </p></li>
<li><p><strong>int_t</strong> &ndash; precision / type of integral arguments </p></li>
<li><p><strong>matrix_idx_t</strong> &ndash; matrix indexing type</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>params</strong> &ndash; <strong>[in]</strong> configure the index building </p></li>
<li><p><strong>dataset</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, dim]</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the constructed ivf-flat index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT">
<span id="_CPPv3I00EN4raft9neighbors8ivf_flat6extendERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT"></span><span id="_CPPv2I00EN4raft9neighbors8ivf_flat6extendERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__flat_1a68ad1bf995c7c7d1a95815e71d3650b9"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_flat</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">extend</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">orig_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_vectors</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_indices</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_rows</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="Permalink to this definition">#</a><br></dt>
<dd><p>Build a new index containing the data of the original plus new extra vectors. </p>
<p>Implementation note: The new data is clustered according to existing kmeans clusters, then the cluster centers are adjusted to match the newly labeled data.</p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">neighbors</span><span class="p">;</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="n">index_params</span><span class="p">.</span><span class="n">add_data_on_build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">      </span><span class="c1">// don't populate index on build</span>
<span class="n">index_params</span><span class="p">.</span><span class="n">kmeans_trainset_fraction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"> </span><span class="c1">// use whole dataset for kmeans training</span>
<span class="c1">// train the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index_empty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">);</span><span class="w"></span>
<span class="c1">// fill the index with the data</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">extend</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_empty</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>orig_index</strong> &ndash; <strong>[in]</strong> original index </p></li>
<li><p><strong>new_vectors</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, <a class="reference internal" href="#structraft_1_1neighbors_1_1ivf__flat_1_1index_1af880dc84b13e6dc993c11dba568ee85d"><span class="std std-ref">index.dim()</span></a>] </p></li>
<li><p><strong>new_indices</strong> &ndash; <strong>[in]</strong> a device pointer to a vector of indices [n_rows]. If the original index is empty (<code class="docutils literal notranslate"><span class="pre">orig_index.size()</span> <span class="pre">==</span> <span class="pre">0</span></code>), you can pass <code class="docutils literal notranslate"><span class="pre">nullptr</span></code> here to imply a continuous range <code class="docutils literal notranslate"><span class="pre">[0...n_rows)</span></code>. </p></li>
<li><p><strong>n_rows</strong> &ndash; <strong>[in]</strong> number of rows in <code class="docutils literal notranslate"><span class="pre">new_vectors</span></code></p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the constructed extended ivf-flat index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE">
<span id="_CPPv3I00EN4raft9neighbors8ivf_flat6extendERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE"></span><span id="_CPPv2I00EN4raft9neighbors8ivf_flat6extendERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__flat_1a57765db9d8217a82de549a38b6a2dfed"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_flat</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">extend</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::neighbors::ivf_flat::extend::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::neighbors::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">orig_index</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::neighbors::ivf_flat::extend::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::neighbors::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">new_vectors</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_vector_view</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::neighbors::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::neighbors::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">new_indices</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">nullopt</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::neighbors::ivf_flat::extend::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::neighbors::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Build a new index containing the data of the original plus new extra vectors. </p>
<p>Implementation note: The new data is clustered according to existing kmeans clusters, then the cluster centers are adjusted to match the newly labeled data.</p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">neighbors</span><span class="p">;</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="n">index_params</span><span class="p">.</span><span class="n">add_data_on_build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">      </span><span class="c1">// don't populate index on build</span>
<span class="n">index_params</span><span class="p">.</span><span class="n">kmeans_trainset_fraction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"> </span><span class="c1">// use whole dataset for kmeans training</span>
<span class="c1">// train the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index_empty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">);</span><span class="w"></span>
<span class="c1">// fill the index with the data</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">extend</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_empty</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_t</strong> &ndash; data element type </p></li>
<li><p><strong>idx_t</strong> &ndash; type of the indices in the source dataset </p></li>
<li><p><strong>int_t</strong> &ndash; precision / type of integral arguments </p></li>
<li><p><strong>matrix_idx_t</strong> &ndash; matrix indexing type</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>orig_index</strong> &ndash; <strong>[in]</strong> original index </p></li>
<li><p><strong>new_vectors</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, <a class="reference internal" href="#structraft_1_1neighbors_1_1ivf__flat_1_1index_1af880dc84b13e6dc993c11dba568ee85d"><span class="std std-ref">index.dim()</span></a>] </p></li>
<li><p><strong>new_indices</strong> &ndash; <strong>[in]</strong> a device pointer to a vector of indices [n_rows]. If the original index is empty (<code class="docutils literal notranslate"><span class="pre">orig_index.size()</span> <span class="pre">==</span> <span class="pre">0</span></code>), you can pass <code class="docutils literal notranslate"><span class="pre">nullptr</span></code> here to imply a continuous range <code class="docutils literal notranslate"><span class="pre">[0...n_rows)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the constructed extended ivf-flat index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT">
<span id="_CPPv3I00EN4raft9neighbors8ivf_flat6extendERK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT"></span><span id="_CPPv2I00EN4raft9neighbors8ivf_flat6extendERK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__flat_1ae38ffdc5a0850dd1c30082b1ba1bcefd"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_flat</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">extend</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_flat::extend::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_vectors</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_indices</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="Permalink to this definition">#</a><br></dt>
<dd><p>Extend the index in-place with the new data. </p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">neighbors</span><span class="p">;</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="n">index_params</span><span class="p">.</span><span class="n">add_data_on_build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">      </span><span class="c1">// don't populate index on build</span>
<span class="n">index_params</span><span class="p">.</span><span class="n">kmeans_trainset_fraction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"> </span><span class="c1">// use whole dataset for kmeans training</span>
<span class="c1">// train the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index_empty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">);</span><span class="w"></span>
<span class="c1">// fill the index with the data</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">extend</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_empty</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; </p></li>
<li><p><strong>index</strong> &ndash; <strong>[inout]</strong> </p></li>
<li><p><strong>new_vectors</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, <a class="reference internal" href="#structraft_1_1neighbors_1_1ivf__flat_1_1index_1af880dc84b13e6dc993c11dba568ee85d"><span class="std std-ref">index.dim()</span></a>] </p></li>
<li><p><strong>new_indices</strong> &ndash; <strong>[in]</strong> a device pointer to a vector of indices [n_rows]. If the original index is empty (<code class="docutils literal notranslate"><span class="pre">orig_index.size()</span> <span class="pre">==</span> <span class="pre">0</span></code>), you can pass <code class="docutils literal notranslate"><span class="pre">nullptr</span></code> here to imply a continuous range <code class="docutils literal notranslate"><span class="pre">[0...n_rows)</span></code>. </p></li>
<li><p><strong>n_rows</strong> &ndash; <strong>[in]</strong> the number of samples </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE">
<span id="_CPPv3I00EN4raft9neighbors8ivf_flat6extendERK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE"></span><span id="_CPPv2I00EN4raft9neighbors8ivf_flat6extendERK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__flat_1a96136ae1692530db08d2a7b16fc7df9d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_flat</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">extend</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::neighbors::ivf_flat::extend::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::neighbors::ivf_flat::extend::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::neighbors::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">index</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::neighbors::ivf_flat::extend::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::neighbors::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">new_vectors</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_vector_view</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::neighbors::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::neighbors::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">new_indices</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">nullopt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Extend the index in-place with the new data. </p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">neighbors</span><span class="p">;</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="n">index_params</span><span class="p">.</span><span class="n">add_data_on_build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">      </span><span class="c1">// don't populate index on build</span>
<span class="n">index_params</span><span class="p">.</span><span class="n">kmeans_trainset_fraction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"> </span><span class="c1">// use whole dataset for kmeans training</span>
<span class="c1">// train the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index_empty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">);</span><span class="w"></span>
<span class="c1">// fill the index with the data</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">extend</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_empty</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_t</strong> &ndash; data element type </p></li>
<li><p><strong>idx_t</strong> &ndash; type of the indices in the source dataset </p></li>
<li><p><strong>int_t</strong> &ndash; precision / type of integral arguments </p></li>
<li><p><strong>matrix_idx_t</strong> &ndash; matrix indexing type</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>index</strong> &ndash; <strong>[inout]</strong> </p></li>
<li><p><strong>new_vectors</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, <a class="reference internal" href="#structraft_1_1neighbors_1_1ivf__flat_1_1index_1af880dc84b13e6dc993c11dba568ee85d"><span class="std std-ref">index.dim()</span></a>] </p></li>
<li><p><strong>new_indices</strong> &ndash; <strong>[in]</strong> a device pointer to a vector of indices [n_rows]. If the original index is empty (<code class="docutils literal notranslate"><span class="pre">orig_index.size()</span> <span class="pre">==</span> <span class="pre">0</span></code>), you can pass <code class="docutils literal notranslate"><span class="pre">std::nullopt</span></code> here to imply a continuous range <code class="docutils literal notranslate"><span class="pre">[0...n_rows)</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE">
<span id="_CPPv3I00EN4raft9neighbors8ivf_flat6searchERK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE"></span><span id="_CPPv2I00EN4raft9neighbors8ivf_flat6searchERK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__flat_1a5dc795b47aae11892e35879c62af30e7"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_flat</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">search</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">search_params</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::neighbors::ivf_flat::search::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::neighbors::ivf_flat::search::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::neighbors::ivf_flat::search::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::neighbors::ivf_flat::search::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">queries</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_queries</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::neighbors::ivf_flat::search::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">neighbors</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">distances</span></span>, <span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mr</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_memory_resource</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">mr</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Search ANN using the constructed index. </p>
<p>See the <a class="reference external" href="#ivf_flat::build">ivf_flat::build</a> documentation for a usage example.</p>
<p>Note, this function requires a temporary buffer to store intermediate results between cuda kernel calls, which may lead to undesirable allocations and slowdown. To alleviate the problem, you can pass a pool memory resource or a large enough pre-allocated memory resource to reduce or eliminate entirely allocations happening within <code class="docutils literal notranslate"><span class="pre">search</span></code>: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="p">...</span><span class="w"></span>
<span class="c1">// Create a pooling memory resource with a pre-defined initial size.</span>
<span class="n">rmm</span><span class="o">::</span><span class="n">mr</span><span class="o">::</span><span class="n">pool_memory_resource</span><span class="o">&lt;</span><span class="n">rmm</span><span class="o">::</span><span class="n">mr</span><span class="o">::</span><span class="n">device_memory_resource</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mr</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="n">rmm</span><span class="o">::</span><span class="n">mr</span><span class="o">::</span><span class="n">get_current_device_resource</span><span class="p">(),</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">);</span><span class="w"></span>
<span class="c1">// use default search parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search_params</span><span class="w"> </span><span class="n">search_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// Use the same allocator across multiple searches to reduce the number of</span>
<span class="c1">// cuda memory allocations</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries1</span><span class="p">,</span><span class="w"> </span><span class="n">N1</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds1</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mr</span><span class="p">);</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries2</span><span class="p">,</span><span class="w"> </span><span class="n">N2</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds2</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists2</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mr</span><span class="p">);</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries3</span><span class="p">,</span><span class="w"> </span><span class="n">N3</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds3</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists3</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mr</span><span class="p">);</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
</pre></div>
</div>
 The exact size of the temporary buffer depends on multiple factors and is an implementation detail. However, you can safely specify a small initial size for the memory pool, so that only a few allocations happen to grow it during the first invocations of the <code class="docutils literal notranslate"><span class="pre">search</span></code>.<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>params</strong> &ndash; <strong>[in]</strong> configure the search </p></li>
<li><p><strong>index</strong> &ndash; <strong>[in]</strong> ivf-flat constructed index </p></li>
<li><p><strong>queries</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_queries, index-&gt;dim()] </p></li>
<li><p><strong>n_queries</strong> &ndash; <strong>[in]</strong> the batch size </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> the number of neighbors to find for each query. </p></li>
<li><p><strong>neighbors</strong> &ndash; <strong>[out]</strong> a device pointer to the indices of the neighbors in the source dataset [n_queries, k] </p></li>
<li><p><strong>distances</strong> &ndash; <strong>[out]</strong> a device pointer to the distances to the selected neighbors [n_queries, k] </p></li>
<li><p><strong>mr</strong> &ndash; <strong>[in]</strong> an optional memory resource to use across the searches (you can provide a large enough memory pool here to avoid memory allocations within search). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewIf5idx_t9row_majorEERK13search_params5int_t">
<span id="_CPPv3I000EN4raft9neighbors8ivf_flat6searchERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewIf5idx_t9row_majorEERK13search_params5int_t"></span><span id="_CPPv2I000EN4raft9neighbors8ivf_flat6searchERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewIf5idx_t9row_majorEERK13search_params5int_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">int_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__flat_1ad80b26373788c58b19b7ebfe248f264d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_flat</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">search</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewIf5idx_t9row_majorEERK13search_params5int_t" title="raft::neighbors::ivf_flat::search::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewIf5idx_t9row_majorEERK13search_params5int_t" title="raft::neighbors::ivf_flat::search::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewIf5idx_t9row_majorEERK13search_params5int_t" title="raft::neighbors::ivf_flat::search::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">index</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewIf5idx_t9row_majorEERK13search_params5int_t" title="raft::neighbors::ivf_flat::search::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewIf5idx_t9row_majorEERK13search_params5int_t" title="raft::neighbors::ivf_flat::search::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">queries</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewIf5idx_t9row_majorEERK13search_params5int_t" title="raft::neighbors::ivf_flat::search::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewIf5idx_t9row_majorEERK13search_params5int_t" title="raft::neighbors::ivf_flat::search::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">neighbors</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewIf5idx_t9row_majorEERK13search_params5int_t" title="raft::neighbors::ivf_flat::search::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">distances</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">search_params</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewIf5idx_t9row_majorEERK13search_params5int_t" title="raft::neighbors::ivf_flat::search::int_t"><span class="n"><span class="pre">int_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN4raft9neighbors8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewIf5idx_t9row_majorEERK13search_params5int_t" title="Permalink to this definition">#</a><br></dt>
<dd><p>Search ANN using the constructed index. </p>
<p>See the <a class="reference external" href="#ivf_flat::build">ivf_flat::build</a> documentation for a usage example.</p>
<p>Note, this function requires a temporary buffer to store intermediate results between cuda kernel calls, which may lead to undesirable allocations and slowdown. To alleviate the problem, you can pass a pool memory resource or a large enough pre-allocated memory resource to reduce or eliminate entirely allocations happening within <code class="docutils literal notranslate"><span class="pre">search</span></code>: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="p">...</span><span class="w"></span>
<span class="c1">// use default search parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search_params</span><span class="w"> </span><span class="n">search_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// Use the same allocator across multiple searches to reduce the number of</span>
<span class="c1">// cuda memory allocations</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries1</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds1</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists1</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">);</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries2</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds2</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists2</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">);</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries3</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds3</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists3</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">);</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_t</strong> &ndash; data element type </p></li>
<li><p><strong>idx_t</strong> &ndash; type of the indices </p></li>
<li><p><strong>int_t</strong> &ndash; precision / type of integral arguments </p></li>
<li><p><strong>matrix_idx_t</strong> &ndash; matrix indexing type</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>index</strong> &ndash; <strong>[in]</strong> ivf-flat constructed index </p></li>
<li><p><strong>queries</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_queries, index-&gt;dim()] </p></li>
<li><p><strong>neighbors</strong> &ndash; <strong>[out]</strong> a device pointer to the indices of the neighbors in the source dataset [n_queries, k] </p></li>
<li><p><strong>distances</strong> &ndash; <strong>[out]</strong> a device pointer to the distances to the selected neighbors [n_queries, k] </p></li>
<li><p><strong>params</strong> &ndash; <strong>[in]</strong> configure the search </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> the number of neighbors to find for each query. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5indexE">
<span id="_CPPv3I00EN4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5indexE"></span><span id="_CPPv2I00EN4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5indexE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ann</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">index</span></span><a class="headerlink" href="#_CPPv4I00EN4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5indexE" title="Permalink to this definition">#</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ivf_flat_types.hpp&gt;</em></div>
<p>IVF-flat index. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset </p></li>
</ul>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index6veclenEv">
<span id="_CPPv3NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index6veclenEv"></span><span id="_CPPv2NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index6veclenEv"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::veclenCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index_1af240f143c5852efaeceb5213d8383b86"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">veclen</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><a class="headerlink" href="#_CPPv4NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index6veclenEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Vectorized load/store size in elements, determines the size of interleaved data chunks.</p>
<p>TODO: in theory, we can lift this to the template parameter and keep it at hardware maximum possible value by padding the <code class="docutils literal notranslate"><span class="pre">dim</span></code> of the data <a class="github reference external" href="https://github.com/rapidsai/raft/issues/711">rapidsai/raft#711</a> </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index6metricEv">
<span id="_CPPv3NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index6metricEv"></span><span id="_CPPv2NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index6metricEv"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::metricCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index_1a6a9a1b5bc99aa8b2be0eca1dda5f4c44"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metric</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">distance</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">DistanceType</span></span><a class="headerlink" href="#_CPPv4NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index6metricEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Distance metric used for clustering. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index16adaptive_centersEv">
<span id="_CPPv3NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index16adaptive_centersEv"></span><span id="_CPPv2NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index16adaptive_centersEv"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::adaptive_centersCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index_1ab7d6edf05c8b515f25acd5861ab677d9"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">adaptive_centers</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><a class="headerlink" href="#_CPPv4NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index16adaptive_centersEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Whether <code class="docutils literal notranslate"><a class="reference internal" href="#structraft_1_1neighbors_1_1ivf__flat_1_1index_1adea37d102efd61cec47f5e50bf670617"><span class="std std-ref"><span class="pre">centers()</span></span></a></code> change upon extending the index (<a class="reference internal" href="#namespaceraft_1_1neighbors_1_1ivf__pq_1ab089beae8957859cfdb82b2bde0a5732"><span class="std std-ref">ivf_pq::extend</span></a>). </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index4dataEv">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index4dataEv"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index4dataEv"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::data"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index_1a0ff8ac7aa31fae1b739f04e566df7fd2"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">data</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4I0000EN4raft13device_mdspanE" title="raft::device_mdspan"><span class="n"><span class="pre">device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5indexE" title="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_2d</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5indexE" title="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index4dataEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Inverted list data [size, dim].</p>
<p>The data consists of the dataset rows, grouped by their labels (into clusters/lists). Within each list (cluster), the data is grouped into blocks of <code class="docutils literal notranslate"><span class="pre">kIndexGroupSize</span></code> interleaved vectors. Note, the total index length is slightly larger than the source dataset length, because each cluster is padded by <code class="docutils literal notranslate"><span class="pre">kIndexGroupSize</span></code> elements.</p>
<p>Interleaving pattern: within groups of <code class="docutils literal notranslate"><span class="pre">kIndexGroupSize</span></code> rows, the data is interleaved with the block size equal to <code class="docutils literal notranslate"><span class="pre">veclen</span> <span class="pre">*</span> <span class="pre">sizeof(T)</span></code>. That is, a chunk of <code class="docutils literal notranslate"><span class="pre">veclen</span></code> consecutive components of one row is followed by a chunk of the same size of the next row, and so on.</p>
<p><strong>Example</strong>: veclen = 2, dim = 6, kIndexGroupSize = 32, list_size = 31 </p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>    <span class="o">-</span>    <span class="p">,</span>    <span class="o">-</span>    <span class="p">,</span>
<span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>    <span class="o">-</span>    <span class="p">,</span>    <span class="o">-</span>    <span class="p">,</span>
<span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>    <span class="o">-</span>    <span class="p">,</span>    <span class="o">-</span>    <span class="p">,</span>
</pre></div>
</div>
 <p></p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index7indicesEv">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index7indicesEv"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index7indicesEv"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::indices"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index_1a63a703f9dbf890bc06937278a80c9013"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">indices</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4I0000EN4raft13device_mdspanE" title="raft::device_mdspan"><span class="n"><span class="pre">device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5indexE" title="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_1d</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5indexE" title="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index7indicesEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Inverted list indices: ids of items in the source data [size] </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index10list_sizesEv">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index10list_sizesEv"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index10list_sizesEv"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::list_sizes"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index_1a7c5ddca6f59531d55def65b27a8477ce"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">list_sizes</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4I0000EN4raft13device_mdspanE" title="raft::device_mdspan"><span class="n"><span class="pre">device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_1d</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index10list_sizesEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Sizes of the lists (clusters) [n_lists] </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index12list_offsetsEv">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index12list_offsetsEv"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index12list_offsetsEv"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::list_offsets"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index_1a59d775131aef597c1a4c63e0871430fe"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">list_offsets</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4I0000EN4raft13device_mdspanE" title="raft::device_mdspan"><span class="n"><span class="pre">device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5indexE" title="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_1d</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index12list_offsetsEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Offsets into the lists [n_lists + 1]. The last value contains the total length of the index. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index7centersEv">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index7centersEv"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index7centersEv"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::centers"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index_1adea37d102efd61cec47f5e50bf670617"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">centers</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4I0000EN4raft13device_mdspanE" title="raft::device_mdspan"><span class="n"><span class="pre">device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_2d</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index7centersEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>k-means cluster centers corresponding to the lists [n_lists, dim] </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index12center_normsEv">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index12center_normsEv"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index12center_normsEv"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::center_norms"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index_1a07e9d78ee9b9b8023706a01038f5bc64"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">center_norms</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="mdspan.html#_CPPv4I0000EN4raft13device_mdspanE" title="raft::device_mdspan"><span class="n"><span class="pre">device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_1d</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index12center_normsEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>(Optional) Precomputed norms of the <code class="docutils literal notranslate"><span class="pre">centers</span></code> w.r.t. the chosen distance metric [n_lists].</p>
<p>NB: this may be empty if the index is empty or if the metric does not require the center norms calculation. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index4sizeEv">
<span id="_CPPv3NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index4sizeEv"></span><span id="_CPPv2NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index4sizeEv"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::sizeCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index_1a505cf0ce13556e921e7df4612fd5225a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5indexE" title="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><a class="headerlink" href="#_CPPv4NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index4sizeEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Total length of the index. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index3dimEv">
<span id="_CPPv3NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index3dimEv"></span><span id="_CPPv2NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index3dimEv"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::dimCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index_1af880dc84b13e6dc993c11dba568ee85d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dim</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><a class="headerlink" href="#_CPPv4NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index3dimEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Dimensionality of the data. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index7n_listsEv">
<span id="_CPPv3NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index7n_listsEv"></span><span id="_CPPv2NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index7n_listsEv"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::n_listsCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index_1a8f3c7536e606f618c4e56e0bfd80a59c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_lists</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><a class="headerlink" href="#_CPPv4NK4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index7n_listsEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Number of clusters/inverted lists. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index5indexERK8handle_tN4raft8distance12DistanceTypeE8uint32_tb8uint32_t">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index5indexERK8handle_tN4raft8distance12DistanceTypeE8uint32_tb8uint32_t"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index5indexERK8handle_tN4raft8distance12DistanceTypeE8uint32_tb8uint32_t"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::index__handle_tCR.raft::distance::DistanceType.uint32_t.b.uint32_t"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index_1a9aee75ec2f3726cc230c15652fe1d2cb"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">distance</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">DistanceType</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_lists</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">adaptive_centers</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index5indexERK8handle_tN4raft8distance12DistanceTypeE8uint32_tb8uint32_t" title="Permalink to this definition">#</a><br></dt>
<dd><p>Construct an empty index. It needs to be trained and then populated. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index5indexERK8handle_tRK12index_params8uint32_t">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index5indexERK8handle_tRK12index_params8uint32_t"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index5indexERK8handle_tRK12index_params8uint32_t"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::index__handle_tCR.index_paramsCR.uint32_t"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index_1a2d00628a82f4a3afa0e7f76eb2f1a662"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_paramsE" title="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index_params"><span class="n"><span class="pre">index_params</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index5indexERK8handle_tRK12index_params8uint32_t" title="Permalink to this definition">#</a><br></dt>
<dd><p>Construct an empty index. It needs to be trained and then populated. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index8allocateERK8handle_t4IdxTb">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index8allocateERK8handle_t4IdxTb"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index8allocateERK8handle_t4IdxTb"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::allocate__handle_tCR.IdxT.b"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index_1a675df24386aecfa48c94cf7aaab085fe"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">allocate</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5indexE" title="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">index_size</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">allocate_center_norms</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat5index8allocateERK8handle_t4IdxTb" title="Permalink to this definition">#</a><br></dt>
<dd><p>Replace the content of the index with new uninitialized mdarrays to hold the indicated amount of data. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_paramsE">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_paramsE"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_paramsE"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index_params"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_params</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ann</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">index_params</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_paramsE" title="Permalink to this definition">#</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ivf_flat_types.hpp&gt;</em></div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params7n_listsE">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params7n_listsE"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params7n_listsE"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index_params::n_lists__uint32_t"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index__params_1ac63359ab189eff63b57dd12fd0815c20"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_lists</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1024</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params7n_listsE" title="Permalink to this definition">#</a><br></dt>
<dd><p>The number of inverted lists (clusters) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params14kmeans_n_itersE">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params14kmeans_n_itersE"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params14kmeans_n_itersE"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index_params::kmeans_n_iters__uint32_t"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index__params_1a0d7a8e128cd3196305680f483eb38ab3"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kmeans_n_iters</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">20</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params14kmeans_n_itersE" title="Permalink to this definition">#</a><br></dt>
<dd><p>The number of iterations searching for kmeans centers (index building). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params24kmeans_trainset_fractionE">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params24kmeans_trainset_fractionE"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params24kmeans_trainset_fractionE"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index_params::kmeans_trainset_fraction__double"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index__params_1a06702f6c0a643113a2cba57f7a71a333"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kmeans_trainset_fraction</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0.5</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params24kmeans_trainset_fractionE" title="Permalink to this definition">#</a><br></dt>
<dd><p>The fraction of data to use during iterative kmeans building. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params16adaptive_centersE">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params16adaptive_centersE"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params16adaptive_centersE"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::index_params::adaptive_centers__b"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1index__params_1a3cff160513c72e45edc7d8db789f4746"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">adaptive_centers</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat12index_params16adaptive_centersE" title="Permalink to this definition">#</a><br></dt>
<dd><p>By default (adaptive_centers = false), the cluster centers are trained in <code class="docutils literal notranslate"><a class="reference internal" href="#namespaceraft_1_1neighbors_1_1ivf__flat_1a862bdf0c894d7c62c3cb6d0aff6a765f"><span class="std std-ref"><span class="pre">ivf_flat::build</span></span></a></code>, and never modified in <code class="docutils literal notranslate"><a class="reference internal" href="#namespaceraft_1_1neighbors_1_1ivf__flat_1a68ad1bf995c7c7d1a95815e71d3650b9"><span class="std std-ref"><span class="pre">ivf_flat::extend</span></span></a></code>. As a result, you may need to retrain the index from scratch after invoking (<code class="docutils literal notranslate"><a class="reference internal" href="#namespaceraft_1_1neighbors_1_1ivf__flat_1a68ad1bf995c7c7d1a95815e71d3650b9"><span class="std std-ref"><span class="pre">ivf_flat::extend</span></span></a></code>) a few times with new data, the distribution of which is no longer representative of the original training set.</p>
<p>The alternative behavior (adaptive_centers = true) is to update the cluster centers for new data when it is added. In this case, <code class="docutils literal notranslate"><a class="reference internal" href="#structraft_1_1neighbors_1_1ivf__flat_1_1index_1adea37d102efd61cec47f5e50bf670617"><span class="std std-ref"><span class="pre">index.centers()</span></span></a></code> are always exactly the centroids of the data in the corresponding clusters. The drawback of this behavior is that the centroids depend on the order of adding new data (through the classification of the added data); that is, <code class="docutils literal notranslate"><a class="reference internal" href="#structraft_1_1neighbors_1_1ivf__flat_1_1index_1adea37d102efd61cec47f5e50bf670617"><span class="std std-ref"><span class="pre">index.centers()</span></span></a></code> &ldquo;drift&rdquo; together with the changing distribution of the newly added data. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat13search_paramsE">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat13search_paramsE"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat13search_paramsE"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::search_params"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1search__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">search_params</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ann</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">search_params</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat13search_paramsE" title="Permalink to this definition">#</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ivf_flat_types.hpp&gt;</em></div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat13search_params8n_probesE">
<span id="_CPPv3N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat13search_params8n_probesE"></span><span id="_CPPv2N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat13search_params8n_probesE"></span><span id="raft::neighbors::ivf_flat::raft::neighbors::ivf_flat::search_params::n_probes__uint32_t"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__flat_1_1search__params_1ac47021e9e24a946caf84e4fcac05a143"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_probes</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">20</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors8ivf_flat4raft9neighbors8ivf_flat13search_params8n_probesE" title="Permalink to this definition">#</a><br></dt>
<dd><p>The number of clusters to search. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="ivf-pq">
<h2>IVF-PQ<a class="headerlink" href="#ivf-pq" title="Permalink to this heading">#</a></h2>
<p>Header: <code class="xref py py-obj docutils literal notranslate"><span class="pre">raft/neighbors/ivf_pq.cuh</span></code></p>
<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq12codebook_genE">
<span id="_CPPv3N4raft9neighbors6ivf_pq12codebook_genE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq12codebook_genE"></span><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__pq_1a35c7ca97e16f4bea17fb24a94010d097"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_pq</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">codebook_gen</span></span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq12codebook_genE" title="Permalink to this definition">#</a><br></dt>
<dd><p>A type for specifying how PQ codebooks are created. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq12codebook_gen12PER_SUBSPACEE">
<span id="_CPPv3N4raft9neighbors6ivf_pq12codebook_gen12PER_SUBSPACEE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq12codebook_gen12PER_SUBSPACEE"></span><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__pq_1a35c7ca97e16f4bea17fb24a94010d097a5056773a9c21a05e14106e853dc39c42"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PER_SUBSPACE</span></span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq12codebook_gen12PER_SUBSPACEE" title="Permalink to this definition">#</a><br></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq12codebook_gen11PER_CLUSTERE">
<span id="_CPPv3N4raft9neighbors6ivf_pq12codebook_gen11PER_CLUSTERE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq12codebook_gen11PER_CLUSTERE"></span><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__pq_1a35c7ca97e16f4bea17fb24a94010d097ab4bc06123f1a290656a492b25ebab336"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PER_CLUSTER</span></span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq12codebook_gen11PER_CLUSTERE" title="Permalink to this definition">#</a><br></dt>
<dd></dd></dl>

</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq15kIndexGroupSizeE">
<span id="_CPPv3N4raft9neighbors6ivf_pq15kIndexGroupSizeE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq15kIndexGroupSizeE"></span><span id="raft::neighbors::ivf_pq::kIndexGroupSize__uint32_t"></span><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__pq_1a6beaadfa8b236e31664fe1e6e624905a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_pq</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">kIndexGroupSize</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">32</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq15kIndexGroupSizeE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Size of the interleaved group. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq17kIndexGroupVecLenE">
<span id="_CPPv3N4raft9neighbors6ivf_pq17kIndexGroupVecLenE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq17kIndexGroupVecLenE"></span><span id="raft::neighbors::ivf_pq::kIndexGroupVecLen__uint32_t"></span><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__pq_1a525ab2b867010e9306c03daf75592301"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_pq</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">kIndexGroupVecLen</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">16</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq17kIndexGroupVecLenE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Stride of the interleaved group for vectorized loads. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft9neighbors6ivf_pq5buildE5indexI4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t">
<span id="_CPPv3I00EN4raft9neighbors6ivf_pq5buildERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t"></span><span id="_CPPv2I00EN4raft9neighbors6ivf_pq5buildERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__pq_1af51c66379a114904dad7b1c34bc8ad26"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_pq</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">build</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">index_params</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq5buildE5indexI4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::neighbors::ivf_pq::build::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dataset</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq5buildE5indexI4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::neighbors::ivf_pq::build::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_rows</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq5buildE5indexI4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::neighbors::ivf_pq::build::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft9neighbors6ivf_pq5buildE5indexI4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="Permalink to this definition">#</a><br></dt>
<dd><p>Build the index from the dataset for efficient search. </p>
<p>NB: Currently, the following distance metrics are supported:</p><ul class="simple">
<li><p>L2Expanded</p></li>
<li><p>L2Unexpanded</p></li>
<li><p>InnerProduct</p></li>
</ul>
<p></p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">neighbors</span><span class="p">;</span><span class="w"></span>
<span class="c1">// use default index parameters</span>
<span class="n">ivf_pq</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// create and fill the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_pq</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">);</span><span class="w"></span>
<span class="c1">// use default search parameters</span>
<span class="n">ivf_pq</span><span class="o">::</span><span class="n">search_params</span><span class="w"> </span><span class="n">search_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// search K nearest neighbours for each of the N queries</span>
<span class="n">ivf_pq</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; </p></li>
<li><p><strong>params</strong> &ndash; configure the index building </p></li>
<li><p><strong>dataset</strong> &ndash; <strong>[in]</strong> a device/host pointer to a row-major matrix [n_rows, dim] </p></li>
<li><p><strong>n_rows</strong> &ndash; the number of samples </p></li>
<li><p><strong>dim</strong> &ndash; the dimensionality of the data</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the constructed ivf-pq index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft9neighbors6ivf_pq6extendE5indexI4IdxTERK8handle_tRK5indexI4IdxTEPK1TPK4IdxT4IdxT">
<span id="_CPPv3I00EN4raft9neighbors6ivf_pq6extendERK8handle_tRK5indexI4IdxTEPK1TPK4IdxT4IdxT"></span><span id="_CPPv2I00EN4raft9neighbors6ivf_pq6extendERK8handle_tRK5indexI4IdxTEPK1TPK4IdxT4IdxT"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__pq_1ab089beae8957859cfdb82b2bde0a5732"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_pq</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">extend</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6extendE5indexI4IdxTERK8handle_tRK5indexI4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_pq::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">orig_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6extendE5indexI4IdxTERK8handle_tRK5indexI4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_pq::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_vectors</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6extendE5indexI4IdxTERK8handle_tRK5indexI4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_pq::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_indices</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6extendE5indexI4IdxTERK8handle_tRK5indexI4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_pq::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_rows</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6extendE5indexI4IdxTERK8handle_tRK5indexI4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_pq::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6extendE5indexI4IdxTERK8handle_tRK5indexI4IdxTEPK1TPK4IdxT4IdxT" title="Permalink to this definition">#</a><br></dt>
<dd><p>Build a new index containing the data of the original plus new extra vectors. </p>
<p>Implementation note: The new data is clustered according to existing kmeans clusters, then the cluster centers are unchanged.</p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">neighbors</span><span class="p">;</span><span class="w"></span>
<span class="n">ivf_pq</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="n">index_params</span><span class="p">.</span><span class="n">add_data_on_build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">      </span><span class="c1">// don't populate index on build</span>
<span class="n">index_params</span><span class="p">.</span><span class="n">kmeans_trainset_fraction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"> </span><span class="c1">// use whole dataset for kmeans training</span>
<span class="c1">// train the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index_empty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_pq</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">);</span><span class="w"></span>
<span class="c1">// fill the index with the data</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_pq</span><span class="o">::</span><span class="n">extend</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_empty</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; </p></li>
<li><p><strong>orig_index</strong> &ndash; original index </p></li>
<li><p><strong>new_vectors</strong> &ndash; <strong>[in]</strong> a device/host pointer to a row-major matrix [n_rows, <a class="reference internal" href="#structraft_1_1neighbors_1_1ivf__pq_1_1index_1a34006dd7653851e7eb96be5c56ac8e98"><span class="std std-ref">index.dim()</span></a>] </p></li>
<li><p><strong>new_indices</strong> &ndash; <strong>[in]</strong> a device/host pointer to a vector of indices [n_rows]. If the original index is empty (<code class="docutils literal notranslate"><span class="pre">orig_index.size()</span> <span class="pre">==</span> <span class="pre">0</span></code>), you can pass <code class="docutils literal notranslate"><span class="pre">nullptr</span></code> here to imply a continuous range <code class="docutils literal notranslate"><span class="pre">[0...n_rows)</span></code>. </p></li>
<li><p><strong>n_rows</strong> &ndash; the number of samples</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the constructed extended ivf-pq index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft9neighbors6ivf_pq6extendEvRK8handle_tP5indexI4IdxTEPK1TPK4IdxT4IdxT">
<span id="_CPPv3I00EN4raft9neighbors6ivf_pq6extendERK8handle_tP5indexI4IdxTEPK1TPK4IdxT4IdxT"></span><span id="_CPPv2I00EN4raft9neighbors6ivf_pq6extendERK8handle_tP5indexI4IdxTEPK1TPK4IdxT4IdxT"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__pq_1a00aa7f4680d66f3f9723ab3e4a5a8e2e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_pq</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">extend</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6extendEvRK8handle_tP5indexI4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_pq::extend::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6extendEvRK8handle_tP5indexI4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_pq::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6extendEvRK8handle_tP5indexI4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_pq::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_vectors</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6extendEvRK8handle_tP5indexI4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_pq::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_indices</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6extendEvRK8handle_tP5indexI4IdxTEPK1TPK4IdxT4IdxT" title="raft::neighbors::ivf_pq::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6extendEvRK8handle_tP5indexI4IdxTEPK1TPK4IdxT4IdxT" title="Permalink to this definition">#</a><br></dt>
<dd><p>Extend the index with the new data. *. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; </p></li>
<li><p><strong>index</strong> &ndash; <strong>[inout]</strong> </p></li>
<li><p><strong>new_vectors</strong> &ndash; <strong>[in]</strong> a device/host pointer to a row-major matrix [n_rows, <a class="reference internal" href="#structraft_1_1neighbors_1_1ivf__pq_1_1index_1a34006dd7653851e7eb96be5c56ac8e98"><span class="std std-ref">index.dim()</span></a>] </p></li>
<li><p><strong>new_indices</strong> &ndash; <strong>[in]</strong> a device/host pointer to a vector of indices [n_rows]. If the original index is empty (<code class="docutils literal notranslate"><span class="pre">orig_index.size()</span> <span class="pre">==</span> <span class="pre">0</span></code>), you can pass <code class="docutils literal notranslate"><span class="pre">nullptr</span></code> here to imply a continuous range <code class="docutils literal notranslate"><span class="pre">[0...n_rows)</span></code>. </p></li>
<li><p><strong>n_rows</strong> &ndash; the number of samples </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft9neighbors6ivf_pq6searchEvRK8handle_tRK13search_paramsRK5indexI4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE">
<span id="_CPPv3I00EN4raft9neighbors6ivf_pq6searchERK8handle_tRK13search_paramsRK5indexI4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE"></span><span id="_CPPv2I00EN4raft9neighbors6ivf_pq6searchERK8handle_tRK13search_paramsRK5indexI4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ivf__pq_1a45fa9d48c33349085acf9349f5167a28"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ivf_pq</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">search</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">search_params</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6searchEvRK8handle_tRK13search_paramsRK5indexI4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::neighbors::ivf_pq::search::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6searchEvRK8handle_tRK13search_paramsRK5indexI4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::neighbors::ivf_pq::search::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6searchEvRK8handle_tRK13search_paramsRK5indexI4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::neighbors::ivf_pq::search::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">queries</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_queries</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6searchEvRK8handle_tRK13search_paramsRK5indexI4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::neighbors::ivf_pq::search::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">neighbors</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">distances</span></span>, <span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mr</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_memory_resource</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">mr</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft9neighbors6ivf_pq6searchEvRK8handle_tRK13search_paramsRK5indexI4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Search ANN using the constructed index. </p>
<p>See the <a class="reference external" href="#ivf_pq::build">ivf_pq::build</a> documentation for a usage example.</p>
<p>Note, this function requires a temporary buffer to store intermediate results between cuda kernel calls, which may lead to undesirable allocations and slowdown. To alleviate the problem, you can pass a pool memory resource or a large enough pre-allocated memory resource to reduce or eliminate entirely allocations happening within <code class="docutils literal notranslate"><span class="pre">search</span></code>: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="p">...</span><span class="w"></span>
<span class="c1">// Create a pooling memory resource with a pre-defined initial size.</span>
<span class="n">rmm</span><span class="o">::</span><span class="n">mr</span><span class="o">::</span><span class="n">pool_memory_resource</span><span class="o">&lt;</span><span class="n">rmm</span><span class="o">::</span><span class="n">mr</span><span class="o">::</span><span class="n">device_memory_resource</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mr</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="n">rmm</span><span class="o">::</span><span class="n">mr</span><span class="o">::</span><span class="n">get_current_device_resource</span><span class="p">(),</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">);</span><span class="w"></span>
<span class="c1">// use default search parameters</span>
<span class="n">ivf_pq</span><span class="o">::</span><span class="n">search_params</span><span class="w"> </span><span class="n">search_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// Use the same allocator across multiple searches to reduce the number of</span>
<span class="c1">// cuda memory allocations</span>
<span class="n">ivf_pq</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries1</span><span class="p">,</span><span class="w"> </span><span class="n">N1</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds1</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mr</span><span class="p">);</span><span class="w"></span>
<span class="n">ivf_pq</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries2</span><span class="p">,</span><span class="w"> </span><span class="n">N2</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds2</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists2</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mr</span><span class="p">);</span><span class="w"></span>
<span class="n">ivf_pq</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries3</span><span class="p">,</span><span class="w"> </span><span class="n">N3</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds3</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists3</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mr</span><span class="p">);</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
</pre></div>
</div>
 The exact size of the temporary buffer depends on multiple factors and is an implementation detail. However, you can safely specify a small initial size for the memory pool, so that only a few allocations happen to grow it during the first invocations of the <code class="docutils literal notranslate"><span class="pre">search</span></code>.<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; </p></li>
<li><p><strong>params</strong> &ndash; configure the search </p></li>
<li><p><strong>index</strong> &ndash; ivf-pq constructed index </p></li>
<li><p><strong>queries</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_queries, index-&gt;dim()] </p></li>
<li><p><strong>n_queries</strong> &ndash; the batch size </p></li>
<li><p><strong>k</strong> &ndash; the number of neighbors to find for each query. </p></li>
<li><p><strong>neighbors</strong> &ndash; <strong>[out]</strong> a device pointer to the indices of the neighbors in the source dataset [n_queries, k] </p></li>
<li><p><strong>distances</strong> &ndash; <strong>[out]</strong> a device pointer to the distances to the selected neighbors [n_queries, k] </p></li>
<li><p><strong>mr</strong> &ndash; an optional memory resource to use across the searches (you can provide a large enough memory pool here to avoid memory allocations within search). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5indexE">
<span id="_CPPv3I0EN4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5indexE"></span><span id="_CPPv2I0EN4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5indexE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ann</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">index</span></span><a class="headerlink" href="#_CPPv4I0EN4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5indexE" title="Permalink to this definition">#</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ivf_pq_types.hpp&gt;</em></div>
<p>IVF-PQ index. </p>
<p>In the IVF-PQ index, a database vector y is approximated with two level quantization:</p>
<p>y = Q_1(y) + Q_2(y - Q_1(y))</p>
<p>The first level quantizer (Q_1), maps the vector y to the nearest cluster center. The number of clusters is n_lists.</p>
<p>The second quantizer encodes the residual, and it is defined as a product quantizer [1].</p>
<p>A product quantizer encodes a <code class="docutils literal notranslate"><span class="pre">dim</span></code> dimensional vector with a <code class="docutils literal notranslate"><span class="pre">pq_dim</span></code> dimensional vector. First we split the input vector into <code class="docutils literal notranslate"><span class="pre">pq_dim</span></code> subvectors (denoted by u), where each u vector contains <code class="docutils literal notranslate"><span class="pre">pq_len</span></code> distinct components of y</p>
<p>y_1, y_2, &hellip; y_{pq_len}, y_{pq_len+1}, &hellip; y_{2*pq_len}, &hellip; y_{dim-pq_len+1} &hellip; y_{dim} ___________________/ ____________________________/ ______________________/ u_1 u_2 u_{pq_dim}</p>
<p>Then each subvector encoded with a separate quantizer q_i, end the results are concatenated</p>
<p>Q_2(y) = q_1(u_1),q_2(u_2),&hellip;,q_{pq_dim}(u_pq_dim})</p>
<p>Each quantizer q_i outputs a code with pq_bit bits. The second level quantizers are also defined by k-means clustering in the corresponding sub-space: the reproduction values are the centroids, and the set of reproduction values is the codebook.</p>
<p>When the data dimensionality <code class="docutils literal notranslate"><span class="pre">dim</span></code> is not multiple of <code class="docutils literal notranslate"><span class="pre">pq_dim</span></code>, the feature space is transformed using a random orthogonal matrix to have <code class="docutils literal notranslate"><span class="pre">rot_dim</span> <span class="pre">=</span> <span class="pre">pq_dim</span> <span class="pre">*</span> <span class="pre">pq_len</span></code> dimensions (<code class="docutils literal notranslate"><span class="pre">rot_dim</span> <span class="pre">&gt;=</span> <span class="pre">dim</span></code>).</p>
<p>The second-level quantizers are trained either for each subspace or for each cluster: (a) codebook_gen::PER_SUBSPACE: creates <code class="docutils literal notranslate"><span class="pre">pq_dim</span></code> second-level quantizers - one for each slice of the data along features; (b) <a class="reference internal" href="#namespaceraft_1_1neighbors_1_1ivf__pq_1a35c7ca97e16f4bea17fb24a94010d097a5056773a9c21a05e14106e853dc39c42"><span class="std std-ref">codebook_gen::PER_CLUSTER</span></a>: creates <code class="docutils literal notranslate"><span class="pre">n_lists</span></code> second-level quantizers - one for each first-level cluster. In either case, the centroids are again found using k-means clustering interpreting the data as having pq_len dimensions.</p>
<p>[1] Product quantization for nearest neighbor search Herve Jegou, Matthijs Douze, Cordelia Schmid</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset </p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index4sizeEv">
<span id="_CPPv3NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index4sizeEv"></span><span id="_CPPv2NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index4sizeEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::sizeCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1a0cc9d8fb3d84fb03a6e8c989b81ed525"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5indexE" title="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><a class="headerlink" href="#_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index4sizeEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Total length of the index. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index3dimEv">
<span id="_CPPv3NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index3dimEv"></span><span id="_CPPv2NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index3dimEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::dimCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1a34006dd7653851e7eb96be5c56ac8e98"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dim</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><a class="headerlink" href="#_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index3dimEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Dimensionality of the input data. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7dim_extEv">
<span id="_CPPv3NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7dim_extEv"></span><span id="_CPPv2NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7dim_extEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::dim_extCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1a914594d07b70d82a53c5af7a6fad05a4"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dim_ext</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><a class="headerlink" href="#_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7dim_extEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Dimensionality of the cluster centers: input data dim extended with vector norms and padded to 8 elems. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7rot_dimEv">
<span id="_CPPv3NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7rot_dimEv"></span><span id="_CPPv2NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7rot_dimEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::rot_dimCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1a68d78ecee05139cfa847f7a492737636"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rot_dim</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><a class="headerlink" href="#_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7rot_dimEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Dimensionality of the data after transforming it for PQ processing (rotated and augmented to be muplitple of <code class="docutils literal notranslate"><span class="pre">pq_dim</span></code>). </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7pq_bitsEv">
<span id="_CPPv3NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7pq_bitsEv"></span><span id="_CPPv2NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7pq_bitsEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::pq_bitsCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1a9190050e3414b9ce9dc402cc8fb53c4e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pq_bits</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><a class="headerlink" href="#_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7pq_bitsEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>The bit length of an encoded vector element after compression by PQ. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index6pq_dimEv">
<span id="_CPPv3NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index6pq_dimEv"></span><span id="_CPPv2NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index6pq_dimEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::pq_dimCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1a5c6f42a1d29e45d38b481845cc644785"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pq_dim</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><a class="headerlink" href="#_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index6pq_dimEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>The dimensionality of an encoded vector after compression by PQ. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index6pq_lenEv">
<span id="_CPPv3NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index6pq_lenEv"></span><span id="_CPPv2NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index6pq_lenEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::pq_lenCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1a74c7ecd25d6b473be0c35f52f8a24670"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pq_len</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><a class="headerlink" href="#_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index6pq_lenEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Dimensionality of a subspaces, i.e. the number of vector components mapped to a subspace </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index12pq_book_sizeEv">
<span id="_CPPv3NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index12pq_book_sizeEv"></span><span id="_CPPv2NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index12pq_book_sizeEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::pq_book_sizeCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1ab2786a121917dafa474dfcbd3b43a763"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pq_book_size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><a class="headerlink" href="#_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index12pq_book_sizeEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>The number of vectors in a PQ codebook (<code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">&lt;&lt;</span> <span class="pre">pq_bits</span></code>). </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index6metricEv">
<span id="_CPPv3NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index6metricEv"></span><span id="_CPPv2NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index6metricEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::metricCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1aa45d6ad7afa903b0a248577c2f1dfc63"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metric</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">distance</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">DistanceType</span></span><a class="headerlink" href="#_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index6metricEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Distance metric used for clustering. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index13codebook_kindEv">
<span id="_CPPv3NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index13codebook_kindEv"></span><span id="_CPPv2NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index13codebook_kindEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::codebook_kindCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1a1f76fd0510d1b1f4a28f920218669306"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">codebook_kind</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft9neighbors6ivf_pq12codebook_genE" title="raft::neighbors::ivf_pq::codebook_gen"><span class="n"><span class="pre">codebook_gen</span></span></a><a class="headerlink" href="#_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index13codebook_kindEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>How PQ codebooks are created. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7n_listsEv">
<span id="_CPPv3NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7n_listsEv"></span><span id="_CPPv2NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7n_listsEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::n_listsCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1ad8d68c57bb87042221cdcf24e54dbc17"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_lists</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><a class="headerlink" href="#_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7n_listsEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Number of clusters/inverted lists (first level quantization). </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index16n_nonempty_listsEv">
<span id="_CPPv3NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index16n_nonempty_listsEv"></span><span id="_CPPv2NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index16n_nonempty_listsEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::n_nonempty_listsCCE"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1aced6947cc3799ec5044d7365cc85fb20"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_nonempty_lists</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><a class="headerlink" href="#_CPPv4NK4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index16n_nonempty_listsEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Number of non-empty clusters/inverted lists. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index5indexERK8handle_tN4raft8distance12DistanceTypeE12codebook_gen8uint32_t8uint32_t8uint32_t8uint32_t8uint32_t">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index5indexERK8handle_tN4raft8distance12DistanceTypeE12codebook_gen8uint32_t8uint32_t8uint32_t8uint32_t8uint32_t"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index5indexERK8handle_tN4raft8distance12DistanceTypeE12codebook_gen8uint32_t8uint32_t8uint32_t8uint32_t8uint32_t"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::index__handle_tCR.raft::distance::DistanceType.codebook_gen.uint32_t.uint32_t.uint32_t.uint32_t.uint32_t"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1a7a7d7ec9d2e17664739306cc8b83413b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">distance</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">DistanceType</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span>, <a class="reference internal" href="#_CPPv4N4raft9neighbors6ivf_pq12codebook_genE" title="raft::neighbors::ivf_pq::codebook_gen"><span class="n"><span class="pre">codebook_gen</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">codebook_kind</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_lists</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">pq_bits</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">8</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">pq_dim</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_nonempty_lists</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index5indexERK8handle_tN4raft8distance12DistanceTypeE12codebook_gen8uint32_t8uint32_t8uint32_t8uint32_t8uint32_t" title="Permalink to this definition">#</a><br></dt>
<dd><p>Construct an empty index. It needs to be trained and then populated. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index5indexERK8handle_tRK12index_params8uint32_t8uint32_t">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index5indexERK8handle_tRK12index_params8uint32_t8uint32_t"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index5indexERK8handle_tRK12index_params8uint32_t8uint32_t"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::index__handle_tCR.index_paramsCR.uint32_t.uint32_t"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1ada190ecd790cca9453004cb8226f3bbc"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_paramsE" title="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index_params"><span class="n"><span class="pre">index_params</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_nonempty_lists</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index5indexERK8handle_tRK12index_params8uint32_t8uint32_t" title="Permalink to this definition">#</a><br></dt>
<dd><p>Construct an empty index. It needs to be trained and then populated. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index8allocateERK8handle_t4IdxT">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index8allocateERK8handle_t4IdxT"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index8allocateERK8handle_t4IdxT"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::allocate__handle_tCR.IdxT"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1aba3565a973fde241a32a7098bdf3e477"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">allocate</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <a class="reference internal" href="#_CPPv4I0EN4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5indexE" title="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">index_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index8allocateERK8handle_t4IdxT" title="Permalink to this definition">#</a><br></dt>
<dd><p>Replace the content of the index with new uninitialized mdarrays to hold the indicated amount of data. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index10pq_centersEv">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index10pq_centersEv"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index10pq_centersEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::pq_centers"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1abedefe8b2e765bc92105f2f2b8645d1b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pq_centers</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4I0000EN4raft13device_mdspanE" title="raft::device_mdspan"><span class="n"><span class="pre">device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">pq_centers_extents</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index10pq_centersEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>PQ cluster centers</p>
<p></p><ul class="simple">
<li><p>codebook_gen::PER_SUBSPACE: [pq_dim , pq_len, pq_book_size]</p></li>
<li><p><a class="reference internal" href="#namespaceraft_1_1neighbors_1_1ivf__pq_1a35c7ca97e16f4bea17fb24a94010d097a5056773a9c21a05e14106e853dc39c42"><span class="std std-ref">codebook_gen::PER_CLUSTER</span></a>: [n_lists, pq_len, pq_book_size] </p></li>
</ul>
<p></p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index10pq_datasetEv">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index10pq_datasetEv"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index10pq_datasetEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::pq_dataset"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1ab14b3f4437a10c555a47ec75994a6003"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pq_dataset</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4I0000EN4raft13device_mdspanE" title="raft::device_mdspan"><span class="n"><span class="pre">device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint8_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">pq_dataset_extents</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index10pq_datasetEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>PQ-encoded data stored in the interleaved format:</p>
<p>[ ceildiv(size, kIndexGroupSize) , ceildiv(pq_dim, (kIndexGroupVecLen * 8u) / pq_bits) , kIndexGroupSize , kIndexGroupVecLen ]. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7indicesEv">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7indicesEv"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7indicesEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::indices"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1aef2aa00661f1cc03176ce160dc5c9c50"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">indices</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4I0000EN4raft13device_mdspanE" title="raft::device_mdspan"><span class="n"><span class="pre">device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5indexE" title="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_1d</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5indexE" title="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7indicesEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Inverted list indices: ids of items in the source data [size] </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index15rotation_matrixEv">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index15rotation_matrixEv"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index15rotation_matrixEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::rotation_matrix"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1abec5f0bbd0c279506a4210fe1e848f17"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rotation_matrix</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4I0000EN4raft13device_mdspanE" title="raft::device_mdspan"><span class="n"><span class="pre">device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_2d</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index15rotation_matrixEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>The transform matrix (original space -&gt; rotated padded space) [rot_dim, dim] </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index12list_offsetsEv">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index12list_offsetsEv"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index12list_offsetsEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::list_offsets"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1a92952bba703647485e86dea2ed6d8d30"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">list_offsets</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4I0000EN4raft13device_mdspanE" title="raft::device_mdspan"><span class="n"><span class="pre">device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5indexE" title="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_1d</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index12list_offsetsEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Offsets into the lists [n_lists + 1]. The last value contains the total length of the index. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index10list_sizesEv">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index10list_sizesEv"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index10list_sizesEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::list_sizes"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1a8dc46f1cd8266ed0b55fcfdd46f7bca4"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">list_sizes</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4I0000EN4raft13device_mdspanE" title="raft::device_mdspan"><span class="n"><span class="pre">device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_1d</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index10list_sizesEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Sizes of the lists [n_lists]. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7centersEv">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7centersEv"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7centersEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::centers"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1a9c1830665632f248b7add51f6fdb26d6"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">centers</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4I0000EN4raft13device_mdspanE" title="raft::device_mdspan"><span class="n"><span class="pre">device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_2d</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index7centersEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Cluster centers corresponding to the lists in the original space [n_lists, dim_ext] </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index11centers_rotEv">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index11centers_rotEv"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index11centers_rotEv"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::centers_rot"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1ae7d38b570678e11f6ef42594436ed288"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">centers_rot</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4I0000EN4raft13device_mdspanE" title="raft::device_mdspan"><span class="n"><span class="pre">device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_2d</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index11centers_rotEv" title="Permalink to this definition">#</a><br></dt>
<dd><p>Cluster centers corresponding to the lists in the rotated space [n_lists, rot_dim] </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index23make_pq_dataset_extentsE4IdxT">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index23make_pq_dataset_extentsE4IdxT"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index23make_pq_dataset_extentsE4IdxT"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::make_pq_dataset_extents__IdxT"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1a99b9ad62d5b4e1513cf0e76128fd88e6"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">make_pq_dataset_extents</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5indexE" title="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_rows</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">pq_dataset_extents</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index23make_pq_dataset_extentsE4IdxT" title="Permalink to this definition">#</a><br></dt>
<dd><p>A helper function to determine the extents of an array enough to hold a given amount of data. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-attributes">Public Static Attributes</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index14kInvalidRecordE">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index14kInvalidRecordE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index14kInvalidRecordE"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::kInvalidRecord__IdxT"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1add0424e95530f8e29574df8cddb0ce6e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5indexE" title="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kInvalidRecord</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">numeric_limits</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5indexE" title="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">max</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="o"><span class="pre">-</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index14kInvalidRecordE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Default value filled in the <code class="docutils literal notranslate"><a class="reference internal" href="#structraft_1_1neighbors_1_1ivf__pq_1_1index_1aef2aa00661f1cc03176ce160dc5c9c50"><span class="std std-ref"><span class="pre">indices()</span></span></a></code> array. One may encounter it trying to access a record within a cluster that is outside of the <code class="docutils literal notranslate"><a class="reference internal" href="#structraft_1_1neighbors_1_1ivf__pq_1_1index_1a8dc46f1cd8266ed0b55fcfdd46f7bca4"><span class="std std-ref"><span class="pre">list_sizes()</span></span></a></code> bound (due to the record alignment <code class="docutils literal notranslate"><span class="pre">kIndexGroupSize</span></code>). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index18kOutOfBoundsRecordE">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index18kOutOfBoundsRecordE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index18kOutOfBoundsRecordE"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::kOutOfBoundsRecord__IdxT"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index_1a456ead62294d65beeda76b2b0b63a4b9"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5indexE" title="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kOutOfBoundsRecord</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">numeric_limits</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5indexE" title="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">max</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq5index18kOutOfBoundsRecordE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Default value returned by <code class="docutils literal notranslate"><span class="pre">search</span></code> when the <code class="docutils literal notranslate"><span class="pre">n_probes</span></code> is too small and top-k is too large. One may encounter it if the combined size of probed clusters is smaller than the requested number of results per query. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_paramsE">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_paramsE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_paramsE"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index_params"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_params</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ann</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">index_params</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_paramsE" title="Permalink to this definition">#</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ivf_pq_types.hpp&gt;</em></div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params7n_listsE">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params7n_listsE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params7n_listsE"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index_params::n_lists__uint32_t"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index__params_1a1c3f23090c965fe27cdeb80e1dcbbc97"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_lists</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1024</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params7n_listsE" title="Permalink to this definition">#</a><br></dt>
<dd><p>The number of inverted lists (clusters)</p>
<p>Hint: the number of vectors per cluster (<code class="docutils literal notranslate"><span class="pre">n_rows/n_lists</span></code>) should be approximately 1,000 to 10,000. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params14kmeans_n_itersE">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params14kmeans_n_itersE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params14kmeans_n_itersE"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index_params::kmeans_n_iters__uint32_t"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index__params_1a3620ce9c3ee52917eaafdef4ddc6f302"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kmeans_n_iters</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">20</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params14kmeans_n_itersE" title="Permalink to this definition">#</a><br></dt>
<dd><p>The number of iterations searching for kmeans centers (index building). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params24kmeans_trainset_fractionE">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params24kmeans_trainset_fractionE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params24kmeans_trainset_fractionE"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index_params::kmeans_trainset_fraction__double"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index__params_1aa77f0710aeb3876fdf0b02fabe98fca3"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kmeans_trainset_fraction</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0.5</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params24kmeans_trainset_fractionE" title="Permalink to this definition">#</a><br></dt>
<dd><p>The fraction of data to use during iterative kmeans building. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params7pq_bitsE">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params7pq_bitsE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params7pq_bitsE"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index_params::pq_bits__uint32_t"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index__params_1af45413e2c4373ccab23985851e204541"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pq_bits</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">8</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params7pq_bitsE" title="Permalink to this definition">#</a><br></dt>
<dd><p>The bit length of the vector element after compression by PQ.</p>
<p>Possible values: [4, 5, 6, 7, 8].</p>
<p>Hint: the smaller the &lsquo;pq_bits&rsquo;, the smaller the index size and the better the search performance, but the lower the recall. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params6pq_dimE">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params6pq_dimE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params6pq_dimE"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index_params::pq_dim__uint32_t"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index__params_1acf0b2ba4e9890ab3864d906369da45f3"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pq_dim</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params6pq_dimE" title="Permalink to this definition">#</a><br></dt>
<dd><p>The dimensionality of the vector after compression by PQ. When zero, an optimal value is selected using a heuristic.</p>
<p>NB: <code class="docutils literal notranslate"><span class="pre">pq_dim</span> <span class="pre">*</span> <span class="pre">pq_bits</span></code> must be a multiple of 8.</p>
<p>Hint: a smaller &lsquo;pq_dim&rsquo; results in a smaller index size and better search performance, but lower recall. If &lsquo;pq_bits&rsquo; is 8, &lsquo;pq_dim&rsquo; can be set to any number, but multiple of 8 are desirable for good performance. If &lsquo;pq_bits&rsquo; is not 8, &lsquo;pq_dim&rsquo; should be a multiple of 8. For good performance, it is desirable that &lsquo;pq_dim&rsquo; is a multiple of 32. Ideally, &lsquo;pq_dim&rsquo; should be also a divisor of the dataset dim. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params13codebook_kindE">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params13codebook_kindE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params13codebook_kindE"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index_params::codebook_kind__codebook_gen"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index__params_1a24539c25da79ad869e17db01648b059f"></span><a class="reference internal" href="#_CPPv4N4raft9neighbors6ivf_pq12codebook_genE" title="raft::neighbors::ivf_pq::codebook_gen"><span class="n"><span class="pre">codebook_gen</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">codebook_kind</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft9neighbors6ivf_pq12codebook_genE" title="raft::neighbors::ivf_pq::codebook_gen"><span class="n"><span class="pre">codebook_gen</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft9neighbors6ivf_pq12codebook_gen12PER_SUBSPACEE" title="raft::neighbors::ivf_pq::codebook_gen::PER_SUBSPACE"><span class="n"><span class="pre">PER_SUBSPACE</span></span></a><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params13codebook_kindE" title="Permalink to this definition">#</a><br></dt>
<dd><p>How PQ codebooks are created. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params21force_random_rotationE">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params21force_random_rotationE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params21force_random_rotationE"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::index_params::force_random_rotation__b"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1index__params_1a3fa5aa346aa2eedb06699c7629a7b9ec"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">force_random_rotation</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq12index_params21force_random_rotationE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Apply a random rotation matrix on the input data and queries even if <code class="docutils literal notranslate"><span class="pre">dim</span> <span class="pre">%</span> <span class="pre">pq_dim</span> <span class="pre">==</span> <span class="pre">0</span></code>.</p>
<p>Note: if <code class="docutils literal notranslate"><span class="pre">dim</span></code> is not multiple of <code class="docutils literal notranslate"><span class="pre">pq_dim</span></code>, a random rotation is always applied to the input data and queries to transform the working space from <code class="docutils literal notranslate"><span class="pre">dim</span></code> to <code class="docutils literal notranslate"><span class="pre">rot_dim</span></code>, which may be slightly larger than the original space and and is a multiple of <code class="docutils literal notranslate"><span class="pre">pq_dim</span></code> (<code class="docutils literal notranslate"><span class="pre">rot_dim</span> <span class="pre">%</span> <span class="pre">pq_dim</span> <span class="pre">==</span> <span class="pre">0</span></code>). However, this transform is not necessary when <code class="docutils literal notranslate"><span class="pre">dim</span></code> is multiple of <code class="docutils literal notranslate"><span class="pre">pq_dim</span></code> (<code class="docutils literal notranslate"><span class="pre">dim</span> <span class="pre">==</span> <span class="pre">rot_dim</span></code>, hence no need in adding &ldquo;extra&rdquo; data columns / features).</p>
<p>By default, if <code class="docutils literal notranslate"><span class="pre">dim</span> <span class="pre">==</span> <span class="pre">rot_dim</span></code>, the rotation transform is initialized with the identity matrix. When <code class="docutils literal notranslate"><span class="pre">force_random_rotation</span> <span class="pre">==</span> <span class="pre">true</span></code>, a random orthogonal transform matrix is generated regardless of the values of <code class="docutils literal notranslate"><span class="pre">dim</span></code> and <code class="docutils literal notranslate"><span class="pre">pq_dim</span></code>. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_paramsE">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_paramsE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_paramsE"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::search_params"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1search__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">search_params</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ann</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">search_params</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_paramsE" title="Permalink to this definition">#</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ivf_pq_types.hpp&gt;</em></div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params8n_probesE">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params8n_probesE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params8n_probesE"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::search_params::n_probes__uint32_t"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1search__params_1a1dd433c96dedd0e0d11f383232a265a2"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_probes</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">20</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params8n_probesE" title="Permalink to this definition">#</a><br></dt>
<dd><p>The number of clusters to search. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params9lut_dtypeE">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params9lut_dtypeE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params9lut_dtypeE"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::search_params::lut_dtype__cudaDataType_t"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1search__params_1a8a2cbf3427d56285df4d185d9b0c73c7"></span><span class="n"><span class="pre">cudaDataType_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">lut_dtype</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">CUDA_R_32F</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params9lut_dtypeE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Data type of look up table to be created dynamically at search time.</p>
<p>Possible values: [CUDA_R_32F, CUDA_R_16F, CUDA_R_8U]</p>
<p>The use of low-precision types reduces the amount of shared memory required at search time, so fast shared memory kernels can be used even for datasets with large dimansionality. Note that the recall is slightly degraded when low-precision type is selected. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params23internal_distance_dtypeE">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params23internal_distance_dtypeE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params23internal_distance_dtypeE"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::search_params::internal_distance_dtype__cudaDataType_t"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1search__params_1a25dfa6d3df230cb825b3b3d881c4b465"></span><span class="n"><span class="pre">cudaDataType_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">internal_distance_dtype</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">CUDA_R_32F</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params23internal_distance_dtypeE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Storage data type for distance/similarity computed at search time.</p>
<p>Possible values: [CUDA_R_16F, CUDA_R_32F]</p>
<p>If the performance limiter at search time is device memory access, selecting FP16 will improve performance slightly. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params24preferred_shmem_carveoutE">
<span id="_CPPv3N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params24preferred_shmem_carveoutE"></span><span id="_CPPv2N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params24preferred_shmem_carveoutE"></span><span id="raft::neighbors::ivf_pq::raft::neighbors::ivf_pq::search_params::preferred_shmem_carveout__double"></span><span class="target" id="structraft_1_1neighbors_1_1ivf__pq_1_1search__params_1a9cac1f52b0ce71234ce90a1dd864df34"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">preferred_shmem_carveout</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.0</span></span><a class="headerlink" href="#_CPPv4N4raft9neighbors6ivf_pq4raft9neighbors6ivf_pq13search_params24preferred_shmem_carveoutE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Preferred fraction of SM&rsquo;s unified memory / L1 cache to be used as shared memory.</p>
<p>Possible values: [0.0 - 1.0] as a fraction of the <code class="docutils literal notranslate"><span class="pre">sharedMemPerMultiprocessor</span></code>.</p>
<p>One wants to increase the carveout to make sure a good GPU occupancy for the main search kernel, but not to keep it too high to leave some memory to be used as L1 cache. Note, this value is interpreted only as a hint. Moreover, a GPU usually allows only a fixed set of cache configurations, so the provided value is rounded up to the nearest configuration. Refer to the NVIDIA tuning guide for the target GPU architecture.</p>
<p>Note, this is a low-level tuning parameter that can have drastic negative effects on the search performance if tweaked incorrectly. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="epsilon-neighborhood">
<h2>Epsilon Neighborhood<a class="headerlink" href="#epsilon-neighborhood" title="Permalink to this heading">#</a></h2>
<p>Header: <code class="xref py py-obj docutils literal notranslate"><span class="pre">raft/neighbors/epsilon_neighborhood.cuh</span></code></p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft9neighbors20epsilon_neighborhood24epsUnexpL2SqNeighborhoodEvPbP5idx_tPK7value_tPK7value_t5idx_t5idx_t5idx_t7value_t12cudaStream_t">
<span id="_CPPv3I00EN4raft9neighbors20epsilon_neighborhood24epsUnexpL2SqNeighborhoodEPbP5idx_tPK7value_tPK7value_t5idx_t5idx_t5idx_t7value_t12cudaStream_t"></span><span id="_CPPv2I00EN4raft9neighbors20epsilon_neighborhood24epsUnexpL2SqNeighborhoodEPbP5idx_tPK7value_tPK7value_t5idx_t5idx_t5idx_t7value_t12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1epsilon__neighborhood_1a4c974875eb1ff0bab4e060acf9e8cc26"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">epsilon_neighborhood</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">epsUnexpL2SqNeighborhood</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">adj</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors20epsilon_neighborhood24epsUnexpL2SqNeighborhoodEvPbP5idx_tPK7value_tPK7value_t5idx_t5idx_t5idx_t7value_t12cudaStream_t" title="raft::neighbors::epsilon_neighborhood::epsUnexpL2SqNeighborhood::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">vd</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors20epsilon_neighborhood24epsUnexpL2SqNeighborhoodEvPbP5idx_tPK7value_tPK7value_t5idx_t5idx_t5idx_t7value_t12cudaStream_t" title="raft::neighbors::epsilon_neighborhood::epsUnexpL2SqNeighborhood::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft9neighbors20epsilon_neighborhood24epsUnexpL2SqNeighborhoodEvPbP5idx_tPK7value_tPK7value_t5idx_t5idx_t5idx_t7value_t12cudaStream_t" title="raft::neighbors::epsilon_neighborhood::epsUnexpL2SqNeighborhood::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors20epsilon_neighborhood24epsUnexpL2SqNeighborhoodEvPbP5idx_tPK7value_tPK7value_t5idx_t5idx_t5idx_t7value_t12cudaStream_t" title="raft::neighbors::epsilon_neighborhood::epsUnexpL2SqNeighborhood::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors20epsilon_neighborhood24epsUnexpL2SqNeighborhoodEvPbP5idx_tPK7value_tPK7value_t5idx_t5idx_t5idx_t7value_t12cudaStream_t" title="raft::neighbors::epsilon_neighborhood::epsUnexpL2SqNeighborhood::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors20epsilon_neighborhood24epsUnexpL2SqNeighborhoodEvPbP5idx_tPK7value_tPK7value_t5idx_t5idx_t5idx_t7value_t12cudaStream_t" title="raft::neighbors::epsilon_neighborhood::epsUnexpL2SqNeighborhood::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft9neighbors20epsilon_neighborhood24epsUnexpL2SqNeighborhoodEvPbP5idx_tPK7value_tPK7value_t5idx_t5idx_t5idx_t7value_t12cudaStream_t" title="raft::neighbors::epsilon_neighborhood::epsUnexpL2SqNeighborhood::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">eps</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft9neighbors20epsilon_neighborhood24epsUnexpL2SqNeighborhoodEvPbP5idx_tPK7value_tPK7value_t5idx_t5idx_t5idx_t7value_t12cudaStream_t" title="Permalink to this definition">#</a><br></dt>
<dd><p>Computes epsilon neighborhood for the L2-Squared distance metric. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_t</strong> &ndash; IO and math type </p></li>
<li><p><strong>idx_t</strong> &ndash; Index type</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>adj</strong> &ndash; <strong>[out]</strong> adjacency matrix [row-major] [on device] [dim = m x n] </p></li>
<li><p><strong>vd</strong> &ndash; <strong>[out]</strong> vertex degree array [on device] [len = m + 1] <code class="docutils literal notranslate"><span class="pre">vd</span> <span class="pre">+</span> <span class="pre">m</span></code> stores the total number of edges in the adjacency matrix. Pass a nullptr if you don&rsquo;t need this info. </p></li>
<li><p><strong>x</strong> &ndash; <strong>[in]</strong> first matrix [row-major] [on device] [dim = m x k] </p></li>
<li><p><strong>y</strong> &ndash; <strong>[in]</strong> second matrix [row-major] [on device] [dim = n x k] </p></li>
<li><p><strong>m</strong> &ndash; <strong>[in]</strong> number of rows in x </p></li>
<li><p><strong>n</strong> &ndash; <strong>[in]</strong> number of rows in y </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> number of columns in x and k </p></li>
<li><p><strong>eps</strong> &ndash; <strong>[in]</strong> defines epsilon neighborhood radius (should be passed as squared as we compute L2-squared distance in this method) </p></li>
<li><p><strong>stream</strong> &ndash; <strong>[in]</strong> cuda stream </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN4raft9neighbors20epsilon_neighborhood18eps_neighbors_l2sqEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIb12matrix_idx_t9row_majorEEN4raft18device_vector_viewI5idx_t12matrix_idx_tEE7value_t">
<span id="_CPPv3I000EN4raft9neighbors20epsilon_neighborhood18eps_neighbors_l2sqERKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIb12matrix_idx_t9row_majorEEN4raft18device_vector_viewI5idx_t12matrix_idx_tEE7value_t"></span><span id="_CPPv2I000EN4raft9neighbors20epsilon_neighborhood18eps_neighbors_l2sqERKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIb12matrix_idx_t9row_majorEEN4raft18device_vector_viewI5idx_t12matrix_idx_tEE7value_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">matrix_idx_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1epsilon__neighborhood_1a30a9f18678cca9ee5a0612e01f81eb45"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">epsilon_neighborhood</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">eps_neighbors_l2sq</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors20epsilon_neighborhood18eps_neighbors_l2sqEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIb12matrix_idx_t9row_majorEEN4raft18device_vector_viewI5idx_t12matrix_idx_tEE7value_t" title="raft::neighbors::epsilon_neighborhood::eps_neighbors_l2sq::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors20epsilon_neighborhood18eps_neighbors_l2sqEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIb12matrix_idx_t9row_majorEEN4raft18device_vector_viewI5idx_t12matrix_idx_tEE7value_t" title="raft::neighbors::epsilon_neighborhood::eps_neighbors_l2sq::matrix_idx_t"><span class="n"><span class="pre">matrix_idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors20epsilon_neighborhood18eps_neighbors_l2sqEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIb12matrix_idx_t9row_majorEEN4raft18device_vector_viewI5idx_t12matrix_idx_tEE7value_t" title="raft::neighbors::epsilon_neighborhood::eps_neighbors_l2sq::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors20epsilon_neighborhood18eps_neighbors_l2sqEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIb12matrix_idx_t9row_majorEEN4raft18device_vector_viewI5idx_t12matrix_idx_tEE7value_t" title="raft::neighbors::epsilon_neighborhood::eps_neighbors_l2sq::matrix_idx_t"><span class="n"><span class="pre">matrix_idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">bool</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors20epsilon_neighborhood18eps_neighbors_l2sqEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIb12matrix_idx_t9row_majorEEN4raft18device_vector_viewI5idx_t12matrix_idx_tEE7value_t" title="raft::neighbors::epsilon_neighborhood::eps_neighbors_l2sq::matrix_idx_t"><span class="n"><span class="pre">matrix_idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">adj</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan.html#_CPPv4I000EN4raft18device_vector_viewE" title="raft::device_vector_view"><span class="n"><span class="pre">device_vector_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors20epsilon_neighborhood18eps_neighbors_l2sqEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIb12matrix_idx_t9row_majorEEN4raft18device_vector_viewI5idx_t12matrix_idx_tEE7value_t" title="raft::neighbors::epsilon_neighborhood::eps_neighbors_l2sq::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors20epsilon_neighborhood18eps_neighbors_l2sqEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIb12matrix_idx_t9row_majorEEN4raft18device_vector_viewI5idx_t12matrix_idx_tEE7value_t" title="raft::neighbors::epsilon_neighborhood::eps_neighbors_l2sq::matrix_idx_t"><span class="n"><span class="pre">matrix_idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vd</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft9neighbors20epsilon_neighborhood18eps_neighbors_l2sqEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIb12matrix_idx_t9row_majorEEN4raft18device_vector_viewI5idx_t12matrix_idx_tEE7value_t" title="raft::neighbors::epsilon_neighborhood::eps_neighbors_l2sq::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">eps</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN4raft9neighbors20epsilon_neighborhood18eps_neighbors_l2sqEvRKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewIb12matrix_idx_t9row_majorEEN4raft18device_vector_viewI5idx_t12matrix_idx_tEE7value_t" title="Permalink to this definition">#</a><br></dt>
<dd><p>Computes epsilon neighborhood for the L2-Squared distance metric and given ball size. The epsilon neighbors is represented by a dense boolean adjacency matrix of size m * n and an array of degrees for each vertex, which can be used as a compressed sparse row (CSR) indptr array. </p>
<p></p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/neighbors/epsilon_neighborhood.cuh&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/handle.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/device_mdarray.hpp&gt;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">neighbors</span><span class="p">;</span><span class="w"></span>
<span class="n">raft</span><span class="o">::</span><span class="n">handle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">;</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">adj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">make_device_matrix</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="p">);</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">vd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">make_device_vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="n">epsilon_neighborhood</span><span class="o">::</span><span class="n">eps_neighbors_l2sq</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">adj</span><span class="p">.</span><span class="n">view</span><span class="p">(),</span><span class="w"> </span><span class="n">vd</span><span class="p">.</span><span class="n">view</span><span class="p">(),</span><span class="w"> </span><span class="n">eps</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_t</strong> &ndash; IO and math type </p></li>
<li><p><strong>idx_t</strong> &ndash; Index type </p></li>
<li><p><strong>matrix_idx_t</strong> &ndash; matrix indexing type</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> raft handle to manage library resources </p></li>
<li><p><strong>x</strong> &ndash; <strong>[in]</strong> first matrix [row-major] [on device] [dim = m x k] </p></li>
<li><p><strong>y</strong> &ndash; <strong>[in]</strong> second matrix [row-major] [on device] [dim = n x k] </p></li>
<li><p><strong>adj</strong> &ndash; <strong>[out]</strong> adjacency matrix [row-major] [on device] [dim = m x n] </p></li>
<li><p><strong>vd</strong> &ndash; <strong>[out]</strong> vertex degree array [on device] [len = m + 1] <code class="docutils literal notranslate"><span class="pre">vd</span> <span class="pre">+</span> <span class="pre">m</span></code> stores the total number of edges in the adjacency matrix. Pass a nullptr if you don&rsquo;t need this info. </p></li>
<li><p><strong>eps</strong> &ndash; <strong>[in]</strong> defines epsilon neighborhood radius (should be passed as squared as we compute L2-squared distance in this method) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="random-ball-cover">
<h2>Random Ball Cover<a class="headerlink" href="#random-ball-cover" title="Permalink to this heading">#</a></h2>
<p>Header: <code class="xref py py-obj docutils literal notranslate"><span class="pre">raft/neighbors/ball_cover.cuh</span></code></p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN4raft9neighbors10ball_cover11build_indexEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE">
<span id="_CPPv3I0000EN4raft9neighbors10ball_cover11build_indexERKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE"></span><span id="_CPPv2I0000EN4raft9neighbors10ball_cover11build_indexERKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">int_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">matrix_idx_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ball__cover_1a02180011cd69d4e04bb949f205033f44"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ball_cover</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">build_index</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">handle_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">BallCoverIndex</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover11build_indexEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE" title="raft::neighbors::ball_cover::build_index::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover11build_indexEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE" title="raft::neighbors::ball_cover::build_index::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover11build_indexEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE" title="raft::neighbors::ball_cover::build_index::int_t"><span class="n"><span class="pre">int_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover11build_indexEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE" title="raft::neighbors::ball_cover::build_index::matrix_idx_t"><span class="n"><span class="pre">matrix_idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">index</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN4raft9neighbors10ball_cover11build_indexEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Builds and populates a previously unbuilt <a class="reference internal" href="#classraft_1_1neighbors_1_1ball__cover_1_1BallCoverIndex"><span class="std std-ref">BallCoverIndex</span></a></p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/handle.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/neighbors/ball_cover.cuh&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/distance/distance_types.hpp&gt;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">neighbors</span><span class="p">;</span><span class="w"></span>

<span class="n">raft</span><span class="o">::</span><span class="n">handle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">;</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">distance</span><span class="o">::</span><span class="n">DistanceType</span><span class="o">::</span><span class="n">L2Expanded</span><span class="p">;</span><span class="w"></span>
<span class="n">BallCoverIndex</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="p">);</span><span class="w"></span>

<span class="n">ball_cover</span><span class="o">::</span><span class="n">build_index</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx_t</strong> &ndash; knn index type </p></li>
<li><p><strong>value_t</strong> &ndash; knn value type </p></li>
<li><p><strong>int_t</strong> &ndash; integral type for knn params </p></li>
<li><p><strong>matrix_idx_t</strong> &ndash; matrix indexing type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> library resource management handle </p></li>
<li><p><strong>index</strong> &ndash; <strong>[inout]</strong> an empty (and not previous built) instance of <a class="reference internal" href="#classraft_1_1neighbors_1_1ball__cover_1_1BallCoverIndex"><span class="std std-ref">BallCoverIndex</span></a> </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE5int_tP5idx_tP7value_tbf">
<span id="_CPPv3I0000EN4raft9neighbors10ball_cover13all_knn_queryERKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE5int_tP5idx_tP7value_tbf"></span><span id="_CPPv2I0000EN4raft9neighbors10ball_cover13all_knn_queryERKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE5int_tP5idx_tP7value_tbf"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">int_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">matrix_idx_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ball__cover_1a934cf4d750386f14dac70f40b222df45"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ball_cover</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">all_knn_query</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">handle_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">BallCoverIndex</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE5int_tP5idx_tP7value_tbf" title="raft::neighbors::ball_cover::all_knn_query::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE5int_tP5idx_tP7value_tbf" title="raft::neighbors::ball_cover::all_knn_query::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE5int_tP5idx_tP7value_tbf" title="raft::neighbors::ball_cover::all_knn_query::int_t"><span class="n"><span class="pre">int_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE5int_tP5idx_tP7value_tbf" title="raft::neighbors::ball_cover::all_knn_query::matrix_idx_t"><span class="n"><span class="pre">matrix_idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">index</span></span>, <a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE5int_tP5idx_tP7value_tbf" title="raft::neighbors::ball_cover::all_knn_query::int_t"><span class="n"><span class="pre">int_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE5int_tP5idx_tP7value_tbf" title="raft::neighbors::ball_cover::all_knn_query::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">inds</span></span>, <a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE5int_tP5idx_tP7value_tbf" title="raft::neighbors::ball_cover::all_knn_query::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dists</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">perform_post_filtering</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">weight</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tE5int_tP5idx_tP7value_tbf" title="Permalink to this definition">#</a><br></dt>
<dd><p>Performs a faster exact knn in metric spaces using the triangle inequality with a number of landmark points to reduce the number of distance computations from O(n^2) to O(sqrt(n)). This performs an all neighbors knn, which can reuse memory when the index and query are the same array. This function will build the index and assumes rbc_build_index() has not already been called. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx_t</strong> &ndash; knn index type </p></li>
<li><p><strong>value_t</strong> &ndash; knn distance type </p></li>
<li><p><strong>int_t</strong> &ndash; type for integers, such as number of rows/cols </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> raft handle for resource management </p></li>
<li><p><strong>index</strong> &ndash; <strong>[inout]</strong> ball cover index which has not yet been built </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> number of nearest neighbors to find </p></li>
<li><p><strong>perform_post_filtering</strong> &ndash; <strong>[in]</strong> if this is false, only the closest k landmarks are considered (which will return approximate results). </p></li>
<li><p><strong>inds</strong> &ndash; <strong>[out]</strong> output knn indices </p></li>
<li><p><strong>dists</strong> &ndash; <strong>[out]</strong> output knn distances </p></li>
<li><p><strong>weight</strong> &ndash; <strong>[in]</strong> a weight for overlap between the closest landmark and the radius of other landmarks when pruning distances. Setting this value below 1 can effectively turn off computing distances against many other balls, enabling approximate nearest neighbors. Recall can be adjusted based on how many relevant balls are ignored. Note that many datasets can still have great recall even by only looking in the closest landmark. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf">
<span id="_CPPv3I0000EN4raft9neighbors10ball_cover13all_knn_queryERKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf"></span><span id="_CPPv2I0000EN4raft9neighbors10ball_cover13all_knn_queryERKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">int_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">matrix_idx_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ball__cover_1a17213fbb9ee74a19a4a0784c6f08738e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ball_cover</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">all_knn_query</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">handle_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">BallCoverIndex</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::all_knn_query::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::all_knn_query::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::all_knn_query::int_t"><span class="n"><span class="pre">int_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::all_knn_query::matrix_idx_t"><span class="n"><span class="pre">matrix_idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">index</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::all_knn_query::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::all_knn_query::matrix_idx_t"><span class="n"><span class="pre">matrix_idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">inds</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::all_knn_query::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::all_knn_query::matrix_idx_t"><span class="n"><span class="pre">matrix_idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dists</span></span>, <a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::all_knn_query::int_t"><span class="n"><span class="pre">int_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">perform_post_filtering</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">weight</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN4raft9neighbors10ball_cover13all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="Permalink to this definition">#</a><br></dt>
<dd><p>Performs a faster exact knn in metric spaces using the triangle inequality with a number of landmark points to reduce the number of distance computations from O(n^2) to O(sqrt(n)). This performs an all neighbors knn, which can reuse memory when the index and query are the same array. This function will build the index and assumes rbc_build_index() has not already been called.</p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/handle.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/neighbors/ball_cover.cuh&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/distance/distance_types.hpp&gt;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">neighbors</span><span class="p">;</span><span class="w"></span>

<span class="n">raft</span><span class="o">::</span><span class="n">handle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">;</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">distance</span><span class="o">::</span><span class="n">DistanceType</span><span class="o">::</span><span class="n">L2Expanded</span><span class="p">;</span><span class="w"></span>

<span class="c1">// Construct a ball cover index</span>
<span class="n">BallCoverIndex</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="p">);</span><span class="w"></span>

<span class="c1">// Perform all neighbors knn query</span>
<span class="n">ball_cover</span><span class="o">::</span><span class="n">all_knn_query</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">inds</span><span class="p">,</span><span class="w"> </span><span class="n">dists</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx_t</strong> &ndash; knn index type </p></li>
<li><p><strong>value_t</strong> &ndash; knn distance type </p></li>
<li><p><strong>int_t</strong> &ndash; type for integers, such as number of rows/cols </p></li>
<li><p><strong>matrix_idx_t</strong> &ndash; matrix indexing type</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> raft handle for resource management </p></li>
<li><p><strong>index</strong> &ndash; <strong>[in]</strong> ball cover index which has not yet been built </p></li>
<li><p><strong>inds</strong> &ndash; <strong>[out]</strong> output knn indices </p></li>
<li><p><strong>dists</strong> &ndash; <strong>[out]</strong> output knn distances </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> number of nearest neighbors to find </p></li>
<li><p><strong>perform_post_filtering</strong> &ndash; <strong>[in]</strong> if this is false, only the closest k landmarks are considered (which will return approximate results). </p></li>
<li><p><strong>weight</strong> &ndash; <strong>[in]</strong> a weight for overlap between the closest landmark and the radius of other landmarks when pruning distances. Setting this value below 1 can effectively turn off computing distances against many other balls, enabling approximate nearest neighbors. Recall can be adjusted based on how many relevant balls are ignored. Note that many datasets can still have great recall even by only looking in the closest landmark. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_tE5int_tPK7value_t5int_tP5idx_tP7value_tbf">
<span id="_CPPv3I000EN4raft9neighbors10ball_cover9knn_queryERKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_tE5int_tPK7value_t5int_tP5idx_tP7value_tbf"></span><span id="_CPPv2I000EN4raft9neighbors10ball_cover9knn_queryERKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_tE5int_tPK7value_t5int_tP5idx_tP7value_tbf"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">int_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ball__cover_1a2c010d8b5fbf278d151f119db26da015"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ball_cover</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">knn_query</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">handle_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">BallCoverIndex</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_tE5int_tPK7value_t5int_tP5idx_tP7value_tbf" title="raft::neighbors::ball_cover::knn_query::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_tE5int_tPK7value_t5int_tP5idx_tP7value_tbf" title="raft::neighbors::ball_cover::knn_query::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_tE5int_tPK7value_t5int_tP5idx_tP7value_tbf" title="raft::neighbors::ball_cover::knn_query::int_t"><span class="n"><span class="pre">int_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">index</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_tE5int_tPK7value_t5int_tP5idx_tP7value_tbf" title="raft::neighbors::ball_cover::knn_query::int_t"><span class="n"><span class="pre">int_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_tE5int_tPK7value_t5int_tP5idx_tP7value_tbf" title="raft::neighbors::ball_cover::knn_query::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">query</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_tE5int_tPK7value_t5int_tP5idx_tP7value_tbf" title="raft::neighbors::ball_cover::knn_query::int_t"><span class="n"><span class="pre">int_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_query_pts</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_tE5int_tPK7value_t5int_tP5idx_tP7value_tbf" title="raft::neighbors::ball_cover::knn_query::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">inds</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_tE5int_tPK7value_t5int_tP5idx_tP7value_tbf" title="raft::neighbors::ball_cover::knn_query::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dists</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">perform_post_filtering</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">weight</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_tE5int_tPK7value_t5int_tP5idx_tP7value_tbf" title="Permalink to this definition">#</a><br></dt>
<dd><p>Performs a faster exact knn in metric spaces using the triangle inequality with a number of landmark points to reduce the number of distance computations from O(n^2) to O(sqrt(n)). This function does not build the index and assumes rbc_build_index() has already been called. Use this function when the index and query arrays are different, otherwise use rbc_all_knn_query(). </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx_t</strong> &ndash; index type </p></li>
<li><p><strong>value_t</strong> &ndash; distances type </p></li>
<li><p><strong>int_t</strong> &ndash; integer type for size info </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> raft handle for resource management </p></li>
<li><p><strong>index</strong> &ndash; <strong>[inout]</strong> ball cover index which has not yet been built </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> number of nearest neighbors to find </p></li>
<li><p><strong>query</strong> &ndash; <strong>[in]</strong> the </p></li>
<li><p><strong>perform_post_filtering</strong> &ndash; <strong>[in]</strong> if this is false, only the closest k landmarks are considered (which will return approximate results). </p></li>
<li><p><strong>inds</strong> &ndash; <strong>[out]</strong> output knn indices </p></li>
<li><p><strong>dists</strong> &ndash; <strong>[out]</strong> output knn distances </p></li>
<li><p><strong>weight</strong> &ndash; <strong>[in]</strong> a weight for overlap between the closest landmark and the radius of other landmarks when pruning distances. Setting this value below 1 can effectively turn off computing distances against many other balls, enabling approximate nearest neighbors. Recall can be adjusted based on how many relevant balls are ignored. Note that many datasets can still have great recall even by only looking in the closest landmark. </p></li>
<li><p><strong>n_query_pts</strong> &ndash; <strong>[in]</strong> number of query points </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf">
<span id="_CPPv3I0000EN4raft9neighbors10ball_cover9knn_queryERKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf"></span><span id="_CPPv2I0000EN4raft9neighbors10ball_cover9knn_queryERKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">int_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">matrix_idx_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1neighbors_1_1ball__cover_1a84ad68de1f3f679367abd2e521cfa7cd"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ball_cover</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">knn_query</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">handle_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">BallCoverIndex</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::knn_query::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::knn_query::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::knn_query::int_t"><span class="n"><span class="pre">int_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::knn_query::matrix_idx_t"><span class="n"><span class="pre">matrix_idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">index</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::knn_query::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::knn_query::matrix_idx_t"><span class="n"><span class="pre">matrix_idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">query</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::knn_query::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::knn_query::matrix_idx_t"><span class="n"><span class="pre">matrix_idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">inds</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::knn_query::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::knn_query::matrix_idx_t"><span class="n"><span class="pre">matrix_idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dists</span></span>, <a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="raft::neighbors::ball_cover::knn_query::int_t"><span class="n"><span class="pre">int_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">perform_post_filtering</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">weight</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN4raft9neighbors10ball_cover9knn_queryEvRKN4raft8handle_tERK14BallCoverIndexI5idx_t7value_t5int_t12matrix_idx_tEN4raft18device_matrix_viewIK7value_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t12matrix_idx_t9row_majorEEN4raft18device_matrix_viewI7value_t12matrix_idx_t9row_majorEE5int_tbf" title="Permalink to this definition">#</a><br></dt>
<dd><p>Performs a faster exact knn in metric spaces using the triangle inequality with a number of landmark points to reduce the number of distance computations from O(n^2) to O(sqrt(n)). This function does not build the index and assumes rbc_build_index() has already been called. Use this function when the index and query arrays are different, otherwise use rbc_all_knn_query().</p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/handle.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/neighbors/ball_cover.cuh&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/distance/distance_types.hpp&gt;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">neighbors</span><span class="p">;</span><span class="w"></span>

<span class="n">raft</span><span class="o">::</span><span class="n">handle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">;</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">distance</span><span class="o">::</span><span class="n">DistanceType</span><span class="o">::</span><span class="n">L2Expanded</span><span class="p">;</span><span class="w"></span>

<span class="c1">// Build a ball cover index</span>
<span class="n">BallCoverIndex</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="p">);</span><span class="w"></span>
<span class="n">ball_cover</span><span class="o">::</span><span class="n">build_index</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">);</span><span class="w"></span>

<span class="c1">// Perform all neighbors knn query</span>
<span class="n">ball_cover</span><span class="o">::</span><span class="n">knn_query</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">inds</span><span class="p">,</span><span class="w"> </span><span class="n">dists</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx_t</strong> &ndash; index type </p></li>
<li><p><strong>value_t</strong> &ndash; distances type </p></li>
<li><p><strong>int_t</strong> &ndash; integer type for size info </p></li>
<li><p><strong>matrix_idx_t</strong> &ndash; </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> raft handle for resource management </p></li>
<li><p><strong>index</strong> &ndash; <strong>[in]</strong> ball cover index which has not yet been built </p></li>
<li><p><strong>query</strong> &ndash; <strong>[in]</strong> device matrix containing query data points </p></li>
<li><p><strong>inds</strong> &ndash; <strong>[out]</strong> output knn indices </p></li>
<li><p><strong>dists</strong> &ndash; <strong>[out]</strong> output knn distances </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> number of nearest neighbors to find </p></li>
<li><p><strong>perform_post_filtering</strong> &ndash; <strong>[in]</strong> if this is false, only the closest k landmarks are considered (which will return approximate results). </p></li>
<li><p><strong>weight</strong> &ndash; <strong>[in]</strong> a weight for overlap between the closest landmark and the radius of other landmarks when pruning distances. Setting this value below 1 can effectively turn off computing distances against many other balls, enabling approximate nearest neighbors. Recall can be adjusted based on how many relevant balls are ignored. Note that many datasets can still have great recall even by only looking in the closest landmark. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndexE">
<span id="_CPPv3I0000EN4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndexE"></span><span id="_CPPv2I0000EN4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndexE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_idx</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_int</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">matrix_idx</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1neighbors_1_1ball__cover_1_1BallCoverIndex"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BallCoverIndex</span></span></span><a class="headerlink" href="#_CPPv4I0000EN4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndexE" title="Permalink to this definition">#</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ball_cover_types.hpp&gt;</em></div>
<p>Stores raw index data points, sampled landmarks, the 1-nns of index points to their closest landmarks, and the ball radii of each landmark. This class is intended to be constructed once and reused across subsequent queries. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_idx</strong> &ndash; </p></li>
<li><p><strong>value_t</strong> &ndash; </p></li>
<li><p><strong>value_int</strong> &ndash; </p></li>
</ul>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndex14BallCoverIndexERKN4raft8handle_tEPK7value_t9value_int9value_intN4raft8distance12DistanceTypeE">
<span id="_CPPv3N4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndex14BallCoverIndexERKN4raft8handle_tEPK7value_t9value_int9value_intN4raft8distance12DistanceTypeE"></span><span id="_CPPv2N4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndex14BallCoverIndexERKN4raft8handle_tEPK7value_t9value_int9value_intN4raft8distance12DistanceTypeE"></span><span id="raft::neighbors::ball_cover::raft::neighbors::ball_cover::BallCoverIndex::BallCoverIndex__raft::handle_tCR.value_tCP.value_int.value_int.raft::distance::DistanceType"></span><span class="target" id="classraft_1_1neighbors_1_1ball__cover_1_1BallCoverIndex_1a0401608245c246b85a34c772d64070f9"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BallCoverIndex</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">handle_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle_</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndexE" title="raft::neighbors::ball_cover::raft::neighbors::ball_cover::BallCoverIndex::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">X_</span></span>, <a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndexE" title="raft::neighbors::ball_cover::raft::neighbors::ball_cover::BallCoverIndex::value_int"><span class="n"><span class="pre">value_int</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m_</span></span>, <a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndexE" title="raft::neighbors::ball_cover::raft::neighbors::ball_cover::BallCoverIndex::value_int"><span class="n"><span class="pre">value_int</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">distance</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">DistanceType</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">metric_</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndex14BallCoverIndexERKN4raft8handle_tEPK7value_t9value_int9value_intN4raft8distance12DistanceTypeE" title="Permalink to this definition">#</a><br></dt>
<dd><p>the <a class="reference internal" href="linalg.html#group__ScalarOps_1ga11956a324b4b96ead56febc92b1ec885"><span class="std std-ref">sqrt()</span></a> here makes the sqrt(m)^2 a linear-time lower bound</p>
<p>Total memory footprint of index: (2 * sqrt(m)) + (n * sqrt(m)) + (2 * m) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndex14BallCoverIndexERKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t10matrix_idx9row_majorEEN4raft8distance12DistanceTypeE">
<span id="_CPPv3N4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndex14BallCoverIndexERKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t10matrix_idx9row_majorEEN4raft8distance12DistanceTypeE"></span><span id="_CPPv2N4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndex14BallCoverIndexERKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t10matrix_idx9row_majorEEN4raft8distance12DistanceTypeE"></span><span id="raft::neighbors::ball_cover::raft::neighbors::ball_cover::BallCoverIndex::BallCoverIndex__raft::handle_tCR.raft::device_matrix_view:value_tC.matrix_idx.row_major:.raft::distance::DistanceType"></span><span class="target" id="classraft_1_1neighbors_1_1ball__cover_1_1BallCoverIndex_1ab6b2339c605c41b75e1dae8adc7e547c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BallCoverIndex</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">handle_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle_</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndexE" title="raft::neighbors::ball_cover::raft::neighbors::ball_cover::BallCoverIndex::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndexE" title="raft::neighbors::ball_cover::raft::neighbors::ball_cover::BallCoverIndex::matrix_idx"><span class="n"><span class="pre">matrix_idx</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mdspan.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">X_</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">distance</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">DistanceType</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">metric_</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft9neighbors10ball_cover4raft9neighbors10ball_cover14BallCoverIndex14BallCoverIndexERKN4raft8handle_tEN4raft18device_matrix_viewIK7value_t10matrix_idx9row_majorEEN4raft8distance12DistanceTypeE" title="Permalink to this definition">#</a><br></dt>
<dd><p>the <a class="reference internal" href="linalg.html#group__ScalarOps_1ga11956a324b4b96ead56febc92b1ec885"><span class="std std-ref">sqrt()</span></a> here makes the sqrt(m)^2 a linear-time lower bound</p>
<p>Total memory footprint of index: (2 * sqrt(m)) + (n * sqrt(m)) + (2 * m) </p>
</dd></dl>

</div>
</dd></dl>

</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class="prev-next-area">
  <a class="left-prev" href="mdspan.html" id="prev-link" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Multi-dimensional Data</p>
      </div>
  </a>
  <a class="right-next" href="solver.html" id="next-link" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Solvers</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav class="page-toc" id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#brute-force">
   Brute-force
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ivf-flat">
   IVF-Flat
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ivf-pq">
   IVF-PQ
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#epsilon-neighborhood">
   Epsilon Neighborhood
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#random-ball-cover">
   Random Ball Cover
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="../_sources/cpp_api/neighbors.rst.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022, nvidia.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>

  </div>
  
</div>
  </footer>
  
<script defer id="rapids-selector-js" src="/assets/js/custom.js"></script><script id="rapids-selector-pixel-invocation" type="text/javascript">_satellite.pageBottom();</script></body></html>