<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport"><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator">

    <title>Distance &mdash; raft 23.02.00 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2">
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2">
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2">

    <link href="../_static/pygments.css" rel="stylesheet" type="text/css">
    <link href="../_static/copybutton.css" rel="stylesheet" type="text/css">
    <link href="../_static/references.css" rel="stylesheet" type="text/css">
    <link href="https://docs.rapids.ai/assets/css/custom.css" rel="stylesheet" type="text/css">
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link as="script" href="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94" rel="preload">
<link as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94" rel="preload">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script defer="defer" src="https://docs.rapids.ai/assets/js/custom.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'cpp_api/distance';</script>
    <link href="../genindex.html" rel="index" title="Index">
    <link href="../search.html" rel="search" title="Search">
    <link href="linalg.html" rel="next" title="Linear Algebra">
    <link href="cluster.html" rel="prev" title="Cluster">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="en" name="docsearch:language">
  <script id="rapids-selector-pixel-src" src="https://assets.adobedtm.com/5d4962a43b79/814eb6e9b4e1/launch-4bc07f1e0b0b.min.js"></script><link href="/assets/css/custom.css" id="rapids-selector-css" rel="stylesheet"></head>
  
  
  <body data-default-mode="" data-offset="180" data-spy="scroll" data-target="#bd-toc-nav">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input class="sidebar-toggle" id="__primary" name="__primary" type="checkbox">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input class="sidebar-toggle" id="__secondary" name="__secondary" type="checkbox">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form action="../search.html" class="bd-search d-flex align-items-center" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input aria-label="Search the docs ..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search the docs ..." spellcheck="false" type="search">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">

  
  
  
  
  
  
  

  
  
    <p class="title logo__title">raft 23.02.00 documentation</p>
  
</a>
    
  </div>

  
  <div class="navbar-header-items">
    <div class="ml-auto" id="navbar-center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
        Site Navigation
    </p>
    <ul class="navbar-nav" id="navbar-main-elements">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../quick_start.html">
                        Quick Start
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../build.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../developer_guide.html">
                        Developer Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../cpp_api.html">
                        C++ API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../pylibraft_api.html">
                        PyLibRAFT API
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button aria-expanded="false" aria-haspopup="true" class="btn dropdown-toggle nav-item" data-toggle="dropdown" type="button">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../raft_dask_api.html">
                        RAFT Dask API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing.html">
                        Contributing
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button aria-label="Search" class="btn btn-sm navbar-btn search-button search-button__button" data-toggle="tooltip" title="Search">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button aria-label="light/dark" class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" data-toggle="tooltip" title="light/dark">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a class="nav-link" data-toggle="tooltip" href="https://github.com/rapidsai/raft" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a class="nav-link" data-toggle="tooltip" href="https://twitter.com/rapidsai" rel="noopener" target="_blank" title="Twitter"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button aria-label="Search" class="btn btn-sm navbar-btn search-button search-button__button" data-toggle="tooltip" title="Search">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar"><div id="rapids-pydata-container"><div class="rapids-home-container"><a class="rapids-home-container__home-btn" href="/api">Home</a></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">raft</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/clx/stable/api.html">clx</a><a class="rapids-selector__menu-item" href="/api/cucim/stable/api.html">cucim</a><a class="rapids-selector__menu-item" href="/api/cudf/stable/index.html">cudf</a><a class="rapids-selector__menu-item" href="/api/cudf-java/nightly">cudf-java</a><a class="rapids-selector__menu-item" href="/api/cugraph/stable">cugraph</a><a class="rapids-selector__menu-item" href="/api/cuml/stable/api.html">cuml</a><a class="rapids-selector__menu-item" href="/api/cusignal/stable/api.html">cusignal</a><a class="rapids-selector__menu-item" href="/api/cuspatial/stable">cuspatial</a><a class="rapids-selector__menu-item" href="/api/cuxfilter/stable">cuxfilter</a><a class="rapids-selector__menu-item" href="/api/dask-cuda/stable/api.html">dask-cuda</a><a class="rapids-selector__menu-item" href="/api/kvikio/stable/api.html">kvikio</a><a class="rapids-selector__menu-item" href="/api/libcudf/stable/namespacecudf.html">libcudf</a><a class="rapids-selector__menu-item" href="/api/libcugraph/stable">libcugraph</a><a class="rapids-selector__menu-item" href="/api/libcuml/stable">libcuml</a><a class="rapids-selector__menu-item" href="/api/libcuspatial/stable">libcuspatial</a><a class="rapids-selector__menu-item" href="/api/libkvikio/stable">libkvikio</a><a class="rapids-selector__menu-item" href="/api/librmm/stable/annotated.html">librmm</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/raft/stable">raft</a><a class="rapids-selector__menu-item" href="/api/rapids-cmake/stable/api.html">rapids-cmake</a><a class="rapids-selector__menu-item" href="/api/rmm/stable/api.html">rmm</a></div></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">nightly (23.02)</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/raft/nightly">nightly (23.02)</a><a class="rapids-selector__menu-item" href="/api/raft/stable">stable (22.12)</a><a class="rapids-selector__menu-item" href="/api/raft/legacy">legacy (22.10)</a></div></div></div>
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
        Site Navigation
    </p>
    <ul class="navbar-nav" id="navbar-main-elements">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../quick_start.html">
                        Quick Start
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../build.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../developer_guide.html">
                        Developer Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../cpp_api.html">
                        C++ API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../pylibraft_api.html">
                        PyLibRAFT API
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button aria-expanded="false" aria-haspopup="true" class="btn dropdown-toggle nav-item" data-toggle="dropdown" type="button">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../raft_dask_api.html">
                        RAFT Dask API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing.html">
                        Contributing
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button aria-label="light/dark" class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" data-toggle="tooltip" title="light/dark">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a class="nav-link" data-toggle="tooltip" href="https://github.com/rapidsai/raft" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a class="nav-link" data-toggle="tooltip" href="https://twitter.com/rapidsai" rel="noopener" target="_blank" title="Twitter"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav aria-label="Section navigation" class="bd-links" id="bd-docs-nav">
  <p aria-level="1" class="bd-links__title" role="heading">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="core.html">Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster.html">Cluster</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Distance</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="linalg.html">Linear Algebra</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="linalg_arithmetic.html">Arithmetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="linalg_blas.html">BLAS Routines</a></li>
<li class="toctree-l2"><a class="reference internal" href="linalg_map_reduce.html">Mapping and Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="linalg_matrix.html">Matrix Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="linalg_matrix_vector.html">Matrix-Vector Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="linalg_solver.html">Linear Algebra Solvers</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="matrix.html">Matrix</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="matrix_arithmetic.html">Matrix Arithmetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix_manipulation.html">Matrix Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix_ordering.html">Matrix Ordering</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix_reduction.html">Matrix Reductions</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix_selection.html">Matrix Selection</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="mdspan.html">Multi-dimensional Data</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="mdspan_representation.html">Multi-dimensional Representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="mdspan_mdspan.html">mdspan: Multi-dimensional Non-owning View</a></li>
<li class="toctree-l2"><a class="reference internal" href="mdspan_mdarray.html">mdarray: Multi-dimensional Owning Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="mdspan_span.html">span: One-dimensional Non-owning View</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="neighbors.html">Neighbors</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="random.html">Random</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="random_datagen.html">Data Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="random_sampling_univariate.html">Univariate Random Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="random_sampling_without_replacement.html">Sampling Without Replacement</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="solver.html">Solvers</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="sparse.html">Sparse</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="sparse_distance.html">Sparse Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse_linalg.html">Sparse Linear Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse_matrix.html">Sparse Matrix Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse_neighbors.html">Sparse Neighbors</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse_solver.html">Sparse Solvers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="stats.html">Stats</a></li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main class="bd-main" id="main-content">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="distance">
<h1>Distance<a class="headerlink" href="#distance" title="Permalink to this heading">#</a></h1>
<p>This page provides C++ class references for the publicly-exposed elements of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">raft/distance</span></code> package. RAFT&rsquo;s
distances have been highly optimized and support a wide assortment of different distance measures.</p>
<section id="distance-types">
<h2>Distance Types<a class="headerlink" href="#distance-types" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;raft/distance/distance_types.hpp&gt;</span></code></p>
<p>namespace <em>raft::distance</em></p>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceTypeE">
<span id="_CPPv3N4raft8distance12DistanceTypeE"></span><span id="_CPPv2N4raft8distance12DistanceTypeE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">distance</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">DistanceType</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceTypeE" title="Permalink to this definition">#</a><br></dt>
<dd><p>enum to tell how to compute distance </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType10L2ExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType10L2ExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType10L2ExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a260d2830aacf708d5a9bab724efdcdf8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L2Expanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType10L2ExpandedE" title="Permalink to this definition">#</a><br></dt>
<dd><p>evaluate as dist_ij = sum(x_ik^2) + sum(y_ij)^2 - 2*sum(x_ik * y_jk) </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType14L2SqrtExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType14L2SqrtExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType14L2SqrtExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a4d8d107312a2302379fb165bfae2d3c6"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L2SqrtExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType14L2SqrtExpandedE" title="Permalink to this definition">#</a><br></dt>
<dd><p>same as above, but inside the epilogue, perform square root operation </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType14CosineExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType14CosineExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType14CosineExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a48fb8815b598ea06333f61749afefb9b"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CosineExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType14CosineExpandedE" title="Permalink to this definition">#</a><br></dt>
<dd><p>cosine distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType2L1E">
<span id="_CPPv3N4raft8distance12DistanceType2L1E"></span><span id="_CPPv2N4raft8distance12DistanceType2L1E"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a4342e21a9d5a89dd05165b548ed76f31"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L1</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType2L1E" title="Permalink to this definition">#</a><br></dt>
<dd><p>L1 distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType12L2UnexpandedE">
<span id="_CPPv3N4raft8distance12DistanceType12L2UnexpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType12L2UnexpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a81c2e8b19beb55f0771bff42a03ac810"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L2Unexpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType12L2UnexpandedE" title="Permalink to this definition">#</a><br></dt>
<dd><p>evaluate as dist_ij += (x_ik - y-jk)^2 </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType16L2SqrtUnexpandedE">
<span id="_CPPv3N4raft8distance12DistanceType16L2SqrtUnexpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType16L2SqrtUnexpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a8318dbfebd41e0f93b0c8a211bef3cb8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L2SqrtUnexpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType16L2SqrtUnexpandedE" title="Permalink to this definition">#</a><br></dt>
<dd><p>same as above, but inside the epilogue, perform square root operation </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType12InnerProductE">
<span id="_CPPv3N4raft8distance12DistanceType12InnerProductE"></span><span id="_CPPv2N4raft8distance12DistanceType12InnerProductE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a70f89c9bf7fa6f05a13646e1de6d7178"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InnerProduct</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType12InnerProductE" title="Permalink to this definition">#</a><br></dt>
<dd><p>basic inner product </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType4LinfE">
<span id="_CPPv3N4raft8distance12DistanceType4LinfE"></span><span id="_CPPv2N4raft8distance12DistanceType4LinfE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a185b8e11ff85c7ffb16372cc11f40833"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Linf</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType4LinfE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Chebyshev (Linf) distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType8CanberraE">
<span id="_CPPv3N4raft8distance12DistanceType8CanberraE"></span><span id="_CPPv2N4raft8distance12DistanceType8CanberraE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1aa772a76513c29f7b67b8884d92a3debd"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Canberra</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType8CanberraE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Canberra distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType12LpUnexpandedE">
<span id="_CPPv3N4raft8distance12DistanceType12LpUnexpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType12LpUnexpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a5f1ddb80c7c8de7a58719c06fcb55aa9"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LpUnexpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType12LpUnexpandedE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Generalized Minkowski distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType19CorrelationExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType19CorrelationExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType19CorrelationExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1ac52ba9a65568dfd526ef3e0e79dd7d76"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CorrelationExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType19CorrelationExpandedE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Correlation distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType15JaccardExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType15JaccardExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType15JaccardExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1afa8c62f78f79f7e9ea54fe96de211a06"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">JaccardExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType15JaccardExpandedE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Jaccard distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType17HellingerExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType17HellingerExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType17HellingerExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1afb2bdeb001658bf43f341662fd25d4bf"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">HellingerExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType17HellingerExpandedE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Hellinger distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType9HaversineE">
<span id="_CPPv3N4raft8distance12DistanceType9HaversineE"></span><span id="_CPPv2N4raft8distance12DistanceType9HaversineE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a85f595d27413bf51df240faf9fd51a1b"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Haversine</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType9HaversineE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Haversine distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType10BrayCurtisE">
<span id="_CPPv3N4raft8distance12DistanceType10BrayCurtisE"></span><span id="_CPPv2N4raft8distance12DistanceType10BrayCurtisE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a260486b7750910efc426c3011c187fc7"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BrayCurtis</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType10BrayCurtisE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Bray-Curtis distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType13JensenShannonE">
<span id="_CPPv3N4raft8distance12DistanceType13JensenShannonE"></span><span id="_CPPv2N4raft8distance12DistanceType13JensenShannonE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a6c4feaa8cee536fb43bb62ec5d640d84"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">JensenShannon</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType13JensenShannonE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Jensen-Shannon distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType17HammingUnexpandedE">
<span id="_CPPv3N4raft8distance12DistanceType17HammingUnexpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType17HammingUnexpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a463aa03baa6d1ebfe73cb7e117c54799"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">HammingUnexpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType17HammingUnexpandedE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Hamming distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType12KLDivergenceE">
<span id="_CPPv3N4raft8distance12DistanceType12KLDivergenceE"></span><span id="_CPPv2N4raft8distance12DistanceType12KLDivergenceE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a120ce453ec90b2f0cc900b427ba17859"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">KLDivergence</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType12KLDivergenceE" title="Permalink to this definition">#</a><br></dt>
<dd><p>KLDivergence </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType17RusselRaoExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType17RusselRaoExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType17RusselRaoExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1aeaed6497e19d80f7a3da8ca9f8f3f2f9"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RusselRaoExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType17RusselRaoExpandedE" title="Permalink to this definition">#</a><br></dt>
<dd><p>RusselRao </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType12DiceExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType12DiceExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType12DiceExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a045a33649506444b73c2c91854a425a3"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DiceExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType12DiceExpandedE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Dice-Sorensen distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType11PrecomputedE">
<span id="_CPPv3N4raft8distance12DistanceType11PrecomputedE"></span><span id="_CPPv2N4raft8distance12DistanceType11PrecomputedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1ab06de53ee826704ad219603dcc4bf9cd"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Precomputed</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType11PrecomputedE" title="Permalink to this definition">#</a><br></dt>
<dd><p>Precomputed (special value) </p>
</dd></dl>

</dd></dl>

</section>
<section id="pairwise-distance">
<h2>Pairwise Distance<a class="headerlink" href="#pairwise-distance" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;raft/distance/distance.cuh&gt;</span></code></p>
<p>namespace <em>raft::distance</em></p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_N4raft8distance12DistanceTypeE00000E8distancevRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType">
<span id="_CPPv3I_N4raft8distance12DistanceTypeE00000E8distanceRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType"></span><span id="_CPPv2I_N4raft8distance12DistanceTypeE00000E8distanceRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">distance</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distanceType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AccType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">layout</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">layout_c_contiguous</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__distance__mdspan_1gaf3cd2723a7ceba7666645cea5ff1ddac"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distance</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000E8distancevRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000E8distancevRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000E8distancevRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000E8distancevRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000E8distancevRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000E8distancevRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000E8distancevRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="distance::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000E8distancevRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000E8distancevRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dist</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000E8distancevRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000E8distancevRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="Permalink to this definition">#</a><br></dt>
<dd><p>Evaluate pairwise distances for the simple use case. </p>
<p>Note: Only contiguous row- or column-major layouts supported currently.</p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/handle.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/device_mdarray.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/random/make_blobs.cuh&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/distance/distance.cuh&gt;</span><span class="cp"></span>

<span class="n">raft</span><span class="o">::</span><span class="n">handle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">;</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">n_samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5000</span><span class="p">;</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">n_features</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span><span class="w"></span>

<span class="k">auto</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">make_device_matrix</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">n_samples</span><span class="p">,</span><span class="w"> </span><span class="n">n_features</span><span class="p">);</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">make_device_vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">n_samples</span><span class="p">);</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">make_device_matrix</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">n_samples</span><span class="p">,</span><span class="w"> </span><span class="n">n_samples</span><span class="p">);</span><span class="w"></span>

<span class="n">raft</span><span class="o">::</span><span class="n">random</span><span class="o">::</span><span class="n">make_blobs</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="n">view</span><span class="p">(),</span><span class="w"> </span><span class="n">labels</span><span class="p">.</span><span class="n">view</span><span class="p">());</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">distance</span><span class="o">::</span><span class="n">DistanceType</span><span class="o">::</span><span class="n">L2SqrtExpanded</span><span class="p">;</span><span class="w"></span>
<span class="n">raft</span><span class="o">::</span><span class="n">distance</span><span class="o">::</span><span class="n">pairwise_distance</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="n">view</span><span class="p">(),</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="n">view</span><span class="p">(),</span><span class="w"> </span><span class="n">output</span><span class="p">.</span><span class="n">view</span><span class="p">(),</span><span class="w"> </span><span class="n">metric</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DistanceType</strong> &ndash; which distance to evaluate </p></li>
<li><p><strong>InType</strong> &ndash; input argument type </p></li>
<li><p><strong>AccType</strong> &ndash; accumulation type </p></li>
<li><p><strong>OutType</strong> &ndash; output type </p></li>
<li><p><strong>Index_</strong> &ndash; Index type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; raft handle for managing expensive resources </p></li>
<li><p><strong>x</strong> &ndash; first set of points (size n*k) </p></li>
<li><p><strong>y</strong> &ndash; second set of points (size m*k) </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix (size n*m) </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000E17pairwise_distancevRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type">
<span id="_CPPv3I000E17pairwise_distanceRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type"></span><span id="_CPPv2I000E17pairwise_distanceRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Type</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">layout</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">layout_c_contiguous</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__distance__mdspan_1ga9b33e196aaa3704790a2ad24df68a3ca"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pairwise_distance</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000E17pairwise_distancevRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E17pairwise_distancevRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E17pairwise_distancevRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="pairwise_distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000E17pairwise_distancevRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E17pairwise_distancevRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E17pairwise_distancevRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="pairwise_distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y</span></span>, <span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000E17pairwise_distancevRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E17pairwise_distancevRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E17pairwise_distancevRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="pairwise_distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dist</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">distance</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span>, <a class="reference internal" href="#_CPPv4I000E17pairwise_distancevRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000E17pairwise_distancevRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="Permalink to this definition">#</a><br></dt>
<dd><p>Convenience wrapper around &lsquo;distance&rsquo; prim to convert runtime metric into compile time for the purpose of dispatch. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Type</strong> &ndash; input/accumulation/output data-type </p></li>
<li><p><strong>Index_</strong> &ndash; indexing type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; raft handle for managing expensive resources </p></li>
<li><p><strong>x</strong> &ndash; first matrix of points (size mxk) </p></li>
<li><p><strong>y</strong> &ndash; second matrix of points (size nxk) </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix (size mxn) </p></li>
<li><p><strong>metric</strong> &ndash; distance metric </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="fused-1-nearest-neighbors">
<h2>Fused 1-Nearest Neighbors<a class="headerlink" href="#fused-1-nearest-neighbors" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;raft/distance/fused_l2_nn.cuh&gt;</span></code></p>
<p>namespace <em>raft::distance</em></p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00000E9fusedL2NNvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t">
<span id="_CPPv3I00000E9fusedL2NNP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t"></span><span id="_CPPv2I00000E9fusedL2NNP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ReduceOpT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">KVPReduceOpT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__fused__l2__nn_1ga00a2383d2785d2962b7ea2e01ee5d491"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fusedL2NN</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00000E9fusedL2NNvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="fusedL2NN::OutT"><span class="n"><span class="pre">OutT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">min</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000E9fusedL2NNvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="fusedL2NN::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000E9fusedL2NNvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="fusedL2NN::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000E9fusedL2NNvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="fusedL2NN::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">xn</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000E9fusedL2NNvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="fusedL2NN::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">yn</span></span>, <a class="reference internal" href="#_CPPv4I00000E9fusedL2NNvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="fusedL2NN::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I00000E9fusedL2NNvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="fusedL2NN::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I00000E9fusedL2NNvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="fusedL2NN::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">workspace</span></span>, <a class="reference internal" href="#_CPPv4I00000E9fusedL2NNvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="fusedL2NN::ReduceOpT"><span class="n"><span class="pre">ReduceOpT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">redOp</span></span>, <a class="reference internal" href="#_CPPv4I00000E9fusedL2NNvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="fusedL2NN::KVPReduceOpT"><span class="n"><span class="pre">KVPReduceOpT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pairRedOp</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sqrt</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">initOutBuffer</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00000E9fusedL2NNvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="Permalink to this definition">#</a><br></dt>
<dd><p>Fused L2 distance and 1-nearest-neighbor computation in a single call. </p>
<p>The benefits of such a call are 2-fold: 1) eliminate the need for an intermediate buffer to store the output of gemm 2) reduce the memory read traffic on this intermediate buffer, otherwise needed during the reduction phase for 1-NN.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DataT</strong> &ndash; data type </p></li>
<li><p><strong>OutT</strong> &ndash; output type to either store 1-NN indices and their minimum distances or store only the min distances. Accordingly, one has to pass an appropriate <code class="docutils literal notranslate"><span class="pre">ReduceOpT</span></code> </p></li>
<li><p><strong>IdxT</strong> &ndash; indexing arithmetic type </p></li>
<li><p><strong>ReduceOpT</strong> &ndash; A struct to perform the final needed reduction operation and also to initialize the output array elements with the appropriate initial value needed for reduction.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>min</strong> &ndash; <strong>[out]</strong> will contain the reduced output (Length = <code class="docutils literal notranslate"><span class="pre">m</span></code>) (on device) </p></li>
<li><p><strong>x</strong> &ndash; <strong>[in]</strong> first matrix. Row major. Dim = <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">x</span> <span class="pre">k</span></code>. (on device). </p></li>
<li><p><strong>y</strong> &ndash; <strong>[in]</strong> second matrix. Row major. Dim = <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">x</span> <span class="pre">k</span></code>. (on device). </p></li>
<li><p><strong>xn</strong> &ndash; <strong>[in]</strong> L2 squared norm of <code class="docutils literal notranslate"><span class="pre">x</span></code>. Length = <code class="docutils literal notranslate"><span class="pre">m</span></code>. (on device). </p></li>
<li><p><strong>yn</strong> &ndash; <strong>[in]</strong> L2 squared norm of <code class="docutils literal notranslate"><span class="pre">y</span></code>. Length = <code class="docutils literal notranslate"><span class="pre">n</span></code>. (on device) </p></li>
<li><p><strong>m</strong> &ndash; <strong>[in]</strong> gemm m </p></li>
<li><p><strong>n</strong> &ndash; <strong>[in]</strong> gemm n </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> gemm k </p></li>
<li><p><strong>workspace</strong> &ndash; <strong>[in]</strong> temp workspace. Size = sizeof(int)*m. (on device) </p></li>
<li><p><strong>redOp</strong> &ndash; <strong>[in]</strong> reduction operator in the epilogue </p></li>
<li><p><strong>pairRedOp</strong> &ndash; <strong>[in]</strong> reduction operation on key value pairs </p></li>
<li><p><strong>sqrt</strong> &ndash; <strong>[in]</strong> Whether the output <code class="docutils literal notranslate"><span class="pre">minDist</span></code> should contain L2-sqrt </p></li>
<li><p><strong>initOutBuffer</strong> &ndash; <strong>[in]</strong> whether to initialize the output buffer before the main kernel launch </p></li>
<li><p><strong>stream</strong> &ndash; <strong>[in]</strong> cuda stream </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000E18fusedL2NNMinReducevP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t">
<span id="_CPPv3I000E18fusedL2NNMinReduceP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t"></span><span id="_CPPv2I000E18fusedL2NNMinReduceP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__fused__l2__nn_1gab098dd70824e421df18fc90ff3e17a9a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fusedL2NNMinReduce</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I000E18fusedL2NNMinReducevP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="fusedL2NNMinReduce::OutT"><span class="n"><span class="pre">OutT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">min</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E18fusedL2NNMinReducevP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="fusedL2NNMinReduce::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E18fusedL2NNMinReducevP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="fusedL2NNMinReduce::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E18fusedL2NNMinReducevP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="fusedL2NNMinReduce::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">xn</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E18fusedL2NNMinReducevP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="fusedL2NNMinReduce::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">yn</span></span>, <a class="reference internal" href="#_CPPv4I000E18fusedL2NNMinReducevP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="fusedL2NNMinReduce::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I000E18fusedL2NNMinReducevP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="fusedL2NNMinReduce::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I000E18fusedL2NNMinReducevP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="fusedL2NNMinReduce::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">workspace</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sqrt</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">initOutBuffer</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000E18fusedL2NNMinReducevP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="Permalink to this definition">#</a><br></dt>
<dd><p>Wrapper around fusedL2NN with minimum reduction operators. </p>
<p>fusedL2NN cannot be compiled in the distance library due to the lambda operators, so this wrapper covers the most common case (minimum). This should be preferred to the more generic API when possible, in order to reduce compilation times for users of the shared library.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DataT</strong> &ndash; data type </p></li>
<li><p><strong>OutT</strong> &ndash; output type to either store 1-NN indices and their minimum distances (e.g. raft::KeyValuePair&lt;int, float&gt;) or store only the min distances. </p></li>
<li><p><strong>IdxT</strong> &ndash; indexing arithmetic type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>min</strong> &ndash; <strong>[out]</strong> will contain the reduced output (Length = <code class="docutils literal notranslate"><span class="pre">m</span></code>) (on device) </p></li>
<li><p><strong>x</strong> &ndash; <strong>[in]</strong> first matrix. Row major. Dim = <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">x</span> <span class="pre">k</span></code>. (on device). </p></li>
<li><p><strong>y</strong> &ndash; <strong>[in]</strong> second matrix. Row major. Dim = <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">x</span> <span class="pre">k</span></code>. (on device). </p></li>
<li><p><strong>xn</strong> &ndash; <strong>[in]</strong> L2 squared norm of <code class="docutils literal notranslate"><span class="pre">x</span></code>. Length = <code class="docutils literal notranslate"><span class="pre">m</span></code>. (on device). </p></li>
<li><p><strong>yn</strong> &ndash; <strong>[in]</strong> L2 squared norm of <code class="docutils literal notranslate"><span class="pre">y</span></code>. Length = <code class="docutils literal notranslate"><span class="pre">n</span></code>. (on device) </p></li>
<li><p><strong>m</strong> &ndash; <strong>[in]</strong> gemm m </p></li>
<li><p><strong>n</strong> &ndash; <strong>[in]</strong> gemm n </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> gemm k </p></li>
<li><p><strong>workspace</strong> &ndash; <strong>[in]</strong> temp workspace. Size = sizeof(int)*m. (on device) </p></li>
<li><p><strong>sqrt</strong> &ndash; <strong>[in]</strong> Whether the output <code class="docutils literal notranslate"><span class="pre">minDist</span></code> should contain L2-sqrt </p></li>
<li><p><strong>initOutBuffer</strong> &ndash; <strong>[in]</strong> whether to initialize the output buffer before the main kernel launch </p></li>
<li><p><strong>stream</strong> &ndash; <strong>[in]</strong> cuda stream </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4I00E12KVPMinReduce">
<span id="_CPPv3I00E12KVPMinReduce"></span><span id="_CPPv2I00E12KVPMinReduce"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LabelT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__fused__l2__nn_1gabb6b16e8f3b34780f10c348585d388b1"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">KVPMinReduce</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">KVPMinReduceImpl</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E12KVPMinReduce" title="KVPMinReduce::LabelT"><span class="n"><span class="pre">LabelT</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00E12KVPMinReduce" title="KVPMinReduce::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00E12KVPMinReduce" title="Permalink to this definition">#</a><br></dt>
<dd></dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4I00E22MinAndDistanceReduceOp">
<span id="_CPPv3I00E22MinAndDistanceReduceOp"></span><span id="_CPPv2I00E22MinAndDistanceReduceOp"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LabelT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__fused__l2__nn_1ga5d7c5661704344e7be1908bef409e6f8"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MinAndDistanceReduceOp</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MinAndDistanceReduceOpImpl</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E22MinAndDistanceReduceOp" title="MinAndDistanceReduceOp::LabelT"><span class="n"><span class="pre">LabelT</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00E22MinAndDistanceReduceOp" title="MinAndDistanceReduceOp::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00E22MinAndDistanceReduceOp" title="Permalink to this definition">#</a><br></dt>
<dd></dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4I00E11MinReduceOp">
<span id="_CPPv3I00E11MinReduceOp"></span><span id="_CPPv2I00E11MinReduceOp"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LabelT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__fused__l2__nn_1gad2c23feb7a46f9f23815ca81fbf234f2"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MinReduceOp</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MinReduceOpImpl</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E11MinReduceOp" title="MinReduceOp::LabelT"><span class="n"><span class="pre">LabelT</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00E11MinReduceOp" title="MinReduceOp::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00E11MinReduceOp" title="Permalink to this definition">#</a><br></dt>
<dd></dd></dl>

</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class="prev-next-area">
  <a class="left-prev" href="cluster.html" id="prev-link" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Cluster</p>
      </div>
  </a>
  <a class="right-next" href="linalg.html" id="next-link" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Linear Algebra</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav class="page-toc" id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#distance-types">
   Distance Types
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pairwise-distance">
   Pairwise Distance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fused-1-nearest-neighbors">
   Fused 1-Nearest Neighbors
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="../_sources/cpp_api/distance.rst.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022, nvidia.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>

  </div>
  
</div>
  </footer>
  
<script defer id="rapids-selector-js" src="/assets/js/custom.js"></script><script id="rapids-selector-pixel-invocation" type="text/javascript">_satellite.pageBottom();</script></body></html>