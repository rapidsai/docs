<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport"><meta content="Docutils 0.18.1: http://docutils.sourceforge.net/" name="generator">

    <title>Mapping and Reduction &mdash; raft 23.04.00 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet">
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet">

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet">
  <link as="font" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2">
<link as="font" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2">
<link as="font" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2">

    <link href="../_static/pygments.css" rel="stylesheet" type="text/css">
    <link href="../_static/copybutton.css" rel="stylesheet" type="text/css">
    <link href="../_static/references.css" rel="stylesheet" type="text/css">
    <link href="https://docs.rapids.ai/assets/css/custom.css" rel="stylesheet" type="text/css">
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" rel="preload">
<link as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" rel="preload">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script defer="defer" src="https://docs.rapids.ai/assets/js/custom.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'cpp_api/linalg_map_reduce';</script>
    <link href="../genindex.html" rel="index" title="Index">
    <link href="../search.html" rel="search" title="Search">
    <link href="linalg_matrix.html" rel="next" title="Matrix Operations">
    <link href="linalg_blas.html" rel="prev" title="BLAS Routines">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="en" name="docsearch:language">
  <script id="rapids-selector-pixel-src" src="https://assets.adobedtm.com/5d4962a43b79/814eb6e9b4e1/launch-4bc07f1e0b0b.min.js"></script><link href="/assets/css/custom.css" id="rapids-selector-css" rel="stylesheet"></head>
  
  
  <body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode data-offset="180">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input class="sidebar-toggle" id="__primary" name="__primary" type="checkbox">
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input class="sidebar-toggle" id="__secondary" name="__secondary" type="checkbox">
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form action="../search.html" class="bd-search d-flex align-items-center" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input aria-label="Search the docs ..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search the docs ..." spellcheck="false" type="search">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">raft 23.04.00 documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="navbar-header-items">
    
    <div class="ms-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../quick_start.html">
                        Quick Start
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../build.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../developer_guide.html">
                        Developer Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../cpp_api.html">
                        C++ API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../pylibraft_api.html">
                        Python API
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button aria-expanded="false" aria-haspopup="true" class="btn dropdown-toggle nav-item" data-bs-toggle="dropdown" type="button">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../cuda_ann_benchmarks.html">
                        CUDA ANN Benchmarks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../raft_dask_api.html">
                        RAFT Dask API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../using_comms.html">
                        Using RAFT Comms
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../using_libraft.html">
                        Using The Pre-Compiled Binary
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing.html">
                        Contributing
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links navbar-nav">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/rapidsai/raft" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://twitter.com/rapidsai" rel="noopener" target="_blank" title="Twitter"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar"><div id="rapids-pydata-container"><div class="rapids-home-container"><a class="rapids-home-container__home-btn" href="/api">Home</a></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">raft</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/clx/stable/api.html">clx</a><a class="rapids-selector__menu-item" href="/api/cucim/stable/api.html">cucim</a><a class="rapids-selector__menu-item" href="/api/cudf/stable/index.html">cudf</a><a class="rapids-selector__menu-item" href="/api/cudf-java/stable">cudf-java</a><a class="rapids-selector__menu-item" href="/api/cugraph/stable">cugraph</a><a class="rapids-selector__menu-item" href="/api/cuml/stable/api.html">cuml</a><a class="rapids-selector__menu-item" href="/api/cusignal/stable/api.html">cusignal</a><a class="rapids-selector__menu-item" href="/api/cuspatial/stable">cuspatial</a><a class="rapids-selector__menu-item" href="/api/cuxfilter/stable">cuxfilter</a><a class="rapids-selector__menu-item" href="/api/dask-cuda/stable/api.html">dask-cuda</a><a class="rapids-selector__menu-item" href="/api/kvikio/stable/api.html">kvikio</a><a class="rapids-selector__menu-item" href="/api/libcudf/stable/namespacecudf.html">libcudf</a><a class="rapids-selector__menu-item" href="/api/libcugraph/stable">libcugraph</a><a class="rapids-selector__menu-item" href="/api/libcuml/stable">libcuml</a><a class="rapids-selector__menu-item" href="/api/libcuspatial/stable">libcuspatial</a><a class="rapids-selector__menu-item" href="/api/libkvikio/stable">libkvikio</a><a class="rapids-selector__menu-item" href="/api/librmm/stable/annotated.html">librmm</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/raft/stable">raft</a><a class="rapids-selector__menu-item" href="/api/rapids-cmake/stable/api.html">rapids-cmake</a><a class="rapids-selector__menu-item" href="/api/rmm/stable/api.html">rmm</a></div></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">nightly (23.04)</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/raft/nightly">nightly (23.04)</a><a class="rapids-selector__menu-item" href="/api/raft/stable">stable (23.02)</a><a class="rapids-selector__menu-item" href="/api/raft/legacy">legacy (22.12)</a></div></div></div>
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../quick_start.html">
                        Quick Start
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../build.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../developer_guide.html">
                        Developer Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../cpp_api.html">
                        C++ API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../pylibraft_api.html">
                        Python API
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button aria-expanded="false" aria-haspopup="true" class="btn dropdown-toggle nav-item" data-bs-toggle="dropdown" type="button">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../cuda_ann_benchmarks.html">
                        CUDA ANN Benchmarks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../raft_dask_api.html">
                        RAFT Dask API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../using_comms.html">
                        Using RAFT Comms
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../using_libraft.html">
                        Using The Pre-Compiled Binary
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing.html">
                        Contributing
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links navbar-nav">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/rapidsai/raft" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://twitter.com/rapidsai" rel="noopener" target="_blank" title="Twitter"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav aria-label="Section Navigation" class="bd-docs-nav bd-links">
  <p aria-level="1" class="bd-links__title" role="heading">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="core.html">Core</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="core_resources.html">Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_logger.html">logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_kvp.html">Key-Value Pair</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_nvtx.html">NVTX</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_interruptible.html">Interruptible</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_operators.html">Operators and Functors</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="cluster.html">Cluster</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="cluster_kmeans.html">K-Means</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_slhc.html">Hierarchical Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_spectral.html">Spectral Clustering</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="distance.html">Distance</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="distance_pairwise.html">Pairwise Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="distance_1nn.html">1-Nearest Neighbors</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="linalg.html">Linear Algebra</a><input checked class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="linalg_arithmetic.html">Arithmetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="linalg_blas.html">BLAS Routines</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Mapping and Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="linalg_matrix.html">Matrix Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="linalg_matrix_vector.html">Matrix-Vector Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="linalg_solver.html">Linear Algebra Solvers</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="matrix.html">Matrix</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="matrix_arithmetic.html">Matrix Arithmetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix_manipulation.html">Matrix Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix_ordering.html">Matrix Ordering</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix_reduction.html">Matrix Reductions</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix_selection.html">Matrix Selection</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="mdspan.html">Multi-dimensional Data</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="mdspan_representation.html">Multi-dimensional Representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="mdspan_mdspan.html">mdspan: Multi-dimensional Non-owning View</a></li>
<li class="toctree-l2"><a class="reference internal" href="mdspan_mdarray.html">mdarray: Multi-dimensional Owning Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="mdspan_span.html">span: One-dimensional Non-owning View</a></li>
<li class="toctree-l2"><a class="reference internal" href="mdspan_temporary_device_buffer.html">temporary_device_buffer: Temporary raft::device_mdspan Producing Object</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mnmg.html">Multi-node Multi-GPU</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="neighbors.html">Neighbors</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="neighbors_brute_force.html">Brute-Force</a></li>
<li class="toctree-l2"><a class="reference internal" href="neighbors_ivf_flat.html">IVF-Flat</a></li>
<li class="toctree-l2"><a class="reference internal" href="neighbors_ivf_pq.html">IVF-PQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="neighbors_epsilon_neighborhood.html">Epsilon Neighborhood</a></li>
<li class="toctree-l2"><a class="reference internal" href="neighbors_ball_cover.html">Random Ball Cover</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="random.html">Random</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="random_datagen.html">Data Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="random_sampling_univariate.html">Univariate Random Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="random_sampling_multivariable.html">Multi-Variable Random Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="random_sampling_without_replacement.html">Sampling Without Replacement</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="solver.html">Solvers</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="sparse.html">Sparse</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="sparse_distance.html">Sparse Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse_linalg.html">Sparse Linear Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse_matrix.html">Sparse Matrix Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse_neighbors.html">Sparse Neighbors</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse_solver.html">Sparse Solvers</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="stats.html">Stats</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="stats_summary.html">Summary Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="stats_probability.html">Probability &amp; Information Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="stats_regression.html">Regression Model Scoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="stats_classification.html">Classification Model Scoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="stats_clustering.html">Clustering Model Scoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="stats_neighborhood.html">Neighborhood Model Scoring</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main class="bd-main" id="main-content">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul aria-label="Breadcrumb" class="bd-breadcrumbs" role="navigation">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a aria-label="Home" class="nav-link" href="../index.html">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a class="nav-link" href="../cpp_api.html">C++ API</a></li>
    
    
    <li class="breadcrumb-item"><a class="nav-link" href="linalg.html">Linear Algebra</a></li>
    
    <li aria-current="page" class="breadcrumb-item active">Mapping and Reduction</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="mapping-and-reduction">
<h1>Mapping and Reduction<a class="headerlink" href="#mapping-and-reduction" title="Permalink to this heading">#</a></h1>
<section id="coalesced-reduction">
<h2>Coalesced Reduction<a class="headerlink" href="#coalesced-reduction" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;raft/linalg/coalesced_reduction.cuh&gt;</span></code></p>
<p>namespace <em>raft::linalg</em></p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000000E19coalesced_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType7IdxTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda">
<span id="_CPPv3I0000000E19coalesced_reductionRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType7IdxTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda"></span><span id="_CPPv2I0000000E19coalesced_reductionRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType7IdxTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InValueType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LayoutPolicy</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutValueType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MainLambda</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft11identity_opE" title="raft::identity_op"><span class="n"><span class="pre">identity_op</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ReduceLambda</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft6add_opE" title="raft::add_op"><span class="n"><span class="pre">add_op</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FinalLambda</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft11identity_opE" title="raft::identity_op"><span class="n"><span class="pre">identity_op</span></span></a><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__coalesced__reduction_1ga691548fd1fc57766a9cac1021c9083b2"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">coalesced_reduction</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E19coalesced_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType7IdxTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="coalesced_reduction::InValueType"><span class="n"><span class="pre">InValueType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E19coalesced_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType7IdxTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="coalesced_reduction::IdxType"><span class="n"><span class="pre">IdxType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E19coalesced_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType7IdxTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="coalesced_reduction::LayoutPolicy"><span class="n"><span class="pre">LayoutPolicy</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_vector_viewE" title="raft::device_vector_view"><span class="n"><span class="pre">device_vector_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000000E19coalesced_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType7IdxTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="coalesced_reduction::OutValueType"><span class="n"><span class="pre">OutValueType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E19coalesced_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType7IdxTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="coalesced_reduction::IdxType"><span class="n"><span class="pre">IdxType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dots</span></span>, <a class="reference internal" href="#_CPPv4I0000000E19coalesced_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType7IdxTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="coalesced_reduction::OutValueType"><span class="n"><span class="pre">OutValueType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">init</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">inplace</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <a class="reference internal" href="#_CPPv4I0000000E19coalesced_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType7IdxTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="coalesced_reduction::MainLambda"><span class="n"><span class="pre">MainLambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">main_op</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft11identity_opE" title="raft::identity_op"><span class="n"><span class="pre">identity_op</span></span></a><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span>, <a class="reference internal" href="#_CPPv4I0000000E19coalesced_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType7IdxTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="coalesced_reduction::ReduceLambda"><span class="n"><span class="pre">ReduceLambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">reduce_op</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft6add_opE" title="raft::add_op"><span class="n"><span class="pre">add_op</span></span></a><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span>, <a class="reference internal" href="#_CPPv4I0000000E19coalesced_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType7IdxTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="coalesced_reduction::FinalLambda"><span class="n"><span class="pre">FinalLambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">final_op</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft11identity_opE" title="raft::identity_op"><span class="n"><span class="pre">identity_op</span></span></a><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000000E19coalesced_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType7IdxTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="Permalink to this definition">#</a><br></dt>
<dd><p>Compute reduction of the input matrix along the leading dimension This API is to be used when the desired reduction is along the dimension of the memory layout. For example, a row-major matrix will be reduced along the columns whereas a column-major matrix will be reduced along the rows. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>InValueType</strong> &ndash; the input data-type of underlying raft::matrix_view </p></li>
<li><p><strong>LayoutPolicy</strong> &ndash; The layout of Input/Output (row or col major) </p></li>
<li><p><strong>OutValueType</strong> &ndash; the output data-type of underlying raft::matrix_view and reduction </p></li>
<li><p><strong>IndexType</strong> &ndash; Integer type used to for addressing </p></li>
<li><p><strong>MainLambda</strong> &ndash; Unary lambda applied while acculumation (eg: L1 or L2 norm) It must be a &lsquo;callable&rsquo; supporting the following input and output:  </p></li>
<li><p><strong>ReduceLambda</strong> &ndash; Binary lambda applied for reduction (eg: addition(+) for L2 norm) It must be a &lsquo;callable&rsquo; supporting the following input and output:  </p></li>
<li><p><strong>FinalLambda</strong> &ndash; the final lambda applied before STG (eg: Sqrt for L2 norm) It must be a &lsquo;callable&rsquo; supporting the following input and output:  </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>data</strong> &ndash; <strong>[in]</strong> Input of type <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a7e14f9414358a77ea57cf19f5bbea3fb"><span class="std std-ref">raft::device_matrix_view</span></a></p></li>
<li><p><strong>dots</strong> &ndash; <strong>[out]</strong> Output of type <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a7e14f9414358a77ea57cf19f5bbea3fb"><span class="std std-ref">raft::device_matrix_view</span></a></p></li>
<li><p><strong>init</strong> &ndash; <strong>[in]</strong> initial value to use for the reduction </p></li>
<li><p><strong>inplace</strong> &ndash; <strong>[in]</strong> reduction result added inplace or overwrites old values? </p></li>
<li><p><strong>main_op</strong> &ndash; <strong>[in]</strong> fused elementwise operation to apply before reduction </p></li>
<li><p><strong>reduce_op</strong> &ndash; <strong>[in]</strong> fused binary reduction operation </p></li>
<li><p><strong>final_op</strong> &ndash; <strong>[in]</strong> fused elementwise operation to apply before storing results </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="map">
<h2>Map<a class="headerlink" href="#map" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;raft/linalg/map.cuh&gt;</span></code></p>
<p>namespace <em>raft::linalg</em></p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00Dp00E3mapvRKN4raft16device_resourcesE7OutType4FuncDp7InTypes">
<span id="_CPPv3I00Dp00E3mapRKN4raft16device_resourcesE7OutType4FuncDp7InTypes"></span><span id="_CPPv2I00Dp00E3mapRKN4raft16device_resourcesE7OutType4FuncDp7InTypes"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Func</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">InTypes</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft30enable_if_output_device_mdspanE" title="raft::enable_if_output_device_mdspan"><span class="n"><span class="pre">enable_if_output_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00Dp00E3mapvRKN4raft16device_resourcesE7OutType4FuncDp7InTypes" title="map::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft29enable_if_input_device_mdspanE" title="raft::enable_if_input_device_mdspan"><span class="n"><span class="pre">enable_if_input_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00Dp00E3mapvRKN4raft16device_resourcesE7OutType4FuncDp7InTypes" title="map::InTypes"><span class="n"><span class="pre">InTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__map_1gad87b085a4282c8a8e610e02b52ea4baf"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">map</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">res</span></span>, <a class="reference internal" href="#_CPPv4I00Dp00E3mapvRKN4raft16device_resourcesE7OutType4FuncDp7InTypes" title="map::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <a class="reference internal" href="#_CPPv4I00Dp00E3mapvRKN4raft16device_resourcesE7OutType4FuncDp7InTypes" title="map::Func"><span class="n"><span class="pre">Func</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">f</span></span>, <a class="reference internal" href="#_CPPv4I00Dp00E3mapvRKN4raft16device_resourcesE7OutType4FuncDp7InTypes" title="map::InTypes"><span class="n"><span class="pre">InTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ins</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00Dp00E3mapvRKN4raft16device_resourcesE7OutType4FuncDp7InTypes" title="Permalink to this definition">#</a><br></dt>
<dd><p>Map a function over zero or more input mdspans of the same size. </p>
<p>The algorithm applied on <code class="docutils literal notranslate"><span class="pre">k</span></code> inputs can be described in a following pseudo-code: </p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">auto</span> <span class="n">i</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span> <span class="o">...</span> <span class="n">out</span><span class="o">.</span><span class="n">size</span><span class="p">()])</span> <span class="p">{</span>
  <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">in_0</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">in_1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">...</span><span class="p">,</span> <span class="n">in_k</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="p">}</span>
</pre></div>
</div>
<p></p>
<p><em>Performance note</em>: when possible, this function loads the argument arrays and stores the output array using vectorized cuda load/store instructions. The size of the vectorization depends on the size of the largest input/output element type and on the alignment of all pointers.</p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/device_mdarray.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/device_resources.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/operators.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/linalg/map.cuh&gt;</span>

<span class="k">auto</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">make_device_vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
<span class="p">...</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="p">..</span>
<span class="k">auto</span><span class="w"> </span><span class="n">squares</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">make_device_vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
<span class="n">raft</span><span class="o">::</span><span class="n">linalg</span><span class="o">::</span><span class="n">map_offset</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">squares</span><span class="p">.</span><span class="n">view</span><span class="p">(),</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">sq_op</span><span class="p">{},</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="n">view</span><span class="p">());</span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>OutType</strong> &ndash; data-type of the result (device_mdspan) </p></li>
<li><p><strong>Func</strong> &ndash; the device-lambda performing the actual operation </p></li>
<li><p><strong>InTypes</strong> &ndash; data-types of the inputs (device_mdspan)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>res</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>out</strong> &ndash; <strong>[out]</strong> the output of the map operation (device_mdspan) </p></li>
<li><p><strong>f</strong> &ndash; <strong>[in]</strong> device lambda (InTypes::value_type xs&hellip;) -&gt; OutType::value_type </p></li>
<li><p><strong>ins</strong> &ndash; <strong>[in]</strong> the inputs (each of the same size as the output) (device_mdspan) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00000E3mapvRKN4raft16device_resourcesE7InType17OutType4Func">
<span id="_CPPv3I00000E3mapRKN4raft16device_resourcesE7InType17OutType4Func"></span><span id="_CPPv2I00000E3mapRKN4raft16device_resourcesE7InType17OutType4Func"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType1</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Func</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft30enable_if_output_device_mdspanE" title="raft::enable_if_output_device_mdspan"><span class="n"><span class="pre">enable_if_output_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00000E3mapvRKN4raft16device_resourcesE7InType17OutType4Func" title="map::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft29enable_if_input_device_mdspanE" title="raft::enable_if_input_device_mdspan"><span class="n"><span class="pre">enable_if_input_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00000E3mapvRKN4raft16device_resourcesE7InType17OutType4Func" title="map::InType1"><span class="n"><span class="pre">InType1</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__map_1ga684cdb3d79136d60973be289b891be0e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">map</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">res</span></span>, <a class="reference internal" href="#_CPPv4I00000E3mapvRKN4raft16device_resourcesE7InType17OutType4Func" title="map::InType1"><span class="n"><span class="pre">InType1</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">in1</span></span>, <a class="reference internal" href="#_CPPv4I00000E3mapvRKN4raft16device_resourcesE7InType17OutType4Func" title="map::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <a class="reference internal" href="#_CPPv4I00000E3mapvRKN4raft16device_resourcesE7InType17OutType4Func" title="map::Func"><span class="n"><span class="pre">Func</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00000E3mapvRKN4raft16device_resourcesE7InType17OutType4Func" title="Permalink to this definition">#</a><br></dt>
<dd><p>Map a function over one mdspan. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>InType1</strong> &ndash; data-type of the input (device_mdspan) </p></li>
<li><p><strong>OutType</strong> &ndash; data-type of the result (device_mdspan) </p></li>
<li><p><strong>Func</strong> &ndash; the device-lambda performing the actual operation</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>res</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>in1</strong> &ndash; <strong>[in]</strong> the input (the same size as the output) (device_mdspan) </p></li>
<li><p><strong>out</strong> &ndash; <strong>[out]</strong> the output of the map operation (device_mdspan) </p></li>
<li><p><strong>f</strong> &ndash; <strong>[in]</strong> device lambda (InType1::value_type x) -&gt; OutType::value_type </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000000E3mapvRKN4raft16device_resourcesE7InType17InType27OutType4Func">
<span id="_CPPv3I000000E3mapRKN4raft16device_resourcesE7InType17InType27OutType4Func"></span><span id="_CPPv2I000000E3mapRKN4raft16device_resourcesE7InType17InType27OutType4Func"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType1</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType2</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Func</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft30enable_if_output_device_mdspanE" title="raft::enable_if_output_device_mdspan"><span class="n"><span class="pre">enable_if_output_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000000E3mapvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="map::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft29enable_if_input_device_mdspanE" title="raft::enable_if_input_device_mdspan"><span class="n"><span class="pre">enable_if_input_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000000E3mapvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="map::InType1"><span class="n"><span class="pre">InType1</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000E3mapvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="map::InType2"><span class="n"><span class="pre">InType2</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__map_1gaa82b1e5c096c4b8b709e6935a04ffe2b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">map</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">res</span></span>, <a class="reference internal" href="#_CPPv4I000000E3mapvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="map::InType1"><span class="n"><span class="pre">InType1</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">in1</span></span>, <a class="reference internal" href="#_CPPv4I000000E3mapvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="map::InType2"><span class="n"><span class="pre">InType2</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">in2</span></span>, <a class="reference internal" href="#_CPPv4I000000E3mapvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="map::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <a class="reference internal" href="#_CPPv4I000000E3mapvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="map::Func"><span class="n"><span class="pre">Func</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000000E3mapvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="Permalink to this definition">#</a><br></dt>
<dd><p>Map a function over two mdspans. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>InType1</strong> &ndash; data-type of the input (device_mdspan) </p></li>
<li><p><strong>InType2</strong> &ndash; data-type of the input (device_mdspan) </p></li>
<li><p><strong>OutType</strong> &ndash; data-type of the result (device_mdspan) </p></li>
<li><p><strong>Func</strong> &ndash; the device-lambda performing the actual operation</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>res</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>in1</strong> &ndash; <strong>[in]</strong> the input (the same size as the output) (device_mdspan) </p></li>
<li><p><strong>in2</strong> &ndash; <strong>[in]</strong> the input (the same size as the output) (device_mdspan) </p></li>
<li><p><strong>out</strong> &ndash; <strong>[out]</strong> the output of the map operation (device_mdspan) </p></li>
<li><p><strong>f</strong> &ndash; <strong>[in]</strong> device lambda (InType1::value_type x1, InType2::value_type x2) -&gt; OutType::value_type </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000000E3mapvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func">
<span id="_CPPv3I0000000E3mapRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func"></span><span id="_CPPv2I0000000E3mapRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType1</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType2</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType3</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Func</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft30enable_if_output_device_mdspanE" title="raft::enable_if_output_device_mdspan"><span class="n"><span class="pre">enable_if_output_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000000E3mapvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft29enable_if_input_device_mdspanE" title="raft::enable_if_input_device_mdspan"><span class="n"><span class="pre">enable_if_input_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000000E3mapvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map::InType1"><span class="n"><span class="pre">InType1</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E3mapvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map::InType2"><span class="n"><span class="pre">InType2</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E3mapvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map::InType3"><span class="n"><span class="pre">InType3</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__map_1ga0125cb4cfd59e759d8adb910881b0526"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">map</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">res</span></span>, <a class="reference internal" href="#_CPPv4I0000000E3mapvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map::InType1"><span class="n"><span class="pre">InType1</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">in1</span></span>, <a class="reference internal" href="#_CPPv4I0000000E3mapvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map::InType2"><span class="n"><span class="pre">InType2</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">in2</span></span>, <a class="reference internal" href="#_CPPv4I0000000E3mapvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map::InType3"><span class="n"><span class="pre">InType3</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">in3</span></span>, <a class="reference internal" href="#_CPPv4I0000000E3mapvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <a class="reference internal" href="#_CPPv4I0000000E3mapvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map::Func"><span class="n"><span class="pre">Func</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000000E3mapvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="Permalink to this definition">#</a><br></dt>
<dd><p>Map a function over three mdspans. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>InType1</strong> &ndash; data-type of the input 1 (device_mdspan) </p></li>
<li><p><strong>InType2</strong> &ndash; data-type of the input 2 (device_mdspan) </p></li>
<li><p><strong>InType3</strong> &ndash; data-type of the input 3 (device_mdspan) </p></li>
<li><p><strong>OutType</strong> &ndash; data-type of the result (device_mdspan) </p></li>
<li><p><strong>Func</strong> &ndash; the device-lambda performing the actual operation</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>res</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>in1</strong> &ndash; <strong>[in]</strong> the input 1 (the same size as the output) (device_mdspan) </p></li>
<li><p><strong>in2</strong> &ndash; <strong>[in]</strong> the input 2 (the same size as the output) (device_mdspan) </p></li>
<li><p><strong>in3</strong> &ndash; <strong>[in]</strong> the input 3 (the same size as the output) (device_mdspan) </p></li>
<li><p><strong>out</strong> &ndash; <strong>[out]</strong> the output of the map operation (device_mdspan) </p></li>
<li><p><strong>f</strong> &ndash; <strong>[in]</strong> device lambda (InType1::value_type x1, InType2::value_type x2, InType3::value_type x3) -&gt; OutType::value_type </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00Dp00E10map_offsetvRKN4raft16device_resourcesE7OutType4FuncDp7InTypes">
<span id="_CPPv3I00Dp00E10map_offsetRKN4raft16device_resourcesE7OutType4FuncDp7InTypes"></span><span id="_CPPv2I00Dp00E10map_offsetRKN4raft16device_resourcesE7OutType4FuncDp7InTypes"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Func</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">InTypes</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft30enable_if_output_device_mdspanE" title="raft::enable_if_output_device_mdspan"><span class="n"><span class="pre">enable_if_output_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00Dp00E10map_offsetvRKN4raft16device_resourcesE7OutType4FuncDp7InTypes" title="map_offset::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft29enable_if_input_device_mdspanE" title="raft::enable_if_input_device_mdspan"><span class="n"><span class="pre">enable_if_input_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00Dp00E10map_offsetvRKN4raft16device_resourcesE7OutType4FuncDp7InTypes" title="map_offset::InTypes"><span class="n"><span class="pre">InTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__map_1ga4a789ded8f679c59e6fa480a3f702aa4"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">map_offset</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">res</span></span>, <a class="reference internal" href="#_CPPv4I00Dp00E10map_offsetvRKN4raft16device_resourcesE7OutType4FuncDp7InTypes" title="map_offset::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <a class="reference internal" href="#_CPPv4I00Dp00E10map_offsetvRKN4raft16device_resourcesE7OutType4FuncDp7InTypes" title="map_offset::Func"><span class="n"><span class="pre">Func</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">f</span></span>, <a class="reference internal" href="#_CPPv4I00Dp00E10map_offsetvRKN4raft16device_resourcesE7OutType4FuncDp7InTypes" title="map_offset::InTypes"><span class="n"><span class="pre">InTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ins</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00Dp00E10map_offsetvRKN4raft16device_resourcesE7OutType4FuncDp7InTypes" title="Permalink to this definition">#</a><br></dt>
<dd><p>Map a function over zero-based flat index (element offset) and zero or more inputs. </p>
<p>The algorithm applied on <code class="docutils literal notranslate"><span class="pre">k</span></code> inputs can be described in a following pseudo-code: </p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">auto</span> <span class="n">i</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span> <span class="o">...</span> <span class="n">out</span><span class="o">.</span><span class="n">size</span><span class="p">()])</span> <span class="p">{</span>
  <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">in_0</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">in_1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">...</span><span class="p">,</span> <span class="n">in_k</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="p">}</span>
</pre></div>
</div>
<p></p>
<p><em>Performance note</em>: when possible, this function loads the argument arrays and stores the output array using vectorized cuda load/store instructions. The size of the vectorization depends on the size of the largest input/output element type and on the alignment of all pointers.</p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/device_mdarray.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/device_resources.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/core/operators.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;raft/linalg/map.cuh&gt;</span>

<span class="k">auto</span><span class="w"> </span><span class="n">squares</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">make_device_vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
<span class="n">raft</span><span class="o">::</span><span class="n">linalg</span><span class="o">::</span><span class="n">map_offset</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">squares</span><span class="p">.</span><span class="n">view</span><span class="p">(),</span><span class="w"> </span><span class="n">raft</span><span class="o">::</span><span class="n">sq_op</span><span class="p">{});</span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>OutType</strong> &ndash; data-type of the result (device_mdspan) </p></li>
<li><p><strong>Func</strong> &ndash; the device-lambda performing the actual operation </p></li>
<li><p><strong>InTypes</strong> &ndash; data-types of the inputs (device_mdspan)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>res</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>out</strong> &ndash; <strong>[out]</strong> the output of the map operation (device_mdspan) </p></li>
<li><p><strong>f</strong> &ndash; <strong>[in]</strong> device lambda (auto offset, InTypes::value_type xs&hellip;) -&gt; OutType::value_type </p></li>
<li><p><strong>ins</strong> &ndash; <strong>[in]</strong> the inputs (each of the same size as the output) (device_mdspan) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00000E10map_offsetvRKN4raft16device_resourcesE7InType17OutType4Func">
<span id="_CPPv3I00000E10map_offsetRKN4raft16device_resourcesE7InType17OutType4Func"></span><span id="_CPPv2I00000E10map_offsetRKN4raft16device_resourcesE7InType17OutType4Func"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType1</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Func</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft30enable_if_output_device_mdspanE" title="raft::enable_if_output_device_mdspan"><span class="n"><span class="pre">enable_if_output_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00000E10map_offsetvRKN4raft16device_resourcesE7InType17OutType4Func" title="map_offset::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft29enable_if_input_device_mdspanE" title="raft::enable_if_input_device_mdspan"><span class="n"><span class="pre">enable_if_input_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00000E10map_offsetvRKN4raft16device_resourcesE7InType17OutType4Func" title="map_offset::InType1"><span class="n"><span class="pre">InType1</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__map_1gabd6c9fb8f43be668614fd29a660b360c"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">map_offset</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">res</span></span>, <a class="reference internal" href="#_CPPv4I00000E10map_offsetvRKN4raft16device_resourcesE7InType17OutType4Func" title="map_offset::InType1"><span class="n"><span class="pre">InType1</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">in1</span></span>, <a class="reference internal" href="#_CPPv4I00000E10map_offsetvRKN4raft16device_resourcesE7InType17OutType4Func" title="map_offset::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <a class="reference internal" href="#_CPPv4I00000E10map_offsetvRKN4raft16device_resourcesE7InType17OutType4Func" title="map_offset::Func"><span class="n"><span class="pre">Func</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00000E10map_offsetvRKN4raft16device_resourcesE7InType17OutType4Func" title="Permalink to this definition">#</a><br></dt>
<dd><p>Map a function over zero-based flat index (element offset) and one mdspan. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>InType1</strong> &ndash; data-type of the input (device_mdspan) </p></li>
<li><p><strong>OutType</strong> &ndash; data-type of the result (device_mdspan) </p></li>
<li><p><strong>Func</strong> &ndash; the device-lambda performing the actual operation</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>res</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>in1</strong> &ndash; <strong>[in]</strong> the input (the same size as the output) (device_mdspan) </p></li>
<li><p><strong>out</strong> &ndash; <strong>[out]</strong> the output of the map operation (device_mdspan) </p></li>
<li><p><strong>f</strong> &ndash; <strong>[in]</strong> device lambda (auto offset, InType1::value_type x) -&gt; OutType::value_type </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27OutType4Func">
<span id="_CPPv3I000000E10map_offsetRKN4raft16device_resourcesE7InType17InType27OutType4Func"></span><span id="_CPPv2I000000E10map_offsetRKN4raft16device_resourcesE7InType17InType27OutType4Func"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType1</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType2</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Func</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft30enable_if_output_device_mdspanE" title="raft::enable_if_output_device_mdspan"><span class="n"><span class="pre">enable_if_output_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="map_offset::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft29enable_if_input_device_mdspanE" title="raft::enable_if_input_device_mdspan"><span class="n"><span class="pre">enable_if_input_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="map_offset::InType1"><span class="n"><span class="pre">InType1</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="map_offset::InType2"><span class="n"><span class="pre">InType2</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__map_1ga39494121d2cd6bd216d0652e39249829"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">map_offset</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">res</span></span>, <a class="reference internal" href="#_CPPv4I000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="map_offset::InType1"><span class="n"><span class="pre">InType1</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">in1</span></span>, <a class="reference internal" href="#_CPPv4I000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="map_offset::InType2"><span class="n"><span class="pre">InType2</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">in2</span></span>, <a class="reference internal" href="#_CPPv4I000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="map_offset::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <a class="reference internal" href="#_CPPv4I000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="map_offset::Func"><span class="n"><span class="pre">Func</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27OutType4Func" title="Permalink to this definition">#</a><br></dt>
<dd><p>Map a function over zero-based flat index (element offset) and two mdspans. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>InType1</strong> &ndash; data-type of the input (device_mdspan) </p></li>
<li><p><strong>InType2</strong> &ndash; data-type of the input (device_mdspan) </p></li>
<li><p><strong>OutType</strong> &ndash; data-type of the result (device_mdspan) </p></li>
<li><p><strong>Func</strong> &ndash; the device-lambda performing the actual operation</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>res</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>in1</strong> &ndash; <strong>[in]</strong> the input (the same size as the output) (device_mdspan) </p></li>
<li><p><strong>in2</strong> &ndash; <strong>[in]</strong> the input (the same size as the output) (device_mdspan) </p></li>
<li><p><strong>out</strong> &ndash; <strong>[out]</strong> the output of the map operation (device_mdspan) </p></li>
<li><p><strong>f</strong> &ndash; <strong>[in]</strong> device lambda (auto offset, InType1::value_type x1, InType2::value_type x2) -&gt; OutType::value_type </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func">
<span id="_CPPv3I0000000E10map_offsetRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func"></span><span id="_CPPv2I0000000E10map_offsetRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType1</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType2</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType3</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Func</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft30enable_if_output_device_mdspanE" title="raft::enable_if_output_device_mdspan"><span class="n"><span class="pre">enable_if_output_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map_offset::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4IDpEN4raft29enable_if_input_device_mdspanE" title="raft::enable_if_input_device_mdspan"><span class="n"><span class="pre">enable_if_input_device_mdspan</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map_offset::InType1"><span class="n"><span class="pre">InType1</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map_offset::InType2"><span class="n"><span class="pre">InType2</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map_offset::InType3"><span class="n"><span class="pre">InType3</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__map_1gaa33500cab9f030ce5a7c3592db8e58b7"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">map_offset</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">res</span></span>, <a class="reference internal" href="#_CPPv4I0000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map_offset::InType1"><span class="n"><span class="pre">InType1</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">in1</span></span>, <a class="reference internal" href="#_CPPv4I0000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map_offset::InType2"><span class="n"><span class="pre">InType2</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">in2</span></span>, <a class="reference internal" href="#_CPPv4I0000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map_offset::InType3"><span class="n"><span class="pre">InType3</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">in3</span></span>, <a class="reference internal" href="#_CPPv4I0000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map_offset::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <a class="reference internal" href="#_CPPv4I0000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="map_offset::Func"><span class="n"><span class="pre">Func</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000000E10map_offsetvRKN4raft16device_resourcesE7InType17InType27InType37OutType4Func" title="Permalink to this definition">#</a><br></dt>
<dd><p>Map a function over zero-based flat index (element offset) and three mdspans. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>InType1</strong> &ndash; data-type of the input 1 (device_mdspan) </p></li>
<li><p><strong>InType2</strong> &ndash; data-type of the input 2 (device_mdspan) </p></li>
<li><p><strong>InType3</strong> &ndash; data-type of the input 3 (device_mdspan) </p></li>
<li><p><strong>OutType</strong> &ndash; data-type of the result (device_mdspan) </p></li>
<li><p><strong>Func</strong> &ndash; the device-lambda performing the actual operation</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>res</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>in1</strong> &ndash; <strong>[in]</strong> the input 1 (the same size as the output) (device_mdspan) </p></li>
<li><p><strong>in2</strong> &ndash; <strong>[in]</strong> the input 2 (the same size as the output) (device_mdspan) </p></li>
<li><p><strong>in3</strong> &ndash; <strong>[in]</strong> the input 3 (the same size as the output) (device_mdspan) </p></li>
<li><p><strong>out</strong> &ndash; <strong>[out]</strong> the output of the map operation (device_mdspan) </p></li>
<li><p><strong>f</strong> &ndash; <strong>[in]</strong> device lambda (auto offset, InType1::value_type x1, InType2::value_type x2, InType3::value_type x3) -&gt; OutType::value_type </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="map-reduce">
<h2>Map Reduce<a class="headerlink" href="#map-reduce" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;raft/linalg/map_reduce.cuh&gt;</span></code></p>
<p>namespace <em>raft::linalg</em></p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000000DpE10map_reducevRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType13ScalarIdxTypeEE12OutValueType5MapOp12ReduceLambdaDp4Args">
<span id="_CPPv3I000000DpE10map_reduceRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType13ScalarIdxTypeEE12OutValueType5MapOp12ReduceLambdaDp4Args"></span><span id="_CPPv2I000000DpE10map_reduceRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType13ScalarIdxTypeEE12OutValueType5MapOp12ReduceLambdaDp4Args"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InValueType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MapOp</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ReduceLambda</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IndexType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutValueType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ScalarIdxType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">Args</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__map__reduce_1ga5e40a70bf882e49c65acbb510da2035d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">map_reduce</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_vector_viewE" title="raft::device_vector_view"><span class="n"><span class="pre">device_vector_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000DpE10map_reducevRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType13ScalarIdxTypeEE12OutValueType5MapOp12ReduceLambdaDp4Args" title="map_reduce::InValueType"><span class="n"><span class="pre">InValueType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000DpE10map_reducevRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType13ScalarIdxTypeEE12OutValueType5MapOp12ReduceLambdaDp4Args" title="map_reduce::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">in</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I00EN4raft18device_scalar_viewE" title="raft::device_scalar_view"><span class="n"><span class="pre">device_scalar_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000000DpE10map_reducevRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType13ScalarIdxTypeEE12OutValueType5MapOp12ReduceLambdaDp4Args" title="map_reduce::OutValueType"><span class="n"><span class="pre">OutValueType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000DpE10map_reducevRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType13ScalarIdxTypeEE12OutValueType5MapOp12ReduceLambdaDp4Args" title="map_reduce::ScalarIdxType"><span class="n"><span class="pre">ScalarIdxType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <a class="reference internal" href="#_CPPv4I000000DpE10map_reducevRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType13ScalarIdxTypeEE12OutValueType5MapOp12ReduceLambdaDp4Args" title="map_reduce::OutValueType"><span class="n"><span class="pre">OutValueType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">neutral</span></span>, <a class="reference internal" href="#_CPPv4I000000DpE10map_reducevRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType13ScalarIdxTypeEE12OutValueType5MapOp12ReduceLambdaDp4Args" title="map_reduce::MapOp"><span class="n"><span class="pre">MapOp</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">map</span></span>, <a class="reference internal" href="#_CPPv4I000000DpE10map_reducevRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType13ScalarIdxTypeEE12OutValueType5MapOp12ReduceLambdaDp4Args" title="map_reduce::ReduceLambda"><span class="n"><span class="pre">ReduceLambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">op</span></span>, <a class="reference internal" href="#_CPPv4I000000DpE10map_reducevRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType13ScalarIdxTypeEE12OutValueType5MapOp12ReduceLambdaDp4Args" title="map_reduce::Args"><span class="n"><span class="pre">Args</span></span></a><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">args</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000000DpE10map_reducevRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType13ScalarIdxTypeEE12OutValueType5MapOp12ReduceLambdaDp4Args" title="Permalink to this definition">#</a><br></dt>
<dd><p>CUDA version of map and then generic reduction operation. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>InValueType</strong> &ndash; the data-type of the input </p></li>
<li><p><strong>MapOp</strong> &ndash; the device-lambda performing the actual map operation </p></li>
<li><p><strong>ReduceLambda</strong> &ndash; the device-lambda performing the actual reduction </p></li>
<li><p><strong>IndexType</strong> &ndash; the index type </p></li>
<li><p><strong>OutValueType</strong> &ndash; the data-type of the output </p></li>
<li><p><strong>ScalarIdxType</strong> &ndash; index type of scalar </p></li>
<li><p><strong>Args</strong> &ndash; additional parameters </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>in</strong> &ndash; <strong>[in]</strong> the input of type <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1af51d94d9b952d2c16f121e815902d3e0"><span class="std std-ref">raft::device_vector_view</span></a></p></li>
<li><p><strong>neutral</strong> &ndash; <strong>[in]</strong> The neutral element of the reduction operation. For example: 0 for sum, 1 for multiply, +Inf for Min, -Inf for Max </p></li>
<li><p><strong>out</strong> &ndash; <strong>[out]</strong> the output reduced value assumed to be a <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a6cfe42bde2a834694a7f7fd9df754427"><span class="std std-ref">raft::device_scalar_view</span></a></p></li>
<li><p><strong>map</strong> &ndash; <strong>[in]</strong> the fused device-lambda </p></li>
<li><p><strong>op</strong> &ndash; <strong>[in]</strong> the fused reduction device lambda </p></li>
<li><p><strong>args</strong> &ndash; <strong>[in]</strong> additional input arrays </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="mean-squared-error">
<h2>Mean Squared Error<a class="headerlink" href="#mean-squared-error" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;raft/linalg/mean_squared_error.cuh&gt;</span></code></p>
<p>namespace <em>raft::linalg</em></p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000E18mean_squared_errorvRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType9IndexTypeEE12OutValueType">
<span id="_CPPv3I000E18mean_squared_errorRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType9IndexTypeEE12OutValueType"></span><span id="_CPPv2I000E18mean_squared_errorRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType9IndexTypeEE12OutValueType"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InValueType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IndexType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutValueType</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__mean__squared__error_1ga063a0440eab68795df98394ee292e2fe"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mean_squared_error</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_vector_viewE" title="raft::device_vector_view"><span class="n"><span class="pre">device_vector_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E18mean_squared_errorvRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType9IndexTypeEE12OutValueType" title="mean_squared_error::InValueType"><span class="n"><span class="pre">InValueType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E18mean_squared_errorvRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType9IndexTypeEE12OutValueType" title="mean_squared_error::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">A</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_vector_viewE" title="raft::device_vector_view"><span class="n"><span class="pre">device_vector_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E18mean_squared_errorvRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType9IndexTypeEE12OutValueType" title="mean_squared_error::InValueType"><span class="n"><span class="pre">InValueType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E18mean_squared_errorvRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType9IndexTypeEE12OutValueType" title="mean_squared_error::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">B</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I00EN4raft18device_scalar_viewE" title="raft::device_scalar_view"><span class="n"><span class="pre">device_scalar_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000E18mean_squared_errorvRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType9IndexTypeEE12OutValueType" title="mean_squared_error::OutValueType"><span class="n"><span class="pre">OutValueType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E18mean_squared_errorvRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType9IndexTypeEE12OutValueType" title="mean_squared_error::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <a class="reference internal" href="#_CPPv4I000E18mean_squared_errorvRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType9IndexTypeEE12OutValueType" title="mean_squared_error::OutValueType"><span class="n"><span class="pre">OutValueType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">weight</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000E18mean_squared_errorvRKN4raft16device_resourcesEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_vector_viewIK11InValueType9IndexTypeEEN4raft18device_scalar_viewI12OutValueType9IndexTypeEE12OutValueType" title="Permalink to this definition">#</a><br></dt>
<dd><p>CUDA version mean squared error function mean((A-B)**2) </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>InValueType</strong> &ndash; Input data-type </p></li>
<li><p><strong>IndexType</strong> &ndash; Input/Output index type </p></li>
<li><p><strong>OutValueType</strong> &ndash; Output data-type </p></li>
<li><p><strong>TPB</strong> &ndash; threads-per-block </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>A</strong> &ndash; <strong>[in]</strong> input <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1af51d94d9b952d2c16f121e815902d3e0"><span class="std std-ref">raft::device_vector_view</span></a></p></li>
<li><p><strong>B</strong> &ndash; <strong>[in]</strong> input <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1af51d94d9b952d2c16f121e815902d3e0"><span class="std std-ref">raft::device_vector_view</span></a></p></li>
<li><p><strong>out</strong> &ndash; <strong>[out]</strong> the output mean squared error value of type <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a6cfe42bde2a834694a7f7fd9df754427"><span class="std std-ref">raft::device_scalar_view</span></a></p></li>
<li><p><strong>weight</strong> &ndash; <strong>[in]</strong> weight to apply to every term in the mean squared error calculation </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="norm">
<h2>Norm<a class="headerlink" href="#norm" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;raft/linalg/norm.cuh&gt;</span></code></p>
<p>namespace <em>raft::linalg</em></p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000E4normvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI11ElementType9IndexTypeEE8NormType5Apply6Lambda">
<span id="_CPPv3I0000E4normRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI11ElementType9IndexTypeEE8NormType5Apply6Lambda"></span><span id="_CPPv2I0000E4normRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI11ElementType9IndexTypeEE8NormType5Apply6Lambda"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ElementType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LayoutPolicy</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IndexType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Lambda</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft11identity_opE" title="raft::identity_op"><span class="n"><span class="pre">identity_op</span></span></a><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__norm_1ga2d34ef4290a701b95b7bd49ab174f0d9"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">norm</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000E4normvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI11ElementType9IndexTypeEE8NormType5Apply6Lambda" title="norm::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000E4normvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI11ElementType9IndexTypeEE8NormType5Apply6Lambda" title="norm::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000E4normvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI11ElementType9IndexTypeEE8NormType5Apply6Lambda" title="norm::LayoutPolicy"><span class="n"><span class="pre">LayoutPolicy</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">in</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_vector_viewE" title="raft::device_vector_view"><span class="n"><span class="pre">device_vector_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000E4normvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI11ElementType9IndexTypeEE8NormType5Apply6Lambda" title="norm::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000E4normvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI11ElementType9IndexTypeEE8NormType5Apply6Lambda" title="norm::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <span class="n"><span class="pre">NormType</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">type</span></span>, <span class="n"><span class="pre">Apply</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">apply</span></span>, <a class="reference internal" href="#_CPPv4I0000E4normvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI11ElementType9IndexTypeEE8NormType5Apply6Lambda" title="norm::Lambda"><span class="n"><span class="pre">Lambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">fin_op</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft11identity_opE" title="raft::identity_op"><span class="n"><span class="pre">identity_op</span></span></a><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000E4normvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI11ElementType9IndexTypeEE8NormType5Apply6Lambda" title="Permalink to this definition">#</a><br></dt>
<dd><p>Compute norm of the input matrix and perform fin_op. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ElementType</strong> &ndash; Input/Output data type </p></li>
<li><p><strong>LayoutPolicy</strong> &ndash; the layout of input (<a class="reference internal" href="mdspan_representation.html#group__C-Contiguous_1gac8af9da37c7965a549a0855eb114ac92"><span class="std std-ref">raft::row_major</span></a> or <a class="reference internal" href="mdspan_representation.html#group__F-Contiguous_1gac5df79ec6868cbdd1dbbb24e98e228ff"><span class="std std-ref">raft::col_major</span></a>) </p></li>
<li><p><strong>IdxType</strong> &ndash; Integer type used to for addressing </p></li>
<li><p><strong>Lambda</strong> &ndash; device final lambda </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>in</strong> &ndash; <strong>[in]</strong> the input <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a7e14f9414358a77ea57cf19f5bbea3fb"><span class="std std-ref">raft::device_matrix_view</span></a></p></li>
<li><p><strong>out</strong> &ndash; <strong>[out]</strong> the output <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1af51d94d9b952d2c16f121e815902d3e0"><span class="std std-ref">raft::device_vector_view</span></a></p></li>
<li><p><strong>type</strong> &ndash; <strong>[in]</strong> the type of norm to be applied </p></li>
<li><p><strong>apply</strong> &ndash; <strong>[in]</strong> Whether to apply the norm along rows (raft::linalg::Apply::ALONG_ROWS) or along columns (raft::linalg::Apply::ALONG_COLUMNS) </p></li>
<li><p><strong>fin_op</strong> &ndash; <strong>[in]</strong> the final lambda op </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00000E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE11ElementType10MainLambda12ReduceLambda11FinalLambda11ElementType">
<span id="_CPPv3I00000E13row_normalizeRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE11ElementType10MainLambda12ReduceLambda11FinalLambda11ElementType"></span><span id="_CPPv2I00000E13row_normalizeRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE11ElementType10MainLambda12ReduceLambda11FinalLambda11ElementType"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ElementType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IndexType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MainLambda</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ReduceLambda</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FinalLambda</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__norm_1ga34ce64cd61b5245ddf99a34ec5eaea8c"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">row_normalize</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE11ElementType10MainLambda12ReduceLambda11FinalLambda11ElementType" title="row_normalize::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE11ElementType10MainLambda12ReduceLambda11FinalLambda11ElementType" title="row_normalize::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">row_major</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">in</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00000E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE11ElementType10MainLambda12ReduceLambda11FinalLambda11ElementType" title="row_normalize::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE11ElementType10MainLambda12ReduceLambda11FinalLambda11ElementType" title="row_normalize::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">row_major</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <a class="reference internal" href="#_CPPv4I00000E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE11ElementType10MainLambda12ReduceLambda11FinalLambda11ElementType" title="row_normalize::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">init</span></span>, <a class="reference internal" href="#_CPPv4I00000E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE11ElementType10MainLambda12ReduceLambda11FinalLambda11ElementType" title="row_normalize::MainLambda"><span class="n"><span class="pre">MainLambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">main_op</span></span>, <a class="reference internal" href="#_CPPv4I00000E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE11ElementType10MainLambda12ReduceLambda11FinalLambda11ElementType" title="row_normalize::ReduceLambda"><span class="n"><span class="pre">ReduceLambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">reduce_op</span></span>, <a class="reference internal" href="#_CPPv4I00000E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE11ElementType10MainLambda12ReduceLambda11FinalLambda11ElementType" title="row_normalize::FinalLambda"><span class="n"><span class="pre">FinalLambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">fin_op</span></span>, <a class="reference internal" href="#_CPPv4I00000E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE11ElementType10MainLambda12ReduceLambda11FinalLambda11ElementType" title="row_normalize::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">eps</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE11ElementType10MainLambda12ReduceLambda11FinalLambda11ElementType" title="row_normalize::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">1e-8</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00000E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE11ElementType10MainLambda12ReduceLambda11FinalLambda11ElementType" title="Permalink to this definition">#</a><br></dt>
<dd><p>Divide rows by their norm defined by main_op, reduce_op and fin_op. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ElementType</strong> &ndash; Input/Output data type </p></li>
<li><p><strong>IndexType</strong> &ndash; Integer type used to for addressing </p></li>
<li><p><strong>MainLambda</strong> &ndash; Type of main_op </p></li>
<li><p><strong>ReduceLambda</strong> &ndash; Type of reduce_op </p></li>
<li><p><strong>FinalLambda</strong> &ndash; Type of fin_op </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>in</strong> &ndash; <strong>[in]</strong> the input <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a7e14f9414358a77ea57cf19f5bbea3fb"><span class="std std-ref">raft::device_matrix_view</span></a></p></li>
<li><p><strong>out</strong> &ndash; <strong>[out]</strong> the output <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a7e14f9414358a77ea57cf19f5bbea3fb"><span class="std std-ref">raft::device_matrix_view</span></a></p></li>
<li><p><strong>init</strong> &ndash; <strong>[in]</strong> Initialization value, i.e identity element for the reduction operation </p></li>
<li><p><strong>main_op</strong> &ndash; <strong>[in]</strong> Operation to apply to the elements before reducing them (e.g square for L2) </p></li>
<li><p><strong>reduce_op</strong> &ndash; <strong>[in]</strong> Operation to reduce a pair of elements (e.g sum for L2) </p></li>
<li><p><strong>fin_op</strong> &ndash; <strong>[in]</strong> Operation to apply once to the reduction result to finalize the norm computation (e.g sqrt for L2) </p></li>
<li><p><strong>eps</strong> &ndash; <strong>[in]</strong> If the norm is below eps, the row is considered zero and no division is applied </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE8NormType11ElementType">
<span id="_CPPv3I00E13row_normalizeRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE8NormType11ElementType"></span><span id="_CPPv2I00E13row_normalizeRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE8NormType11ElementType"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ElementType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IndexType</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__norm_1gaa9a53a23225068f17d2c5cb23e21d097"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">row_normalize</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE8NormType11ElementType" title="row_normalize::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE8NormType11ElementType" title="row_normalize::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">row_major</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">in</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE8NormType11ElementType" title="row_normalize::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE8NormType11ElementType" title="row_normalize::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">row_major</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <span class="n"><span class="pre">NormType</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">norm_type</span></span>, <a class="reference internal" href="#_CPPv4I00E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE8NormType11ElementType" title="row_normalize::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">eps</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE8NormType11ElementType" title="row_normalize::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">1e-8</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E13row_normalizevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexType9row_majorEEN4raft18device_matrix_viewI11ElementType9IndexType9row_majorEE8NormType11ElementType" title="Permalink to this definition">#</a><br></dt>
<dd><p>Divide rows by their norm. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ElementType</strong> &ndash; Input/Output data type </p></li>
<li><p><strong>IndexType</strong> &ndash; Integer type used to for addressing </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>in</strong> &ndash; <strong>[in]</strong> the input <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a7e14f9414358a77ea57cf19f5bbea3fb"><span class="std std-ref">raft::device_matrix_view</span></a></p></li>
<li><p><strong>out</strong> &ndash; <strong>[out]</strong> the output <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a7e14f9414358a77ea57cf19f5bbea3fb"><span class="std std-ref">raft::device_matrix_view</span></a></p></li>
<li><p><strong>norm_type</strong> &ndash; <strong>[in]</strong> the type of norm to be applied </p></li>
<li><p><strong>eps</strong> &ndash; <strong>[in]</strong> If the norm is below eps, the row is considered zero and no division is applied </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="normalize">
<h2>Normalize<a class="headerlink" href="#normalize" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;raft/linalg/normalize.cuh&gt;</span></code></p>
<p>namespace <em>raft::linalg</em></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>doxygengroup: Cannot find group &ldquo;normalize&rdquo; in doxygen xml output for project &ldquo;RAFT&rdquo; from directory: ../../cpp/doxygen/_xml/</p>
</div>
</section>
<section id="reduction">
<h2>Reduction<a class="headerlink" href="#reduction" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;raft/linalg/reduce.cuh&gt;</span></code></p>
<p>namespace <em>raft::linalg</em></p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000000E6reducevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK13InElementType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI14OutElementType7IdxTypeEE14OutElementType5Applyb10MainLambda12ReduceLambda11FinalLambda">
<span id="_CPPv3I0000000E6reduceRKN4raft16device_resourcesEN4raft18device_matrix_viewIK13InElementType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI14OutElementType7IdxTypeEE14OutElementType5Applyb10MainLambda12ReduceLambda11FinalLambda"></span><span id="_CPPv2I0000000E6reduceRKN4raft16device_resourcesEN4raft18device_matrix_viewIK13InElementType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI14OutElementType7IdxTypeEE14OutElementType5Applyb10MainLambda12ReduceLambda11FinalLambda"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InElementType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LayoutPolicy</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutElementType</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E6reducevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK13InElementType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI14OutElementType7IdxTypeEE14OutElementType5Applyb10MainLambda12ReduceLambda11FinalLambda" title="reduce::InElementType"><span class="n"><span class="pre">InElementType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxType</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MainLambda</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft11identity_opE" title="raft::identity_op"><span class="n"><span class="pre">identity_op</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ReduceLambda</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft6add_opE" title="raft::add_op"><span class="n"><span class="pre">add_op</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FinalLambda</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft11identity_opE" title="raft::identity_op"><span class="n"><span class="pre">identity_op</span></span></a><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__reduction_1ga2a6802a289275128ba7d70aeaef62bd5"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reduce</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E6reducevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK13InElementType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI14OutElementType7IdxTypeEE14OutElementType5Applyb10MainLambda12ReduceLambda11FinalLambda" title="reduce::InElementType"><span class="n"><span class="pre">InElementType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E6reducevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK13InElementType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI14OutElementType7IdxTypeEE14OutElementType5Applyb10MainLambda12ReduceLambda11FinalLambda" title="reduce::IdxType"><span class="n"><span class="pre">IdxType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E6reducevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK13InElementType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI14OutElementType7IdxTypeEE14OutElementType5Applyb10MainLambda12ReduceLambda11FinalLambda" title="reduce::LayoutPolicy"><span class="n"><span class="pre">LayoutPolicy</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_vector_viewE" title="raft::device_vector_view"><span class="n"><span class="pre">device_vector_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000000E6reducevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK13InElementType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI14OutElementType7IdxTypeEE14OutElementType5Applyb10MainLambda12ReduceLambda11FinalLambda" title="reduce::OutElementType"><span class="n"><span class="pre">OutElementType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E6reducevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK13InElementType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI14OutElementType7IdxTypeEE14OutElementType5Applyb10MainLambda12ReduceLambda11FinalLambda" title="reduce::IdxType"><span class="n"><span class="pre">IdxType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dots</span></span>, <a class="reference internal" href="#_CPPv4I0000000E6reducevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK13InElementType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI14OutElementType7IdxTypeEE14OutElementType5Applyb10MainLambda12ReduceLambda11FinalLambda" title="reduce::OutElementType"><span class="n"><span class="pre">OutElementType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">init</span></span>, <span class="n"><span class="pre">Apply</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">apply</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">inplace</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <a class="reference internal" href="#_CPPv4I0000000E6reducevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK13InElementType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI14OutElementType7IdxTypeEE14OutElementType5Applyb10MainLambda12ReduceLambda11FinalLambda" title="reduce::MainLambda"><span class="n"><span class="pre">MainLambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">main_op</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft11identity_opE" title="raft::identity_op"><span class="n"><span class="pre">identity_op</span></span></a><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span>, <a class="reference internal" href="#_CPPv4I0000000E6reducevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK13InElementType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI14OutElementType7IdxTypeEE14OutElementType5Applyb10MainLambda12ReduceLambda11FinalLambda" title="reduce::ReduceLambda"><span class="n"><span class="pre">ReduceLambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">reduce_op</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft6add_opE" title="raft::add_op"><span class="n"><span class="pre">add_op</span></span></a><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span>, <a class="reference internal" href="#_CPPv4I0000000E6reducevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK13InElementType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI14OutElementType7IdxTypeEE14OutElementType5Applyb10MainLambda12ReduceLambda11FinalLambda" title="reduce::FinalLambda"><span class="n"><span class="pre">FinalLambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">final_op</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft11identity_opE" title="raft::identity_op"><span class="n"><span class="pre">identity_op</span></span></a><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000000E6reducevRKN4raft16device_resourcesEN4raft18device_matrix_viewIK13InElementType7IdxType12LayoutPolicyEEN4raft18device_vector_viewI14OutElementType7IdxTypeEE14OutElementType5Applyb10MainLambda12ReduceLambda11FinalLambda" title="Permalink to this definition">#</a><br></dt>
<dd><p>Compute reduction of the input matrix along the requested dimension This API computes a reduction of a matrix whose underlying storage is either row-major or column-major, while allowing the choose the dimension for reduction. Depending upon the dimension chosen for reduction, the memory accesses may be coalesced or strided. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>InElementType</strong> &ndash; the input data-type of underlying raft::matrix_view </p></li>
<li><p><strong>LayoutPolicy</strong> &ndash; The layout of Input/Output (row or col major) </p></li>
<li><p><strong>OutElementType</strong> &ndash; the output data-type of underlying raft::matrix_view and reduction </p></li>
<li><p><strong>IndexType</strong> &ndash; Integer type used to for addressing </p></li>
<li><p><strong>MainLambda</strong> &ndash; Unary lambda applied while acculumation (eg: L1 or L2 norm) It must be a &lsquo;callable&rsquo; supporting the following input and output:  </p></li>
<li><p><strong>ReduceLambda</strong> &ndash; Binary lambda applied for reduction (eg: addition(+) for L2 norm) It must be a &lsquo;callable&rsquo; supporting the following input and output:  </p></li>
<li><p><strong>FinalLambda</strong> &ndash; the final lambda applied before STG (eg: Sqrt for L2 norm) It must be a &lsquo;callable&rsquo; supporting the following input and output:  </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>data</strong> &ndash; <strong>[in]</strong> Input of type <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a7e14f9414358a77ea57cf19f5bbea3fb"><span class="std std-ref">raft::device_matrix_view</span></a></p></li>
<li><p><strong>dots</strong> &ndash; <strong>[out]</strong> Output of type <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a7e14f9414358a77ea57cf19f5bbea3fb"><span class="std std-ref">raft::device_matrix_view</span></a></p></li>
<li><p><strong>init</strong> &ndash; <strong>[in]</strong> initial value to use for the reduction </p></li>
<li><p><strong>apply</strong> &ndash; <strong>[in]</strong> whether to reduce along rows or along columns (using raft::linalg::Apply) </p></li>
<li><p><strong>main_op</strong> &ndash; <strong>[in]</strong> fused elementwise operation to apply before reduction </p></li>
<li><p><strong>reduce_op</strong> &ndash; <strong>[in]</strong> fused binary reduction operation </p></li>
<li><p><strong>final_op</strong> &ndash; <strong>[in]</strong> fused elementwise operation to apply before storing results </p></li>
<li><p><strong>inplace</strong> &ndash; <strong>[in]</strong> reduction result added inplace or overwrites old values? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="reduce-cols-by-key">
<h2>Reduce Cols By Key<a class="headerlink" href="#reduce-cols-by-key" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;raft/linalg/reduce_cols_by_key.cuh&gt;</span></code></p>
<p>namespace <em>raft::linalg</em></p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000E18reduce_cols_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeb">
<span id="_CPPv3I000E18reduce_cols_by_keyRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeb"></span><span id="_CPPv2I000E18reduce_cols_by_keyRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeb"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ElementType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">KeyType</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E18reduce_cols_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeb" title="reduce_cols_by_key::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IndexType</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__reduce__cols__by__key_1ga4c28032d578ecfe66d8c0103d5ac390e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reduce_cols_by_key</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E18reduce_cols_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeb" title="reduce_cols_by_key::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E18reduce_cols_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeb" title="reduce_cols_by_key::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_representation.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_vector_viewE" title="raft::device_vector_view"><span class="n"><span class="pre">device_vector_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E18reduce_cols_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeb" title="reduce_cols_by_key::KeyType"><span class="n"><span class="pre">KeyType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E18reduce_cols_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeb" title="reduce_cols_by_key::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">keys</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000E18reduce_cols_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeb" title="reduce_cols_by_key::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E18reduce_cols_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeb" title="reduce_cols_by_key::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_representation.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <a class="reference internal" href="#_CPPv4I000E18reduce_cols_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeb" title="reduce_cols_by_key::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">nkeys</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">reset_sums</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000E18reduce_cols_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeb" title="Permalink to this definition">#</a><br></dt>
<dd><p>Computes the sum-reduction of matrix columns for each given key TODO: Support generic reduction lambdas <a class="github reference external" href="https://github.com/rapidsai/raft/issues/860">rapidsai/raft#860</a>. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ElementType</strong> &ndash; the input data type (as well as the output reduced matrix) </p></li>
<li><p><strong>KeyType</strong> &ndash; data type of the keys </p></li>
<li><p><strong>IndexType</strong> &ndash; indexing arithmetic type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>data</strong> &ndash; <strong>[in]</strong> the input data (dim = nrows x ncols). This is assumed to be in row-major layout of type <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a7e14f9414358a77ea57cf19f5bbea3fb"><span class="std std-ref">raft::device_matrix_view</span></a></p></li>
<li><p><strong>keys</strong> &ndash; <strong>[in]</strong> keys <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1af51d94d9b952d2c16f121e815902d3e0"><span class="std std-ref">raft::device_vector_view</span></a> (len = ncols). It is assumed that each key in this array is between [0, nkeys). In case this is not true, the caller is expected to have called make_monotonic primitive to prepare such a contiguous and monotonically increasing keys array. </p></li>
<li><p><strong>out</strong> &ndash; <strong>[out]</strong> the output reduced <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a7e14f9414358a77ea57cf19f5bbea3fb"><span class="std std-ref">raft::device_matrix_view</span></a> along columns (dim = nrows x nkeys). This will be assumed to be in row-major layout </p></li>
<li><p><strong>nkeys</strong> &ndash; <strong>[in]</strong> Number of unique keys in the keys array. By default, inferred from the number of columns of out </p></li>
<li><p><strong>reset_sums</strong> &ndash; <strong>[in]</strong> Whether to reset the output sums to zero before reducing </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="reduce-rows-by-key">
<h2>Reduce Rows By Key<a class="headerlink" href="#reduce-rows-by-key" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;raft/linalg/reduce_rows_by_key.cuh&gt;</span></code></p>
<p>namespace <em>raft::linalg</em></p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000E18reduce_rows_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeN4raft18device_vector_viewIc9IndexTypeEENSt8optionalIN4raft18device_vector_viewIK10WeightType9IndexTypeEEEEb">
<span id="_CPPv3I0000E18reduce_rows_by_keyRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeN4raft18device_vector_viewIc9IndexTypeEENSt8optionalIN4raft18device_vector_viewIK10WeightType9IndexTypeEEEEb"></span><span id="_CPPv2I0000E18reduce_rows_by_keyRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeN4raft18device_vector_viewIc9IndexTypeEENSt8optionalIN4raft18device_vector_viewIK10WeightType9IndexTypeEEEEb"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ElementType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">KeyType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">WeightType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IndexType</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__reduce__rows__by__key_1gabaa881cae4f83410a8d28b9264df5ef2"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reduce_rows_by_key</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000E18reduce_rows_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeN4raft18device_vector_viewIc9IndexTypeEENSt8optionalIN4raft18device_vector_viewIK10WeightType9IndexTypeEEEEb" title="reduce_rows_by_key::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000E18reduce_rows_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeN4raft18device_vector_viewIc9IndexTypeEENSt8optionalIN4raft18device_vector_viewIK10WeightType9IndexTypeEEEEb" title="reduce_rows_by_key::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_representation.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">d_A</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_vector_viewE" title="raft::device_vector_view"><span class="n"><span class="pre">device_vector_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000E18reduce_rows_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeN4raft18device_vector_viewIc9IndexTypeEENSt8optionalIN4raft18device_vector_viewIK10WeightType9IndexTypeEEEEb" title="reduce_rows_by_key::KeyType"><span class="n"><span class="pre">KeyType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000E18reduce_rows_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeN4raft18device_vector_viewIc9IndexTypeEENSt8optionalIN4raft18device_vector_viewIK10WeightType9IndexTypeEEEEb" title="reduce_rows_by_key::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">d_keys</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000E18reduce_rows_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeN4raft18device_vector_viewIc9IndexTypeEENSt8optionalIN4raft18device_vector_viewIK10WeightType9IndexTypeEEEEb" title="reduce_rows_by_key::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000E18reduce_rows_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeN4raft18device_vector_viewIc9IndexTypeEENSt8optionalIN4raft18device_vector_viewIK10WeightType9IndexTypeEEEEb" title="reduce_rows_by_key::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_representation.html#_CPPv4N4raft9row_majorE" title="raft::row_major"><span class="n"><span class="pre">row_major</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">d_sums</span></span>, <a class="reference internal" href="#_CPPv4I0000E18reduce_rows_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeN4raft18device_vector_viewIc9IndexTypeEENSt8optionalIN4raft18device_vector_viewIK10WeightType9IndexTypeEEEEb" title="reduce_rows_by_key::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_unique_keys</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_vector_viewE" title="raft::device_vector_view"><span class="n"><span class="pre">device_vector_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">char</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000E18reduce_rows_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeN4raft18device_vector_viewIc9IndexTypeEENSt8optionalIN4raft18device_vector_viewIK10WeightType9IndexTypeEEEEb" title="reduce_rows_by_key::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">d_keys_char</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_vector_viewE" title="raft::device_vector_view"><span class="n"><span class="pre">device_vector_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000E18reduce_rows_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeN4raft18device_vector_viewIc9IndexTypeEENSt8optionalIN4raft18device_vector_viewIK10WeightType9IndexTypeEEEEb" title="reduce_rows_by_key::WeightType"><span class="n"><span class="pre">WeightType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000E18reduce_rows_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeN4raft18device_vector_viewIc9IndexTypeEENSt8optionalIN4raft18device_vector_viewIK10WeightType9IndexTypeEEEEb" title="reduce_rows_by_key::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">d_weights</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">nullopt</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">reset_sums</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000E18reduce_rows_by_keyvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11ElementType9IndexTypeN4raft9row_majorEEEN4raft18device_vector_viewIK7KeyType9IndexTypeEEN4raft18device_matrix_viewI11ElementType9IndexTypeN4raft9row_majorEEE9IndexTypeN4raft18device_vector_viewIc9IndexTypeEENSt8optionalIN4raft18device_vector_viewIK10WeightType9IndexTypeEEEEb" title="Permalink to this definition">#</a><br></dt>
<dd><p>Computes the weighted sum-reduction of matrix rows for each given key TODO: Support generic reduction lambdas <a class="github reference external" href="https://github.com/rapidsai/raft/issues/860">rapidsai/raft#860</a>. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ElementType</strong> &ndash; data-type of input and output </p></li>
<li><p><strong>KeyType</strong> &ndash; data-type of keys </p></li>
<li><p><strong>WeightType</strong> &ndash; data-type of weights </p></li>
<li><p><strong>IndexType</strong> &ndash; index type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>d_A</strong> &ndash; <strong>[in]</strong> Input <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a21e6a932bbb75924f22f89574a3f1d94"><span class="std std-ref">raft::device_mdspan</span></a> (ncols * nrows) </p></li>
<li><p><strong>d_keys</strong> &ndash; <strong>[in]</strong> Keys for each row <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1af51d94d9b952d2c16f121e815902d3e0"><span class="std std-ref">raft::device_vector_view</span></a> (1 x nrows) </p></li>
<li><p><strong>d_sums</strong> &ndash; <strong>[out]</strong> Row sums by key <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a7e14f9414358a77ea57cf19f5bbea3fb"><span class="std std-ref">raft::device_matrix_view</span></a> (ncols x d_keys) </p></li>
<li><p><strong>n_unique_keys</strong> &ndash; <strong>[in]</strong> Number of unique keys in d_keys </p></li>
<li><p><strong>d_keys_char</strong> &ndash; <strong>[out]</strong> Scratch memory for conversion of keys to char, <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1af51d94d9b952d2c16f121e815902d3e0"><span class="std std-ref">raft::device_vector_view</span></a></p></li>
<li><p><strong>d_weights</strong> &ndash; <strong>[in]</strong> Weights for each observation in d_A <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1af51d94d9b952d2c16f121e815902d3e0"><span class="std std-ref">raft::device_vector_view</span></a> optional (1 x nrows) </p></li>
<li><p><strong>reset_sums</strong> &ndash; <strong>[in]</strong> Whether to reset the output sums to zero before reducing </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="strided-reduction">
<h2>Strided Reduction<a class="headerlink" href="#strided-reduction" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;raft/linalg/strided_reduction.cuh&gt;</span></code></p>
<p>namespace <em>raft::linalg</em></p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000000E17strided_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType9IndexTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda">
<span id="_CPPv3I0000000E17strided_reductionRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType9IndexTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda"></span><span id="_CPPv2I0000000E17strided_reductionRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType9IndexTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InValueType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LayoutPolicy</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutValueType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IndexType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MainLambda</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft11identity_opE" title="raft::identity_op"><span class="n"><span class="pre">identity_op</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ReduceLambda</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft6add_opE" title="raft::add_op"><span class="n"><span class="pre">add_op</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FinalLambda</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft11identity_opE" title="raft::identity_op"><span class="n"><span class="pre">identity_op</span></span></a><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="group__strided__reduction_1gaf96bac9901bb77bc07e6861a5b466ff3"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">strided_reduction</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_resources.html#_CPPv4N4raft16device_resourcesE" title="raft::device_resources"><span class="n"><span class="pre">device_resources</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_matrix_viewE" title="raft::device_matrix_view"><span class="n"><span class="pre">device_matrix_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E17strided_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType9IndexTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="strided_reduction::InValueType"><span class="n"><span class="pre">InValueType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E17strided_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType9IndexTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="strided_reduction::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E17strided_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType9IndexTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="strided_reduction::LayoutPolicy"><span class="n"><span class="pre">LayoutPolicy</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mdspan_mdspan.html#_CPPv4I000EN4raft18device_vector_viewE" title="raft::device_vector_view"><span class="n"><span class="pre">device_vector_view</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000000E17strided_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType9IndexTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="strided_reduction::OutValueType"><span class="n"><span class="pre">OutValueType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000000E17strided_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType9IndexTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="strided_reduction::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dots</span></span>, <a class="reference internal" href="#_CPPv4I0000000E17strided_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType9IndexTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="strided_reduction::OutValueType"><span class="n"><span class="pre">OutValueType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">init</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">inplace</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <a class="reference internal" href="#_CPPv4I0000000E17strided_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType9IndexTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="strided_reduction::MainLambda"><span class="n"><span class="pre">MainLambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">main_op</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft11identity_opE" title="raft::identity_op"><span class="n"><span class="pre">identity_op</span></span></a><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span>, <a class="reference internal" href="#_CPPv4I0000000E17strided_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType9IndexTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="strided_reduction::ReduceLambda"><span class="n"><span class="pre">ReduceLambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">reduce_op</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft6add_opE" title="raft::add_op"><span class="n"><span class="pre">add_op</span></span></a><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span>, <a class="reference internal" href="#_CPPv4I0000000E17strided_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType9IndexTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="strided_reduction::FinalLambda"><span class="n"><span class="pre">FinalLambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">final_op</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core_operators.html#_CPPv4N4raft11identity_opE" title="raft::identity_op"><span class="n"><span class="pre">identity_op</span></span></a><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000000E17strided_reductionvRKN4raft16device_resourcesEN4raft18device_matrix_viewIK11InValueType9IndexType12LayoutPolicyEEN4raft18device_vector_viewI12OutValueType9IndexTypeEE12OutValueTypeb10MainLambda12ReduceLambda11FinalLambda" title="Permalink to this definition">#</a><br></dt>
<dd><p>Compute reduction of the input matrix along the strided dimension This API is to be used when the desired reduction is NOT along the dimension of the memory layout. For example, a row-major matrix will be reduced along the rows whereas a column-major matrix will be reduced along the columns. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>InValueType</strong> &ndash; the input data-type of underlying raft::matrix_view </p></li>
<li><p><strong>LayoutPolicy</strong> &ndash; The layout of Input/Output (row or col major) </p></li>
<li><p><strong>OutValueType</strong> &ndash; the output data-type of underlying raft::matrix_view and reduction </p></li>
<li><p><strong>IndexType</strong> &ndash; Integer type used to for addressing </p></li>
<li><p><strong>MainLambda</strong> &ndash; Unary lambda applied while acculumation (eg: L1 or L2 norm) It must be a &lsquo;callable&rsquo; supporting the following input and output:  </p></li>
<li><p><strong>ReduceLambda</strong> &ndash; Binary lambda applied for reduction (eg: addition(+) for L2 norm) It must be a &lsquo;callable&rsquo; supporting the following input and output:  </p></li>
<li><p><strong>FinalLambda</strong> &ndash; the final lambda applied before STG (eg: Sqrt for L2 norm) It must be a &lsquo;callable&rsquo; supporting the following input and output:  </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> <a class="reference internal" href="core_resources.html#classraft_1_1device__resources"><span class="std std-ref">raft::device_resources</span></a></p></li>
<li><p><strong>data</strong> &ndash; <strong>[in]</strong> Input of type <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a7e14f9414358a77ea57cf19f5bbea3fb"><span class="std std-ref">raft::device_matrix_view</span></a></p></li>
<li><p><strong>dots</strong> &ndash; <strong>[out]</strong> Output of type <a class="reference internal" href="mdspan_mdspan.html#namespaceraft_1a7e14f9414358a77ea57cf19f5bbea3fb"><span class="std std-ref">raft::device_matrix_view</span></a></p></li>
<li><p><strong>init</strong> &ndash; <strong>[in]</strong> initial value to use for the reduction </p></li>
<li><p><strong>main_op</strong> &ndash; <strong>[in]</strong> fused elementwise operation to apply before reduction </p></li>
<li><p><strong>reduce_op</strong> &ndash; <strong>[in]</strong> fused binary reduction operation </p></li>
<li><p><strong>final_op</strong> &ndash; <strong>[in]</strong> fused elementwise operation to apply before storing results </p></li>
<li><p><strong>inplace</strong> &ndash; <strong>[in]</strong> reduction result added inplace or overwrites old values? </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev" href="linalg_blas.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">BLAS Routines</p>
      </div>
    </a>
    <a class="right-next" href="linalg_matrix.html" title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Matrix Operations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coalesced-reduction">Coalesced Reduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#map">Map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#map-reduce">Map Reduce</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-squared-error">Mean Squared Error</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#norm">Norm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalize">Normalize</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduction">Reduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduce-cols-by-key">Reduce Cols By Key</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduce-rows-by-key">Reduce Rows By Key</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strided-reduction">Strided Reduction</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/cpp_api/linalg_map_reduce.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      &copy; Copyright 2023, NVIDIA Corporation.
      <br>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    <br>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  
<script defer id="rapids-selector-js" src="/assets/js/custom.js"></script><script id="rapids-selector-pixel-invocation" type="text/javascript">_satellite.pageBottom();</script></body></html>