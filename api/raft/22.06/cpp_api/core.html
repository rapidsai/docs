<!DOCTYPE html>
<html class="writer-html5" lang="en"><head>
  <meta charset="utf-8"><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator">

  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Core &mdash; raft 22.02.00 documentation</title>
      <link href="../_static/pygments.css" rel="stylesheet" type="text/css">
      <link href="../_static/css/theme.css" rel="stylesheet" type="text/css">
      <link href="../_static/copybutton.css" rel="stylesheet" type="text/css">
      <link href="../_static/infoboxes.css" rel="stylesheet" type="text/css">
      <link href="../_static/params.css" rel="stylesheet" type="text/css">
      <link href="../_static/references.css" rel="stylesheet" type="text/css">
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/example_mod.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link href="../genindex.html" rel="index" title="Index">
    <link href="../search.html" rel="search" title="Search">
    <link href="clustering.html" rel="next" title="Clustering">
    <link href="../cpp_api.html" rel="prev" title="RAFT C++ API Reference"> 
<script id="rapids-selector-pixel-src" src="https://assets.adobedtm.com/5d4962a43b79/814eb6e9b4e1/launch-4bc07f1e0b0b.min.js"></script><link href="/assets/css/custom.css" id="rapids-selector-css" rel="stylesheet"></head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav class="wy-nav-side" data-toggle="wy-nav-shift">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"><div id="rapids-jtd-container"><div class="rapids-home-container"><a class="rapids-home-container__home-btn" href="/api">Home</a></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">raft</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/clx/stable/api.html">clx</a><a class="rapids-selector__menu-item" href="/api/cucim/stable/api.html">cucim</a><a class="rapids-selector__menu-item" href="/api/cudf/stable/index.html">cudf</a><a class="rapids-selector__menu-item" href="/api/cudf-java/stable">cudf-java</a><a class="rapids-selector__menu-item" href="/api/cugraph/stable">cugraph</a><a class="rapids-selector__menu-item" href="/api/cuml/stable/api.html">cuml</a><a class="rapids-selector__menu-item" href="/api/cusignal/stable/api.html">cusignal</a><a class="rapids-selector__menu-item" href="/api/cuspatial/stable">cuspatial</a><a class="rapids-selector__menu-item" href="/api/cuxfilter/stable">cuxfilter</a><a class="rapids-selector__menu-item" href="/api/dask-cuda/stable/api.html">dask-cuda</a><a class="rapids-selector__menu-item" href="/api/kvikio/stable/api.html">kvikio</a><a class="rapids-selector__menu-item" href="/api/libcudf/stable/namespacecudf.html">libcudf</a><a class="rapids-selector__menu-item" href="/api/libcugraph/stable">libcugraph</a><a class="rapids-selector__menu-item" href="/api/libcuml/stable">libcuml</a><a class="rapids-selector__menu-item" href="/api/libcuspatial/stable">libcuspatial</a><a class="rapids-selector__menu-item" href="/api/libkvikio/stable">libkvikio</a><a class="rapids-selector__menu-item" href="/api/librmm/stable/annotated.html">librmm</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/raft/stable">raft</a><a class="rapids-selector__menu-item" href="/api/rapids-cmake/stable/api.html">rapids-cmake</a><a class="rapids-selector__menu-item" href="/api/rmm/stable/api.html">rmm</a></div></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">stable (22.06)</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/raft/nightly">nightly (22.08)</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/raft/stable">stable (22.06)</a><a class="rapids-selector__menu-item" href="/api/raft/legacy">legacy (22.04)</a></div></div></div>
            
              
<div role="search">
  <form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
    <input name="q" placeholder="Search docs" type="text">
    <input name="check_keywords" type="hidden" value="yes">
    <input name="area" type="hidden" value="default">
  </form>
</div>
        </div><div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../cpp_api.html">RAFT C++ API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Core</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#handle-t">handle_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interruptible">interruptible</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mdarray">mdarray</a></li>
<li class="toctree-l3"><a class="reference internal" href="#span">span</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logger">logger</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multi-node-multi-gpu">Multi-node Multi-GPU</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="clustering.html">Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="linalg.html">Linear Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="optimization.html">Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="random.html">Random</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial.html">Spatial</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse.html">Sparse</a></li>
<li class="toctree-l2"><a class="reference internal" href="stats.html">Stats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pyraft_api.html">PyRAFT API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pylibraft_api.html">PyLibRAFT API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section class="wy-nav-content-wrap" data-toggle="wy-nav-shift"><nav aria-label="Mobile navigation menu" class="wy-nav-top">
          <i class="fa fa-bars" data-toggle="wy-nav-top"></i>
          <a href="../index.html">raft</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div aria-label="Page navigation" role="navigation">
  <ul class="wy-breadcrumbs">
      <li><a class="icon icon-home" href="../index.html"></a> &raquo;</li>
          <li><a href="../cpp_api.html">RAFT C++ API Reference</a> &raquo;</li>
      <li>Core</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/cpp_api/core.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr>
</div>
          <div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
           <div itemprop="articleBody">
             
  <section id="core">
<h1>Core<a class="headerlink" href="#core" title="Permalink to this headline">&para;</a></h1>
<p>This page provides C++ class references for the publicly-exposed elements of the core package.</p>
<section id="handle-t">
<h2>handle_t<a class="headerlink" href="#handle-t" title="Permalink to this headline">&para;</a></h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8handle_tE">
<span id="_CPPv3N4raft8handle_tE"></span><span id="_CPPv2N4raft8handle_tE"></span><span id="raft::handle_t"></span><span class="target" id="classraft_1_1handle__t"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">handle_t</span></span></span><a class="headerlink" href="#_CPPv4N4raft8handle_tE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Main handle object that stores all necessary context used for calling necessary cuda kernels and/or libraries. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8handle_t8handle_tEN3rmm16cuda_stream_viewENSt10shared_ptrIN3rmm16cuda_stream_poolEEE">
<span id="_CPPv3N4raft8handle_t8handle_tEN3rmm16cuda_stream_viewENSt10shared_ptrIN3rmm16cuda_stream_poolEEE"></span><span id="_CPPv2N4raft8handle_t8handle_tEN3rmm16cuda_stream_viewENSt10shared_ptrIN3rmm16cuda_stream_poolEEE"></span><span id="raft::handle_t::handle_t__rmm::cuda_stream_view.std::shared_ptr:rmm::cuda_stream_pool:"></span><span class="target" id="classraft_1_1handle__t_1a11813633599cf1d4b2cc6d9b7b5533d1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">handle_t</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda_stream_view</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream_view</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda_stream_per_thread</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda_stream_pool</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream_pool</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="k"><span class="pre">nullptr</span></span><span class="p"><span class="pre">}</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft8handle_t8handle_tEN3rmm16cuda_stream_viewENSt10shared_ptrIN3rmm16cuda_stream_poolEEE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Construct a handle with a stream view and stream pool. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream_view</strong> &ndash; <strong>[in]</strong> the default stream (which has the default per-thread stream if unspecified) </p></li>
<li><p><strong>stream_pool</strong> &ndash; <strong>[in]</strong> the stream pool used (which has default of nullptr if unspecified) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8handle_tD0Ev">
<span id="_CPPv3N4raft8handle_tD0Ev"></span><span id="_CPPv2N4raft8handle_tD0Ev"></span><span id="raft::handle_t::~handle_t"></span><span class="target" id="classraft_1_1handle__t_1a8379883ef04bc26073496270d16d4119"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~handle_t</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft8handle_tD0Ev" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Destroys all held-up resources </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft8handle_t11sync_streamEN3rmm16cuda_stream_viewE">
<span id="_CPPv3NK4raft8handle_t11sync_streamEN3rmm16cuda_stream_viewE"></span><span id="_CPPv2NK4raft8handle_t11sync_streamEN3rmm16cuda_stream_viewE"></span><span id="raft::handle_t::sync_stream__rmm::cuda_stream_viewC"></span><span class="target" id="classraft_1_1handle__t_1aabc5055b95035cb32ac9004249341cd4"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sync_stream</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda_stream_view</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft8handle_t11sync_streamEN3rmm16cuda_stream_viewE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>synchronize a stream on the handle </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft8handle_t11sync_streamEv">
<span id="_CPPv3NK4raft8handle_t11sync_streamEv"></span><span id="_CPPv2NK4raft8handle_t11sync_streamEv"></span><span id="raft::handle_t::sync_streamC"></span><span class="target" id="classraft_1_1handle__t_1ad2e937835c281f994d87197f02f250f5"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sync_stream</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft8handle_t11sync_streamEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>synchronize main stream on the handle </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft8handle_t10get_streamEv">
<span id="_CPPv3NK4raft8handle_t10get_streamEv"></span><span id="_CPPv2NK4raft8handle_t10get_streamEv"></span><span id="raft::handle_t::get_streamC"></span><span class="target" id="classraft_1_1handle__t_1aa536650642276cf7bb0aa9e27a1c09f7"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda_stream_view</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_stream</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft8handle_t10get_streamEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>returns main stream on the handle </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft8handle_t26is_stream_pool_initializedEv">
<span id="_CPPv3NK4raft8handle_t26is_stream_pool_initializedEv"></span><span id="_CPPv2NK4raft8handle_t26is_stream_pool_initializedEv"></span><span id="raft::handle_t::is_stream_pool_initializedC"></span><span class="target" id="classraft_1_1handle__t_1a48f1269a6e87fa369a6459583b7cd030"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">is_stream_pool_initialized</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft8handle_t26is_stream_pool_initializedEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>returns whether stream pool was initialized on the handle </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft8handle_t15get_stream_poolEv">
<span id="_CPPv3NK4raft8handle_t15get_stream_poolEv"></span><span id="_CPPv2NK4raft8handle_t15get_stream_poolEv"></span><span id="raft::handle_t::get_stream_poolC"></span><span class="target" id="classraft_1_1handle__t_1a6d6c2e9054c42b4a965a8143c5ec1304"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda_stream_pool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">get_stream_pool</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft8handle_t15get_stream_poolEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>returns stream pool on the handle </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft8handle_t27get_stream_from_stream_poolEv">
<span id="_CPPv3NK4raft8handle_t27get_stream_from_stream_poolEv"></span><span id="_CPPv2NK4raft8handle_t27get_stream_from_stream_poolEv"></span><span id="raft::handle_t::get_stream_from_stream_poolC"></span><span class="target" id="classraft_1_1handle__t_1a7a24c4444f75a12c69111b1f56d9105d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda_stream_view</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_stream_from_stream_pool</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft8handle_t27get_stream_from_stream_poolEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>return stream from pool </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft8handle_t27get_stream_from_stream_poolENSt6size_tE">
<span id="_CPPv3NK4raft8handle_t27get_stream_from_stream_poolENSt6size_tE"></span><span id="_CPPv2NK4raft8handle_t27get_stream_from_stream_poolENSt6size_tE"></span><span id="raft::handle_t::get_stream_from_stream_pool__std::sC"></span><span class="target" id="classraft_1_1handle__t_1ac480d27bf07a2e3783667fb03599d778"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda_stream_view</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_stream_from_stream_pool</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream_idx</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft8handle_t27get_stream_from_stream_poolENSt6size_tE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>return stream from pool at index </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft8handle_t22get_next_usable_streamEv">
<span id="_CPPv3NK4raft8handle_t22get_next_usable_streamEv"></span><span id="_CPPv2NK4raft8handle_t22get_next_usable_streamEv"></span><span id="raft::handle_t::get_next_usable_streamC"></span><span class="target" id="classraft_1_1handle__t_1aeb512e642e792aecbfadbb5299d1fbe8"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda_stream_view</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_next_usable_stream</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft8handle_t22get_next_usable_streamEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>return stream from pool if size &gt; 0, else main stream on handle </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft8handle_t22get_next_usable_streamENSt6size_tE">
<span id="_CPPv3NK4raft8handle_t22get_next_usable_streamENSt6size_tE"></span><span id="_CPPv2NK4raft8handle_t22get_next_usable_streamENSt6size_tE"></span><span id="raft::handle_t::get_next_usable_stream__std::sC"></span><span class="target" id="classraft_1_1handle__t_1a0ad22edafe9bd7ce307bcd630a844384"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda_stream_view</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_next_usable_stream</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream_idx</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft8handle_t22get_next_usable_streamENSt6size_tE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>return stream from pool at index if size &gt; 0, else main stream on handle </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stream_idx</strong> &ndash; <strong>[in]</strong> the required index of the stream in the stream pool if available </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft8handle_t16sync_stream_poolEv">
<span id="_CPPv3NK4raft8handle_t16sync_stream_poolEv"></span><span id="_CPPv2NK4raft8handle_t16sync_stream_poolEv"></span><span id="raft::handle_t::sync_stream_poolC"></span><span class="target" id="classraft_1_1handle__t_1a73cad16b20c22f8817b21dd9ced9d716"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sync_stream_pool</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft8handle_t16sync_stream_poolEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>synchronize the stream pool on the handle </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft8handle_t16sync_stream_poolEKNSt6vectorINSt6size_tEEE">
<span id="_CPPv3NK4raft8handle_t16sync_stream_poolEKNSt6vectorINSt6size_tEEE"></span><span id="_CPPv2NK4raft8handle_t16sync_stream_poolEKNSt6vectorINSt6size_tEEE"></span><span id="raft::handle_t::sync_stream_pool__std::vector:std::s:CC"></span><span class="target" id="classraft_1_1handle__t_1ae0a059366c9e6d576a845785cd0fdc05"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sync_stream_pool</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream_indices</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft8handle_t16sync_stream_poolEKNSt6vectorINSt6size_tEEE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>synchronize subset of stream pool </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stream_indices</strong> &ndash; <strong>[in]</strong> the indices of the streams in the stream pool to synchronize </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft8handle_t26wait_stream_pool_on_streamEv">
<span id="_CPPv3NK4raft8handle_t26wait_stream_pool_on_streamEv"></span><span id="_CPPv2NK4raft8handle_t26wait_stream_pool_on_streamEv"></span><span id="raft::handle_t::wait_stream_pool_on_streamC"></span><span class="target" id="classraft_1_1handle__t_1a2907155d3f49e7818c9316b2e87556f3"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">wait_stream_pool_on_stream</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft8handle_t26wait_stream_pool_on_streamEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>ask stream pool to wait on last event in main stream </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="interruptible">
<h2>interruptible<a class="headerlink" href="#interruptible" title="Permalink to this headline">&para;</a></h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N4raft13interruptibleE">
<span id="_CPPv3N4raft13interruptibleE"></span><span id="_CPPv2N4raft13interruptibleE"></span><span id="raft::interruptible"></span><span class="target" id="classraft_1_1interruptible"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">interruptible</span></span></span><a class="headerlink" href="#_CPPv4N4raft13interruptibleE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Cooperative-style interruptible execution. </p>
<p>This class provides facilities for interrupting execution of a C++ thread at designated points in code from outside of the thread. In particular, it provides an interruptible version of the blocking CUDA synchronization function, that allows dropping a long-running GPU work.</p>
<p><strong>Important:</strong> Although CUDA synchronize calls serve as cancellation points, the interruptible machinery has nothing to do with CUDA streams or events. In other words, when you call <code class="docutils literal notranslate"><span class="pre">cancel</span></code>, it&rsquo;s the CPU waiting function what is interrupted, not the GPU stream work. This means, when the <code class="docutils literal notranslate"><span class="pre">interrupted_exception</span></code> is raised, any unfinished GPU stream work continues to run. It&rsquo;s the responsibility of the developer then to make sure the unfinished stream work does not affect the program in an undesirable way.</p>
<p>What can happen to CUDA stream when the <code class="docutils literal notranslate"><span class="pre">synchronize</span></code> is cancelled? If you catch the <code class="docutils literal notranslate"><span class="pre">interrupted_exception</span></code> immediately, you can safely wait on the stream again. Otherwise, some of the allocated resources may be released before the active kernel finishes using them, which will result in writing into deallocated or reallocated memory and undefined behavior in general. A dead-locked kernel may never finish (or may crash if you&rsquo;re lucky). In practice, the outcome is usually acceptable for the use case of emergency program interruption (e.g., CTRL+C), but extra effort on the use side is required to allow safe interrupting and resuming of the GPU stream work. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft13interruptible6cancelEv">
<span id="_CPPv3N4raft13interruptible6cancelEv"></span><span id="_CPPv2N4raft13interruptible6cancelEv"></span><span id="raft::interruptible::cancel"></span><span class="target" id="classraft_1_1interruptible_1a034a8cacd4d8ea74e4f48f5ea9afde5b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cancel</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4raft13interruptible6cancelEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Cancel any current or next call to <code class="docutils literal notranslate"><a class="reference internal" href="#classraft_1_1interruptible_1acae7a26d1d8e32b377227e87ae3b683f"><span class="std std-ref"><span class="pre">interruptible::synchronize</span></span></a></code> performed on the CPU thread given by this <code class="docutils literal notranslate"><span class="pre">interruptible</span></code> token. </p>
<p>Note, this function does not involve thread synchronization/locks and does not throw any exceptions, so it&rsquo;s safe to call from a signal handler. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-functions">Public Static Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft13interruptible11synchronizeEN3rmm16cuda_stream_viewE">
<span id="_CPPv3N4raft13interruptible11synchronizeEN3rmm16cuda_stream_viewE"></span><span id="_CPPv2N4raft13interruptible11synchronizeEN3rmm16cuda_stream_viewE"></span><span id="raft::interruptible::synchronize__rmm::cuda_stream_view"></span><span class="target" id="classraft_1_1interruptible_1acae7a26d1d8e32b377227e87ae3b683f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">synchronize</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda_stream_view</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft13interruptible11synchronizeEN3rmm16cuda_stream_viewE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Synchronize the CUDA stream, subject to being interrupted by <code class="docutils literal notranslate"><a class="reference internal" href="#classraft_1_1interruptible_1aff1375dbad542d5131ac9d82ee613724"><span class="std std-ref"><span class="pre">interruptible::cancel</span></span></a></code> called on this CPU thread. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stream</strong> &ndash; <strong>[in]</strong> a CUDA stream.</p>
</dd>
<dt class="field-even">Throws</dt>
<dd class="field-even"><ul class="simple">
<li><p><span><span class="cpp-expr sig sig-inline cpp"><span class="n">raft</span><span class="p">::</span><span class="n">interrupted_exception</span></span></span> &ndash; if <a class="reference internal" href="#classraft_1_1interruptible_1a034a8cacd4d8ea74e4f48f5ea9afde5b"><span class="std std-ref">interruptible::cancel()</span></a> was called on the current CPU thread before the currently captured work has been finished. </p></li>
<li><p><span><span class="cpp-expr sig sig-inline cpp"><span class="n">raft</span><span class="p">::</span><span class="n">cuda_error</span></span></span> &ndash; if another CUDA error happens. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft13interruptible11synchronizeE11cudaEvent_t">
<span id="_CPPv3N4raft13interruptible11synchronizeE11cudaEvent_t"></span><span id="_CPPv2N4raft13interruptible11synchronizeE11cudaEvent_t"></span><span id="raft::interruptible::synchronize__cudaEvent_t"></span><span class="target" id="classraft_1_1interruptible_1a8a82ae1a4914665405cec95e5c0a25b5"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">synchronize</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">cudaEvent_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">event</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft13interruptible11synchronizeE11cudaEvent_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Synchronize the CUDA event, subject to being interrupted by <code class="docutils literal notranslate"><a class="reference internal" href="#classraft_1_1interruptible_1aff1375dbad542d5131ac9d82ee613724"><span class="std std-ref"><span class="pre">interruptible::cancel</span></span></a></code> called on this CPU thread. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>event</strong> &ndash; <strong>[in]</strong> a CUDA event.</p>
</dd>
<dt class="field-even">Throws</dt>
<dd class="field-even"><ul class="simple">
<li><p><span><span class="cpp-expr sig sig-inline cpp"><span class="n">raft</span><span class="p">::</span><span class="n">interrupted_exception</span></span></span> &ndash; if <a class="reference internal" href="#classraft_1_1interruptible_1a034a8cacd4d8ea74e4f48f5ea9afde5b"><span class="std std-ref">interruptible::cancel()</span></a> was called on the current CPU thread before the currently captured work has been finished. </p></li>
<li><p><span><span class="cpp-expr sig sig-inline cpp"><span class="n">raft</span><span class="p">::</span><span class="n">cuda_error</span></span></span> &ndash; if another CUDA error happens. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft13interruptible5yieldEv">
<span id="_CPPv3N4raft13interruptible5yieldEv"></span><span id="_CPPv2N4raft13interruptible5yieldEv"></span><span id="raft::interruptible::yield"></span><span class="target" id="classraft_1_1interruptible_1ac7eb778e9744695cb3fcad4935770f2d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">yield</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft13interruptible5yieldEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Check the thread state, whether the thread can continue execution or is interrupted by <code class="docutils literal notranslate"><a class="reference internal" href="#classraft_1_1interruptible_1aff1375dbad542d5131ac9d82ee613724"><span class="std std-ref"><span class="pre">interruptible::cancel</span></span></a></code>. </p>
<p>This is a cancellation point for an interruptible thread. It&rsquo;s called in the internals of <code class="docutils literal notranslate"><a class="reference internal" href="#classraft_1_1interruptible_1acae7a26d1d8e32b377227e87ae3b683f"><span class="std std-ref"><span class="pre">interruptible::synchronize</span></span></a></code> in a loop. If two synchronize calls are far apart, it&rsquo;s recommended to call <code class="docutils literal notranslate"><a class="reference internal" href="#classraft_1_1interruptible_1ac7eb778e9744695cb3fcad4935770f2d"><span class="std std-ref"><span class="pre">interruptible::yield()</span></span></a></code> in between to make sure the thread does not become unresponsive for too long.</p>
<p>Both <code class="docutils literal notranslate"><span class="pre">yield</span></code> and <code class="docutils literal notranslate"><span class="pre">yield_no_throw</span></code> reset the state to non-cancelled after execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Throws</dt>
<dd class="field-odd"><p><span><span class="cpp-expr sig sig-inline cpp"><span class="n">raft</span><span class="p">::</span><span class="n">interrupted_exception</span></span></span> &ndash; if <a class="reference internal" href="#classraft_1_1interruptible_1a034a8cacd4d8ea74e4f48f5ea9afde5b"><span class="std std-ref">interruptible::cancel()</span></a> was called on the current CPU thread. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft13interruptible14yield_no_throwEv">
<span id="_CPPv3N4raft13interruptible14yield_no_throwEv"></span><span id="_CPPv2N4raft13interruptible14yield_no_throwEv"></span><span id="raft::interruptible::yield_no_throw"></span><span class="target" id="classraft_1_1interruptible_1aa69a9b4fd788baa72ecf5a8fb5a851f4"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">yield_no_throw</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><a class="headerlink" href="#_CPPv4N4raft13interruptible14yield_no_throwEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Check the thread state, whether the thread can continue execution or is interrupted by <code class="docutils literal notranslate"><a class="reference internal" href="#classraft_1_1interruptible_1aff1375dbad542d5131ac9d82ee613724"><span class="std std-ref"><span class="pre">interruptible::cancel</span></span></a></code>. </p>
<p>Same as <code class="docutils literal notranslate"><a class="reference internal" href="#classraft_1_1interruptible_1ac7eb778e9744695cb3fcad4935770f2d"><span class="std std-ref"><span class="pre">interruptible::yield</span></span></a></code>, but does not throw an exception if the thread is cancelled.</p>
<p>Both <code class="docutils literal notranslate"><span class="pre">yield</span></code> and <code class="docutils literal notranslate"><span class="pre">yield_no_throw</span></code> reset the state to non-cancelled after execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>whether the thread can continue, i.e. <code class="docutils literal notranslate"><span class="pre">true</span></code> means continue, <code class="docutils literal notranslate"><span class="pre">false</span></code> means cancelled. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft13interruptible9get_tokenEv">
<span id="_CPPv3N4raft13interruptible9get_tokenEv"></span><span id="_CPPv2N4raft13interruptible9get_tokenEv"></span><span id="raft::interruptible::get_token"></span><span class="target" id="classraft_1_1interruptible_1a2994946fa50eceacbec1a53e11a80518"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_token</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N4raft13interruptibleE" title="raft::interruptible"><span class="n"><span class="pre">interruptible</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft13interruptible9get_tokenEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Get a cancellation token for this CPU thread. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>an object that can be used to cancel the GPU work waited on this CPU thread. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft13interruptible9get_tokenENSt6thread2idE">
<span id="_CPPv3N4raft13interruptible9get_tokenENSt6thread2idE"></span><span id="_CPPv2N4raft13interruptible9get_tokenENSt6thread2idE"></span><span id="raft::interruptible::get_token__std::thread::id"></span><span class="target" id="classraft_1_1interruptible_1a7c8450a375fb5e97a7da8171839fd869"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_token</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">thread</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">id</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">thread_id</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N4raft13interruptibleE" title="raft::interruptible"><span class="n"><span class="pre">interruptible</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft13interruptible9get_tokenENSt6thread2idE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Get a cancellation token for a CPU thread given by its id. </p>
<p>The returned token may live longer than the associated thread. In that case, using its <code class="docutils literal notranslate"><span class="pre">cancel</span></code> method has no effect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>thread_id</strong> &ndash; <strong>[in]</strong> an id of a C++ CPU thread. </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an object that can be used to cancel the GPU work waited on the given CPU thread. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft13interruptible6cancelENSt6thread2idE">
<span id="_CPPv3N4raft13interruptible6cancelENSt6thread2idE"></span><span id="_CPPv2N4raft13interruptible6cancelENSt6thread2idE"></span><span id="raft::interruptible::cancel__std::thread::id"></span><span class="target" id="classraft_1_1interruptible_1aff1375dbad542d5131ac9d82ee613724"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cancel</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">thread</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">id</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">thread_id</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft13interruptible6cancelENSt6thread2idE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Cancel any current or next call to <code class="docutils literal notranslate"><a class="reference internal" href="#classraft_1_1interruptible_1acae7a26d1d8e32b377227e87ae3b683f"><span class="std std-ref"><span class="pre">interruptible::synchronize</span></span></a></code> performed on the CPU thread given by the <code class="docutils literal notranslate"><span class="pre">thread_id</span></code> </p>
<p>Note, this function uses a mutex to safely get a cancellation token that may be shared among multiple threads. If you plan to use it from a signal handler, consider the non-static <code class="docutils literal notranslate"><a class="reference internal" href="#classraft_1_1interruptible_1a034a8cacd4d8ea74e4f48f5ea9afde5b"><span class="std std-ref"><span class="pre">cancel()</span></span></a></code> instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>thread_id</strong> &ndash; <strong>[in]</strong> a CPU thread, in which the work should be interrupted. </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="mdarray">
<h2>mdarray<a class="headerlink" href="#mdarray" title="Permalink to this headline">&para;</a></h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN4raft7mdarrayE">
<span id="_CPPv3I0000EN4raft7mdarrayE"></span><span id="_CPPv2I0000EN4raft7mdarrayE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ElementType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Extents</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LayoutPolicy</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ContainerPolicy</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1mdarray"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">mdarray</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array_interface</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN4raft7mdarrayE" title="raft::mdarray"><span class="n"><span class="pre">mdarray</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN4raft7mdarrayE" title="raft::mdarray::ElementType"><span class="n"><span class="pre">ElementType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft7mdarrayE" title="raft::mdarray::Extents"><span class="n"><span class="pre">Extents</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft7mdarrayE" title="raft::mdarray::LayoutPolicy"><span class="n"><span class="pre">LayoutPolicy</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN4raft7mdarrayE" title="raft::mdarray::ContainerPolicy"><span class="n"><span class="pre">ContainerPolicy</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I0000EN4raft7mdarrayE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Modified from the c++ mdarray proposal. </p>
<p><a class="reference external" href="https://isocpp.org/files/papers/D1684R0.html">https://isocpp.org/files/papers/D1684R0.html</a></p>
<p>mdarray is a container type for mdspan with similar template arguments. However there are some inconsistencies in between them. We have made some modificiations to fit our needs, which are listed below.</p>
<p></p><ul class="simple">
<li><p>Layout policy is different, the mdarray in raft uses <code class="docutils literal notranslate"><span class="pre">stdex::extent</span></code> directly just like <code class="docutils literal notranslate"><span class="pre">mdspan</span></code>, while the <code class="docutils literal notranslate"><span class="pre">mdarray</span></code> in the reference implementation uses varidic template.</p></li>
<li><p>Most of the constructors from the reference implementation is removed to make sure CUDA stream is honorred.</p></li>
<li><p>unique_size is not implemented, which is still working in progress in the proposal</p></li>
<li><p>For container policy, we adopt the alternative approach documented in the proposal [sec 2.4.3], which requires an additional make_accessor method for it to be used in mdspan. The container policy reference implementation has multiple <code class="docutils literal notranslate"><span class="pre">access</span></code> methods that accommodate needs for both mdarray and mdspan. This is more difficult for us since the policy might contain states that are unwanted inside a CUDA kernel. Also, on host we return a proxy to the actual value as <code class="docutils literal notranslate"><span class="pre">device_ref</span></code> so different access methods will have different return type, which is less desirable.</p></li>
<li><p>For the above reasons, copying from other mdarray with different policy type is also removed. </p></li>
</ul>
<p></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-types">Public Types</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7mdarray9view_typeE">
<span id="_CPPv3N4raft7mdarray9view_typeE"></span><span id="_CPPv2N4raft7mdarray9view_typeE"></span><span class="target" id="classraft_1_1mdarray_1a73ab8c010952843fe760bae97c364cc7"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">view_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">view_type_impl</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">element_type</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft7mdarray9view_typeE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>the mdspan type returned by view method. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7mdarray7mdarrayERK12mapping_typeRK21container_policy_type">
<span id="_CPPv3N4raft7mdarray7mdarrayERK12mapping_typeRK21container_policy_type"></span><span id="_CPPv2N4raft7mdarray7mdarrayERK12mapping_typeRK21container_policy_type"></span><span id="raft::mdarray::mdarray__mapping_typeCR.container_policy_typeCR"></span><span class="target" id="classraft_1_1mdarray_1a8a3adb2a6e7f03b609ebab60dbde17be"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">RAFT_MDARRAY_CTOR_CONSTEXPR</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mdarray</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">mapping_type</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">m</span></span>, <span class="n"><span class="pre">container_policy_type</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7mdarray7mdarrayERK12mapping_typeRK21container_policy_type" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>The only constructor that can create storage, this is to make sure CUDA stream is being used. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7mdarray4viewEv">
<span id="_CPPv3N4raft7mdarray4viewEv"></span><span id="_CPPv2N4raft7mdarray4viewEv"></span><span id="raft::mdarray::view"></span><span class="target" id="classraft_1_1mdarray_1a496dd23a28cb13a5d3ff9c26aedc5757"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">view</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4raft7mdarray4viewEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Get a mdspan that can be passed down to CUDA kernels. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft7mdarray4viewEv">
<span id="_CPPv3NK4raft7mdarray4viewEv"></span><span id="_CPPv2NK4raft7mdarray4viewEv"></span><span id="raft::mdarray::viewC"></span><span class="target" id="classraft_1_1mdarray_1a567cbcbc8c42eab430069f8bb7d18cf3"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">view</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4raft7mdarray4viewEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Get a mdspan that can be passed down to CUDA kernels. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN4raft7mdarrayclENSt11enable_if_tIXaaeqsZ9IndexTypeclN12extents_type4rankEEaacvDpRRNSt16is_convertible_vI9IndexType10index_typeEEadadNSt18is_constructible_vI12extents_typeDp9IndexTypeEENSt18is_constructible_vI12mapping_type12extents_typeEEE9referenceEEDpRR9IndexType">
<span id="_CPPv3IDpEN4raft7mdarrayclEDpRR9IndexType"></span><span id="_CPPv2IDpEN4raft7mdarrayclEDpRR9IndexType"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">IndexType</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1mdarray_1aa42dbbeddf217b26498317860d0bca95"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">()</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN4raft7mdarrayclENSt11enable_if_tIXaaeqsZ9IndexTypeclN12extents_type4rankEEaacvDpRRNSt16is_convertible_vI9IndexType10index_typeEEadadNSt18is_constructible_vI12extents_typeDp9IndexTypeEENSt18is_constructible_vI12mapping_type12extents_typeEEE9referenceEEDpRR9IndexType" title="raft::mdarray::operator()::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indices</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if_t</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">sizeof</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv4IDpEN4raft7mdarrayclENSt11enable_if_tIXaaeqsZ9IndexTypeclN12extents_type4rankEEaacvDpRRNSt16is_convertible_vI9IndexType10index_typeEEadadNSt18is_constructible_vI12extents_typeDp9IndexTypeEENSt18is_constructible_vI12mapping_type12extents_typeEEE9referenceEEDpRR9IndexType" title="raft::mdarray::operator()::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="o"><span class="pre">==</span></span><span class="w"> </span><span class="n"><span class="pre">extents_type</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="o"><span class="pre">&amp;&amp;</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_convertible_v</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN4raft7mdarrayclENSt11enable_if_tIXaaeqsZ9IndexTypeclN12extents_type4rankEEaacvDpRRNSt16is_convertible_vI9IndexType10index_typeEEadadNSt18is_constructible_vI12extents_typeDp9IndexTypeEENSt18is_constructible_vI12mapping_type12extents_typeEEE9referenceEEDpRR9IndexType" title="raft::mdarray::operator()::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">index_type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">)</span></span><span class="o"><span class="pre">&amp;</span></span><span class="o"><span class="pre">&amp;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_constructible_v</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">extents_type</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4IDpEN4raft7mdarrayclENSt11enable_if_tIXaaeqsZ9IndexTypeclN12extents_type4rankEEaacvDpRRNSt16is_convertible_vI9IndexType10index_typeEEadadNSt18is_constructible_vI12extents_typeDp9IndexTypeEENSt18is_constructible_vI12mapping_type12extents_typeEEE9referenceEEDpRR9IndexType" title="raft::mdarray::operator()::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="o"><span class="pre">&amp;&amp;</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_constructible_v</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">mapping_type</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extents_type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4IDpEN4raft7mdarrayclENSt11enable_if_tIXaaeqsZ9IndexTypeclN12extents_type4rankEEaacvDpRRNSt16is_convertible_vI9IndexType10index_typeEEadadNSt18is_constructible_vI12extents_typeDp9IndexTypeEENSt18is_constructible_vI12mapping_type12extents_typeEEE9referenceEEDpRR9IndexType" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Indexing operator, use it sparingly since it triggers a device&lt;-&gt;host copy. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpENK4raft7mdarrayclENSt11enable_if_tIXaaeqsZ9IndexTypeclN12extents_type4rankEEaacvDpRRNSt16is_convertible_vI9IndexType10index_typeEEadadNSt18is_constructible_vI12extents_typeDp9IndexTypeEENSt16is_constructibleI12mapping_type12extents_typeE5valueEE15const_referenceEEDpRR9IndexType">
<span id="_CPPv3IDpENK4raft7mdarrayclEDpRR9IndexType"></span><span id="_CPPv2IDpENK4raft7mdarrayclEDpRR9IndexType"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">IndexType</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1mdarray_1aa5958ffa0de4052339c5fbf23f44bb5a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">()</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpENK4raft7mdarrayclENSt11enable_if_tIXaaeqsZ9IndexTypeclN12extents_type4rankEEaacvDpRRNSt16is_convertible_vI9IndexType10index_typeEEadadNSt18is_constructible_vI12extents_typeDp9IndexTypeEENSt16is_constructibleI12mapping_type12extents_typeE5valueEE15const_referenceEEDpRR9IndexType" title="raft::mdarray::operator()::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indices</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if_t</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">sizeof</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv4IDpENK4raft7mdarrayclENSt11enable_if_tIXaaeqsZ9IndexTypeclN12extents_type4rankEEaacvDpRRNSt16is_convertible_vI9IndexType10index_typeEEadadNSt18is_constructible_vI12extents_typeDp9IndexTypeEENSt16is_constructibleI12mapping_type12extents_typeE5valueEE15const_referenceEEDpRR9IndexType" title="raft::mdarray::operator()::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="o"><span class="pre">==</span></span><span class="w"> </span><span class="n"><span class="pre">extents_type</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="o"><span class="pre">&amp;&amp;</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_convertible_v</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpENK4raft7mdarrayclENSt11enable_if_tIXaaeqsZ9IndexTypeclN12extents_type4rankEEaacvDpRRNSt16is_convertible_vI9IndexType10index_typeEEadadNSt18is_constructible_vI12extents_typeDp9IndexTypeEENSt16is_constructibleI12mapping_type12extents_typeE5valueEE15const_referenceEEDpRR9IndexType" title="raft::mdarray::operator()::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">index_type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">)</span></span><span class="o"><span class="pre">&amp;</span></span><span class="o"><span class="pre">&amp;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_constructible_v</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">extents_type</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4IDpENK4raft7mdarrayclENSt11enable_if_tIXaaeqsZ9IndexTypeclN12extents_type4rankEEaacvDpRRNSt16is_convertible_vI9IndexType10index_typeEEadadNSt18is_constructible_vI12extents_typeDp9IndexTypeEENSt16is_constructibleI12mapping_type12extents_typeE5valueEE15const_referenceEEDpRR9IndexType" title="raft::mdarray::operator()::IndexType"><span class="n"><span class="pre">IndexType</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="o"><span class="pre">&amp;&amp;</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_constructible</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">mapping_type</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extents_type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">const_reference</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4IDpENK4raft7mdarrayclENSt11enable_if_tIXaaeqsZ9IndexTypeclN12extents_type4rankEEaacvDpRRNSt16is_convertible_vI9IndexType10index_typeEEadadNSt18is_constructible_vI12extents_typeDp9IndexTypeEENSt16is_constructibleI12mapping_type12extents_typeE5valueEE15const_referenceEEDpRR9IndexType" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Indexing operator, use it sparingly since it triggers a device&lt;-&gt;host copy. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft7mdarray6extentE6size_t">
<span id="_CPPv3NK4raft7mdarray6extentE6size_t"></span><span id="_CPPv2NK4raft7mdarray6extentE6size_t"></span><span id="raft::mdarray::extent__sCCE"></span><span class="target" id="classraft_1_1mdarray_1ab208ca84686a499e2633ae8f61b1647f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="n"><span class="pre">MDSPAN_INLINE_FUNCTION</span></span><span class="w"> </span><span class="k"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">extent</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">index_type</span></span><a class="headerlink" href="#_CPPv4NK4raft7mdarray6extentE6size_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>the extent of rank r </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="span">
<h2>span<a class="headerlink" href="#span" title="Permalink to this headline">&para;</a></h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I0_b_NSt6size_tEEN4raft4spanE">
<span id="_CPPv3I0_b_NSt6size_tEEN4raft4spanE"></span><span id="_CPPv2I0_b_NSt6size_tEEN4raft4spanE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">is_device</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Extent</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">dynamic_extent</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1span"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">span</span></span></span><a class="headerlink" href="#_CPPv4I0_b_NSt6size_tEEN4raft4spanE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>The span class defined in ISO C++20. Iterator is defined as plain pointer and most of the methods have bound check on debug build. </p>
<p></p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rmm</span><span class="p">::</span><span class="n">device_uvector</span><span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span> <span class="n">uvec</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">rmm</span><span class="p">::</span><span class="n">cuda_stream_default</span><span class="p">);</span>
<span class="n">auto</span> <span class="n">view</span> <span class="o">=</span> <span class="n">device_span</span><span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span><span class="p">{</span><span class="n">uvec</span><span class="o">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">uvec</span><span class="o">.</span><span class="n">size</span><span class="p">()};</span>
</pre></div>
</div>
 <p></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft4span4spanEv">
<span id="_CPPv3N4raft4span4spanEv"></span><span id="_CPPv2N4raft4span4spanEv"></span><span id="raft::span::spanCE"></span><span class="target" id="classraft_1_1span_1a2b0818f47bb9e05a56f8d7eeaa92c8e5"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">span</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N4raft4span4spanEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Default constructor that constructs a span with size 0 and nullptr. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft4span4spanE7pointer9size_type">
<span id="_CPPv3N4raft4span4spanE7pointer9size_type"></span><span id="_CPPv2N4raft4span4spanE7pointer9size_type"></span><span id="raft::span::span__pointer.size_typeCE"></span><span class="target" id="classraft_1_1span_1a2686da762b59ab1cda4424647e80b99a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">span</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">pointer</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ptr</span></span>, <span class="n"><span class="pre">size_type</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">count</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4raft4span4spanE7pointer9size_type" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Constructs a span that is a view over the range [first, first + count);. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft4span4spanE7pointer7pointer">
<span id="_CPPv3N4raft4span4spanE7pointer7pointer"></span><span id="_CPPv2N4raft4span4spanE7pointer7pointer"></span><span id="raft::span::span__pointer.pointerCE"></span><span class="target" id="classraft_1_1span_1ae096f984bf42bf66af723626644cdbcd"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">span</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">pointer</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">first</span></span>, <span class="n"><span class="pre">pointer</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">last</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4raft4span4spanE7pointer7pointer" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Constructs a span that is a view over the range [first, last) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_NSt6size_tEEN4raft4span4spanERA1N_12element_type">
<span id="_CPPv3I_NSt6size_tEEN4raft4span4spanERA1N_12element_type"></span><span id="_CPPv2I_NSt6size_tEEN4raft4span4spanERAN_12element_type"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">N</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1span_1a35ce9473358b8d1502272264de1b578e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">span</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">element_type</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">arr</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#_CPPv4I_NSt6size_tEEN4raft4span4spanERA1N_12element_type" title="raft::span::span::N"><span class="n"><span class="pre">N</span></span></a><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4I_NSt6size_tEEN4raft4span4spanERA1N_12element_type" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Constructs a span that is a view over the array arr. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0_NSt6size_tE0EN4raft4span4spanERK4spanI1U9is_device11OtherExtentE">
<span id="_CPPv3I0_NSt6size_tE0EN4raft4span4spanERK4spanI1U9is_device11OtherExtentE"></span><span id="_CPPv2I0_NSt6size_tE0EN4raft4span4spanERK4spanI1U9is_device11OtherExtentE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OtherExtent</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_allowed_element_type_conversion_t</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0_NSt6size_tE0EN4raft4span4spanERK4spanI1U9is_device11OtherExtentE" title="raft::span::span::U"><span class="n"><span class="pre">U</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0_b_NSt6size_tEEN4raft4spanE" title="raft::span::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value</span></span><span class="w"> </span><span class="o"><span class="pre">&amp;&amp;</span></span><span class="w"> </span><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_allowed_extent_conversion_t</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0_NSt6size_tE0EN4raft4span4spanERK4spanI1U9is_device11OtherExtentE" title="raft::span::span::OtherExtent"><span class="n"><span class="pre">OtherExtent</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0_b_NSt6size_tEEN4raft4spanE" title="raft::span::Extent"><span class="n"><span class="pre">Extent</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1span_1ad1729f715df2be05c54a90a127aaa392"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">span</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0_NSt6size_tE0EN4raft4span4spanERK4spanI1U9is_device11OtherExtentE" title="raft::span::span"><span class="n"><span class="pre">span</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0_NSt6size_tE0EN4raft4span4spanERK4spanI1U9is_device11OtherExtentE" title="raft::span::span::U"><span class="n"><span class="pre">U</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0_b_NSt6size_tEEN4raft4spanE" title="raft::span::is_device"><span class="n"><span class="pre">is_device</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0_NSt6size_tE0EN4raft4span4spanERK4spanI1U9is_device11OtherExtentE" title="raft::span::span::OtherExtent"><span class="n"><span class="pre">OtherExtent</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">other</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4I0_NSt6size_tE0EN4raft4span4spanERK4spanI1U9is_device11OtherExtentE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Initialize a span class from another one who&rsquo;s underlying type is convertible to element_type. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_NSt6size_tE_NSt6size_tEENK4raft4span7subspanE4spanI12element_type9is_deviceN6detail14extent_value_tI6Extent6Offset5CountE5valueEEv">
<span id="_CPPv3I_NSt6size_tE_NSt6size_tEENK4raft4span7subspanEv"></span><span id="_CPPv2I_NSt6size_tE_NSt6size_tEENK4raft4span7subspanEv"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Offset</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Count</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">dynamic_extent</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1span_1a307f75f36f4278bf3fdc8b408a0e3e5c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">subspan</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0_b_NSt6size_tEEN4raft4spanE" title="raft::span"><span class="n"><span class="pre">span</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">element_type</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0_b_NSt6size_tEEN4raft4spanE" title="raft::span::is_device"><span class="n"><span class="pre">is_device</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">extent_value_t</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0_b_NSt6size_tEEN4raft4spanE" title="raft::span::Extent"><span class="n"><span class="pre">Extent</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_NSt6size_tE_NSt6size_tEENK4raft4span7subspanE4spanI12element_type9is_deviceN6detail14extent_value_tI6Extent6Offset5CountE5valueEEv" title="raft::span::subspan::Offset"><span class="n"><span class="pre">Offset</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_NSt6size_tE_NSt6size_tEENK4raft4span7subspanE4spanI12element_type9is_deviceN6detail14extent_value_tI6Extent6Offset5CountE5valueEEv" title="raft::span::subspan::Count"><span class="n"><span class="pre">Count</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I_NSt6size_tE_NSt6size_tEENK4raft4span7subspanE4spanI12element_type9is_deviceN6detail14extent_value_tI6Extent6Offset5CountE5valueEEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>If Count is std::dynamic_extent, r.size() == this-&gt;size() - Offset; Otherwise r.size() == Count. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="logger">
<h2>logger<a class="headerlink" href="#logger" title="Permalink to this headline">&para;</a></h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N4raft6loggerE">
<span id="_CPPv3N4raft6loggerE"></span><span id="_CPPv2N4raft6loggerE"></span><span id="raft::logger"></span><span class="target" id="classraft_1_1logger"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">logger</span></span></span><a class="headerlink" href="#_CPPv4N4raft6loggerE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>The main Logging class for raft library. </p>
<p>This class acts as a thin wrapper over the underlying <code class="docutils literal notranslate"><span class="pre">spdlog</span></code> interface. The design is done in this way in order to avoid us having to also ship <code class="docutils literal notranslate"><span class="pre">spdlog</span></code> header files in our installation.</p>
<p></p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Todo:</span></em></dt>
<dd><p>This currently only supports logging to stdout. Need to add support in future to add custom loggers as well [Issue #2046] </p>
</dd></dl>

<p></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft6logger9set_levelEi">
<span id="_CPPv3N4raft6logger9set_levelEi"></span><span id="_CPPv2N4raft6logger9set_levelEi"></span><span id="raft::logger::set_level__i"></span><span class="target" id="classraft_1_1logger_1af946862d86761af29ccaac80cf8c6a67"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_level</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft6logger9set_levelEi" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Set the logging level. </p>
<p>Only messages with level equal or above this will be printed</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The log level will actually be set only if the input is within the range [RAFT_LEVEL_TRACE, RAFT_LEVEL_OFF]. If it is not, then it&rsquo;ll be ignored. See documentation of decisiontree for how this gets used </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>level</strong> &ndash; <strong>[in]</strong> logging level</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft6logger11set_patternERKNSt6stringE">
<span id="_CPPv3N4raft6logger11set_patternERKNSt6stringE"></span><span id="_CPPv2N4raft6logger11set_patternERKNSt6stringE"></span><span id="raft::logger::set_pattern__ssCR"></span><span class="target" id="classraft_1_1logger_1a8441bea3d12b0dfbe5c7cfd971925869"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_pattern</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">pattern</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft6logger11set_patternERKNSt6stringE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Set the logging pattern. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pattern</strong> &ndash; <strong>[in]</strong> the pattern to be set. Refer this link <a class="reference external" href="https://github.com/gabime/spdlog/wiki/3.-Custom-formatting">https://github.com/gabime/spdlog/wiki/3.-Custom-formatting</a> to know the right syntax of this pattern </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft6logger12set_callbackEPFviPKcE">
<span id="_CPPv3N4raft6logger12set_callbackEPFviPKcE"></span><span id="_CPPv2N4raft6logger12set_callbackEPFviPKcE"></span><span class="target" id="classraft_1_1logger_1af0439b8f8730758e5d487af07039f58b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_callback</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">callback</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">lvl</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft6logger12set_callbackEPFviPKcE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Register a callback function to be run in place of usual log call. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>callback</strong> &ndash; <strong>[in]</strong> the function to be run on all logged messages </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft6logger9set_flushEPFvvE">
<span id="_CPPv3N4raft6logger9set_flushEPFvvE"></span><span id="_CPPv2N4raft6logger9set_flushEPFvvE"></span><span class="target" id="classraft_1_1logger_1a231529ad85444f9032bc68fc1a05f360"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_flush</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">flush</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft6logger9set_flushEPFvvE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Register a flush function compatible with the registered callback. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>flush</strong> &ndash; <strong>[in]</strong> the function to use when flushing logs </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft6logger14should_log_forEi">
<span id="_CPPv3NK4raft6logger14should_log_forEi"></span><span id="_CPPv2NK4raft6logger14should_log_forEi"></span><span id="raft::logger::should_log_for__iC"></span><span class="target" id="classraft_1_1logger_1ad3554a1eaa339eb587d87e9585df3514"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">should_log_for</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft6logger14should_log_forEi" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Tells whether messages will be logged for the given log level. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>level</strong> &ndash; <strong>[in]</strong> log level to be checked for </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>true if messages will be logged for this level, else false </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft6logger9get_levelEv">
<span id="_CPPv3NK4raft6logger9get_levelEv"></span><span id="_CPPv2NK4raft6logger9get_levelEv"></span><span id="raft::logger::get_levelC"></span><span class="target" id="classraft_1_1logger_1a91c8075ad75c7d0c75a9692776479817"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_level</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft6logger9get_levelEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Query for the current log level. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the current log level </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft6logger11get_patternEv">
<span id="_CPPv3NK4raft6logger11get_patternEv"></span><span id="_CPPv2NK4raft6logger11get_patternEv"></span><span id="raft::logger::get_patternC"></span><span class="target" id="classraft_1_1logger_1adf85bb40b5581c7c57fb41ec99fb69fb"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_pattern</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft6logger11get_patternEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Get the current logging pattern. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the pattern </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft6logger3logEiPKcz">
<span id="_CPPv3N4raft6logger3logEiPKcz"></span><span id="_CPPv2N4raft6logger3logEiPKcz"></span><span id="raft::logger::log__i.cCP.z"></span><span class="target" id="classraft_1_1logger_1ac8970950e761884617f7fa64c68070bc"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">log</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fmt</span></span>, <span class="p"><span class="pre">...</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft6logger3logEiPKcz" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Main logging method. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> &ndash; <strong>[in]</strong> logging level of this message </p></li>
<li><p><strong>fmt</strong> &ndash; <strong>[in]</strong> C-like format string, followed by respective params </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft6logger5flushEv">
<span id="_CPPv3N4raft6logger5flushEv"></span><span id="_CPPv2N4raft6logger5flushEv"></span><span id="raft::logger::flush"></span><span class="target" id="classraft_1_1logger_1adc00084a168248609c4bcf1752116c3b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">flush</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft6logger5flushEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Flush logs by calling flush on underlying logger. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-functions">Public Static Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft6logger3getERKNSt6stringE">
<span id="_CPPv3N4raft6logger3getERKNSt6stringE"></span><span id="_CPPv2N4raft6logger3getERKNSt6stringE"></span><span id="raft::logger::get__ssCR"></span><span class="target" id="classraft_1_1logger_1a561993e90a6dac190ba136fa20926669"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft6loggerE" title="raft::logger"><span class="n"><span class="pre">logger</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">get</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">name</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">""</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft6logger3getERKNSt6stringE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Singleton method to get the underlying logger object. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the singleton logger object </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="multi-node-multi-gpu">
<h2>Multi-node Multi-GPU<a class="headerlink" href="#multi-node-multi-gpu" title="Permalink to this headline">&para;</a></h2>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5commsE">
<span id="_CPPv3N4raft5commsE"></span><span id="_CPPv2N4raft5commsE"></span><span id="raft::comms"></span><span class="target" id="namespaceraft_1_1comms"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">comms</span></span></span><a class="headerlink" href="#_CPPv4N4raft5commsE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms9mpi_commsE">
<span id="_CPPv3N4raft5comms9mpi_commsE"></span><span id="_CPPv2N4raft5comms9mpi_commsE"></span><span class="target" id="namespaceraft_1_1comms_1a517ba91d67a8c741e281f3c53b5991a7"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpi_comms</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mpi_comms</span></span><a class="headerlink" href="#_CPPv4N4raft5comms9mpi_commsE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms9std_commsE">
<span id="_CPPv3N4raft5comms9std_commsE"></span><span id="_CPPv2N4raft5comms9std_commsE"></span><span class="target" id="namespaceraft_1_1comms_1a6c4ebfc242273b69189ad1be82e90ac3"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">std_comms</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std_comms</span></span><a class="headerlink" href="#_CPPv4N4raft5comms9std_commsE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms9request_tE">
<span id="_CPPv3N4raft5comms9request_tE"></span><span id="_CPPv2N4raft5comms9request_tE"></span><span id="raft::comms::request_t"></span><span class="target" id="namespaceraft_1_1comms_1a246d3ec2b79e1c94842a124b2ff02b11"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">request_t</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms9request_tE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-enums">Enums</p>
<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms10datatype_tE">
<span id="_CPPv3N4raft5comms10datatype_tE"></span><span id="_CPPv2N4raft5comms10datatype_tE"></span><span class="target" id="namespaceraft_1_1comms_1aaf0b3135a6b576039b7dc58be0768ac4"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">datatype_t</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms10datatype_tE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms10datatype_t4CHARE">
<span id="_CPPv3N4raft5comms10datatype_t4CHARE"></span><span id="_CPPv2N4raft5comms10datatype_t4CHARE"></span><span class="target" id="namespaceraft_1_1comms_1aaf0b3135a6b576039b7dc58be0768ac4a027acd3aa6b1dd7f26119d3cf0f9a063"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CHAR</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms10datatype_t4CHARE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms10datatype_t5UINT8E">
<span id="_CPPv3N4raft5comms10datatype_t5UINT8E"></span><span id="_CPPv2N4raft5comms10datatype_t5UINT8E"></span><span class="target" id="namespaceraft_1_1comms_1aaf0b3135a6b576039b7dc58be0768ac4aecfc091ed2a607335524c8389cfa41b5"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">UINT8</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms10datatype_t5UINT8E" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms10datatype_t5INT32E">
<span id="_CPPv3N4raft5comms10datatype_t5INT32E"></span><span id="_CPPv2N4raft5comms10datatype_t5INT32E"></span><span class="target" id="namespaceraft_1_1comms_1aaf0b3135a6b576039b7dc58be0768ac4a6495adba09844fac8eeb0aba86e6f1bf"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">INT32</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms10datatype_t5INT32E" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms10datatype_t6UINT32E">
<span id="_CPPv3N4raft5comms10datatype_t6UINT32E"></span><span id="_CPPv2N4raft5comms10datatype_t6UINT32E"></span><span class="target" id="namespaceraft_1_1comms_1aaf0b3135a6b576039b7dc58be0768ac4a17266551181f69a1b4a3ad5c9e270afc"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">UINT32</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms10datatype_t6UINT32E" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms10datatype_t5INT64E">
<span id="_CPPv3N4raft5comms10datatype_t5INT64E"></span><span id="_CPPv2N4raft5comms10datatype_t5INT64E"></span><span class="target" id="namespaceraft_1_1comms_1aaf0b3135a6b576039b7dc58be0768ac4a4e866b275c85fbb439f6484251cfb31c"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">INT64</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms10datatype_t5INT64E" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms10datatype_t6UINT64E">
<span id="_CPPv3N4raft5comms10datatype_t6UINT64E"></span><span id="_CPPv2N4raft5comms10datatype_t6UINT64E"></span><span class="target" id="namespaceraft_1_1comms_1aaf0b3135a6b576039b7dc58be0768ac4a6de7acf711860176ba606e9aa2b85d5f"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">UINT64</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms10datatype_t6UINT64E" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms10datatype_t7FLOAT32E">
<span id="_CPPv3N4raft5comms10datatype_t7FLOAT32E"></span><span id="_CPPv2N4raft5comms10datatype_t7FLOAT32E"></span><span class="target" id="namespaceraft_1_1comms_1aaf0b3135a6b576039b7dc58be0768ac4a967d280b5c16d95f2947647dd2ca6cc2"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FLOAT32</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms10datatype_t7FLOAT32E" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms10datatype_t7FLOAT64E">
<span id="_CPPv3N4raft5comms10datatype_t7FLOAT64E"></span><span id="_CPPv2N4raft5comms10datatype_t7FLOAT64E"></span><span class="target" id="namespaceraft_1_1comms_1aaf0b3135a6b576039b7dc58be0768ac4a139882c654db8a57f7c3092de1dd0b02"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FLOAT64</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms10datatype_t7FLOAT64E" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

</dd></dl>

<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms4op_tE">
<span id="_CPPv3N4raft5comms4op_tE"></span><span id="_CPPv2N4raft5comms4op_tE"></span><span class="target" id="namespaceraft_1_1comms_1a8c0a574daa0f1083d50dba6bf2ea9126"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">op_t</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms4op_tE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms4op_t3SUME">
<span id="_CPPv3N4raft5comms4op_t3SUME"></span><span id="_CPPv2N4raft5comms4op_t3SUME"></span><span class="target" id="namespaceraft_1_1comms_1a8c0a574daa0f1083d50dba6bf2ea9126a6970bdc2201030b9c03fbdcf3973858a"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SUM</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms4op_t3SUME" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms4op_t4PRODE">
<span id="_CPPv3N4raft5comms4op_t4PRODE"></span><span id="_CPPv2N4raft5comms4op_t4PRODE"></span><span class="target" id="namespaceraft_1_1comms_1a8c0a574daa0f1083d50dba6bf2ea9126ac8074bb318fb85693233e64acc64c1ed"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PROD</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms4op_t4PRODE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms4op_t3MINE">
<span id="_CPPv3N4raft5comms4op_t3MINE"></span><span id="_CPPv2N4raft5comms4op_t3MINE"></span><span class="target" id="namespaceraft_1_1comms_1a8c0a574daa0f1083d50dba6bf2ea9126ace31e2a082d17e038fcc6e3006166653"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MIN</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms4op_t3MINE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms4op_t3MAXE">
<span id="_CPPv3N4raft5comms4op_t3MAXE"></span><span id="_CPPv2N4raft5comms4op_t3MAXE"></span><span class="target" id="namespaceraft_1_1comms_1a8c0a574daa0f1083d50dba6bf2ea9126a26a4b44a837bf97b972628509912b4a5"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MAX</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms4op_t3MAXE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

</dd></dl>

<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms8status_tE">
<span id="_CPPv3N4raft5comms8status_tE"></span><span id="_CPPv2N4raft5comms8status_tE"></span><span class="target" id="namespaceraft_1_1comms_1aa3becda5f6905f60b846f29992bf40a7"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">status_t</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms8status_tE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>The resulting status of distributed stream synchronization </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms8status_t7SUCCESSE">
<span id="_CPPv3N4raft5comms8status_t7SUCCESSE"></span><span id="_CPPv2N4raft5comms8status_t7SUCCESSE"></span><span class="target" id="namespaceraft_1_1comms_1aa3becda5f6905f60b846f29992bf40a7ad0749aaba8b833466dfcbb0428e4f89c"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SUCCESS</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms8status_t7SUCCESSE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms8status_t5ERRORE">
<span id="_CPPv3N4raft5comms8status_t5ERRORE"></span><span id="_CPPv2N4raft5comms8status_t5ERRORE"></span><span class="target" id="namespaceraft_1_1comms_1aa3becda5f6905f60b846f29992bf40a7abb1ca97ec761fc37101737ba0aa2e7c5"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ERROR</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms8status_t5ERRORE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms8status_t5ABORTE">
<span id="_CPPv3N4raft5comms8status_t5ABORTE"></span><span id="_CPPv2N4raft5comms8status_t5ABORTE"></span><span class="target" id="namespaceraft_1_1comms_1aa3becda5f6905f60b846f29992bf40a7a8d12a2ca7e5a64036d7251a3eda51a38"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ABORT</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms8status_t5ABORTE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms25test_collective_allreduceERK8handle_ti">
<span id="_CPPv3N4raft5comms25test_collective_allreduceERK8handle_ti"></span><span id="_CPPv2N4raft5comms25test_collective_allreduceERK8handle_ti"></span><span id="raft::comms::test_collective_allreduce__handle_tCR.i"></span><span class="target" id="namespaceraft_1_1comms_1a9949c335ecd1d0d4f53bdfba93f0dfd3"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_collective_allreduce</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">root</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms25test_collective_allreduceERK8handle_ti" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>A simple sanity check that NCCL is able to perform a collective operation. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> the raft handle to use. This is expected to already have an initialized comms instance. </p></li>
<li><p><strong>root</strong> &ndash; <strong>[in]</strong> the root rank id </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms25test_collective_broadcastERK8handle_ti">
<span id="_CPPv3N4raft5comms25test_collective_broadcastERK8handle_ti"></span><span id="_CPPv2N4raft5comms25test_collective_broadcastERK8handle_ti"></span><span id="raft::comms::test_collective_broadcast__handle_tCR.i"></span><span class="target" id="namespaceraft_1_1comms_1a271156d37275120f5ddb49ac1636628a"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_collective_broadcast</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">root</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms25test_collective_broadcastERK8handle_ti" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>A simple sanity check that NCCL is able to perform a collective operation. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> the raft handle to use. This is expected to already have an initialized comms instance. </p></li>
<li><p><strong>root</strong> &ndash; <strong>[in]</strong> the root rank id </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms22test_collective_reduceERK8handle_ti">
<span id="_CPPv3N4raft5comms22test_collective_reduceERK8handle_ti"></span><span id="_CPPv2N4raft5comms22test_collective_reduceERK8handle_ti"></span><span id="raft::comms::test_collective_reduce__handle_tCR.i"></span><span class="target" id="namespaceraft_1_1comms_1abf53679abcef939d1310bafd897737b6"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_collective_reduce</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">root</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms22test_collective_reduceERK8handle_ti" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>A simple sanity check that NCCL is able to perform a collective reduce. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> the raft handle to use. This is expected to already have an initialized comms instance. </p></li>
<li><p><strong>root</strong> &ndash; <strong>[in]</strong> the root rank id </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms25test_collective_allgatherERK8handle_ti">
<span id="_CPPv3N4raft5comms25test_collective_allgatherERK8handle_ti"></span><span id="_CPPv2N4raft5comms25test_collective_allgatherERK8handle_ti"></span><span id="raft::comms::test_collective_allgather__handle_tCR.i"></span><span class="target" id="namespaceraft_1_1comms_1adff7da7fafd3e5f696ccbeecea85bd96"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_collective_allgather</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">root</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms25test_collective_allgatherERK8handle_ti" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>A simple sanity check that NCCL is able to perform a collective allgather. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> the raft handle to use. This is expected to already have an initialized comms instance. </p></li>
<li><p><strong>root</strong> &ndash; <strong>[in]</strong> the root rank id </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms22test_collective_gatherERK8handle_ti">
<span id="_CPPv3N4raft5comms22test_collective_gatherERK8handle_ti"></span><span id="_CPPv2N4raft5comms22test_collective_gatherERK8handle_ti"></span><span id="raft::comms::test_collective_gather__handle_tCR.i"></span><span class="target" id="namespaceraft_1_1comms_1a30e4bb7c28b644e9132000cfb5aadf79"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_collective_gather</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">root</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms22test_collective_gatherERK8handle_ti" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>A simple sanity check that NCCL is able to perform a collective gather. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> the raft handle to use. This is expected to already have an initialized comms instance. </p></li>
<li><p><strong>root</strong> &ndash; <strong>[in]</strong> the root rank id </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms23test_collective_gathervERK8handle_ti">
<span id="_CPPv3N4raft5comms23test_collective_gathervERK8handle_ti"></span><span id="_CPPv2N4raft5comms23test_collective_gathervERK8handle_ti"></span><span id="raft::comms::test_collective_gatherv__handle_tCR.i"></span><span class="target" id="namespaceraft_1_1comms_1a8a31c610aba1d24c27f4bdb2f07c225e"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_collective_gatherv</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">root</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms23test_collective_gathervERK8handle_ti" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>A simple sanity check that NCCL is able to perform a collective gatherv. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> the raft handle to use. This is expected to already have an initialized comms instance. </p></li>
<li><p><strong>root</strong> &ndash; <strong>[in]</strong> the root rank id </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms29test_collective_reducescatterERK8handle_ti">
<span id="_CPPv3N4raft5comms29test_collective_reducescatterERK8handle_ti"></span><span id="_CPPv2N4raft5comms29test_collective_reducescatterERK8handle_ti"></span><span id="raft::comms::test_collective_reducescatter__handle_tCR.i"></span><span class="target" id="namespaceraft_1_1comms_1aae572e5c281e8d1dac6faa12d5284e13"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_collective_reducescatter</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">root</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms29test_collective_reducescatterERK8handle_ti" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>A simple sanity check that NCCL is able to perform a collective reducescatter. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> the raft handle to use. This is expected to already have an initialized comms instance. </p></li>
<li><p><strong>root</strong> &ndash; <strong>[in]</strong> the root rank id </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms34test_pointToPoint_simple_send_recvERK8handle_ti">
<span id="_CPPv3N4raft5comms34test_pointToPoint_simple_send_recvERK8handle_ti"></span><span id="_CPPv2N4raft5comms34test_pointToPoint_simple_send_recvERK8handle_ti"></span><span id="raft::comms::test_pointToPoint_simple_send_recv__handle_tCR.i"></span><span class="target" id="namespaceraft_1_1comms_1aaef9e3a62b4fb57f69a0fb47897aa9c0"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_pointToPoint_simple_send_recv</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">h</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">numTrials</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms34test_pointToPoint_simple_send_recvERK8handle_ti" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>A simple sanity check that UCX is able to send messages between all ranks</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h</strong> &ndash; <strong>[in]</strong> the raft handle to use. This is expected to already have an initialized comms instance. </p></li>
<li><p><strong>numTrials</strong> &ndash; <strong>[in]</strong> number of iterations of all-to-all messaging to perform </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms37test_pointToPoint_device_send_or_recvERK8handle_ti">
<span id="_CPPv3N4raft5comms37test_pointToPoint_device_send_or_recvERK8handle_ti"></span><span id="_CPPv2N4raft5comms37test_pointToPoint_device_send_or_recvERK8handle_ti"></span><span id="raft::comms::test_pointToPoint_device_send_or_recv__handle_tCR.i"></span><span class="target" id="namespaceraft_1_1comms_1ad3dc0149f3876810278cc31e96a4e25e"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_pointToPoint_device_send_or_recv</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">h</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">numTrials</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms37test_pointToPoint_device_send_or_recvERK8handle_ti" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>A simple sanity check that device is able to send OR receive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h</strong> &ndash; the raft handle to use. This is expected to already have an initialized comms instance. </p></li>
<li><p><strong>numTrials</strong> &ndash; number of iterations of send or receive messaging to perform </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms33test_pointToPoint_device_sendrecvERK8handle_ti">
<span id="_CPPv3N4raft5comms33test_pointToPoint_device_sendrecvERK8handle_ti"></span><span id="_CPPv2N4raft5comms33test_pointToPoint_device_sendrecvERK8handle_ti"></span><span id="raft::comms::test_pointToPoint_device_sendrecv__handle_tCR.i"></span><span class="target" id="namespaceraft_1_1comms_1ae000ebdb3da2cac14853791a8f32c51a"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_pointToPoint_device_sendrecv</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">h</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">numTrials</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms33test_pointToPoint_device_sendrecvERK8handle_ti" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>A simple sanity check that device is able to send and receive at the same time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h</strong> &ndash; the raft handle to use. This is expected to already have an initialized comms instance. </p></li>
<li><p><strong>numTrials</strong> &ndash; number of iterations of send or receive messaging to perform </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms43test_pointToPoint_device_multicast_sendrecvERK8handle_ti">
<span id="_CPPv3N4raft5comms43test_pointToPoint_device_multicast_sendrecvERK8handle_ti"></span><span id="_CPPv2N4raft5comms43test_pointToPoint_device_multicast_sendrecvERK8handle_ti"></span><span id="raft::comms::test_pointToPoint_device_multicast_sendrecv__handle_tCR.i"></span><span class="target" id="namespaceraft_1_1comms_1aa893bd90472cb234afed8e1898ef5ceb"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_pointToPoint_device_multicast_sendrecv</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">h</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">numTrials</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms43test_pointToPoint_device_multicast_sendrecvERK8handle_ti" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>A simple sanity check that device is able to perform multiple concurrent sends and receives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h</strong> &ndash; the raft handle to use. This is expected to already have an initialized comms instance. </p></li>
<li><p><strong>numTrials</strong> &ndash; number of iterations of send or receive messaging to perform </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms14test_commsplitERK8handle_ti">
<span id="_CPPv3N4raft5comms14test_commsplitERK8handle_ti"></span><span id="_CPPv2N4raft5comms14test_commsplitERK8handle_ti"></span><span id="raft::comms::test_commsplit__handle_tCR.i"></span><span class="target" id="namespaceraft_1_1comms_1a1baa7f354263c52b1dd6ea8bf1002905"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">test_commsplit</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">h</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_colors</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms14test_commsplitERK8handle_ti" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>A simple test that the comms can be split into 2 separate subcommunicators</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h</strong> &ndash; the raft handle to use. This is expected to already have an initialized comms instance. </p></li>
<li><p><strong>n_colors</strong> &ndash; number of different colors to test </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms21build_comms_nccl_onlyEP8handle_t10ncclComm_tii">
<span id="_CPPv3N4raft5comms21build_comms_nccl_onlyEP8handle_t10ncclComm_tii"></span><span id="_CPPv2N4raft5comms21build_comms_nccl_onlyEP8handle_t10ncclComm_tii"></span><span id="raft::comms::build_comms_nccl_only__handle_tP.ncclComm_t.i.i"></span><span class="target" id="namespaceraft_1_1comms_1afacbb860a7cd0fdd33230606ff9ede4b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">build_comms_nccl_only</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">ncclComm_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nccl_comm</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_ranks</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rank</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms21build_comms_nccl_onlyEP8handle_t10ncclComm_tii" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Function to construct <a class="reference internal" href="#classraft_1_1comms_1_1comms__t"><span class="std std-ref">comms_t</span></a> and inject it on a <a class="reference internal" href="#classraft_1_1handle__t"><span class="std std-ref">handle_t</span></a>. This is used for convenience in the Python layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <a class="reference internal" href="#classraft_1_1handle__t"><span class="std std-ref">raft::handle_t</span></a> for injecting the comms </p></li>
<li><p><strong>nccl_comm</strong> &ndash; initialized NCCL communicator to use for collectives </p></li>
<li><p><strong>num_ranks</strong> &ndash; number of ranks in communicator clique </p></li>
<li><p><strong>rank</strong> &ndash; rank of local instance </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms20build_comms_nccl_ucxEP8handle_t10ncclComm_tPvPvii">
<span id="_CPPv3N4raft5comms20build_comms_nccl_ucxEP8handle_t10ncclComm_tPvPvii"></span><span id="_CPPv2N4raft5comms20build_comms_nccl_ucxEP8handle_t10ncclComm_tPvPvii"></span><span id="raft::comms::build_comms_nccl_ucx__handle_tP.ncclComm_t.voidP.voidP.i.i"></span><span class="target" id="namespaceraft_1_1comms_1a6a65b2419f0b423bfa65f51744682b43"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">build_comms_nccl_ucx</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">ncclComm_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nccl_comm</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ucp_worker</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">eps</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_ranks</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rank</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms20build_comms_nccl_ucxEP8handle_t10ncclComm_tPvPvii" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Function to construct <a class="reference internal" href="#classraft_1_1comms_1_1comms__t"><span class="std std-ref">comms_t</span></a> and inject it on a <a class="reference internal" href="#classraft_1_1handle__t"><span class="std std-ref">handle_t</span></a>. This is used for convenience in the Python layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <a class="reference internal" href="#classraft_1_1handle__t"><span class="std std-ref">raft::handle_t</span></a> for injecting the comms </p></li>
<li><p><strong>nccl_comm</strong> &ndash; initialized NCCL communicator to use for collectives </p></li>
<li><p><strong>ucp_worker</strong> &ndash; of local process Note: This is purposefully left as void* so that the ucp_worker_h doesn&rsquo;t need to be exposed through the cython layer </p></li>
<li><p><strong>eps</strong> &ndash; array of ucp_ep_h instances. Note: This is purposefully left as void* so that the ucp_ep_h doesn&rsquo;t need to be exposed through the cython layer. </p></li>
<li><p><strong>num_ranks</strong> &ndash; number of ranks in communicator clique </p></li>
<li><p><strong>rank</strong> &ndash; rank of local instance </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms24nccl_unique_id_from_charEP12ncclUniqueIdPci">
<span id="_CPPv3N4raft5comms24nccl_unique_id_from_charEP12ncclUniqueIdPci"></span><span id="_CPPv2N4raft5comms24nccl_unique_id_from_charEP12ncclUniqueIdPci"></span><span id="raft::comms::nccl_unique_id_from_char__ncclUniqueIdP.cP.i"></span><span class="target" id="namespaceraft_1_1comms_1af9e234192e592fa0a4c974435f472a8c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nccl_unique_id_from_char</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">ncclUniqueId</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">id</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">uniqueId</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms24nccl_unique_id_from_charEP12ncclUniqueIdPci" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms13get_unique_idEPci">
<span id="_CPPv3N4raft5comms13get_unique_idEPci"></span><span id="_CPPv2N4raft5comms13get_unique_idEPci"></span><span id="raft::comms::get_unique_id__cP.i"></span><span class="target" id="namespaceraft_1_1comms_1afb288bfa092d955eceff954a8be667ed"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_unique_id</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">uid</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms13get_unique_idEPci" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms20initialize_mpi_commsEP8handle_t8MPI_Comm">
<span id="_CPPv3N4raft5comms20initialize_mpi_commsEP8handle_t8MPI_Comm"></span><span id="_CPPv2N4raft5comms20initialize_mpi_commsEP8handle_t8MPI_Comm"></span><span id="raft::comms::initialize_mpi_comms__handle_tP.MPI_Comm"></span><span class="target" id="namespaceraft_1_1comms_1a0b6a56ab14ddc5c6575f77ebc1d15fc7"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">initialize_mpi_comms</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms20initialize_mpi_commsEP8handle_t8MPI_Comm" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4raft5comms8get_typeE10datatype_tv">
<span id="_CPPv3I0EN4raft5comms8get_typeEv"></span><span id="_CPPv2I0EN4raft5comms8get_typeEv"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1comms_1ab0815935d84804f5ec93f53989ef4d53"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft5comms10datatype_tE" title="raft::comms::datatype_t"><span class="n"><span class="pre">datatype_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_type</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN4raft5comms8get_typeE10datatype_tv" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IEN4raft5comms8get_typeIcEE10datatype_tv">
<span id="_CPPv3IEN4raft5comms8get_typeIcEEv"></span><span id="_CPPv2IEN4raft5comms8get_typeIcEEv"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1comms_1a8f356cacf3f5b69e009d0ba8ca234cd7"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft5comms10datatype_tE" title="raft::comms::datatype_t"><span class="n"><span class="pre">datatype_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_type</span></span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">char</span></span><span class="p"><span class="pre">&gt;</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IEN4raft5comms8get_typeIcEE10datatype_tv" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IEN4raft5comms8get_typeI7uint8_tEE10datatype_tv">
<span id="_CPPv3IEN4raft5comms8get_typeI7uint8_tEEv"></span><span id="_CPPv2IEN4raft5comms8get_typeI7uint8_tEEv"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1comms_1aeeed9b1369ecc0335fc27f1c6d5452f6"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft5comms10datatype_tE" title="raft::comms::datatype_t"><span class="n"><span class="pre">datatype_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_type</span></span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IEN4raft5comms8get_typeI7uint8_tEE10datatype_tv" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IEN4raft5comms8get_typeIiEE10datatype_tv">
<span id="_CPPv3IEN4raft5comms8get_typeIiEEv"></span><span id="_CPPv2IEN4raft5comms8get_typeIiEEv"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1comms_1a697a23d05e581be48ea13b38034735dd"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft5comms10datatype_tE" title="raft::comms::datatype_t"><span class="n"><span class="pre">datatype_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_type</span></span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IEN4raft5comms8get_typeIiEE10datatype_tv" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IEN4raft5comms8get_typeI8uint32_tEE10datatype_tv">
<span id="_CPPv3IEN4raft5comms8get_typeI8uint32_tEEv"></span><span id="_CPPv2IEN4raft5comms8get_typeI8uint32_tEEv"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1comms_1af5e585b8cb98670b253764c753c0e222"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft5comms10datatype_tE" title="raft::comms::datatype_t"><span class="n"><span class="pre">datatype_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_type</span></span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IEN4raft5comms8get_typeI8uint32_tEE10datatype_tv" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IEN4raft5comms8get_typeI7int64_tEE10datatype_tv">
<span id="_CPPv3IEN4raft5comms8get_typeI7int64_tEEv"></span><span id="_CPPv2IEN4raft5comms8get_typeI7int64_tEEv"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1comms_1a84e1884a3fdcf90fe934322dfaf75bd5"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft5comms10datatype_tE" title="raft::comms::datatype_t"><span class="n"><span class="pre">datatype_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_type</span></span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IEN4raft5comms8get_typeI7int64_tEE10datatype_tv" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IEN4raft5comms8get_typeI8uint64_tEE10datatype_tv">
<span id="_CPPv3IEN4raft5comms8get_typeI8uint64_tEEv"></span><span id="_CPPv2IEN4raft5comms8get_typeI8uint64_tEEv"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1comms_1a94f724501cc6d9e3f4ecd97b94a68257"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft5comms10datatype_tE" title="raft::comms::datatype_t"><span class="n"><span class="pre">datatype_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_type</span></span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IEN4raft5comms8get_typeI8uint64_tEE10datatype_tv" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IEN4raft5comms8get_typeIfEE10datatype_tv">
<span id="_CPPv3IEN4raft5comms8get_typeIfEEv"></span><span id="_CPPv2IEN4raft5comms8get_typeIfEEv"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1comms_1aa0b28e3fcec1ca806575688a12abaf7f"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft5comms10datatype_tE" title="raft::comms::datatype_t"><span class="n"><span class="pre">datatype_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_type</span></span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">&gt;</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IEN4raft5comms8get_typeIfEE10datatype_tv" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IEN4raft5comms8get_typeIdEE10datatype_tv">
<span id="_CPPv3IEN4raft5comms8get_typeIdEEv"></span><span id="_CPPv2IEN4raft5comms8get_typeIdEEv"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1comms_1afad4d72f752f467e823c2f9f86e7cee6"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft5comms10datatype_tE" title="raft::comms::datatype_t"><span class="n"><span class="pre">datatype_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_type</span></span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&gt;</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IEN4raft5comms8get_typeIdEE10datatype_tv" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

</div>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms11comms_ifaceE">
<span id="_CPPv3N4raft5comms11comms_ifaceE"></span><span id="_CPPv2N4raft5comms11comms_ifaceE"></span><span id="raft::comms::comms_iface"></span><span class="target" id="classraft_1_1comms_1_1comms__iface"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">comms_iface</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms11comms_ifaceE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;comms.hpp&gt;</em></div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms7comms_tE">
<span id="_CPPv3N4raft5comms7comms_tE"></span><span id="_CPPv2N4raft5comms7comms_tE"></span><span id="raft::comms::comms_t"></span><span class="target" id="classraft_1_1comms_1_1comms__t"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">comms_t</span></span></span><a class="headerlink" href="#_CPPv4N4raft5comms7comms_tE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;comms.hpp&gt;</em></div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft5comms7comms_tD0Ev">
<span id="_CPPv3N4raft5comms7comms_tD0Ev"></span><span id="_CPPv2N4raft5comms7comms_tD0Ev"></span><span id="raft::comms::comms_t::~comms_t"></span><span class="target" id="classraft_1_1comms_1_1comms__t_1ae5c278346b7a2ff2b90b51cee458d093"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~comms_t</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft5comms7comms_tD0Ev" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Virtual Destructor to enable polymorphism </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft5comms7comms_t8get_sizeEv">
<span id="_CPPv3NK4raft5comms7comms_t8get_sizeEv"></span><span id="_CPPv2NK4raft5comms7comms_t8get_sizeEv"></span><span id="raft::comms::comms_t::get_sizeC"></span><span class="target" id="classraft_1_1comms_1_1comms__t_1aa094aaca08561f70019e0bebec174098"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft5comms7comms_t8get_sizeEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Returns the size of the communicator clique </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft5comms7comms_t8get_rankEv">
<span id="_CPPv3NK4raft5comms7comms_t8get_rankEv"></span><span id="_CPPv2NK4raft5comms7comms_t8get_rankEv"></span><span id="raft::comms::comms_t::get_rankC"></span><span class="target" id="classraft_1_1comms_1_1comms__t_1a0c951101d9fe4f1dee70ce24605d9297"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_rank</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft5comms7comms_t8get_rankEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Returns the local rank </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft5comms7comms_t10comm_splitEii">
<span id="_CPPv3NK4raft5comms7comms_t10comm_splitEii"></span><span id="_CPPv2NK4raft5comms7comms_t10comm_splitEii"></span><span id="raft::comms::comms_t::comm_split__i.iC"></span><span class="target" id="classraft_1_1comms_1_1comms__t_1a8de0762f4d80dff8b1612f78933e8fce"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">unique_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N4raft5comms11comms_ifaceE" title="raft::comms::comms_iface"><span class="n"><span class="pre">comms_iface</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">comm_split</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">color</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">key</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft5comms7comms_t10comm_splitEii" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Splits the current communicator clique into sub-cliques matching the given color and key</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>color</strong> &ndash; ranks w/ the same color are placed in the same communicator </p></li>
<li><p><strong>key</strong> &ndash; controls rank assignment </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft5comms7comms_t7barrierEv">
<span id="_CPPv3NK4raft5comms7comms_t7barrierEv"></span><span id="_CPPv2NK4raft5comms7comms_t7barrierEv"></span><span id="raft::comms::comms_t::barrierC"></span><span class="target" id="classraft_1_1comms_1_1comms__t_1aeae7ddcd447bd7f8b94480be5e668d12"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">barrier</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft5comms7comms_t7barrierEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Performs a collective barrier synchronization </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft5comms7comms_t11sync_streamE12cudaStream_t">
<span id="_CPPv3NK4raft5comms7comms_t11sync_streamE12cudaStream_t"></span><span id="_CPPv2NK4raft5comms7comms_t11sync_streamE12cudaStream_t"></span><span id="raft::comms::comms_t::sync_stream__cudaStream_tC"></span><span class="target" id="classraft_1_1comms_1_1comms__t_1ab9252700286e287dcc242aab69f97d09"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft5comms8status_tE" title="raft::comms::status_t"><span class="n"><span class="pre">status_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sync_stream</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft5comms7comms_t11sync_streamE12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Some collective communications implementations (eg. NCCL) might use asynchronous collectives that are explicitly synchronized. It&rsquo;s important to always synchronize using this method to allow failures to propagate, rather than <code class="docutils literal notranslate"><span class="pre">cudaStreamSynchronize()</span></code>, to prevent the potential for deadlocks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stream</strong> &ndash; the cuda stream to sync collective operations on </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4raft5comms7comms_t5isendEvPK7value_t6size_tiiP9request_t">
<span id="_CPPv3I0ENK4raft5comms7comms_t5isendEPK7value_t6size_tiiP9request_t"></span><span id="_CPPv2I0ENK4raft5comms7comms_t5isendEPK7value_t6size_tiiP9request_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1comms_1_1comms__t_1a0c7858efa12646e3f1948dc6f3a3a572"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">isend</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t5isendEvPK7value_t6size_tiiP9request_t" title="raft::comms::comms_t::isend::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dest</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">tag</span></span>, <a class="reference internal" href="#_CPPv4N4raft5comms9request_tE" title="raft::comms::request_t"><span class="n"><span class="pre">request_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">request</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK4raft5comms7comms_t5isendEvPK7value_t6size_tiiP9request_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Performs an asynchronous point-to-point send </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>value_t</strong> &ndash; the type of data to send </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>buf</strong> &ndash; pointer to array of data to send </p></li>
<li><p><strong>size</strong> &ndash; number of elements in buf </p></li>
<li><p><strong>dest</strong> &ndash; destination rank </p></li>
<li><p><strong>tag</strong> &ndash; a tag to use for the receiver to filter </p></li>
<li><p><strong>request</strong> &ndash; pointer to hold returned request_t object. This will be used in <code class="docutils literal notranslate"><a class="reference internal" href="#classraft_1_1comms_1_1comms__t_1a5a29eee9b4d2488fb18689c567dd8806"><span class="std std-ref"><span class="pre">waitall()</span></span></a></code> to synchronize until the message is delivered (or fails). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4raft5comms7comms_t5irecvEvP7value_t6size_tiiP9request_t">
<span id="_CPPv3I0ENK4raft5comms7comms_t5irecvEP7value_t6size_tiiP9request_t"></span><span id="_CPPv2I0ENK4raft5comms7comms_t5irecvEP7value_t6size_tiiP9request_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1comms_1_1comms__t_1aa88010d9562773ce7c11211566cffb8f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">irecv</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t5irecvEvP7value_t6size_tiiP9request_t" title="raft::comms::comms_t::irecv::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">source</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">tag</span></span>, <a class="reference internal" href="#_CPPv4N4raft5comms9request_tE" title="raft::comms::request_t"><span class="n"><span class="pre">request_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">request</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK4raft5comms7comms_t5irecvEvP7value_t6size_tiiP9request_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Performs an asynchronous point-to-point receive </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>value_t</strong> &ndash; the type of data to be received </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>buf</strong> &ndash; pointer to (initialized) array that will hold received data </p></li>
<li><p><strong>size</strong> &ndash; number of elements in buf </p></li>
<li><p><strong>source</strong> &ndash; source rank </p></li>
<li><p><strong>tag</strong> &ndash; a tag to use for message filtering </p></li>
<li><p><strong>request</strong> &ndash; pointer to hold returned request_t object. This will be used in <code class="docutils literal notranslate"><a class="reference internal" href="#classraft_1_1comms_1_1comms__t_1a5a29eee9b4d2488fb18689c567dd8806"><span class="std std-ref"><span class="pre">waitall()</span></span></a></code> to synchronize until the message is delivered (or fails). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft5comms7comms_t7waitallEiA_9request_t">
<span id="_CPPv3NK4raft5comms7comms_t7waitallEiA_9request_t"></span><span id="_CPPv2NK4raft5comms7comms_t7waitallEiA_9request_t"></span><span id="raft::comms::comms_t::waitall__i.request_tAC"></span><span class="target" id="classraft_1_1comms_1_1comms__t_1a5a29eee9b4d2488fb18689c567dd8806"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">waitall</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">count</span></span>, <a class="reference internal" href="#_CPPv4N4raft5comms9request_tE" title="raft::comms::request_t"><span class="n"><span class="pre">request_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">array_of_requests</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft5comms7comms_t7waitallEiA_9request_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Synchronize on an array of request_t objects returned from isend/irecv </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>count</strong> &ndash; number of requests to synchronize on </p></li>
<li><p><strong>array_of_requests</strong> &ndash; an array of request_t objects returned from isend/irecv </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4raft5comms7comms_t9allreduceEvPK7value_tP7value_t6size_t4op_t12cudaStream_t">
<span id="_CPPv3I0ENK4raft5comms7comms_t9allreduceEPK7value_tP7value_t6size_t4op_t12cudaStream_t"></span><span id="_CPPv2I0ENK4raft5comms7comms_t9allreduceEPK7value_tP7value_t6size_t4op_t12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1comms_1_1comms__t_1afd5e34b8712b16b8216336c6169ab511"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">allreduce</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t9allreduceEvPK7value_tP7value_t6size_t4op_t12cudaStream_t" title="raft::comms::comms_t::allreduce::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sendbuff</span></span>, <a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t9allreduceEvPK7value_tP7value_t6size_t4op_t12cudaStream_t" title="raft::comms::comms_t::allreduce::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">recvbuff</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">count</span></span>, <a class="reference internal" href="#_CPPv4N4raft5comms4op_tE" title="raft::comms::op_t"><span class="n"><span class="pre">op_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">op</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK4raft5comms7comms_t9allreduceEvPK7value_tP7value_t6size_t4op_t12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Perform an allreduce collective </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>value_t</strong> &ndash; datatype of underlying buffers </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sendbuff</strong> &ndash; data to reduce </p></li>
<li><p><strong>recvbuff</strong> &ndash; buffer to hold the reduced result </p></li>
<li><p><strong>count</strong> &ndash; number of elements in sendbuff </p></li>
<li><p><strong>op</strong> &ndash; reduction operation to perform </p></li>
<li><p><strong>stream</strong> &ndash; CUDA stream to synchronize operation </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4raft5comms7comms_t5bcastEvP7value_t6size_ti12cudaStream_t">
<span id="_CPPv3I0ENK4raft5comms7comms_t5bcastEP7value_t6size_ti12cudaStream_t"></span><span id="_CPPv2I0ENK4raft5comms7comms_t5bcastEP7value_t6size_ti12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1comms_1_1comms__t_1a2d798f475a97c565845552053b0a4fe9"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">bcast</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t5bcastEvP7value_t6size_ti12cudaStream_t" title="raft::comms::comms_t::bcast::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buff</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">count</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">root</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK4raft5comms7comms_t5bcastEvP7value_t6size_ti12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Broadcast data from one rank to the rest </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>value_t</strong> &ndash; datatype of underlying buffers </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>buff</strong> &ndash; buffer to send </p></li>
<li><p><strong>count</strong> &ndash; number of elements if buff </p></li>
<li><p><strong>root</strong> &ndash; the rank initiating the broadcast </p></li>
<li><p><strong>stream</strong> &ndash; CUDA stream to synchronize operation </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4raft5comms7comms_t5bcastEvPK7value_tP7value_t6size_ti12cudaStream_t">
<span id="_CPPv3I0ENK4raft5comms7comms_t5bcastEPK7value_tP7value_t6size_ti12cudaStream_t"></span><span id="_CPPv2I0ENK4raft5comms7comms_t5bcastEPK7value_tP7value_t6size_ti12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1comms_1_1comms__t_1a42b32b5b79a1fd98233402f83b477aa5"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">bcast</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t5bcastEvPK7value_tP7value_t6size_ti12cudaStream_t" title="raft::comms::comms_t::bcast::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sendbuff</span></span>, <a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t5bcastEvPK7value_tP7value_t6size_ti12cudaStream_t" title="raft::comms::comms_t::bcast::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">recvbuff</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">count</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">root</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK4raft5comms7comms_t5bcastEvPK7value_tP7value_t6size_ti12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Broadcast data from one rank to the rest </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>value_t</strong> &ndash; datatype of underlying buffers </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sendbuff</strong> &ndash; buffer containing data to broadcast (only used in root) </p></li>
<li><p><strong>recvbuff</strong> &ndash; buffer to receive broadcasted data </p></li>
<li><p><strong>count</strong> &ndash; number of elements if buff </p></li>
<li><p><strong>root</strong> &ndash; the rank initiating the broadcast </p></li>
<li><p><strong>stream</strong> &ndash; CUDA stream to synchronize operation </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4raft5comms7comms_t6reduceEvPK7value_tP7value_t6size_t4op_ti12cudaStream_t">
<span id="_CPPv3I0ENK4raft5comms7comms_t6reduceEPK7value_tP7value_t6size_t4op_ti12cudaStream_t"></span><span id="_CPPv2I0ENK4raft5comms7comms_t6reduceEPK7value_tP7value_t6size_t4op_ti12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1comms_1_1comms__t_1aa53d38961981373b76c5a6b526293b7b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reduce</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t6reduceEvPK7value_tP7value_t6size_t4op_ti12cudaStream_t" title="raft::comms::comms_t::reduce::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sendbuff</span></span>, <a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t6reduceEvPK7value_tP7value_t6size_t4op_ti12cudaStream_t" title="raft::comms::comms_t::reduce::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">recvbuff</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">count</span></span>, <a class="reference internal" href="#_CPPv4N4raft5comms4op_tE" title="raft::comms::op_t"><span class="n"><span class="pre">op_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">op</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">root</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK4raft5comms7comms_t6reduceEvPK7value_tP7value_t6size_t4op_ti12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Reduce data from many ranks down to a single rank </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>value_t</strong> &ndash; datatype of underlying buffers </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sendbuff</strong> &ndash; buffer containing data to reduce </p></li>
<li><p><strong>recvbuff</strong> &ndash; buffer containing reduced data (only needs to be initialized on root) </p></li>
<li><p><strong>count</strong> &ndash; number of elements in sendbuff </p></li>
<li><p><strong>op</strong> &ndash; reduction operation to perform </p></li>
<li><p><strong>root</strong> &ndash; rank to store the results </p></li>
<li><p><strong>stream</strong> &ndash; CUDA stream to synchronize operation </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4raft5comms7comms_t9allgatherEvPK7value_tP7value_t6size_t12cudaStream_t">
<span id="_CPPv3I0ENK4raft5comms7comms_t9allgatherEPK7value_tP7value_t6size_t12cudaStream_t"></span><span id="_CPPv2I0ENK4raft5comms7comms_t9allgatherEPK7value_tP7value_t6size_t12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1comms_1_1comms__t_1ad86cdbfdc7e0feda6cff6e36f5cde698"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">allgather</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t9allgatherEvPK7value_tP7value_t6size_t12cudaStream_t" title="raft::comms::comms_t::allgather::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sendbuff</span></span>, <a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t9allgatherEvPK7value_tP7value_t6size_t12cudaStream_t" title="raft::comms::comms_t::allgather::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">recvbuff</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sendcount</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK4raft5comms7comms_t9allgatherEvPK7value_tP7value_t6size_t12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Gathers data from each rank onto all ranks </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>value_t</strong> &ndash; datatype of underlying buffers </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sendbuff</strong> &ndash; buffer containing data to gather </p></li>
<li><p><strong>recvbuff</strong> &ndash; buffer containing gathered data from all ranks </p></li>
<li><p><strong>sendcount</strong> &ndash; number of elements in send buffer </p></li>
<li><p><strong>stream</strong> &ndash; CUDA stream to synchronize operation </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4raft5comms7comms_t10allgathervEvPK7value_tP7value_tPK6size_tPK6size_t12cudaStream_t">
<span id="_CPPv3I0ENK4raft5comms7comms_t10allgathervEPK7value_tP7value_tPK6size_tPK6size_t12cudaStream_t"></span><span id="_CPPv2I0ENK4raft5comms7comms_t10allgathervEPK7value_tP7value_tPK6size_tPK6size_t12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1comms_1_1comms__t_1a59666f497126ffac46c4ac85f1ef10f0"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">allgatherv</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t10allgathervEvPK7value_tP7value_tPK6size_tPK6size_t12cudaStream_t" title="raft::comms::comms_t::allgatherv::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sendbuf</span></span>, <a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t10allgathervEvPK7value_tP7value_tPK6size_tPK6size_t12cudaStream_t" title="raft::comms::comms_t::allgatherv::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">recvbuf</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">recvcounts</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">displs</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK4raft5comms7comms_t10allgathervEvPK7value_tP7value_tPK6size_tPK6size_t12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Gathers data from all ranks and delivers to combined data to all ranks </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>value_t</strong> &ndash; datatype of underlying buffers </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sendbuf</strong> &ndash; buffer containing data to send </p></li>
<li><p><strong>recvbuf</strong> &ndash; buffer containing data to receive </p></li>
<li><p><strong>recvcounts</strong> &ndash; pointer to an array (of length num_ranks size) containing the number of elements that are to be received from each rank </p></li>
<li><p><strong>displs</strong> &ndash; pointer to an array (of length num_ranks size) to specify the displacement (relative to recvbuf) at which to place the incoming data from each rank </p></li>
<li><p><strong>stream</strong> &ndash; CUDA stream to synchronize operation </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4raft5comms7comms_t6gatherEvPK7value_tP7value_t6size_ti12cudaStream_t">
<span id="_CPPv3I0ENK4raft5comms7comms_t6gatherEPK7value_tP7value_t6size_ti12cudaStream_t"></span><span id="_CPPv2I0ENK4raft5comms7comms_t6gatherEPK7value_tP7value_t6size_ti12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1comms_1_1comms__t_1a2a2bd975bd7bb67840e2247570fb4319"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gather</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t6gatherEvPK7value_tP7value_t6size_ti12cudaStream_t" title="raft::comms::comms_t::gather::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sendbuff</span></span>, <a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t6gatherEvPK7value_tP7value_t6size_ti12cudaStream_t" title="raft::comms::comms_t::gather::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">recvbuff</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sendcount</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">root</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK4raft5comms7comms_t6gatherEvPK7value_tP7value_t6size_ti12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Gathers data from each rank onto all ranks </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>value_t</strong> &ndash; datatype of underlying buffers </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sendbuff</strong> &ndash; buffer containing data to gather </p></li>
<li><p><strong>recvbuff</strong> &ndash; buffer containing gathered data from all ranks </p></li>
<li><p><strong>sendcount</strong> &ndash; number of elements in send buffer </p></li>
<li><p><strong>root</strong> &ndash; rank to store the results </p></li>
<li><p><strong>stream</strong> &ndash; CUDA stream to synchronize operation </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4raft5comms7comms_t7gathervEvPK7value_tP7value_t6size_tPK6size_tPK6size_ti12cudaStream_t">
<span id="_CPPv3I0ENK4raft5comms7comms_t7gathervEPK7value_tP7value_t6size_tPK6size_tPK6size_ti12cudaStream_t"></span><span id="_CPPv2I0ENK4raft5comms7comms_t7gathervEPK7value_tP7value_t6size_tPK6size_tPK6size_ti12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1comms_1_1comms__t_1a3e0cfb0f77b143920855c06a1b11d8e8"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gatherv</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t7gathervEvPK7value_tP7value_t6size_tPK6size_tPK6size_ti12cudaStream_t" title="raft::comms::comms_t::gatherv::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sendbuf</span></span>, <a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t7gathervEvPK7value_tP7value_t6size_tPK6size_tPK6size_ti12cudaStream_t" title="raft::comms::comms_t::gatherv::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">recvbuf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sendcount</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">recvcounts</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">displs</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">root</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK4raft5comms7comms_t7gathervEvPK7value_tP7value_t6size_tPK6size_tPK6size_ti12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Gathers data from all ranks and delivers to combined data to all ranks </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>value_t</strong> &ndash; datatype of underlying buffers </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sendbuf</strong> &ndash; buffer containing data to send </p></li>
<li><p><strong>recvbuf</strong> &ndash; buffer containing data to receive </p></li>
<li><p><strong>sendcount</strong> &ndash; number of elements in send buffer </p></li>
<li><p><strong>recvcounts</strong> &ndash; pointer to an array (of length num_ranks size) containing the number of elements that are to be received from each rank </p></li>
<li><p><strong>displs</strong> &ndash; pointer to an array (of length num_ranks size) to specify the displacement (relative to recvbuf) at which to place the incoming data from each rank </p></li>
<li><p><strong>root</strong> &ndash; rank to store the results </p></li>
<li><p><strong>stream</strong> &ndash; CUDA stream to synchronize operation </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4raft5comms7comms_t13reducescatterEvPK7value_tP7value_t6size_t4op_t12cudaStream_t">
<span id="_CPPv3I0ENK4raft5comms7comms_t13reducescatterEPK7value_tP7value_t6size_t4op_t12cudaStream_t"></span><span id="_CPPv2I0ENK4raft5comms7comms_t13reducescatterEPK7value_tP7value_t6size_t4op_t12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1comms_1_1comms__t_1ad9e9fa43acbeac6ea84ef449b542f15b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reducescatter</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t13reducescatterEvPK7value_tP7value_t6size_t4op_t12cudaStream_t" title="raft::comms::comms_t::reducescatter::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sendbuff</span></span>, <a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t13reducescatterEvPK7value_tP7value_t6size_t4op_t12cudaStream_t" title="raft::comms::comms_t::reducescatter::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">recvbuff</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">recvcount</span></span>, <a class="reference internal" href="#_CPPv4N4raft5comms4op_tE" title="raft::comms::op_t"><span class="n"><span class="pre">op_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">op</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK4raft5comms7comms_t13reducescatterEvPK7value_tP7value_t6size_t4op_t12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Reduces data from all ranks then scatters the result across ranks </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>value_t</strong> &ndash; datatype of underlying buffers </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sendbuff</strong> &ndash; buffer containing data to send (size recvcount * num_ranks) </p></li>
<li><p><strong>recvbuff</strong> &ndash; buffer containing received data </p></li>
<li><p><strong>recvcount</strong> &ndash; number of items to receive </p></li>
<li><p><strong>op</strong> &ndash; reduction operation to perform </p></li>
<li><p><strong>stream</strong> &ndash; CUDA stream to synchronize operation </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4raft5comms7comms_t11device_sendEvPK7value_t6size_ti12cudaStream_t">
<span id="_CPPv3I0ENK4raft5comms7comms_t11device_sendEPK7value_t6size_ti12cudaStream_t"></span><span id="_CPPv2I0ENK4raft5comms7comms_t11device_sendEPK7value_t6size_ti12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1comms_1_1comms__t_1a88282297b64c6f63fb0430506f689269"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">device_send</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t11device_sendEvPK7value_t6size_ti12cudaStream_t" title="raft::comms::comms_t::device_send::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dest</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK4raft5comms7comms_t11device_sendEvPK7value_t6size_ti12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Performs a point-to-point send</p>
<p>if a thread is sending &amp; receiving at the same time, use device_sendrecv to avoid deadlock.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>value_t</strong> &ndash; the type of data to send </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>buf</strong> &ndash; pointer to array of data to send </p></li>
<li><p><strong>size</strong> &ndash; number of elements in buf </p></li>
<li><p><strong>dest</strong> &ndash; destination rank </p></li>
<li><p><strong>stream</strong> &ndash; CUDA stream to synchronize operation </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4raft5comms7comms_t11device_recvEvP7value_t6size_ti12cudaStream_t">
<span id="_CPPv3I0ENK4raft5comms7comms_t11device_recvEP7value_t6size_ti12cudaStream_t"></span><span id="_CPPv2I0ENK4raft5comms7comms_t11device_recvEP7value_t6size_ti12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1comms_1_1comms__t_1a29aa5929295a754c6480d60dd219cce7"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">device_recv</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t11device_recvEvP7value_t6size_ti12cudaStream_t" title="raft::comms::comms_t::device_recv::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">source</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK4raft5comms7comms_t11device_recvEvP7value_t6size_ti12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Performs a point-to-point receive</p>
<p>if a thread is sending &amp; receiving at the same time, use device_sendrecv to avoid deadlock.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>value_t</strong> &ndash; the type of data to be received </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>buf</strong> &ndash; pointer to (initialized) array that will hold received data </p></li>
<li><p><strong>size</strong> &ndash; number of elements in buf </p></li>
<li><p><strong>source</strong> &ndash; source rank </p></li>
<li><p><strong>stream</strong> &ndash; CUDA stream to synchronize operation </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4raft5comms7comms_t15device_sendrecvEvPK7value_t6size_tiP7value_t6size_ti12cudaStream_t">
<span id="_CPPv3I0ENK4raft5comms7comms_t15device_sendrecvEPK7value_t6size_tiP7value_t6size_ti12cudaStream_t"></span><span id="_CPPv2I0ENK4raft5comms7comms_t15device_sendrecvEPK7value_t6size_tiP7value_t6size_ti12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1comms_1_1comms__t_1a83a50eea848b53118bfc10039647bbe3"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">device_sendrecv</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t15device_sendrecvEvPK7value_t6size_tiP7value_t6size_ti12cudaStream_t" title="raft::comms::comms_t::device_sendrecv::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sendbuf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sendsize</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dest</span></span>, <a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t15device_sendrecvEvPK7value_t6size_tiP7value_t6size_ti12cudaStream_t" title="raft::comms::comms_t::device_sendrecv::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">recvbuf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">recvsize</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">source</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK4raft5comms7comms_t15device_sendrecvEvPK7value_t6size_tiP7value_t6size_ti12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Performs a point-to-point send/receive</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>value_t</strong> &ndash; the type of data to be sent &amp; received </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sendbuf</strong> &ndash; pointer to array of data to send </p></li>
<li><p><strong>sendsize</strong> &ndash; number of elements in sendbuf </p></li>
<li><p><strong>dest</strong> &ndash; destination rank </p></li>
<li><p><strong>recvbuf</strong> &ndash; pointer to (initialized) array that will hold received data </p></li>
<li><p><strong>recvsize</strong> &ndash; number of elements in recvbuf </p></li>
<li><p><strong>source</strong> &ndash; source rank </p></li>
<li><p><strong>stream</strong> &ndash; CUDA stream to synchronize operation </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4raft5comms7comms_t25device_multicast_sendrecvEvPK7value_tRKNSt6vectorI6size_tEERKNSt6vectorI6size_tEERKNSt6vectorIiEEP7value_tRKNSt6vectorI6size_tEERKNSt6vectorI6size_tEERKNSt6vectorIiEE12cudaStream_t">
<span id="_CPPv3I0ENK4raft5comms7comms_t25device_multicast_sendrecvEPK7value_tRKNSt6vectorI6size_tEERKNSt6vectorI6size_tEERKNSt6vectorIiEEP7value_tRKNSt6vectorI6size_tEERKNSt6vectorI6size_tEERKNSt6vectorIiEE12cudaStream_t"></span><span id="_CPPv2I0ENK4raft5comms7comms_t25device_multicast_sendrecvEPK7value_tRKNSt6vectorI6size_tEERKNSt6vectorI6size_tEERKNSt6vectorIiEEP7value_tRKNSt6vectorI6size_tEERKNSt6vectorI6size_tEERKNSt6vectorIiEE12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="classraft_1_1comms_1_1comms__t_1ab5ee4d8600e35bcb47d4d5d3a9daa801"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">device_multicast_sendrecv</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t25device_multicast_sendrecvEvPK7value_tRKNSt6vectorI6size_tEERKNSt6vectorI6size_tEERKNSt6vectorIiEEP7value_tRKNSt6vectorI6size_tEERKNSt6vectorI6size_tEERKNSt6vectorIiEE12cudaStream_t" title="raft::comms::comms_t::device_multicast_sendrecv::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sendbuf</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sendsizes</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sendoffsets</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dests</span></span>, <a class="reference internal" href="#_CPPv4I0ENK4raft5comms7comms_t25device_multicast_sendrecvEvPK7value_tRKNSt6vectorI6size_tEERKNSt6vectorI6size_tEERKNSt6vectorIiEEP7value_tRKNSt6vectorI6size_tEERKNSt6vectorI6size_tEERKNSt6vectorIiEE12cudaStream_t" title="raft::comms::comms_t::device_multicast_sendrecv::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">recvbuf</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">recvsizes</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">recvoffsets</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sources</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK4raft5comms7comms_t25device_multicast_sendrecvEvPK7value_tRKNSt6vectorI6size_tEERKNSt6vectorI6size_tEERKNSt6vectorIiEEP7value_tRKNSt6vectorI6size_tEERKNSt6vectorI6size_tEERKNSt6vectorIiEE12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Performs a multicast send/receive</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>value_t</strong> &ndash; the type of data to be sent &amp; received </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sendbuf</strong> &ndash; pointer to array of data to send </p></li>
<li><p><strong>sendsizes</strong> &ndash; numbers of elements to send </p></li>
<li><p><strong>sendoffsets</strong> &ndash; offsets in a number of elements from sendbuf </p></li>
<li><p><strong>dests</strong> &ndash; destination ranks </p></li>
<li><p><strong>recvbuf</strong> &ndash; pointer to (initialized) array that will hold received data </p></li>
<li><p><strong>recvsizes</strong> &ndash; numbers of elements to recv </p></li>
<li><p><strong>recvoffsets</strong> &ndash; offsets in a number of elements from recvbuf </p></li>
<li><p><strong>sources</strong> &ndash; source ranks </p></li>
<li><p><strong>stream</strong> &ndash; CUDA stream to synchronize operation </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div aria-label="Footer" class="rst-footer-buttons" role="navigation">
        <a accesskey="p" class="btn btn-neutral float-left" href="../cpp_api.html" rel="prev" title="RAFT C++ API Reference"><span aria-hidden="true" class="fa fa-arrow-circle-left"></span> Previous</a>
        <a accesskey="n" class="btn btn-neutral float-right" href="clustering.html" rel="next" title="Clustering">Next <span aria-hidden="true" class="fa fa-arrow-circle-right"></span></a>
    </div>

  <hr>

  <div role="contentinfo">
    <p>&copy; Copyright 2022, nvidia.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 


<script defer id="rapids-selector-js" src="/assets/js/custom.js"></script><script id="rapids-selector-pixel-invocation" type="text/javascript">_satellite.pageBottom();</script></body></html>