<!DOCTYPE html>
<html class="writer-html5" lang="en"><head>
  <meta charset="utf-8"><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator">

  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Spatial &mdash; raft 22.10.00 documentation</title>
      <link href="../_static/pygments.css" rel="stylesheet" type="text/css">
      <link href="../_static/css/theme.css" rel="stylesheet" type="text/css">
      <link href="../_static/copybutton.css" rel="stylesheet" type="text/css">
      <link href="../_static/infoboxes.css" rel="stylesheet" type="text/css">
      <link href="../_static/references.css" rel="stylesheet" type="text/css">
      <link href="https://docs.rapids.ai/assets/css/custom.css" rel="stylesheet" type="text/css">
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script defer="defer" src="https://docs.rapids.ai/assets/js/custom.js"></script>
        <script src="../_static/example_mod.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link href="../genindex.html" rel="index" title="Index">
    <link href="../search.html" rel="search" title="Search">
    <link href="sparse.html" rel="next" title="Sparse">
    <link href="random.html" rel="prev" title="Random"> 
<script id="rapids-selector-pixel-src" src="https://assets.adobedtm.com/5d4962a43b79/814eb6e9b4e1/launch-4bc07f1e0b0b.min.js"></script><link href="/assets/css/custom.css" id="rapids-selector-css" rel="stylesheet"></head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav class="wy-nav-side" data-toggle="wy-nav-shift">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"><div id="rapids-jtd-container"><div class="rapids-home-container"><a class="rapids-home-container__home-btn" href="/api">Home</a></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">raft</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/clx/stable/api.html">clx</a><a class="rapids-selector__menu-item" href="/api/cucim/stable/api.html">cucim</a><a class="rapids-selector__menu-item" href="/api/cudf/stable/index.html">cudf</a><a class="rapids-selector__menu-item" href="/api/cudf-java/stable">cudf-java</a><a class="rapids-selector__menu-item" href="/api/cugraph/stable">cugraph</a><a class="rapids-selector__menu-item" href="/api/cuml/stable/api.html">cuml</a><a class="rapids-selector__menu-item" href="/api/cusignal/stable/api.html">cusignal</a><a class="rapids-selector__menu-item" href="/api/cuspatial/stable">cuspatial</a><a class="rapids-selector__menu-item" href="/api/cuxfilter/stable">cuxfilter</a><a class="rapids-selector__menu-item" href="/api/dask-cuda/stable/api.html">dask-cuda</a><a class="rapids-selector__menu-item" href="/api/kvikio/stable/api.html">kvikio</a><a class="rapids-selector__menu-item" href="/api/libcudf/stable/namespacecudf.html">libcudf</a><a class="rapids-selector__menu-item" href="/api/libcugraph/stable">libcugraph</a><a class="rapids-selector__menu-item" href="/api/libcuml/stable">libcuml</a><a class="rapids-selector__menu-item" href="/api/libcuspatial/stable">libcuspatial</a><a class="rapids-selector__menu-item" href="/api/libkvikio/stable">libkvikio</a><a class="rapids-selector__menu-item" href="/api/librmm/stable/annotated.html">librmm</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/raft/stable">raft</a><a class="rapids-selector__menu-item" href="/api/rapids-cmake/stable/api.html">rapids-cmake</a><a class="rapids-selector__menu-item" href="/api/rmm/stable/api.html">rmm</a></div></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">stable (22.10)</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/raft/nightly">nightly (22.12)</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/raft/stable">stable (22.10)</a><a class="rapids-selector__menu-item" href="/api/raft/legacy">legacy (22.08)</a></div></div></div>
            
              
<div role="search">
  <form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
    <input name="q" placeholder="Search docs" type="text">
    <input name="check_keywords" type="hidden" value="yes">
    <input name="area" type="hidden" value="default">
  </form>
</div>
        </div><div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../cpp_api.html">RAFT C++ API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="core.html">Core</a></li>
<li class="toctree-l2"><a class="reference internal" href="clustering.html">Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="linalg.html">Linear Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="optimization.html">Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="random.html">Random</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Spatial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#distance">Distance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nearest-neighbors">Nearest Neighbors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ivf-flat">IVF-Flat</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sparse.html">Sparse</a></li>
<li class="toctree-l2"><a class="reference internal" href="stats.html">Stats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../raft_dask_api.html">RAFT Dask API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pylibraft_api.html">PyLibRAFT API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section class="wy-nav-content-wrap" data-toggle="wy-nav-shift"><nav aria-label="Mobile navigation menu" class="wy-nav-top">
          <i class="fa fa-bars" data-toggle="wy-nav-top"></i>
          <a href="../index.html">raft</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div aria-label="Page navigation" role="navigation">
  <ul class="wy-breadcrumbs">
      <li><a class="icon icon-home" href="../index.html"></a> &raquo;</li>
          <li><a href="../cpp_api.html">RAFT C++ API Reference</a> &raquo;</li>
      <li>Spatial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/cpp_api/spatial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr>
</div>
          <div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
           <div itemprop="articleBody">
             
  <section id="spatial">
<h1>Spatial<a class="headerlink" href="#spatial" title="Permalink to this heading">&para;</a></h1>
<p>This page provides C++ class references for the publicly-exposed elements of the spatial package.</p>
<section id="distance">
<h2>Distance<a class="headerlink" href="#distance" title="Permalink to this heading">&para;</a></h2>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distanceE">
<span id="_CPPv3N4raft8distanceE"></span><span id="_CPPv2N4raft8distanceE"></span><span id="raft::distance"></span><span class="target" id="namespaceraft_1_1distance"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distance</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distanceE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft8distance12KVPMinReduceE">
<span id="_CPPv3I00EN4raft8distance12KVPMinReduceE"></span><span id="_CPPv2I00EN4raft8distance12KVPMinReduceE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LabelT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1abb6b16e8f3b34780f10c348585d388b1"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">KVPMinReduce</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">KVPMinReduceImpl</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft8distance12KVPMinReduceE" title="raft::distance::KVPMinReduce::LabelT"><span class="n"><span class="pre">LabelT</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft8distance12KVPMinReduceE" title="raft::distance::KVPMinReduce::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft8distance12KVPMinReduceE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft8distance22MinAndDistanceReduceOpE">
<span id="_CPPv3I00EN4raft8distance22MinAndDistanceReduceOpE"></span><span id="_CPPv2I00EN4raft8distance22MinAndDistanceReduceOpE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LabelT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a5d7c5661704344e7be1908bef409e6f8"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MinAndDistanceReduceOp</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MinAndDistanceReduceOpImpl</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft8distance22MinAndDistanceReduceOpE" title="raft::distance::MinAndDistanceReduceOp::LabelT"><span class="n"><span class="pre">LabelT</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft8distance22MinAndDistanceReduceOpE" title="raft::distance::MinAndDistanceReduceOp::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft8distance22MinAndDistanceReduceOpE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft8distance11MinReduceOpE">
<span id="_CPPv3I00EN4raft8distance11MinReduceOpE"></span><span id="_CPPv2I00EN4raft8distance11MinReduceOpE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LabelT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1ad2c23feb7a46f9f23815ca81fbf234f2"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MinReduceOp</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MinReduceOpImpl</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft8distance11MinReduceOpE" title="raft::distance::MinReduceOp::LabelT"><span class="n"><span class="pre">LabelT</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft8distance11MinReduceOpE" title="raft::distance::MinReduceOp::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft8distance11MinReduceOpE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-enums">Enums</p>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceTypeE">
<span id="_CPPv3N4raft8distance12DistanceTypeE"></span><span id="_CPPv2N4raft8distance12DistanceTypeE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DistanceType</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceTypeE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>enum to tell how to compute distance </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType10L2ExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType10L2ExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType10L2ExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a260d2830aacf708d5a9bab724efdcdf8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L2Expanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType10L2ExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>evaluate as dist_ij = sum(x_ik^2) + sum(y_ij)^2 - 2*sum(x_ik * y_jk) </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType14L2SqrtExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType14L2SqrtExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType14L2SqrtExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a4d8d107312a2302379fb165bfae2d3c6"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L2SqrtExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType14L2SqrtExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>same as above, but inside the epilogue, perform square root operation </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType14CosineExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType14CosineExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType14CosineExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a48fb8815b598ea06333f61749afefb9b"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CosineExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType14CosineExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>cosine distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType2L1E">
<span id="_CPPv3N4raft8distance12DistanceType2L1E"></span><span id="_CPPv2N4raft8distance12DistanceType2L1E"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a4342e21a9d5a89dd05165b548ed76f31"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L1</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType2L1E" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>L1 distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType12L2UnexpandedE">
<span id="_CPPv3N4raft8distance12DistanceType12L2UnexpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType12L2UnexpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a81c2e8b19beb55f0771bff42a03ac810"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L2Unexpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType12L2UnexpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>evaluate as dist_ij += (x_ik - y-jk)^2 </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType16L2SqrtUnexpandedE">
<span id="_CPPv3N4raft8distance12DistanceType16L2SqrtUnexpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType16L2SqrtUnexpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a8318dbfebd41e0f93b0c8a211bef3cb8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L2SqrtUnexpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType16L2SqrtUnexpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>same as above, but inside the epilogue, perform square root operation </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType12InnerProductE">
<span id="_CPPv3N4raft8distance12DistanceType12InnerProductE"></span><span id="_CPPv2N4raft8distance12DistanceType12InnerProductE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a70f89c9bf7fa6f05a13646e1de6d7178"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InnerProduct</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType12InnerProductE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>basic inner product </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType4LinfE">
<span id="_CPPv3N4raft8distance12DistanceType4LinfE"></span><span id="_CPPv2N4raft8distance12DistanceType4LinfE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a185b8e11ff85c7ffb16372cc11f40833"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Linf</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType4LinfE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Chebyshev (Linf) distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType8CanberraE">
<span id="_CPPv3N4raft8distance12DistanceType8CanberraE"></span><span id="_CPPv2N4raft8distance12DistanceType8CanberraE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1aa772a76513c29f7b67b8884d92a3debd"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Canberra</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType8CanberraE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Canberra distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType12LpUnexpandedE">
<span id="_CPPv3N4raft8distance12DistanceType12LpUnexpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType12LpUnexpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a5f1ddb80c7c8de7a58719c06fcb55aa9"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LpUnexpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType12LpUnexpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Generalized Minkowski distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType19CorrelationExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType19CorrelationExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType19CorrelationExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1ac52ba9a65568dfd526ef3e0e79dd7d76"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CorrelationExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType19CorrelationExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Correlation distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType15JaccardExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType15JaccardExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType15JaccardExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1afa8c62f78f79f7e9ea54fe96de211a06"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">JaccardExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType15JaccardExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Jaccard distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType17HellingerExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType17HellingerExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType17HellingerExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1afb2bdeb001658bf43f341662fd25d4bf"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">HellingerExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType17HellingerExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Hellinger distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType9HaversineE">
<span id="_CPPv3N4raft8distance12DistanceType9HaversineE"></span><span id="_CPPv2N4raft8distance12DistanceType9HaversineE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a85f595d27413bf51df240faf9fd51a1b"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Haversine</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType9HaversineE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Haversine distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType10BrayCurtisE">
<span id="_CPPv3N4raft8distance12DistanceType10BrayCurtisE"></span><span id="_CPPv2N4raft8distance12DistanceType10BrayCurtisE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a260486b7750910efc426c3011c187fc7"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BrayCurtis</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType10BrayCurtisE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Bray-Curtis distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType13JensenShannonE">
<span id="_CPPv3N4raft8distance12DistanceType13JensenShannonE"></span><span id="_CPPv2N4raft8distance12DistanceType13JensenShannonE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a6c4feaa8cee536fb43bb62ec5d640d84"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">JensenShannon</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType13JensenShannonE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Jensen-Shannon distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType17HammingUnexpandedE">
<span id="_CPPv3N4raft8distance12DistanceType17HammingUnexpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType17HammingUnexpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a463aa03baa6d1ebfe73cb7e117c54799"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">HammingUnexpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType17HammingUnexpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Hamming distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType12KLDivergenceE">
<span id="_CPPv3N4raft8distance12DistanceType12KLDivergenceE"></span><span id="_CPPv2N4raft8distance12DistanceType12KLDivergenceE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a120ce453ec90b2f0cc900b427ba17859"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">KLDivergence</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType12KLDivergenceE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>KLDivergence </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType17RusselRaoExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType17RusselRaoExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType17RusselRaoExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1aeaed6497e19d80f7a3da8ca9f8f3f2f9"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RusselRaoExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType17RusselRaoExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>RusselRao </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType12DiceExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType12DiceExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType12DiceExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a045a33649506444b73c2c91854a425a3"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DiceExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType12DiceExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Dice-Sorensen distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType11PrecomputedE">
<span id="_CPPv3N4raft8distance12DistanceType11PrecomputedE"></span><span id="_CPPv2N4raft8distance12DistanceType11PrecomputedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1ab06de53ee826704ad219603dcc4bf9cd"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Precomputed</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType11PrecomputedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Precomputed (special value) </p>
</dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType">
<span id="_CPPv3I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType"></span><span id="_CPPv2I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distanceType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AccType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FinalLambda</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a30b5d0ad9c6fd2da977963427f6b4179"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distance</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dist</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">workspace</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">worksize</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::FinalLambda"><span class="n"><span class="pre">FinalLambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">fin_op</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">isRowMajor</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Evaluate pairwise distances with the user epilogue lamba allowed. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>fin_op: This is a device lambda which is supposed to operate upon the input which is AccType and returns the output in OutType. It&rsquo;s signature is as follows: . If one needs any other parameters, feel free to pass them via closure. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DistanceType</strong> &ndash; which distance to evaluate </p></li>
<li><p><strong>InType</strong> &ndash; input argument type </p></li>
<li><p><strong>AccType</strong> &ndash; accumulation type </p></li>
<li><p><strong>OutType</strong> &ndash; output type </p></li>
<li><p><strong>FinalLambda</strong> &ndash; user-defined epilogue lamba </p></li>
<li><p><strong>Index_</strong> &ndash; Index type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> &ndash; first set of points </p></li>
<li><p><strong>y</strong> &ndash; second set of points </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix </p></li>
<li><p><strong>m</strong> &ndash; number of points in x </p></li>
<li><p><strong>n</strong> &ndash; number of points in y </p></li>
<li><p><strong>k</strong> &ndash; dimensionality </p></li>
<li><p><strong>workspace</strong> &ndash; temporary workspace needed for computations </p></li>
<li><p><strong>worksize</strong> &ndash; number of bytes of the workspace </p></li>
<li><p><strong>fin_op</strong> &ndash; the final gemm epilogue lambda </p></li>
<li><p><strong>stream</strong> &ndash; cuda stream </p></li>
<li><p><strong>isRowMajor</strong> &ndash; whether the matrices are row-major or col-major </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType">
<span id="_CPPv3I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType"></span><span id="_CPPv2I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distanceType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AccType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1ad7690136a3ce7b161692a58f97c1929e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distance</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="raft::distance::distance::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dist</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">workspace</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">worksize</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">isRowMajor</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Evaluate pairwise distances for the simple use case. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if workspace is passed as nullptr, this will return in worksize, the number of bytes of workspace required </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DistanceType</strong> &ndash; which distance to evaluate </p></li>
<li><p><strong>InType</strong> &ndash; input argument type </p></li>
<li><p><strong>AccType</strong> &ndash; accumulation type </p></li>
<li><p><strong>OutType</strong> &ndash; output type </p></li>
<li><p><strong>Index_</strong> &ndash; Index type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> &ndash; first set of points </p></li>
<li><p><strong>y</strong> &ndash; second set of points </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix </p></li>
<li><p><strong>m</strong> &ndash; number of points in x </p></li>
<li><p><strong>n</strong> &ndash; number of points in y </p></li>
<li><p><strong>k</strong> &ndash; dimensionality </p></li>
<li><p><strong>workspace</strong> &ndash; temporary workspace needed for computations </p></li>
<li><p><strong>worksize</strong> &ndash; number of bytes of the workspace </p></li>
<li><p><strong>stream</strong> &ndash; cuda stream </p></li>
<li><p><strong>isRowMajor</strong> &ndash; whether the matrices are row-major or col-major </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeE6size_tPK6InTypePK6InType6Index_6Index_6Index_">
<span id="_CPPv3I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeEPK6InTypePK6InType6Index_6Index_6Index_"></span><span id="_CPPv2I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeEPK6InTypePK6InType6Index_6Index_6Index_"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distanceType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AccType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a088c016777ff14cfe25dd028224135c6"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">getWorkspaceSize</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeE6size_tPK6InTypePK6InType6Index_6Index_6Index_" title="raft::distance::getWorkspaceSize::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeE6size_tPK6InTypePK6InType6Index_6Index_6Index_" title="raft::distance::getWorkspaceSize::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeE6size_tPK6InTypePK6InType6Index_6Index_6Index_" title="raft::distance::getWorkspaceSize::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeE6size_tPK6InTypePK6InType6Index_6Index_6Index_" title="raft::distance::getWorkspaceSize::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeE6size_tPK6InTypePK6InType6Index_6Index_6Index_" title="raft::distance::getWorkspaceSize::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeE6size_tPK6InTypePK6InType6Index_6Index_6Index_" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Return the exact workspace size to compute the distance. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the specified distanceType doesn&rsquo;t need the workspace at all, it returns 0. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DistanceType</strong> &ndash; which distance to evaluate </p></li>
<li><p><strong>InType</strong> &ndash; input argument type </p></li>
<li><p><strong>AccType</strong> &ndash; accumulation type </p></li>
<li><p><strong>OutType</strong> &ndash; output type </p></li>
<li><p><strong>Index_</strong> &ndash; Index type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> &ndash; first set of points </p></li>
<li><p><strong>y</strong> &ndash; second set of points </p></li>
<li><p><strong>m</strong> &ndash; number of points in x </p></li>
<li><p><strong>n</strong> &ndash; number of points in y </p></li>
<li><p><strong>k</strong> &ndash; dimensionality</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeE6size_tKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE">
<span id="_CPPv3I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeEKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE"></span><span id="_CPPv2I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeEKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distanceType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AccType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">layout</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1afef1ec261e2fb5f236cb8a8e0eb7b9fc"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">getWorkspaceSize</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeE6size_tKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE" title="raft::distance::getWorkspaceSize::InType"><span class="n"><span class="pre">InType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeE6size_tKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE" title="raft::distance::getWorkspaceSize::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeE6size_tKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE" title="raft::distance::getWorkspaceSize::InType"><span class="n"><span class="pre">InType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeE6size_tKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE" title="raft::distance::getWorkspaceSize::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeE6size_tKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Return the exact workspace size to compute the distance. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the specified distanceType doesn&rsquo;t need the workspace at all, it returns 0. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DistanceType</strong> &ndash; which distance to evaluate </p></li>
<li><p><strong>InType</strong> &ndash; input argument type </p></li>
<li><p><strong>AccType</strong> &ndash; accumulation type </p></li>
<li><p><strong>OutType</strong> &ndash; output type </p></li>
<li><p><strong>Index_</strong> &ndash; Index type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> &ndash; first set of points (size m*k) </p></li>
<li><p><strong>y</strong> &ndash; second set of points (size n*k) </p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of bytes needed in workspace</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType">
<span id="_CPPv3I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType"></span><span id="_CPPv2I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distanceType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AccType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a343f180fa6587eebb0d32c765f83b543"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distance</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="raft::distance::distance::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dist</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">isRowMajor</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Evaluate pairwise distances for the simple use case. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DistanceType</strong> &ndash; which distance to evaluate </p></li>
<li><p><strong>InType</strong> &ndash; input argument type </p></li>
<li><p><strong>AccType</strong> &ndash; accumulation type </p></li>
<li><p><strong>OutType</strong> &ndash; output type </p></li>
<li><p><strong>Index_</strong> &ndash; Index type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> &ndash; first set of points </p></li>
<li><p><strong>y</strong> &ndash; second set of points </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix </p></li>
<li><p><strong>m</strong> &ndash; number of points in x </p></li>
<li><p><strong>n</strong> &ndash; number of points in y </p></li>
<li><p><strong>k</strong> &ndash; dimensionality </p></li>
<li><p><strong>stream</strong> &ndash; cuda stream </p></li>
<li><p><strong>isRowMajor</strong> &ndash; whether the matrices are row-major or col-major </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType">
<span id="_CPPv3I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceERKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType"></span><span id="_CPPv2I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceERKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distanceType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AccType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">layout</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">layout_c_contiguous</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1af3cd2723a7ceba7666645cea5ff1ddac"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distance</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dist</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Evaluate pairwise distances for the simple use case. </p>
<p>Note: Only contiguous row- or column-major layouts supported currently.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DistanceType</strong> &ndash; which distance to evaluate </p></li>
<li><p><strong>InType</strong> &ndash; input argument type </p></li>
<li><p><strong>AccType</strong> &ndash; accumulation type </p></li>
<li><p><strong>OutType</strong> &ndash; output type </p></li>
<li><p><strong>Index_</strong> &ndash; Index type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; raft handle for managing expensive resources </p></li>
<li><p><strong>x</strong> &ndash; first set of points (size n*k) </p></li>
<li><p><strong>y</strong> &ndash; second set of points (size m*k) </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix (size n*m) </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type">
<span id="_CPPv3I00EN4raft8distance17pairwise_distanceERKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type"></span><span id="_CPPv2I00EN4raft8distance17pairwise_distanceERKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Type</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a379cae44de27631bee797702aea7bf58"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pairwise_distance</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dist</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_uvector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">char</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">workspace</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">isRowMajor</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Convenience wrapper around &lsquo;distance&rsquo; prim to convert runtime metric into compile time for the purpose of dispatch. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Type</strong> &ndash; input/accumulation/output data-type </p></li>
<li><p><strong>Index_</strong> &ndash; indexing type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; raft handle for managing expensive resources </p></li>
<li><p><strong>x</strong> &ndash; first set of points </p></li>
<li><p><strong>y</strong> &ndash; second set of points </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix </p></li>
<li><p><strong>m</strong> &ndash; number of points in x </p></li>
<li><p><strong>n</strong> &ndash; number of points in y </p></li>
<li><p><strong>k</strong> &ndash; dimensionality </p></li>
<li><p><strong>workspace</strong> &ndash; temporary workspace buffer which can get resized as per the needed workspace size </p></li>
<li><p><strong>metric</strong> &ndash; distance metric </p></li>
<li><p><strong>isRowMajor</strong> &ndash; whether the matrices are row-major or col-major </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type">
<span id="_CPPv3I00EN4raft8distance17pairwise_distanceERKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type"></span><span id="_CPPv2I00EN4raft8distance17pairwise_distanceERKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Type</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1af26ef24cd2317ae5ec2c78740d1a22c9"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pairwise_distance</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dist</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">isRowMajor</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Convenience wrapper around &lsquo;distance&rsquo; prim to convert runtime metric into compile time for the purpose of dispatch. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Type</strong> &ndash; input/accumulation/output data-type </p></li>
<li><p><strong>Index_</strong> &ndash; indexing type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; raft handle for managing expensive resources </p></li>
<li><p><strong>x</strong> &ndash; first set of points </p></li>
<li><p><strong>y</strong> &ndash; second set of points </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix </p></li>
<li><p><strong>m</strong> &ndash; number of points in x </p></li>
<li><p><strong>n</strong> &ndash; number of points in y </p></li>
<li><p><strong>k</strong> &ndash; dimensionality </p></li>
<li><p><strong>metric</strong> &ndash; distance metric </p></li>
<li><p><strong>isRowMajor</strong> &ndash; whether the matrices are row-major or col-major </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type">
<span id="_CPPv3I000EN4raft8distance17pairwise_distanceERKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type"></span><span id="_CPPv2I000EN4raft8distance17pairwise_distanceERKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Type</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">layout</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">layout_c_contiguous</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a9b33e196aaa3704790a2ad24df68a3ca"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pairwise_distance</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y</span></span>, <span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dist</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Convenience wrapper around &lsquo;distance&rsquo; prim to convert runtime metric into compile time for the purpose of dispatch. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Type</strong> &ndash; input/accumulation/output data-type </p></li>
<li><p><strong>Index_</strong> &ndash; indexing type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; raft handle for managing expensive resources </p></li>
<li><p><strong>x</strong> &ndash; first matrix of points (size mxk) </p></li>
<li><p><strong>y</strong> &ndash; second matrix of points (size nxk) </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix (size mxn) </p></li>
<li><p><strong>metric</strong> &ndash; distance metric </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN4raft8distance10initializeEvRKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT">
<span id="_CPPv3I0000EN4raft8distance10initializeERKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT"></span><span id="_CPPv2I0000EN4raft8distance10initializeERKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ReduceOpT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a8d3c8c84ddc2e9d8fc282a8fc4b787f6"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">initialize</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <a class="reference internal" href="#_CPPv4I0000EN4raft8distance10initializeEvRKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT" title="raft::distance::initialize::OutT"><span class="n"><span class="pre">OutT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">min</span></span>, <a class="reference internal" href="#_CPPv4I0000EN4raft8distance10initializeEvRKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT" title="raft::distance::initialize::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I0000EN4raft8distance10initializeEvRKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT" title="raft::distance::initialize::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">maxVal</span></span>, <a class="reference internal" href="#_CPPv4I0000EN4raft8distance10initializeEvRKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT" title="raft::distance::initialize::ReduceOpT"><span class="n"><span class="pre">ReduceOpT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">redOp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN4raft8distance10initializeEvRKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Initialize array using init value from reduction op </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t">
<span id="_CPPv3I00000EN4raft8distance9fusedL2NNEP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t"></span><span id="_CPPv2I00000EN4raft8distance9fusedL2NNEP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ReduceOpT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">KVPReduceOpT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a00a2383d2785d2962b7ea2e01ee5d491"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fusedL2NN</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::OutT"><span class="n"><span class="pre">OutT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">min</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">xn</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">yn</span></span>, <a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">workspace</span></span>, <a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::ReduceOpT"><span class="n"><span class="pre">ReduceOpT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">redOp</span></span>, <a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::KVPReduceOpT"><span class="n"><span class="pre">KVPReduceOpT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pairRedOp</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sqrt</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">initOutBuffer</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Fused L2 distance and 1-nearest-neighbor computation in a single call. </p>
<p>The benefits of such a call are 2-fold: 1) eliminate the need for an intermediate buffer to store the output of gemm 2) reduce the memory read traffic on this intermediate buffer, otherwise needed during the reduction phase for 1-NN.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DataT</strong> &ndash; data type </p></li>
<li><p><strong>OutT</strong> &ndash; output type to either store 1-NN indices and their minimum distances or store only the min distances. Accordingly, one has to pass an appropriate <code class="docutils literal notranslate"><span class="pre">ReduceOpT</span></code> </p></li>
<li><p><strong>IdxT</strong> &ndash; indexing arithmetic type </p></li>
<li><p><strong>ReduceOpT</strong> &ndash; A struct to perform the final needed reduction operation and also to initialize the output array elements with the appropriate initial value needed for reduction.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>min</strong> &ndash; <strong>[out]</strong> will contain the reduced output (Length = <code class="docutils literal notranslate"><span class="pre">m</span></code>) (on device) </p></li>
<li><p><strong>x</strong> &ndash; <strong>[in]</strong> first matrix. Row major. Dim = <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">x</span> <span class="pre">k</span></code>. (on device). </p></li>
<li><p><strong>y</strong> &ndash; <strong>[in]</strong> second matrix. Row major. Dim = <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">x</span> <span class="pre">k</span></code>. (on device). </p></li>
<li><p><strong>xn</strong> &ndash; <strong>[in]</strong> L2 squared norm of <code class="docutils literal notranslate"><span class="pre">x</span></code>. Length = <code class="docutils literal notranslate"><span class="pre">m</span></code>. (on device). </p></li>
<li><p><strong>yn</strong> &ndash; <strong>[in]</strong> L2 squared norm of <code class="docutils literal notranslate"><span class="pre">y</span></code>. Length = <code class="docutils literal notranslate"><span class="pre">n</span></code>. (on device) </p></li>
<li><p><strong>m</strong> &ndash; <strong>[in]</strong> gemm m </p></li>
<li><p><strong>n</strong> &ndash; <strong>[in]</strong> gemm n </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> gemm k </p></li>
<li><p><strong>workspace</strong> &ndash; <strong>[in]</strong> temp workspace. Size = sizeof(int)*m. (on device) </p></li>
<li><p><strong>redOp</strong> &ndash; <strong>[in]</strong> reduction operator in the epilogue </p></li>
<li><p><strong>pairRedOp</strong> &ndash; <strong>[in]</strong> reduction operation on key value pairs </p></li>
<li><p><strong>sqrt</strong> &ndash; <strong>[in]</strong> Whether the output <code class="docutils literal notranslate"><span class="pre">minDist</span></code> should contain L2-sqrt </p></li>
<li><p><strong>initOutBuffer</strong> &ndash; <strong>[in]</strong> whether to initialize the output buffer before the main kernel launch </p></li>
<li><p><strong>stream</strong> &ndash; <strong>[in]</strong> cuda stream </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN4raft8distance18fusedL2NNMinReduceEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t">
<span id="_CPPv3I000EN4raft8distance18fusedL2NNMinReduceEP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t"></span><span id="_CPPv2I000EN4raft8distance18fusedL2NNMinReduceEP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1ab098dd70824e421df18fc90ff3e17a9a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fusedL2NNMinReduce</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I000EN4raft8distance18fusedL2NNMinReduceEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="raft::distance::fusedL2NNMinReduce::OutT"><span class="n"><span class="pre">OutT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">min</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance18fusedL2NNMinReduceEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="raft::distance::fusedL2NNMinReduce::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance18fusedL2NNMinReduceEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="raft::distance::fusedL2NNMinReduce::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance18fusedL2NNMinReduceEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="raft::distance::fusedL2NNMinReduce::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">xn</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance18fusedL2NNMinReduceEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="raft::distance::fusedL2NNMinReduce::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">yn</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft8distance18fusedL2NNMinReduceEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="raft::distance::fusedL2NNMinReduce::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft8distance18fusedL2NNMinReduceEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="raft::distance::fusedL2NNMinReduce::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft8distance18fusedL2NNMinReduceEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="raft::distance::fusedL2NNMinReduce::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">workspace</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sqrt</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">initOutBuffer</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN4raft8distance18fusedL2NNMinReduceEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPvbb12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Wrapper around fusedL2NN with minimum reduction operators. </p>
<p>fusedL2NN cannot be compiled in the distance library due to the lambda operators, so this wrapper covers the most common case (minimum). This should be preferred to the more generic API when possible, in order to reduce compilation times for users of the shared library.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DataT</strong> &ndash; data type </p></li>
<li><p><strong>OutT</strong> &ndash; output type to either store 1-NN indices and their minimum distances (e.g. cub::KeyValuePair&lt;int, float&gt;) or store only the min distances. </p></li>
<li><p><strong>IdxT</strong> &ndash; indexing arithmetic type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>min</strong> &ndash; <strong>[out]</strong> will contain the reduced output (Length = <code class="docutils literal notranslate"><span class="pre">m</span></code>) (on device) </p></li>
<li><p><strong>x</strong> &ndash; <strong>[in]</strong> first matrix. Row major. Dim = <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">x</span> <span class="pre">k</span></code>. (on device). </p></li>
<li><p><strong>y</strong> &ndash; <strong>[in]</strong> second matrix. Row major. Dim = <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">x</span> <span class="pre">k</span></code>. (on device). </p></li>
<li><p><strong>xn</strong> &ndash; <strong>[in]</strong> L2 squared norm of <code class="docutils literal notranslate"><span class="pre">x</span></code>. Length = <code class="docutils literal notranslate"><span class="pre">m</span></code>. (on device). </p></li>
<li><p><strong>yn</strong> &ndash; <strong>[in]</strong> L2 squared norm of <code class="docutils literal notranslate"><span class="pre">y</span></code>. Length = <code class="docutils literal notranslate"><span class="pre">n</span></code>. (on device) </p></li>
<li><p><strong>m</strong> &ndash; <strong>[in]</strong> gemm m </p></li>
<li><p><strong>n</strong> &ndash; <strong>[in]</strong> gemm n </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> gemm k </p></li>
<li><p><strong>workspace</strong> &ndash; <strong>[in]</strong> temp workspace. Size = sizeof(int)*m. (on device) </p></li>
<li><p><strong>sqrt</strong> &ndash; <strong>[in]</strong> Whether the output <code class="docutils literal notranslate"><span class="pre">minDist</span></code> should contain L2-sqrt </p></li>
<li><p><strong>initOutBuffer</strong> &ndash; <strong>[in]</strong> whether to initialize the output buffer before the main kernel launch </p></li>
<li><p><strong>stream</strong> &ndash; <strong>[in]</strong> cuda stream </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance7runtimeE">
<span id="_CPPv3N4raft8distance7runtimeE"></span><span id="_CPPv2N4raft8distance7runtimeE"></span><span id="raft::distance::runtime"></span><span class="target" id="namespaceraft_1_1distance_1_1runtime"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">runtime</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance7runtimeE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPfPfPfiiiN4raft8distance12DistanceTypeEbf">
<span id="_CPPv3N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPfPfPfiiiN4raft8distance12DistanceTypeEbf"></span><span id="_CPPv2N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPfPfPfiiiN4raft8distance12DistanceTypeEbf"></span><span id="raft::distance::runtime::pairwise_distance__raft::handle_tCR.floatP.floatP.floatP.i.i.i.raft::distance::DistanceType.b.float"></span><span class="target" id="namespaceraft_1_1distance_1_1runtime_1a0913983595ea9ae13af305048cd3d2d7"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pairwise_distance</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dists</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">isRowMajor</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPfPfPfiiiN4raft8distance12DistanceTypeEbf" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPdPdPdiiiN4raft8distance12DistanceTypeEbf">
<span id="_CPPv3N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPdPdPdiiiN4raft8distance12DistanceTypeEbf"></span><span id="_CPPv2N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPdPdPdiiiN4raft8distance12DistanceTypeEbf"></span><span id="raft::distance::runtime::pairwise_distance__raft::handle_tCR.doubleP.doubleP.doubleP.i.i.i.raft::distance::DistanceType.b.float"></span><span class="target" id="namespaceraft_1_1distance_1_1runtime_1a58e6972cd916cd9a70d35907181036f4"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pairwise_distance</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dists</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">isRowMajor</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPdPdPdiiiN4raft8distance12DistanceTypeEbf" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
<section id="nearest-neighbors">
<h2>Nearest Neighbors<a class="headerlink" href="#nearest-neighbors" title="Permalink to this heading">&para;</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>doxygenfunction: Unable to resolve function &ldquo;raft::spatial::knn::brute_force_knn&rdquo; with arguments None in doxygen xml output for project &ldquo;RAFT&rdquo; from directory: ../../cpp/build/xml/.
Potential matches:
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">template</span><span class="o">&lt;</span><span class="n">typename</span> <span class="n">idx_t</span> <span class="o">=</span> <span class="n">std</span><span class="p">::</span><span class="n">int64_t</span><span class="p">,</span> <span class="n">typename</span> <span class="n">value_t</span> <span class="o">=</span> <span class="nb">float</span><span class="p">,</span> <span class="n">typename</span> <span class="n">value_int</span> <span class="o">=</span> <span class="nb">int</span><span class="o">&gt;</span> <span class="n">void</span> <span class="n">brute_force_knn</span><span class="p">(</span><span class="n">raft</span><span class="p">::</span><span class="n">handle_t</span> <span class="n">const</span> <span class="o">&amp;</span><span class="n">handle</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">value_t</span><span class="o">*&gt;</span> <span class="o">&amp;</span><span class="nb">input</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">value_int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">sizes</span><span class="p">,</span> <span class="n">value_int</span> <span class="n">D</span><span class="p">,</span> <span class="n">value_t</span> <span class="o">*</span><span class="n">search_items</span><span class="p">,</span> <span class="n">value_int</span> <span class="n">n</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">res_I</span><span class="p">,</span> <span class="n">value_t</span> <span class="o">*</span><span class="n">res_D</span><span class="p">,</span> <span class="n">value_int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">bool</span> <span class="n">rowMajorIndex</span> <span class="o">=</span> <span class="n">true</span><span class="p">,</span> <span class="nb">bool</span> <span class="n">rowMajorQuery</span> <span class="o">=</span> <span class="n">true</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">idx_t</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">translations</span> <span class="o">=</span> <span class="n">nullptr</span><span class="p">,</span> <span class="n">distance</span><span class="p">::</span><span class="n">DistanceType</span> <span class="n">metric</span> <span class="o">=</span> <span class="n">distance</span><span class="p">::</span><span class="n">DistanceType</span><span class="p">::</span><span class="n">L2Unexpanded</span><span class="p">,</span> <span class="nb">float</span> <span class="n">metric_arg</span> <span class="o">=</span> <span class="mf">2.0</span><span class="n">f</span><span class="p">)</span>
<span class="o">-</span> <span class="n">template</span><span class="o">&lt;</span><span class="n">typename</span> <span class="n">idx_t</span><span class="p">,</span> <span class="n">typename</span> <span class="n">value_t</span><span class="p">,</span> <span class="n">typename</span> <span class="n">value_int</span><span class="p">,</span> <span class="n">typename</span> <span class="n">matrix_idx</span><span class="p">,</span> <span class="n">typename</span> <span class="n">index_layout</span><span class="p">,</span> <span class="n">typename</span> <span class="n">search_layout</span><span class="o">&gt;</span> <span class="n">void</span> <span class="n">brute_force_knn</span><span class="p">(</span><span class="n">raft</span><span class="p">::</span><span class="n">handle_t</span> <span class="n">const</span> <span class="o">&amp;</span><span class="n">handle</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">raft</span><span class="p">::</span><span class="n">device_matrix_view</span><span class="o">&lt;</span><span class="n">const</span> <span class="n">value_t</span><span class="p">,</span> <span class="n">matrix_idx</span><span class="p">,</span> <span class="n">index_layout</span><span class="o">&gt;&gt;</span> <span class="n">index</span><span class="p">,</span> <span class="n">raft</span><span class="p">::</span><span class="n">device_matrix_view</span><span class="o">&lt;</span><span class="n">const</span> <span class="n">value_t</span><span class="p">,</span> <span class="n">matrix_idx</span><span class="p">,</span> <span class="n">search_layout</span><span class="o">&gt;</span> <span class="n">search</span><span class="p">,</span> <span class="n">raft</span><span class="p">::</span><span class="n">device_matrix_view</span><span class="o">&lt;</span><span class="n">idx_t</span><span class="p">,</span> <span class="n">matrix_idx</span><span class="p">,</span> <span class="n">row_major</span><span class="o">&gt;</span> <span class="n">indices</span><span class="p">,</span> <span class="n">raft</span><span class="p">::</span><span class="n">device_matrix_view</span><span class="o">&lt;</span><span class="n">value_t</span><span class="p">,</span> <span class="n">matrix_idx</span><span class="p">,</span> <span class="n">row_major</span><span class="o">&gt;</span> <span class="n">distances</span><span class="p">,</span> <span class="n">value_int</span> <span class="n">k</span><span class="p">,</span> <span class="n">distance</span><span class="p">::</span><span class="n">DistanceType</span> <span class="n">metric</span> <span class="o">=</span> <span class="n">distance</span><span class="p">::</span><span class="n">DistanceType</span><span class="p">::</span><span class="n">L2Unexpanded</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">optional</span><span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span> <span class="n">metric_arg</span> <span class="o">=</span> <span class="n">std</span><span class="p">::</span><span class="n">make_optional</span><span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">2.0</span><span class="n">f</span><span class="p">),</span> <span class="n">std</span><span class="p">::</span><span class="n">optional</span><span class="o">&lt;</span><span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">idx_t</span><span class="o">&gt;&gt;</span> <span class="n">translations</span> <span class="o">=</span> <span class="n">std</span><span class="p">::</span><span class="n">nullopt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn8select_kEvPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo">
<span id="_CPPv3I00EN4raft7spatial3knn8select_kEPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo"></span><span id="_CPPv2I00EN4raft7spatial3knn8select_kEPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1a2bebc4f0961322d8ee90a278d545c3c9"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">spatial</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">knn</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">select_k</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8select_kEvPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo" title="raft::spatial::knn::select_k::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">in_keys</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8select_kEvPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo" title="raft::spatial::knn::select_k::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">in_values</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_inputs</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">input_len</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8select_kEvPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo" title="raft::spatial::knn::select_k::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_keys</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8select_kEvPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo" title="raft::spatial::knn::select_k::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_values</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">select_min</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span>, <span class="n"><span class="pre">SelectKAlgo</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">algo</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">SelectKAlgo</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">FAISS</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn8select_kEvPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Select k smallest or largest key/values from each row in the input data.</p>
<p>If you think of the input data <code class="docutils literal notranslate"><span class="pre">in_keys</span></code> as a row-major matrix with input_len columns and n_inputs rows, then this function selects k smallest/largest values in each row and fills in the row-major matrix <code class="docutils literal notranslate"><span class="pre">out_keys</span></code> of size (n_inputs, k).</p>
<p>Note, depending on the selected algorithm, the values within rows of <code class="docutils literal notranslate"><span class="pre">out_keys</span></code> are not necessarily sorted. See the <code class="docutils literal notranslate"><span class="pre">SelectKAlgo</span></code> enumeration for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx_t</strong> &ndash; the payload type (what is being selected together with the keys). </p></li>
<li><p><strong>value_t</strong> &ndash; the type of the keys (what is being compared).</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>in_keys</strong> &ndash; <strong>[in]</strong> contiguous device array of inputs of size (input_len * n_inputs); these are compared and selected. </p></li>
<li><p><strong>in_values</strong> &ndash; <strong>[in]</strong> contiguous device array of inputs of size (input_len * n_inputs); typically, these are indices of the corresponding in_keys. You can pass <code class="docutils literal notranslate"><span class="pre">NULL</span></code> as an argument here; this would imply <code class="docutils literal notranslate"><span class="pre">in_values</span></code> is a homogeneous array of indices from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">input_len</span> <span class="pre">-</span> <span class="pre">1</span></code> for every input and reduce the usage of memory bandwidth. </p></li>
<li><p><strong>n_inputs</strong> &ndash; <strong>[in]</strong> number of input rows, i.e. the batch size. </p></li>
<li><p><strong>input_len</strong> &ndash; <strong>[in]</strong> length of a single input array (row); also sometimes referred as n_cols. Invariant: input_len &gt;= k. </p></li>
<li><p><strong>out_keys</strong> &ndash; <strong>[out]</strong> contiguous device array of outputs of size (k * n_inputs); the k smallest/largest values from each row of the <code class="docutils literal notranslate"><span class="pre">in_keys</span></code>. </p></li>
<li><p><strong>out_values</strong> &ndash; <strong>[out]</strong> contiguous device array of outputs of size (k * n_inputs); the payload selected together with <code class="docutils literal notranslate"><span class="pre">out_keys</span></code>. </p></li>
<li><p><strong>select_min</strong> &ndash; <strong>[in]</strong> whether to select k smallest (true) or largest (false) keys. </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> the number of outputs to select in each input row. </p></li>
<li><p><strong>stream</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>algo</strong> &ndash; <strong>[in]</strong> the implementation of the algorithm </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>doxygenfunction: Unable to resolve function &ldquo;raft::spatial::knn::knn_merge_parts&rdquo; with arguments None in doxygen xml output for project &ldquo;RAFT&rdquo; from directory: ../../cpp/build/xml/.
Potential matches:
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">template</span><span class="o">&lt;</span><span class="n">typename</span> <span class="n">idx_t</span> <span class="o">=</span> <span class="n">int64_t</span><span class="p">,</span> <span class="n">typename</span> <span class="n">value_t</span> <span class="o">=</span> <span class="nb">float</span><span class="o">&gt;</span> <span class="n">void</span> <span class="n">knn_merge_parts</span><span class="p">(</span><span class="n">value_t</span> <span class="o">*</span><span class="n">in_keys</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">in_values</span><span class="p">,</span> <span class="n">value_t</span> <span class="o">*</span><span class="n">out_keys</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">out_values</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">n_samples</span><span class="p">,</span> <span class="nb">int</span> <span class="n">n_parts</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="n">cudaStream_t</span> <span class="n">stream</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">translations</span><span class="p">)</span>
<span class="o">-</span> <span class="n">template</span><span class="o">&lt;</span><span class="n">typename</span> <span class="n">idx_t</span><span class="p">,</span> <span class="n">typename</span> <span class="n">value_t</span><span class="o">&gt;</span> <span class="n">void</span> <span class="n">knn_merge_parts</span><span class="p">(</span><span class="n">const</span> <span class="n">raft</span><span class="p">::</span><span class="n">handle_t</span> <span class="o">&amp;</span><span class="n">handle</span><span class="p">,</span> <span class="n">raft</span><span class="p">::</span><span class="n">device_matrix_view</span><span class="o">&lt;</span><span class="n">const</span> <span class="n">value_t</span><span class="p">,</span> <span class="n">idx_t</span><span class="p">,</span> <span class="n">row_major</span><span class="o">&gt;</span> <span class="n">in_keys</span><span class="p">,</span> <span class="n">raft</span><span class="p">::</span><span class="n">device_matrix_view</span><span class="o">&lt;</span><span class="n">const</span> <span class="n">idx_t</span><span class="p">,</span> <span class="n">idx_t</span><span class="p">,</span> <span class="n">row_major</span><span class="o">&gt;</span> <span class="n">in_values</span><span class="p">,</span> <span class="n">raft</span><span class="p">::</span><span class="n">device_matrix_view</span><span class="o">&lt;</span><span class="n">value_t</span><span class="p">,</span> <span class="n">idx_t</span><span class="p">,</span> <span class="n">row_major</span><span class="o">&gt;</span> <span class="n">out_keys</span><span class="p">,</span> <span class="n">raft</span><span class="p">::</span><span class="n">device_matrix_view</span><span class="o">&lt;</span><span class="n">idx_t</span><span class="p">,</span> <span class="n">idx_t</span><span class="p">,</span> <span class="n">row_major</span><span class="o">&gt;</span> <span class="n">out_values</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">std</span><span class="p">::</span><span class="n">optional</span><span class="o">&lt;</span><span class="n">raft</span><span class="p">::</span><span class="n">device_vector_view</span><span class="o">&lt;</span><span class="n">idx_t</span><span class="p">,</span> <span class="n">idx_t</span><span class="o">&gt;&gt;</span> <span class="n">translations</span> <span class="o">=</span> <span class="n">std</span><span class="p">::</span><span class="n">nullopt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="ivf-flat">
<h3>IVF-Flat<a class="headerlink" href="#ivf-flat" title="Permalink to this heading">&para;</a></h3>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flatE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flatE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flatE"></span><span id="raft::spatial::knn::ivf_flat"></span><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ivf_flat</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flatE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t">
<span id="_CPPv3I00EN4raft7spatial3knn8ivf_flat5buildERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t"></span><span id="_CPPv2I00EN4raft7spatial3knn8ivf_flat5buildERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1ad50e858132aa3fecc6ddae2b45973090"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">build</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn8ivf_flat12index_paramsE" title="raft::spatial::knn::ivf_flat::index_params"><span class="n"><span class="pre">index_params</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::spatial::knn::ivf_flat::build::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dataset</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::spatial::knn::ivf_flat::build::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_rows</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::spatial::knn::ivf_flat::build::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::spatial::knn::ivf_flat::build::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Build the index from the dataset for efficient search. </p>
<p>NB: Currently, the following distance metrics are supported:</p><ul class="simple">
<li><p>L2Expanded</p></li>
<li><p>L2Unexpanded</p></li>
<li><p>InnerProduct</p></li>
</ul>
<p></p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">spatial</span><span class="o">::</span><span class="nn">knn</span><span class="p">;</span><span class="w"></span>
<span class="c1">// use default index parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// create and fill the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">);</span><span class="w"></span>
<span class="c1">// use default search parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search_params</span><span class="w"> </span><span class="n">search_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// search K nearest neighbours for each of the N queries</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>params</strong> &ndash; <strong>[in]</strong> configure the index building </p></li>
<li><p><strong>dataset</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, dim] </p></li>
<li><p><strong>n_rows</strong> &ndash; <strong>[in]</strong> the number of samples </p></li>
<li><p><strong>dim</strong> &ndash; <strong>[in]</strong> the dimensionality of the data</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the constructed ivf-flat index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn8ivf_flat11build_indexE5indexI7value_t5idx_tERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params">
<span id="_CPPv3I00EN4raft7spatial3knn8ivf_flat11build_indexERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params"></span><span id="_CPPv2I00EN4raft7spatial3knn8ivf_flat11build_indexERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1acb660735fbe4471a8c9722e7b5151606"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">build_index</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat11build_indexE5indexI7value_t5idx_tERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params" title="raft::spatial::knn::ivf_flat::build_index::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat11build_indexE5indexI7value_t5idx_tERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params" title="raft::spatial::knn::ivf_flat::build_index::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">row_major</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dataset</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn8ivf_flat12index_paramsE" title="raft::spatial::knn::ivf_flat::index_params"><span class="n"><span class="pre">index_params</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat11build_indexE5indexI7value_t5idx_tERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params" title="raft::spatial::knn::ivf_flat::build_index::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat11build_indexE5indexI7value_t5idx_tERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params" title="raft::spatial::knn::ivf_flat::build_index::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat11build_indexE5indexI7value_t5idx_tERK8handle_tN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEERK12index_params" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Build the index from the dataset for efficient search. </p>
<p>NB: Currently, the following distance metrics are supported:</p><ul class="simple">
<li><p>L2Expanded</p></li>
<li><p>L2Unexpanded</p></li>
<li><p>InnerProduct</p></li>
</ul>
<p></p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">spatial</span><span class="o">::</span><span class="nn">knn</span><span class="p">;</span><span class="w"></span>
<span class="c1">// use default index parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// create and fill the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">);</span><span class="w"></span>
<span class="c1">// use default search parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search_params</span><span class="w"> </span><span class="n">search_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// search K nearest neighbours for each of the N queries</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_t</strong> &ndash; data element type </p></li>
<li><p><strong>idx_t</strong> &ndash; type of the indices in the source dataset </p></li>
<li><p><strong>int_t</strong> &ndash; precision / type of integral arguments </p></li>
<li><p><strong>matrix_idx_t</strong> &ndash; matrix indexing type</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>params</strong> &ndash; <strong>[in]</strong> configure the index building </p></li>
<li><p><strong>dataset</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, dim]</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the constructed ivf-flat index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT">
<span id="_CPPv3I00EN4raft7spatial3knn8ivf_flat6extendERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT"></span><span id="_CPPv2I00EN4raft7spatial3knn8ivf_flat6extendERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1a424709dd33226264363e5d84f4fead28"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">extend</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">orig_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_vectors</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_indices</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_rows</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Build a new index containing the data of the original plus new extra vectors. </p>
<p>Implementation note: The new data is clustered according to existing kmeans clusters, then the cluster centers are adjusted to match the newly labeled data.</p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">spatial</span><span class="o">::</span><span class="nn">knn</span><span class="p">;</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="n">index_params</span><span class="p">.</span><span class="n">add_data_on_build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">      </span><span class="c1">// don't populate index on build</span>
<span class="n">index_params</span><span class="p">.</span><span class="n">kmeans_trainset_fraction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"> </span><span class="c1">// use whole dataset for kmeans training</span>
<span class="c1">// train the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index_empty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">);</span><span class="w"></span>
<span class="c1">// fill the index with the data</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">extend</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_empty</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>orig_index</strong> &ndash; <strong>[in]</strong> original index </p></li>
<li><p><strong>new_vectors</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, <a class="reference internal" href="#structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1ab05e320b6d58148cc24bab005247bbf9"><span class="std std-ref">index.dim()</span></a>] </p></li>
<li><p><strong>new_indices</strong> &ndash; <strong>[in]</strong> a device pointer to a vector of indices [n_rows]. If the original index is empty (<code class="docutils literal notranslate"><span class="pre">orig_index.size()</span> <span class="pre">==</span> <span class="pre">0</span></code>), you can pass <code class="docutils literal notranslate"><span class="pre">nullptr</span></code> here to imply a continuous range <code class="docutils literal notranslate"><span class="pre">[0...n_rows)</span></code>. </p></li>
<li><p><strong>n_rows</strong> &ndash; <strong>[in]</strong> number of rows in <code class="docutils literal notranslate"><span class="pre">new_vectors</span></code></p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the constructed extended ivf-flat index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE">
<span id="_CPPv3I00EN4raft7spatial3knn8ivf_flat6extendERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE"></span><span id="_CPPv2I00EN4raft7spatial3knn8ivf_flat6extendERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1aca6ebbc32d7eca9b7f9b9e617579cfa4"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">extend</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::spatial::knn::ivf_flat::extend::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::spatial::knn::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">orig_index</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::spatial::knn::ivf_flat::extend::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::spatial::knn::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">row_major</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">new_vectors</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_vector_view</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::spatial::knn::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::spatial::knn::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">new_indices</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">nullopt</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::spatial::knn::ivf_flat::extend::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::spatial::knn::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI7value_t5idx_tERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Build a new index containing the data of the original plus new extra vectors. </p>
<p>Implementation note: The new data is clustered according to existing kmeans clusters, then the cluster centers are adjusted to match the newly labeled data.</p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">spatial</span><span class="o">::</span><span class="nn">knn</span><span class="p">;</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="n">index_params</span><span class="p">.</span><span class="n">add_data_on_build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">      </span><span class="c1">// don't populate index on build</span>
<span class="n">index_params</span><span class="p">.</span><span class="n">kmeans_trainset_fraction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"> </span><span class="c1">// use whole dataset for kmeans training</span>
<span class="c1">// train the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index_empty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">);</span><span class="w"></span>
<span class="c1">// fill the index with the data</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">extend</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_empty</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_t</strong> &ndash; data element type </p></li>
<li><p><strong>idx_t</strong> &ndash; type of the indices in the source dataset </p></li>
<li><p><strong>int_t</strong> &ndash; precision / type of integral arguments </p></li>
<li><p><strong>matrix_idx_t</strong> &ndash; matrix indexing type</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>orig_index</strong> &ndash; <strong>[in]</strong> original index </p></li>
<li><p><strong>new_vectors</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, <a class="reference internal" href="#structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1ab05e320b6d58148cc24bab005247bbf9"><span class="std std-ref">index.dim()</span></a>] </p></li>
<li><p><strong>new_indices</strong> &ndash; <strong>[in]</strong> a device pointer to a vector of indices [n_rows]. If the original index is empty (<code class="docutils literal notranslate"><span class="pre">orig_index.size()</span> <span class="pre">==</span> <span class="pre">0</span></code>), you can pass <code class="docutils literal notranslate"><span class="pre">nullptr</span></code> here to imply a continuous range <code class="docutils literal notranslate"><span class="pre">[0...n_rows)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the constructed extended ivf-flat index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT">
<span id="_CPPv3I00EN4raft7spatial3knn8ivf_flat6extendERK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT"></span><span id="_CPPv2I00EN4raft7spatial3knn8ivf_flat6extendERK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1a3f2c7e97bf349a11e80fd779d02ff8d6"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">extend</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_vectors</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_indices</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Extend the index with the new data. *. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; </p></li>
<li><p><strong>index</strong> &ndash; <strong>[inout]</strong> </p></li>
<li><p><strong>new_vectors</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, <a class="reference internal" href="#structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1ab05e320b6d58148cc24bab005247bbf9"><span class="std std-ref">index.dim()</span></a>] </p></li>
<li><p><strong>new_indices</strong> &ndash; <strong>[in]</strong> a device pointer to a vector of indices [n_rows]. If the original index is empty (<code class="docutils literal notranslate"><span class="pre">orig_index.size()</span> <span class="pre">==</span> <span class="pre">0</span></code>), you can pass <code class="docutils literal notranslate"><span class="pre">nullptr</span></code> here to imply a continuous range <code class="docutils literal notranslate"><span class="pre">[0...n_rows)</span></code>. </p></li>
<li><p><strong>n_rows</strong> &ndash; <strong>[in]</strong> the number of samples </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE">
<span id="_CPPv3I00EN4raft7spatial3knn8ivf_flat6extendERK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE"></span><span id="_CPPv2I00EN4raft7spatial3knn8ivf_flat6extendERK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1ae11e96f5f71472b6bfcc7602d3bdfedc"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">extend</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::spatial::knn::ivf_flat::extend::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::spatial::knn::ivf_flat::extend::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::spatial::knn::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">index</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::spatial::knn::ivf_flat::extend::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::spatial::knn::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">row_major</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">new_vectors</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_vector_view</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::spatial::knn::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="raft::spatial::knn::ivf_flat::extend::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">new_indices</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">nullopt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendEvRK8handle_tP5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEENSt8optionalIN4raft18device_vector_viewIK5idx_t5idx_tEEEE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Extend the index with the new data. *. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_t</strong> &ndash; data element type </p></li>
<li><p><strong>idx_t</strong> &ndash; type of the indices in the source dataset </p></li>
<li><p><strong>int_t</strong> &ndash; precision / type of integral arguments </p></li>
<li><p><strong>matrix_idx_t</strong> &ndash; matrix indexing type</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>index</strong> &ndash; <strong>[inout]</strong> </p></li>
<li><p><strong>new_vectors</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, <a class="reference internal" href="#structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1ab05e320b6d58148cc24bab005247bbf9"><span class="std std-ref">index.dim()</span></a>] </p></li>
<li><p><strong>new_indices</strong> &ndash; <strong>[in]</strong> a device pointer to a vector of indices [n_rows]. If the original index is empty (<code class="docutils literal notranslate"><span class="pre">orig_index.size()</span> <span class="pre">==</span> <span class="pre">0</span></code>), you can pass <code class="docutils literal notranslate"><span class="pre">std::nullopt</span></code> here to imply a continuous range <code class="docutils literal notranslate"><span class="pre">[0...n_rows)</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE">
<span id="_CPPv3I00EN4raft7spatial3knn8ivf_flat6searchERK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE"></span><span id="_CPPv2I00EN4raft7spatial3knn8ivf_flat6searchERK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1a8581684992f1669e42ec02c09c8347ee"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">search</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn8ivf_flat13search_paramsE" title="raft::spatial::knn::ivf_flat::search_params"><span class="n"><span class="pre">search_params</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::spatial::knn::ivf_flat::search::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::spatial::knn::ivf_flat::search::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::spatial::knn::ivf_flat::search::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::spatial::knn::ivf_flat::search::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">queries</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_queries</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::spatial::knn::ivf_flat::search::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">neighbors</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">distances</span></span>, <span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mr</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_memory_resource</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">mr</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Search ANN using the constructed index. </p>
<p>See the <a class="reference external" href="#ivf_flat::build">ivf_flat::build</a> documentation for a usage example.</p>
<p>Note, this function requires a temporary buffer to store intermediate results between cuda kernel calls, which may lead to undesirable allocations and slowdown. To alleviate the problem, you can pass a pool memory resource or a large enough pre-allocated memory resource to reduce or eliminate entirely allocations happening within <code class="docutils literal notranslate"><span class="pre">search</span></code>: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="p">...</span><span class="w"></span>
<span class="c1">// Create a pooling memory resource with a pre-defined initial size.</span>
<span class="n">rmm</span><span class="o">::</span><span class="n">mr</span><span class="o">::</span><span class="n">pool_memory_resource</span><span class="o">&lt;</span><span class="n">rmm</span><span class="o">::</span><span class="n">mr</span><span class="o">::</span><span class="n">device_memory_resource</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mr</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="n">rmm</span><span class="o">::</span><span class="n">mr</span><span class="o">::</span><span class="n">get_current_device_resource</span><span class="p">(),</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">);</span><span class="w"></span>
<span class="c1">// use default search parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search_params</span><span class="w"> </span><span class="n">search_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// Use the same allocator across multiple searches to reduce the number of</span>
<span class="c1">// cuda memory allocations</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries1</span><span class="p">,</span><span class="w"> </span><span class="n">N1</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds1</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mr</span><span class="p">);</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries2</span><span class="p">,</span><span class="w"> </span><span class="n">N2</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds2</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists2</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mr</span><span class="p">);</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries3</span><span class="p">,</span><span class="w"> </span><span class="n">N3</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds3</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists3</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mr</span><span class="p">);</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
</pre></div>
</div>
 The exact size of the temporary buffer depends on multiple factors and is an implementation detail. However, you can safely specify a small initial size for the memory pool, so that only a few allocations happen to grow it during the first invocations of the <code class="docutils literal notranslate"><span class="pre">search</span></code>.<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>params</strong> &ndash; <strong>[in]</strong> configure the search </p></li>
<li><p><strong>index</strong> &ndash; <strong>[in]</strong> ivf-flat constructed index </p></li>
<li><p><strong>queries</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_queries, index-&gt;dim()] </p></li>
<li><p><strong>n_queries</strong> &ndash; <strong>[in]</strong> the batch size </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> the number of neighbors to find for each query. </p></li>
<li><p><strong>neighbors</strong> &ndash; <strong>[out]</strong> a device pointer to the indices of the neighbors in the source dataset [n_queries, k] </p></li>
<li><p><strong>distances</strong> &ndash; <strong>[out]</strong> a device pointer to the distances to the selected neighbors [n_queries, k] </p></li>
<li><p><strong>mr</strong> &ndash; <strong>[in]</strong> an optional memory resource to use across the searches (you can provide a large enough memory pool here to avoid memory allocations within search). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_tfEERK13search_params5int_t">
<span id="_CPPv3I000EN4raft7spatial3knn8ivf_flat6searchERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_tfEERK13search_params5int_t"></span><span id="_CPPv2I000EN4raft7spatial3knn8ivf_flat6searchERK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_tfEERK13search_params5int_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">int_t</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1ac6edcc1ff7b5fbf346f3f34defb93170"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">search</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_tfEERK13search_params5int_t" title="raft::spatial::knn::ivf_flat::search::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_tfEERK13search_params5int_t" title="raft::spatial::knn::ivf_flat::search::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_tfEERK13search_params5int_t" title="raft::spatial::knn::ivf_flat::search::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">index</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_tfEERK13search_params5int_t" title="raft::spatial::knn::ivf_flat::search::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_tfEERK13search_params5int_t" title="raft::spatial::knn::ivf_flat::search::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">row_major</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">queries</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_tfEERK13search_params5int_t" title="raft::spatial::knn::ivf_flat::search::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_tfEERK13search_params5int_t" title="raft::spatial::knn::ivf_flat::search::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">row_major</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">neighbors</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_tfEERK13search_params5int_t" title="raft::spatial::knn::ivf_flat::search::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_tfEERK13search_params5int_t" title="raft::spatial::knn::ivf_flat::search::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">distances</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn8ivf_flat13search_paramsE" title="raft::spatial::knn::ivf_flat::search_params"><span class="n"><span class="pre">search_params</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_tfEERK13search_params5int_t" title="raft::spatial::knn::ivf_flat::search::int_t"><span class="n"><span class="pre">int_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK5indexI7value_t5idx_tEN4raft18device_matrix_viewIK7value_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_t9row_majorEEN4raft18device_matrix_viewI5idx_t5idx_tfEERK13search_params5int_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Search ANN using the constructed index. </p>
<p>See the <a class="reference external" href="#ivf_flat::build">ivf_flat::build</a> documentation for a usage example.</p>
<p>Note, this function requires a temporary buffer to store intermediate results between cuda kernel calls, which may lead to undesirable allocations and slowdown. To alleviate the problem, you can pass a pool memory resource or a large enough pre-allocated memory resource to reduce or eliminate entirely allocations happening within <code class="docutils literal notranslate"><span class="pre">search</span></code>: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="p">...</span><span class="w"></span>
<span class="c1">// Create a pooling memory resource with a pre-defined initial size.</span>
<span class="n">rmm</span><span class="o">::</span><span class="n">mr</span><span class="o">::</span><span class="n">pool_memory_resource</span><span class="o">&lt;</span><span class="n">rmm</span><span class="o">::</span><span class="n">mr</span><span class="o">::</span><span class="n">device_memory_resource</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mr</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="n">rmm</span><span class="o">::</span><span class="n">mr</span><span class="o">::</span><span class="n">get_current_device_resource</span><span class="p">(),</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">);</span><span class="w"></span>
<span class="c1">// use default search parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search_params</span><span class="w"> </span><span class="n">search_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// Use the same allocator across multiple searches to reduce the number of</span>
<span class="c1">// cuda memory allocations</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries1</span><span class="p">,</span><span class="w"> </span><span class="n">N1</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds1</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mr</span><span class="p">);</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries2</span><span class="p">,</span><span class="w"> </span><span class="n">N2</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds2</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists2</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mr</span><span class="p">);</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries3</span><span class="p">,</span><span class="w"> </span><span class="n">N3</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds3</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists3</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mr</span><span class="p">);</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
</pre></div>
</div>
 The exact size of the temporary buffer depends on multiple factors and is an implementation detail. However, you can safely specify a small initial size for the memory pool, so that only a few allocations happen to grow it during the first invocations of the <code class="docutils literal notranslate"><span class="pre">search</span></code>.<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_t</strong> &ndash; data element type </p></li>
<li><p><strong>idx_t</strong> &ndash; type of the indices </p></li>
<li><p><strong>int_t</strong> &ndash; precision / type of integral arguments </p></li>
<li><p><strong>matrix_idx_t</strong> &ndash; matrix indexing type</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>index</strong> &ndash; <strong>[in]</strong> ivf-flat constructed index </p></li>
<li><p><strong>queries</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_queries, index-&gt;dim()] </p></li>
<li><p><strong>neighbors</strong> &ndash; <strong>[out]</strong> a device pointer to the indices of the neighbors in the source dataset [n_queries, k] </p></li>
<li><p><strong>distances</strong> &ndash; <strong>[out]</strong> a device pointer to the distances to the selected neighbors [n_queries, k] </p></li>
<li><p><strong>params</strong> &ndash; <strong>[in]</strong> configure the search </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> the number of neighbors to find for each query. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-variables">Variables</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat15kIndexGroupSizeE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat15kIndexGroupSizeE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat15kIndexGroupSizeE"></span><span id="raft::spatial::knn::ivf_flat::kIndexGroupSize__uint32_t"></span><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1a6319667e75c70a4ad40b77aee54a0c62"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kIndexGroupSize</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">32</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat15kIndexGroupSizeE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Size of the interleaved group (see <code class="docutils literal notranslate"><a class="reference internal" href="#structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1ac66ce132d066c543895323a9cd748802"><span class="std std-ref"><span class="pre">index::data</span></span></a></code> description). </p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE">
<span id="_CPPv3I00EN4raft7spatial3knn8ivf_flat5indexE"></span><span id="_CPPv2I00EN4raft7spatial3knn8ivf_flat5indexE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">spatial</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">knn</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">index</span></span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ivf_flat_types.hpp&gt;</em></div>
<p>IVF-flat index. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset </p></li>
</ul>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft7spatial3knn8ivf_flat5index6veclenEv">
<span id="_CPPv3NK4raft7spatial3knn8ivf_flat5index6veclenEv"></span><span id="_CPPv2NK4raft7spatial3knn8ivf_flat5index6veclenEv"></span><span id="raft::spatial::knn::ivf_flat::index::veclenCCE"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1ad3d1cade935e263203bf10eb18ff8693"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">veclen</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><a class="headerlink" href="#_CPPv4NK4raft7spatial3knn8ivf_flat5index6veclenEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Vectorized load/store size in elements, determines the size of interleaved data chunks.</p>
<p>TODO: in theory, we can lift this to the template parameter and keep it at hardware maximum possible value by padding the <code class="docutils literal notranslate"><span class="pre">dim</span></code> of the data <a class="reference external" href="https://github.com/rapidsai/raft/issues/711">https://github.com/rapidsai/raft/issues/711</a> </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft7spatial3knn8ivf_flat5index6metricEv">
<span id="_CPPv3NK4raft7spatial3knn8ivf_flat5index6metricEv"></span><span id="_CPPv2NK4raft7spatial3knn8ivf_flat5index6metricEv"></span><span id="raft::spatial::knn::ivf_flat::index::metricCCE"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a8302496b75a05c6f76b13b7b93542f84"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metric</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><a class="headerlink" href="#_CPPv4NK4raft7spatial3knn8ivf_flat5index6metricEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Distance metric used for clustering. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index4dataEv">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index4dataEv"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index4dataEv"></span><span id="raft::spatial::knn::ivf_flat::index::data"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1ac66ce132d066c543895323a9cd748802"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">data</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">device_mdspan</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_2d</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">row_major</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index4dataEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Inverted list data [size, dim].</p>
<p>The data consists of the dataset rows, grouped by their labels (into clusters/lists). Within each list (cluster), the data is grouped into blocks of <code class="docutils literal notranslate"><span class="pre">kIndexGroupSize</span></code> interleaved vectors. Note, the total index length is slightly larger than the source dataset length, because each cluster is padded by <code class="docutils literal notranslate"><span class="pre">kIndexGroupSize</span></code> elements.</p>
<p>Interleaving pattern: within groups of <code class="docutils literal notranslate"><span class="pre">kIndexGroupSize</span></code> rows, the data is interleaved with the block size equal to <code class="docutils literal notranslate"><span class="pre">veclen</span> <span class="pre">*</span> <span class="pre">sizeof(T)</span></code>. That is, a chunk of <code class="docutils literal notranslate"><span class="pre">veclen</span></code> consecutive components of one row is followed by a chunk of the same size of the next row, and so on.</p>
<p><strong>Example</strong>: veclen = 2, dim = 6, kIndexGroupSize = 32, list_size = 31 </p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>    <span class="o">-</span>    <span class="p">,</span>    <span class="o">-</span>    <span class="p">,</span>
<span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>    <span class="o">-</span>    <span class="p">,</span>    <span class="o">-</span>    <span class="p">,</span>
<span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>    <span class="o">-</span>    <span class="p">,</span>    <span class="o">-</span>    <span class="p">,</span>
</pre></div>
</div>
 <p></p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index7indicesEv">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index7indicesEv"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index7indicesEv"></span><span id="raft::spatial::knn::ivf_flat::index::indices"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1af2685fe1cbbdf4ab3cf22647668d87e7"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">indices</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">device_mdspan</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_1d</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">row_major</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index7indicesEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Inverted list indices: ids of items in the source data [size] </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index10list_sizesEv">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index10list_sizesEv"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index10list_sizesEv"></span><span id="raft::spatial::knn::ivf_flat::index::list_sizes"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a8ad9d1ea62e9bc5f73296c2eeeeb792b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">list_sizes</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">device_mdspan</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_1d</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">row_major</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index10list_sizesEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Sizes of the lists (clusters) [n_lists] </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index12list_offsetsEv">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index12list_offsetsEv"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index12list_offsetsEv"></span><span id="raft::spatial::knn::ivf_flat::index::list_offsets"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1adc1c059a729cec4d41a02dd7e5499f6f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">list_offsets</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">device_mdspan</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_1d</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">row_major</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index12list_offsetsEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Offsets into the lists [n_lists + 1]. The last value contains the total length of the index. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index7centersEv">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index7centersEv"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index7centersEv"></span><span id="raft::spatial::knn::ivf_flat::index::centers"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a0e8dff09b34c6762ccd18a44e42e7d1f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">centers</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">device_mdspan</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_2d</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">row_major</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index7centersEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>k-means cluster centers corresponding to the lists [n_lists, dim] </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index12center_normsEv">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index12center_normsEv"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index12center_normsEv"></span><span id="raft::spatial::knn::ivf_flat::index::center_norms"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a889c71c1fb82dd83b6f629e3c1ebff0b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">center_norms</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">device_mdspan</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">extent_1d</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">row_major</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index12center_normsEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>(Optional) Precomputed norms of the <code class="docutils literal notranslate"><span class="pre">centers</span></code> w.r.t. the chosen distance metric [n_lists].</p>
<p>NB: this may be empty if the index is empty or if the metric does not require the center norms calculation. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft7spatial3knn8ivf_flat5index4sizeEv">
<span id="_CPPv3NK4raft7spatial3knn8ivf_flat5index4sizeEv"></span><span id="_CPPv2NK4raft7spatial3knn8ivf_flat5index4sizeEv"></span><span id="raft::spatial::knn::ivf_flat::index::sizeCCE"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a00f62f07f48c7ff4dcbf4dc5af7af168"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><a class="headerlink" href="#_CPPv4NK4raft7spatial3knn8ivf_flat5index4sizeEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Total length of the index. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft7spatial3knn8ivf_flat5index3dimEv">
<span id="_CPPv3NK4raft7spatial3knn8ivf_flat5index3dimEv"></span><span id="_CPPv2NK4raft7spatial3knn8ivf_flat5index3dimEv"></span><span id="raft::spatial::knn::ivf_flat::index::dimCCE"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1ab05e320b6d58148cc24bab005247bbf9"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dim</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><a class="headerlink" href="#_CPPv4NK4raft7spatial3knn8ivf_flat5index3dimEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Dimensionality of the data. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft7spatial3knn8ivf_flat5index7n_listsEv">
<span id="_CPPv3NK4raft7spatial3knn8ivf_flat5index7n_listsEv"></span><span id="_CPPv2NK4raft7spatial3knn8ivf_flat5index7n_listsEv"></span><span id="raft::spatial::knn::ivf_flat::index::n_listsCCE"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a472a8f130af116380e1caa8e18828475"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_lists</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><a class="headerlink" href="#_CPPv4NK4raft7spatial3knn8ivf_flat5index7n_listsEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Number of clusters/inverted lists. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index5indexERK8handle_tN4raft8distance12DistanceTypeE8uint32_t8uint32_t">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index5indexERK8handle_tN4raft8distance12DistanceTypeE8uint32_t8uint32_t"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index5indexERK8handle_tN4raft8distance12DistanceTypeE8uint32_t8uint32_t"></span><span id="raft::spatial::knn::ivf_flat::index::index__handle_tCR.raft::distance::DistanceType.uint32_t.uint32_t"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a4b5cf99046dcdf458c6b45bb1f54feb8"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_lists</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index5indexERK8handle_tN4raft8distance12DistanceTypeE8uint32_t8uint32_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Construct an empty index. It needs to be trained and then populated. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index5indexERK8handle_tRK12index_params8uint32_t">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index5indexERK8handle_tRK12index_params8uint32_t"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index5indexERK8handle_tRK12index_params8uint32_t"></span><span id="raft::spatial::knn::ivf_flat::index::index__handle_tCR.index_paramsCR.uint32_t"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1acc04211fb96fea96dbf4e67ee7b4453b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn8ivf_flat12index_paramsE" title="raft::spatial::knn::ivf_flat::index_params"><span class="n"><span class="pre">index_params</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index5indexERK8handle_tRK12index_params8uint32_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Construct an empty index. It needs to be trained and then populated. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index8allocateERK8handle_t4IdxTb">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index8allocateERK8handle_t4IdxTb"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index8allocateERK8handle_t4IdxTb"></span><span id="raft::spatial::knn::ivf_flat::index::allocate__handle_tCR.IdxT.b"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a6cdc5552f6d90cb998239de86cb741d3"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">allocate</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">index_size</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">allocate_center_norms</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index8allocateERK8handle_t4IdxTb" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Replace the content of the index with new uninitialized mdarrays to hold the indicated amount of data. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat12index_paramsE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat12index_paramsE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat12index_paramsE"></span><span id="raft::spatial::knn::ivf_flat::index_params"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_params</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">spatial</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">knn</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">index_params</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat12index_paramsE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ivf_flat_types.hpp&gt;</em></div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat12index_params7n_listsE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat12index_params7n_listsE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat12index_params7n_listsE"></span><span id="raft::spatial::knn::ivf_flat::index_params::n_lists__uint32_t"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index__params_1af8f324b1e79215c4af261a4dc105e085"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_lists</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1024</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat12index_params7n_listsE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>The number of inverted lists (clusters) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat12index_params14kmeans_n_itersE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat12index_params14kmeans_n_itersE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat12index_params14kmeans_n_itersE"></span><span id="raft::spatial::knn::ivf_flat::index_params::kmeans_n_iters__uint32_t"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index__params_1a4d2f2a32ff4a00d9ef2876eae23a6ccf"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kmeans_n_iters</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">20</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat12index_params14kmeans_n_itersE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>The number of iterations searching for kmeans centers (index building). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat12index_params24kmeans_trainset_fractionE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat12index_params24kmeans_trainset_fractionE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat12index_params24kmeans_trainset_fractionE"></span><span id="raft::spatial::knn::ivf_flat::index_params::kmeans_trainset_fraction__double"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index__params_1a047e8ec857677d8cfead647fda9842a7"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kmeans_trainset_fraction</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0.5</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat12index_params24kmeans_trainset_fractionE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>The fraction of data to use during iterative kmeans building. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat13search_paramsE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat13search_paramsE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat13search_paramsE"></span><span id="raft::spatial::knn::ivf_flat::search_params"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1search__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">search_params</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">spatial</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">knn</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">search_params</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat13search_paramsE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ivf_flat_types.hpp&gt;</em></div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat13search_params8n_probesE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat13search_params8n_probesE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat13search_params8n_probesE"></span><span id="raft::spatial::knn::ivf_flat::search_params::n_probes__uint32_t"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1search__params_1ae11798df7987c1986aee094fb5180dd5"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_probes</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">20</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat13search_params8n_probesE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>The number of clusters to search. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div aria-label="Footer" class="rst-footer-buttons" role="navigation">
        <a accesskey="p" class="btn btn-neutral float-left" href="random.html" rel="prev" title="Random"><span aria-hidden="true" class="fa fa-arrow-circle-left"></span> Previous</a>
        <a accesskey="n" class="btn btn-neutral float-right" href="sparse.html" rel="next" title="Sparse">Next <span aria-hidden="true" class="fa fa-arrow-circle-right"></span></a>
    </div>

  <hr>

  <div role="contentinfo">
    <p>&copy; Copyright 2022, nvidia.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 


<script defer id="rapids-selector-js" src="/assets/js/custom.js"></script><script id="rapids-selector-pixel-invocation" type="text/javascript">_satellite.pageBottom();</script></body></html>