<!-- HTML header for doxygen 1.8.20--><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta content="text/xhtml;charset=utf-8" http-equiv="Content-Type">
<meta content="IE=9" http-equiv="X-UA-Compatible">
<meta content="Doxygen 1.8.20" name="generator">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>RMM: per_device_resource.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<script src="jquery.js" type="text/javascript"></script>
<script src="dynsections.js" type="text/javascript"></script>
<link href="search/search.css" rel="stylesheet" type="text/css">
<script src="search/searchdata.js" type="text/javascript"></script>
<script src="search/search.js" type="text/javascript"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<!-- RAPIDS CUSTOM JS & CSS: START, Please add these two lines back after every version upgrade -->
<script defer src="https://docs.rapids.ai/assets/js/custom.js"></script>
<link href="https://docs.rapids.ai/assets/css/custom.css" rel="stylesheet">
<!-- RAPIDS CUSTOM JS & CSS: END -->
<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" id="rapids-fa-tag" rel="stylesheet"><script id="rapids-selector-pixel-src" src="https://assets.adobedtm.com/5d4962a43b79/814eb6e9b4e1/launch-4bc07f1e0b0b.min.js"></script><link href="/assets/css/custom.css" id="rapids-selector-css" rel="stylesheet"></head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea"><div id="rapids-doxygen-container"><div class="rapids-home-container"><a class="rapids-home-container__home-btn" href="/api">Home</a></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">librmm</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/clx/stable/api.html">clx</a><a class="rapids-selector__menu-item" href="/api/cucim/stable/api.html">cucim</a><a class="rapids-selector__menu-item" href="/api/cudf/stable/index.html">cudf</a><a class="rapids-selector__menu-item" href="/api/cudf-java/stable">cudf-java</a><a class="rapids-selector__menu-item" href="/api/cugraph/stable">cugraph</a><a class="rapids-selector__menu-item" href="/api/cuml/stable/api.html">cuml</a><a class="rapids-selector__menu-item" href="/api/cusignal/stable/api.html">cusignal</a><a class="rapids-selector__menu-item" href="/api/cuspatial/stable">cuspatial</a><a class="rapids-selector__menu-item" href="/api/cuxfilter/stable">cuxfilter</a><a class="rapids-selector__menu-item" href="/api/dask-cuda/stable/api.html">dask-cuda</a><a class="rapids-selector__menu-item" href="/api/kvikio/stable/api.html">kvikio</a><a class="rapids-selector__menu-item" href="/api/libcudf/stable/namespacecudf.html">libcudf</a><a class="rapids-selector__menu-item" href="/api/libcugraph/stable">libcugraph</a><a class="rapids-selector__menu-item" href="/api/libcuml/stable">libcuml</a><a class="rapids-selector__menu-item" href="/api/libcuspatial/stable">libcuspatial</a><a class="rapids-selector__menu-item" href="/api/libkvikio/stable">libkvikio</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/librmm/stable/annotated.html">librmm</a><a class="rapids-selector__menu-item" href="/api/raft/stable">raft</a><a class="rapids-selector__menu-item" href="/api/rapids-cmake/stable/api.html">rapids-cmake</a><a class="rapids-selector__menu-item" href="/api/rmm/stable/api.html">rmm</a></div></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">nightly (22.08)</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/librmm/nightly/annotated.html">nightly (22.08)</a><a class="rapids-selector__menu-item" href="/api/librmm/stable/annotated.html">stable (22.06)</a><a class="rapids-selector__menu-item" href="/api/librmm/legacy/annotated.html">legacy (22.04)</a></div></div></div>

</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script src="menudata.js" type="text/javascript"></script>
<script src="menu.js" type="text/javascript"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)">
</iframe>
</div>

<div class="navpath" id="nav-path">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_5337baf0b33a4669aff4110e3e3840c1.html">rmm</a></li><li class="navelem"><a class="el" href="dir_ae5c469e7b915eb6e477229fa888af20.html">mr</a></li><li class="navelem"><a class="el" href="dir_f1ed285de97e886a5c5f9bcf93707a3b.html">device</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">per_device_resource.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Management of per-device <code>device_memory_resource</code>s.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;rmm/cuda_device.hpp&gt;</code><br>
<code>#include &lt;rmm/detail/export.hpp&gt;</code><br>
<code>#include &lt;rmm/mr/device/cuda_memory_resource.hpp&gt;</code><br>
<code>#include &lt;rmm/mr/device/device_memory_resource.hpp&gt;</code><br>
<code>#include &lt;map&gt;</code><br>
<code>#include &lt;mutex&gt;</code><br>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for per_device_resource.hpp:</div>
<div class="dyncontent">
<div class="center"><img alt border="0" src="per__device__resource_8hpp__incl.png" usemap="#aper__device__resource_8hpp"></div>
<map id="aper__device__resource_8hpp" name="per__device__resource_8hpp">
<area alt coords="566,5,750,32" shape="rect" title="Management of per-device device_memory_resources.">
<area alt coords="27,259,193,285" href="cuda__device_8hpp_source.html" shape="rect" title=" ">
<area alt coords="635,87,803,114" href="export_8hpp_source.html" shape="rect" title=" ">
<area alt coords="385,80,560,121" href="cuda__memory__resource_8hpp_source.html" shape="rect" title=" ">
<area alt coords="545,169,720,211" href="device__memory__resource_8hpp_source.html" shape="rect" title=" ">
<area alt coords="827,87,878,114" shape="rect" title=" ">
<area alt coords="902,87,966,114" shape="rect" title=" ">
<area alt coords="167,333,323,360" href="error_8hpp_source.html" shape="rect" title=" ">
<area alt coords="5,408,156,435" shape="rect" title=" ">
<area alt coords="394,408,519,435" href="logger_8hpp_source.html" shape="rect" title=" ">
<area alt coords="177,490,257,517" shape="rect" title=" ">
<area alt coords="291,490,350,517" shape="rect" title=" ">
<area alt coords="587,408,657,435" shape="rect" title=" ">
<area alt coords="283,408,369,435" shape="rect" title=" ">
<area alt coords="379,483,521,524" shape="rect" title=" ">
<area alt coords="545,490,669,517" shape="rect" title=" ">
<area alt coords="269,259,476,285" href="cuda__stream__view_8hpp_source.html" shape="rect" title=" ">
<area alt coords="529,333,600,360" shape="rect" title=" ">
<area alt coords="687,259,861,285" href="aligned_8hpp_source.html" shape="rect" title=" ">
<area alt coords="603,259,663,285" shape="rect" title=" ">
<area alt coords="347,333,414,360" shape="rect" title=" ">
<area alt coords="438,333,505,360" shape="rect" title=" ">
<area alt coords="719,333,797,360" shape="rect" title=" ">
<area alt coords="821,333,871,360" shape="rect" title=" ">
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img alt border="0" src="per__device__resource_8hpp__dep__incl.png" usemap="#aper__device__resource_8hppdep"></div>
<map id="aper__device__resource_8hppdep" name="per__device__resource_8hppdep">
<area alt coords="139,5,323,32" shape="rect" title="Management of per-device device_memory_resources.">
<area alt coords="5,80,143,107" href="device__buffer_8hpp.html" shape="rect" title="RAII construct for device memory allocation.">
<area alt coords="45,155,193,181" href="device__uvector_8hpp_source.html" shape="rect" title=" ">
<area alt coords="106,229,245,256" href="device__scalar_8hpp_source.html" shape="rect" title=" ">
<area alt coords="269,80,463,107" href="polymorphic__allocator_8hpp_source.html" shape="rect" title=" ">
<area alt coords="487,80,695,107" href="thrust__allocator__adaptor_8hpp_source.html" shape="rect" title=" ">
<area alt coords="413,155,553,181" href="device__vector_8hpp_source.html" shape="rect" title=" ">
<area alt coords="450,229,623,256" href="thrust__rmm__allocator_8h_source.html" shape="rect" title=" ">
<area alt coords="629,155,753,181" href="exec__policy_8hpp.html" shape="rect" title=" ">
</map>
</div>
</div>
<p><a href="per__device__resource_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tbody><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8be55b82ca1fcd81cddd707e25dbbe8b"><td align="right" class="memItemLeft" valign="top">device_memory_resource *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="per__device__resource_8hpp.html#a8be55b82ca1fcd81cddd707e25dbbe8b">rmm::mr::detail::initial_resource</a> ()</td></tr>
<tr class="memdesc:a8be55b82ca1fcd81cddd707e25dbbe8b"><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns a pointer to the initial resource.  <a href="per__device__resource_8hpp.html#a8be55b82ca1fcd81cddd707e25dbbe8b">More...</a><br></td></tr>
<tr class="separator:a8be55b82ca1fcd81cddd707e25dbbe8b"><td class="memSeparator" colspan="2">&nbsp;</td></tr>
<tr class="memitem:a5ace167b1fe2399e901eccad527d6896"><td align="right" class="memItemLeft" valign="top"><a id="a5ace167b1fe2399e901eccad527d6896"></a>
std::mutex &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><b>rmm::mr::detail::map_lock</b> ()</td></tr>
<tr class="separator:a5ace167b1fe2399e901eccad527d6896"><td class="memSeparator" colspan="2">&nbsp;</td></tr>
<tr class="memitem:ac0fde3236bf64121df0c3502b3979290"><td align="right" class="memItemLeft" valign="top"><a id="ac0fde3236bf64121df0c3502b3979290"></a>
RMM_EXPORT auto &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><b>rmm::mr::detail::get_map</b> ()</td></tr>
<tr class="separator:ac0fde3236bf64121df0c3502b3979290"><td class="memSeparator" colspan="2">&nbsp;</td></tr>
<tr class="memitem:ae36992092d6747790208049598cb40d5"><td align="right" class="memItemLeft" valign="top">device_memory_resource *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="per__device__resource_8hpp.html#ae36992092d6747790208049598cb40d5">rmm::mr::get_per_device_resource</a> (cuda_device_id device_id)</td></tr>
<tr class="memdesc:ae36992092d6747790208049598cb40d5"><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the resource for the specified device.  <a href="per__device__resource_8hpp.html#ae36992092d6747790208049598cb40d5">More...</a><br></td></tr>
<tr class="separator:ae36992092d6747790208049598cb40d5"><td class="memSeparator" colspan="2">&nbsp;</td></tr>
<tr class="memitem:aaa65b924cf2a4a038586d2cdf41752b8"><td align="right" class="memItemLeft" valign="top">device_memory_resource *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="per__device__resource_8hpp.html#aaa65b924cf2a4a038586d2cdf41752b8">rmm::mr::set_per_device_resource</a> (cuda_device_id device_id, device_memory_resource *new_mr)</td></tr>
<tr class="memdesc:aaa65b924cf2a4a038586d2cdf41752b8"><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the <code><a class="el" href="classrmm_1_1mr_1_1device__memory__resource.html" title="Base class for all libcudf device memory allocation.">device_memory_resource</a></code> for the specified device.  <a href="per__device__resource_8hpp.html#aaa65b924cf2a4a038586d2cdf41752b8">More...</a><br></td></tr>
<tr class="separator:aaa65b924cf2a4a038586d2cdf41752b8"><td class="memSeparator" colspan="2">&nbsp;</td></tr>
<tr class="memitem:a95bf69637b8f3d29b13b33562370fc8f"><td align="right" class="memItemLeft" valign="top">device_memory_resource *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="per__device__resource_8hpp.html#a95bf69637b8f3d29b13b33562370fc8f">rmm::mr::get_current_device_resource</a> ()</td></tr>
<tr class="memdesc:a95bf69637b8f3d29b13b33562370fc8f"><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the memory resource for the current device.  <a href="per__device__resource_8hpp.html#a95bf69637b8f3d29b13b33562370fc8f">More...</a><br></td></tr>
<tr class="separator:a95bf69637b8f3d29b13b33562370fc8f"><td class="memSeparator" colspan="2">&nbsp;</td></tr>
<tr class="memitem:a3d74a9fb18c09c8f6409ac222b559d44"><td align="right" class="memItemLeft" valign="top">device_memory_resource *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="per__device__resource_8hpp.html#a3d74a9fb18c09c8f6409ac222b559d44">rmm::mr::set_current_device_resource</a> (device_memory_resource *new_mr)</td></tr>
<tr class="memdesc:a3d74a9fb18c09c8f6409ac222b559d44"><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the memory resource for the current device.  <a href="per__device__resource_8hpp.html#a3d74a9fb18c09c8f6409ac222b559d44">More...</a><br></td></tr>
<tr class="separator:a3d74a9fb18c09c8f6409ac222b559d44"><td class="memSeparator" colspan="2">&nbsp;</td></tr>
</tbody></table>
<a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Management of per-device <code>device_memory_resource</code>s. </p>
<p>One might wish to construct a <code>device_memory_resource</code> and use it for (de)allocation without explicit dependency injection, i.e., passing a reference to that object to all places it is to be used. Instead, one might want to set their resource as a "default" and have it be used in all places where another resource has not been explicitly specified. In applications with multiple GPUs in the same process, it may also be necessary to maintain independent default resources for each device. To this end, the <code>set_per_device_resource</code> and <code>get_per_device_resource</code> functions enable mapping a CUDA device id to a <code>device_memory_resource</code> pointer.</p>
<p>For example, given a pointer, <code>mr</code>, to a <code>device_memory_resource</code> object, calling <code>set_per_device_resource(cuda_device_id{0}, mr)</code> will establish a mapping between CUDA device 0 and <code>mr</code> such that all future calls to <code>get_per_device_resource(cuda_device_id{0})</code> will return the same pointer, <code>mr</code>. In this way, all places that use the resource returned from <code>get_per_device_resource</code> for (de)allocation will use the user provided resource, <code>mr</code>.</p>
<dl class="section note"><dt>Note</dt><dd><code>device_memory_resource</code>s make CUDA API calls without setting the current CUDA device. Therefore a memory resource should only be used with the current CUDA device set to the device that was active when the memory resource was created. Calling <code>set_per_device_resource(id, mr)</code> is only valid if <code>id</code> refers to the CUDA device that was active when <code>mr</code> was created.</dd></dl>
<p>If no resource was explicitly set for a given device specified by <code>id</code>, then <code>get_per_device_resource(id)</code> will return a pointer to a <code>cuda_memory_resource</code>.</p>
<p>To fetch and modify the resource for the current CUDA device, <code><a class="el" href="per__device__resource_8hpp.html#a95bf69637b8f3d29b13b33562370fc8f" title="Get the memory resource for the current device.">get_current_device_resource()</a></code> and <code><a class="el" href="per__device__resource_8hpp.html#a3d74a9fb18c09c8f6409ac222b559d44" title="Set the memory resource for the current device.">set_current_device_resource()</a></code> will automatically use the current CUDA device id from <code>cudaGetDevice()</code>.</p>
<p>Creating a device_memory_resource for each device requires care to set the current device before creating each resource, and to maintain the lifetime of the resources as long as they are set as per-device resources. Here is an example loop that creates <code>unique_ptr</code>s to pool_memory_resource objects for each device and sets them as the per-device resource for that device.</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">std::vector&lt;unique_ptr&lt;pool_memory_resource&gt;&gt; per_device_pools;</div>
<div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; N; ++i) {</div>
<div class="line">  cudaSetDevice(i);</div>
<div class="line">  per_device_pools.push_back(std::make_unique&lt;pool_memory_resource&gt;());</div>
<div class="line">  <a class="code" href="per__device__resource_8hpp.html#aaa65b924cf2a4a038586d2cdf41752b8">set_per_device_resource</a>(cuda_device_id{i}, &amp;per_device_pools.back());</div>
<div class="line">}</div>
</div><!-- fragment --> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a95bf69637b8f3d29b13b33562370fc8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95bf69637b8f3d29b13b33562370fc8f">◆&nbsp;</a></span>get_current_device_resource()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tbody><tr>
  <td class="mlabels-left">
      <table class="memname">
        <tbody><tr>
          <td class="memname">device_memory_resource* rmm::mr::get_current_device_resource </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </tbody></table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</tbody></table>
</div><div class="memdoc">

<p>Get the memory resource for the current device. </p>
<p>Returns a pointer to the resource set for the current device. The initial resource is a <code>cuda_memory_resource</code>.</p>
<p>The "current device" is the device returned by <code>cudaGetDevice</code>.</p>
<p>This function is thread-safe with respect to concurrent calls to <code>set_per_device_resource</code>, <code>get_per_device_resource</code>, <code>get_current_device_resource</code>, and <code>set_current_device_resource</code>. Concurrent calls to any of these functions will result in a valid state, but the order of execution is undefined.</p>
<dl class="section note"><dt>Note</dt><dd>The returned <code>device_memory_resource</code> should only be used with the current CUDA device. Changing the current device (e.g. using <code>cudaSetDevice()</code>) and then using the returned resource can result in undefined behavior. The behavior of a device_memory_resource is undefined if used while the active CUDA device is a different device from the one that was active when the device_memory_resource was created.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the resource for the current device </dd></dl>

</div>
</div>
<a id="ae36992092d6747790208049598cb40d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae36992092d6747790208049598cb40d5">◆&nbsp;</a></span>get_per_device_resource()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tbody><tr>
  <td class="mlabels-left">
      <table class="memname">
        <tbody><tr>
          <td class="memname">device_memory_resource* rmm::mr::get_per_device_resource </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrmm_1_1cuda__device__id.html">cuda_device_id</a>&nbsp;</td>
          <td class="paramname"><em>device_id</em></td><td>)</td>
          <td></td>
        </tr>
      </tbody></table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</tbody></table>
</div><div class="memdoc">

<p>Get the resource for the specified device. </p>
<p>Returns a pointer to the <code>device_memory_resource</code> for the specified device. The initial resource is a <code>cuda_memory_resource</code>.</p>
<p><code>id.value()</code> must be in the range <code>[0, cudaGetDeviceCount())</code>, otherwise behavior is undefined.</p>
<p>This function is thread-safe with respect to concurrent calls to <code>set_per_device_resource</code>, <code>get_per_device_resource</code>, <code>get_current_device_resource</code>, and <code>set_current_device_resource</code>. Concurrent calls to any of these functions will result in a valid state, but the order of execution is undefined.</p>
<dl class="section note"><dt>Note</dt><dd>The returned <code>device_memory_resource</code> should only be used when CUDA device <code>id</code> is the current device (e.g. set using <code>cudaSetDevice()</code>). The behavior of a device_memory_resource is undefined if used while the active CUDA device is a different device from the one that was active when the device_memory_resource was created.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramname">id</td><td>The id of the target device </td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the current <code>device_memory_resource</code> for device <code>id</code> </dd></dl>

</div>
</div>
<a id="a8be55b82ca1fcd81cddd707e25dbbe8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8be55b82ca1fcd81cddd707e25dbbe8b">◆&nbsp;</a></span>initial_resource()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tbody><tr>
  <td class="mlabels-left">
      <table class="memname">
        <tbody><tr>
          <td class="memname">device_memory_resource* rmm::mr::detail::initial_resource </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </tbody></table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</tbody></table>
</div><div class="memdoc">

<p>Returns a pointer to the initial resource. </p>
<p>Returns a global instance of a <code>cuda_memory_resource</code> as a function local static.</p>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the static cuda_memory_resource used as the initial, default resource </dd></dl>

</div>
</div>
<a id="a3d74a9fb18c09c8f6409ac222b559d44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d74a9fb18c09c8f6409ac222b559d44">◆&nbsp;</a></span>set_current_device_resource()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tbody><tr>
  <td class="mlabels-left">
      <table class="memname">
        <tbody><tr>
          <td class="memname">device_memory_resource* rmm::mr::set_current_device_resource </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classrmm_1_1mr_1_1device__memory__resource.html">device_memory_resource</a> *&nbsp;</td>
          <td class="paramname"><em>new_mr</em></td><td>)</td>
          <td></td>
        </tr>
      </tbody></table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</tbody></table>
</div><div class="memdoc">

<p>Set the memory resource for the current device. </p>
<p>If <code>new_mr</code> is not <code>nullptr</code>, sets the resource pointer for the current device to <code>new_mr</code>. Otherwise, resets the resource to the initial <code>cuda_memory_resource</code>.</p>
<p>The "current device" is the device returned by <code>cudaGetDevice</code>.</p>
<p>The object pointed to by <code>new_mr</code> must outlive the last use of the resource, otherwise behavior is undefined. It is the caller's responsibility to maintain the lifetime of the resource object.</p>
<p>This function is thread-safe with respect to concurrent calls to <code>set_per_device_resource</code>, <code>get_per_device_resource</code>, <code>get_current_device_resource</code>, and <code>set_current_device_resource</code>. Concurrent calls to any of these functions will result in a valid state, but the order of execution is undefined.</p>
<dl class="section note"><dt>Note</dt><dd>The resource passed in <code>new_mr</code> must have been created for the current CUDA device. The behavior of a device_memory_resource is undefined if used while the active CUDA device is a different device from the one that was active when the device_memory_resource was created.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramname">new_mr</td><td>If not <code>nullptr</code>, pointer to new resource to use for the current device </td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the previous resource for the current device </dd></dl>

</div>
</div>
<a id="aaa65b924cf2a4a038586d2cdf41752b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa65b924cf2a4a038586d2cdf41752b8">◆&nbsp;</a></span>set_per_device_resource()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tbody><tr>
  <td class="mlabels-left">
      <table class="memname">
        <tbody><tr>
          <td class="memname">device_memory_resource* rmm::mr::set_per_device_resource </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrmm_1_1cuda__device__id.html">cuda_device_id</a>&nbsp;</td>
          <td class="paramname"><em>device_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classrmm_1_1mr_1_1device__memory__resource.html">device_memory_resource</a> *&nbsp;</td>
          <td class="paramname"><em>new_mr</em>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </tbody></table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</tbody></table>
</div><div class="memdoc">

<p>Set the <code>device_memory_resource</code> for the specified device. </p>
<p>If <code>new_mr</code> is not <code>nullptr</code>, sets the memory resource pointer for the device specified by <code>id</code> to <code>new_mr</code>. Otherwise, resets <code>id</code>s resource to the initial <code>cuda_memory_resource</code>.</p>
<p><code>id.value()</code> must be in the range <code>[0, cudaGetDeviceCount())</code>, otherwise behavior is undefined.</p>
<p>The object pointed to by <code>new_mr</code> must outlive the last use of the resource, otherwise behavior is undefined. It is the caller's responsibility to maintain the lifetime of the resource object.</p>
<p>This function is thread-safe with respect to concurrent calls to <code>set_per_device_resource</code>, <code>get_per_device_resource</code>, <code>get_current_device_resource</code>, and <code>set_current_device_resource</code>. Concurrent calls to any of these functions will result in a valid state, but the order of execution is undefined.</p>
<dl class="section note"><dt>Note</dt><dd>The resource passed in <code>new_mr</code> must have been created when device <code>id</code> was the current CUDA device (e.g. set using <code>cudaSetDevice()</code>). The behavior of a device_memory_resource is undefined if used while the active CUDA device is a different device from the one that was active when the device_memory_resource was created.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramname">id</td><td>The id of the target device </td></tr>
    <tr><td class="paramname">new_mr</td><td>If not <code>nullptr</code>, pointer to new <code>device_memory_resource</code> to use as new resource for <code>id</code> </td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the previous memory resource for <code>id</code> </dd></dl>

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="aper__device__resource_8hpp_html_aaa65b924cf2a4a038586d2cdf41752b8"><div class="ttname"><a href="per__device__resource_8hpp.html#aaa65b924cf2a4a038586d2cdf41752b8">rmm::mr::set_per_device_resource</a></div><div class="ttdeci">device_memory_resource * set_per_device_resource(cuda_device_id device_id, device_memory_resource *new_mr)</div><div class="ttdoc">Set the device_memory_resource for the specified device.</div><div class="ttdef"><b>Definition:</b> per_device_resource.hpp:164</div></div>
<!-- start footer part -->
<hr class="footer"><address class="footer"><small>
Generated by&nbsp;<a href="http://www.doxygen.org/index.html"><img alt="doxygen" class="footer" height="31" src="doxygen.svg" width="104"></a> 1.8.20
</small></address>


<script defer id="rapids-selector-js" src="/assets/js/custom.js"></script><script id="rapids-selector-pixel-invocation" type="text/javascript">_satellite.pageBottom();</script></body></html>